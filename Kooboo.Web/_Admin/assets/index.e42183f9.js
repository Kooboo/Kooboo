var C=(E,s,o)=>new Promise((u,r)=>{var a=v=>{try{_(o.next(v))}catch(m){r(m)}},g=v=>{try{_(o.throw(v))}catch(m){r(m)}},_=v=>v.done?u(v.value):Promise.resolve(v.value).then(a,g);_((o=o.apply(E,s)).next())});import{_ as ee}from"./k-table.b1a54b80.js";import{b as j,X as oe,Y as te,Z as le,_ as ae,w as ne,$ as se,a0 as re,a1 as me}from"./main.9fdfea92.js";import{g as B,o as ie,w as G}from"./i18n.a87944a4.js";import{b as ue}from"./use-date.f1258183.js";import{s as M}from"./confirm.b60b5d2f.js";import{_ as X}from"./index.f0d5f031.js";import{a as R,s as de,R as L,C as ce,e as pe,p as fe}from"./validate.bb56f9e3.js";import{E as Y}from"./index.178b9e08.js";import{E as Z,a as H}from"./index.9fd79879.js";import{E as F}from"./index.c003dfa1.js";import{d as T,g as V,o as b,j as O,w as n,b as l,u as e,cd as _e,c as P,b8 as ve,aI as N,t as d,k as U,e as be,f as t,a as A,b7 as ge,n as xe,F as J,O as we,aG as Ve}from"./url.4cb47a7a.js";import{E as Q}from"./windi.6360286d.js";import{E as ye}from"./index.fd96ea36.js";import{E as W}from"./index.361e2245.js";import{u as he}from"./replace-all.56d2c1f7.js";import{E as Oe}from"./index.b38edc72.js";import"./sortable.esm.a99254e8.js";import"./icon-button.74ccc970.js";import"./index.d96452a6.js";import"./focus-trap.50a00b7f.js";import"./isNil.98bb3b88.js";import"./event.53b2ad83.js";import"./index.7b8c5aef.js";import"./index.4f90a917.js";import"./index.4d568055.js";import"./index.c6da2706.js";import"./index.7c862087.js";import"./error.7e8331f1.js";import"./event.776e7e11.js";import"./scroll.16983984.js";import"./isEqual.4cab74e3.js";import"./_baseIsEqual.dc9e64c4.js";import"./debounce.4e0c106e.js";import"./toNumber.47eea968.js";import"./index.66319a92.js";import"./validator.b5df2420.js";import"./index.42922617.js";import"./index.f15f695e.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";import"./dayjs.min.ccc40d4f.js";import"./logo-transparent.1566007e.js";import"./index.f2c1b903.js";import"./index.c10802d9.js";import"./aria.75ec5909.js";import"./index.d24a40b9.js";import"./index.f23f1e38.js";import"./index.a24f458a.js";import"./index.1fd72ea8.js";import"./index.abe211fa.js";import"./style.c350d462.js";import"./_baseClone.b8903935.js";import"./refs.3132cbdb.js";const ke=T({props:{modelValue:{type:Boolean}},emits:["update:modelValue","addSuccess"],setup(E,{emit:s}){const o=j(),{t:u}=B(),r=V(),a=V({userName:"",organizationId:o.currentOrg.id}),g=V(!0),_=V({userName:[R(u("common.fieldRequiredTips")),de()]}),v=()=>C(this,null,function*(){yield r.value.validate(),yield oe(a.value),g.value=!1,a.value.userName="",s("addSuccess")});return(m,p)=>{const k=Y,y=Z,c=H,i=X,f=F;return b(),O(f,{modelValue:g.value,"onUpdate:modelValue":p[3]||(p[3]=h=>g.value=h),width:"400px",title:e(u)("common.addMember"),onClosed:p[4]||(p[4]=h=>s("update:modelValue",!1))},{footer:n(()=>[l(i,{"confirm-label":e(u)("common.add"),onConfirm:v,onCancel:p[2]||(p[2]=h=>g.value=!1)},null,8,["confirm-label"])]),default:n(()=>[l(c,{ref_key:"form",ref:r,modal:a.value,rules:_.value,"label-position":"top",model:a.value,onSubmit:p[1]||(p[1]=G(()=>{},["prevent"]))},{default:n(()=>[l(y,{prop:"userName",label:e(u)("common.username")},{default:n(()=>[l(k,{modelValue:a.value.userName,"onUpdate:modelValue":p[0]||(p[0]=h=>a.value.userName=h),onKeydown:ie(v,["enter"])},null,8,["modelValue","onKeydown"])]),_:1},8,["label"])]),_:1},8,["modal","rules","model"])]),_:1},8,["modelValue","title"])}}}),Ce={class:"px-16 mt-8 space-y-8"},Ue=["onClick"],$e={class:"flex justify-between items-center py-24 pr-4"},Ne={class:"flex items-center justify-between w-[460px]"},Ee={class:"flex items-center"},ze=["title"],Ae={key:0,class:"flex-1 text-12px flex items-center bg-blue/10 text-blue px-10px h-20px rounded-full mx-12"},De=T({props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(E,{emit:s}){const{t:o}=B(),u=j(),r=_e(),a=V(),g=P(()=>{var f;const i=(f=_.value)==null?void 0:f.find(h=>h.id===a.value);return i?i.isAdmin===!0:!1}),_=V(),v=V(!0),m=()=>C(this,null,function*(){yield M(o("common.switchOrganizationTips")),yield te(a.value),u.logout(),r.push({name:"login"})}),p=()=>C(this,null,function*(){yield M(o("common.departOrganizationTips")),yield le(a.value),u.logout(),r.push({name:"login"})}),k=P(()=>{var i;return!((i=_.value)!=null&&i.some(f=>f.isAdmin===!0))}),y=()=>C(this,null,function*(){yield ae(),c()}),c=()=>C(this,null,function*(){_.value=yield ne(),a.value=u.currentOrg.id});return c(),(i,f)=>{const h=Q,z=ye,$=W,D=F,S=ve("hasPermission");return b(),O(D,{modelValue:v.value,"onUpdate:modelValue":f[1]||(f[1]=x=>v.value=x),width:"650px",title:e(o)("common.organizationAdmin"),"custom-class":"el-dialog--zero-padding",onClosed:f[2]||(f[2]=x=>s("update:modelValue",!1))},{footer:n(()=>[l($,{"data-cy":"cancel-in-dialog",onClick:f[0]||(f[0]=x=>v.value=!1)},{default:n(()=>[N(d(e(o)("common.cancel")),1)]),_:1}),l($,{round:"",disabled:e(g)||!a.value,onClick:p},{default:n(()=>[N(d(e(o)("common.depart")),1)]),_:1},8,["disabled"]),e(k)?(b(),O($,{key:0,round:"",onClick:y},{default:n(()=>[N(d(e(o)("common.createOwnOrg")),1)]),_:1})):U("",!0),be((b(),O($,{round:"",type:"primary",disabled:e(u).currentOrg.id===a.value||!a.value,onClick:m},{default:n(()=>[N(d(e(o)("domain.switch")),1)]),_:1},8,["disabled"])),[[S,{feature:"style",action:"edit"}]])]),default:n(()=>[l(z,{"max-height":"240px",always:""},{default:n(()=>[t("ul",Ce,[(b(!0),A(J,null,ge(_.value,x=>(b(),A("li",{key:x.id,class:xe(["pl-16 pr-8 cursor-pointer border-transparent hover:border-blue border-1 border-solid rounded-normal hover:bg-[#2296F3] hover:bg-opacity-10",x.id===a.value?"  bg-[#2296F3] bg-opacity-10 !border-blue":""]),onClick:I=>a.value=x.id},[t("div",$e,[t("div",Ne,[t("div",Ee,[t("span",{class:"ellipsis max-w-200px leading-5",title:x.name},d(x.name),9,ze),x.id===e(u).currentOrg.id?(b(),A("span",Ae,d(e(o)("common.currentOrganization")),1)):U("",!0)]),t("span",null,d(x.members)+" "+d(e(o)("organization.members")),1)]),t("div",null,[x.id===a.value?(b(),O(h,{key:0,class:"iconfont icon-Select2 text-green text-xl"})):U("",!0)])])],10,Ue))),128))])]),_:1})]),_:1},8,["modelValue","title"])}}}),Se=T({props:{modelValue:{type:Boolean}},emits:["update:modelValue","create-success"],setup(E,{emit:s}){const{t:o}=B(),u=V(!0),r=V({userName:"",password:"",email:"",phone:""}),a=V(),g={userName:[R(o("common.fieldRequiredTips")),L(o("common.username"),2,30)],password:[ce,R(o("common.inputPasswordTips")),L(o("common.password"),2,30)],email:[pe,R(o("common.inputEmailTips"))],phone:[fe]},_=()=>C(this,null,function*(){yield a.value.validate(),yield se(r.value),u.value=!1,s("create-success")});return(v,m)=>{const p=Y,k=Z,y=H,c=F;return b(),O(c,{"model-value":u.value,width:"670px",title:e(o)("common.create"),onClosed:m[6]||(m[6]=i=>s("update:modelValue",!1))},{footer:n(()=>[l(X,{onConfirm:_,onCancel:m[5]||(m[5]=i=>u.value=!1)})]),default:n(()=>[l(y,{ref_key:"form",ref:a,class:"el-form--label-normal",model:r.value,rules:g,"label-position":"left","label-width":"150px",onSubmit:m[4]||(m[4]=G(()=>{},["prevent"]))},{default:n(()=>[l(k,{prop:"userName",label:e(o)("common.username")},{default:n(()=>[l(p,{modelValue:r.value.userName,"onUpdate:modelValue":m[0]||(m[0]=i=>r.value.userName=i),class:"w-400px"},null,8,["modelValue"])]),_:1},8,["label"]),l(k,{prop:"password",label:e(o)("common.password")},{default:n(()=>[l(p,{modelValue:r.value.password,"onUpdate:modelValue":m[1]||(m[1]=i=>r.value.password=i),class:"w-400px",type:"password"},null,8,["modelValue"])]),_:1},8,["label"]),l(k,{prop:"email",label:e(o)("common.email")},{default:n(()=>[l(p,{modelValue:r.value.email,"onUpdate:modelValue":m[2]||(m[2]=i=>r.value.email=i),class:"w-400px"},null,8,["modelValue"])]),_:1},8,["label"]),l(k,{prop:"phone",label:e(o)("common.phone")},{default:n(()=>[l(p,{modelValue:r.value.phone,"onUpdate:modelValue":m[3]||(m[3]=i=>r.value.phone=i),class:"w-400px"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["model-value","title"])}}}),Re={class:"p-24 space-y-16"},Be={class:"flex gap-8 items-center dark:text-gray"},Te={class:"flex space-x-24"},Ie={class:"text-blue ml-8"},Me={class:"text-blue ml-8"},je={class:"text-blue ml-8"},Fe=t("div",{class:"flex-1"},null,-1),qe={class:"flex items-center"},Ke={class:"flex items-center"},Le={class:"h-60px flex items-center justify-between px-16"},Pe={class:"flex items-center"},Ge={class:"flex items-center"},Xe={class:"flex items-center"},Ye={key:0,class:"text-12px flex items-center bg-blue/10 text-blue px-10px h-20px rounded-full ml-16"},Ho=T({setup(E){const{t:s}=B(),o=j(),u=V([]),r=V(!1),a=V(!1),g=V(!1),_=()=>C(this,null,function*(){var y;u.value=yield re((y=o.currentOrg)==null?void 0:y.id),u.value.forEach(c=>{c.$DisabledSelect=c.isAdmin})}),v=()=>{r.value=!0},m=()=>{g.value=!0},p=()=>{a.value=!0},k=y=>C(this,null,function*(){yield M(s("common.removeMemberTips"));const c={organizationId:o.currentOrg.id,userName:y[0].userName};yield me(c),_()});return _(),(y,c)=>{var D,S,x,I,q;const i=Q,f=W,h=we("router-link"),z=Oe,$=ee;return b(),A(J,null,[t("div",Re,[t("div",Be,[t("ul",Te,[t("li",null,[t("span",null,d(e(s)("common.currentOrganization"))+":",1),t("span",Ie,d((D=e(o).currentOrg)==null?void 0:D.name),1)]),t("li",null,[N(d(e(s)("common.members"))+":",1),t("span",Me,d((S=u.value)==null?void 0:S.length),1)]),t("li",null,[N(d(e(s)("common.identity"))+":",1),t("span",je,d((x=e(o).currentOrg)!=null&&x.isAdmin?e(s)("common.admin"):e(s)("common.member")),1)])]),Fe,t("div",null,[l(h,{to:e(he)({name:"departments"}),class:"mx-8"},{default:n(()=>[l(f,{round:""},{default:n(()=>[l(i,{class:"iconfont icon-module1 text-blue"}),t("div",qe,d(e(s)("common.departments")),1)]),_:1})]),_:1},8,["to"])]),t("div",null,[l(f,{round:"",onClick:p},{default:n(()=>[l(i,{class:"iconfont icon-qiehuanjiaose text-blue"}),t("div",Ke,d(e(s)("common.organizationAdmin")),1)]),_:1})])]),l($,{data:u.value,"show-check":(I=e(o).currentOrg)==null?void 0:I.isAdmin,"is-radio":!0,onDelete:k},Ve({default:n(()=>[l(z,{label:e(s)("common.userName")},{default:n(({row:w})=>[t("div",Xe,[t("span",null,d(w.userName),1),w.isAdmin?(b(),A("span",Ye,d(e(s)("common.admin")),1)):U("",!0)])]),_:1},8,["label"]),l(z,{prop:"emailAddress",label:e(s)("common.email")},null,8,["label"]),l(z,{label:e(s)("common.joinDate")},{default:n(({row:w})=>[t("span",null,d(e(ue)(w.joinDate)),1)]),_:1},8,["label"])]),_:2},[(q=e(o).currentOrg)!=null&&q.isAdmin?{name:"leftBar",fn:n(()=>{var w,K;return[t("div",Le,[(w=e(o).currentOrg)!=null&&w.isAdmin?(b(),O(f,{key:0,round:"",onClick:v},{default:n(()=>[l(i,{class:"iconfont icon-a-addto"}),t("div",Pe,d(e(s)("common.addMember")),1)]),_:1})):U("",!0),(K=e(o).currentOrg)!=null&&K.isAdmin?(b(),O(f,{key:1,round:"",onClick:m},{default:n(()=>[l(i,{class:"iconfont icon-a-addto"}),t("div",Ge,d(e(s)("common.createMember")),1)]),_:1})):U("",!0)])]})}:void 0]),1032,["data","show-check"])]),r.value?(b(),O(ke,{key:0,modelValue:r.value,"onUpdate:modelValue":c[0]||(c[0]=w=>r.value=w),onAddSuccess:_},null,8,["modelValue"])):U("",!0),g.value?(b(),O(Se,{key:1,modelValue:g.value,"onUpdate:modelValue":c[1]||(c[1]=w=>g.value=w),onCreateSuccess:c[2]||(c[2]=w=>_())},null,8,["modelValue"])):U("",!0),a.value?(b(),O(De,{key:2,modelValue:a.value,"onUpdate:modelValue":c[3]||(c[3]=w=>a.value=w)},null,8,["modelValue"])):U("",!0)],64)}}});export{Ho as default};
