import{b as x,_ as O,a as $,c as w,d as q,e as T}from"./basic.4940a9e4.js";import{g as A}from"./main.582f9de6.js";import{K as F,L}from"./dev-mode.1f379952.js";import{e as N}from"./guid.c1a40312.js";import{c as M,d as Q,g as P,aV as j,o as v,j as V,w as m,b as c,u as o,k as D}from"./url.8f5ec20c.js";import{g as G}from"./i18n.bcd18f8a.js";import{_ as H}from"./plugin-vue_export-helper.21dcd24c.js";import{E as z,a as J}from"./index.af31fb90.js";function R(t){const f=A(),u=F(),d=L();t.id===N&&(t.metas=[]);const y=M(()=>{for(const e of t.metas)e.el||(e.el=x(e,f.default));return t.metas}),b=e=>{const n=t.metas.find(l=>l.el===e.el);if(n){e.el=x(e,f.default);const l=t.metas.indexOf(n);t.metas.splice(l,1,e)}else e.el=x(e,f.default),t.metas.push(e)},h=M(()=>{const e=[];if(!t.styles)return e;for(const n of t.styles){const l=u.all.find(i=>i.href===n);l?e.push({content:l.name,id:l.id}):e.push({content:n,id:""})}return e}),p=e=>{var l,i;const n=u.all.find(s=>s.id===e.id);n?t.styles=(l=t.styles)==null?void 0:l.filter(s=>s!==n.href):t.styles=(i=t.styles)==null?void 0:i.filter(s=>s!==e.content)},B=e=>{var l;const n=u.all.find(i=>i.id===e);n&&((l=t.styles)==null||l.push(n.href))},U=e=>{if(!t.styles)return;const n=t.styles.splice(e.oldIndex,1);t.styles.splice(e.newIndex,0,n[0])},I=M(()=>{const e=[];if(!t.scripts)return e;for(const n of t.scripts){const l=d.all.find(i=>i.href===n);l?e.push({content:l.name,id:l.id,position:"head"}):e.push({content:n,id:"",position:"head"})}return e});return{metas:y,addOrUpdateMeta:b,styles:h,insertStyle:B,deleteStyle:p,sortStyle:U,scripts:I,insertScript:e=>{var l;const n=d.all.find(i=>i.id===e);n&&((l=t.scripts)==null||l.push(n.href))},sortScript:e=>{if(!t.scripts)return;const n=t.scripts.splice(e.oldIndex,1);t.scripts.splice(e.newIndex,0,n[0])},deleteScript:e=>{var l,i;const n=d.all.find(s=>s.id===e.id);n?t.scripts=(l=t.scripts)==null?void 0:l.filter(s=>s!==n.href):t.scripts=(i=t.scripts)==null?void 0:i.filter(s=>s!==e.content)}}}const W=Q({props:{model:null,oldUrlPath:null,layout:null,sources:null,hideStyles:{type:Boolean},hideScripts:{type:Boolean}},setup(t,{expose:f}){const u=t,{t:d}=G(),{metas:y,addOrUpdateMeta:b,deleteScript:h,deleteStyle:p,insertScript:B,insertStyle:U,scripts:I,sortScript:C,sortStyle:k,styles:K}=R(u.model),e=P(),n=P([]),l=P([]);return f({validate:()=>{var i;return(i=e.value)==null?void 0:i.validate()}}),j(()=>{var i;(i=u.sources)==null||i.forEach(s=>{var a,S;!s.source.metaBindings||!s.source.urlParamsBindings||(s.source.metaBindings.length&&(n.value=n.value.concat((a=s.source)==null?void 0:a.metaBindings)),s.source.urlParamsBindings.length&&(l.value=l.value.concat((S=s.source)==null?void 0:S.urlParamsBindings)))})}),(i,s)=>{const a=z,S=J;return v(),V(S,{"model-value":"basic"},{default:m(()=>[c(a,{name:"basic",title:o(d)("common.basic")},{default:m(()=>[c(O,{ref_key:"basicForm",ref:e,url:t.model.urlPath,"onUpdate:url":s[0]||(s[0]=r=>t.model.urlPath=r),titles:t.model.contentTitle,"onUpdate:titles":s[1]||(s[1]=r=>t.model.contentTitle=r),published:t.model.published,"onUpdate:published":s[2]||(s[2]=r=>t.model.published=r),"old-url-path":t.oldUrlPath,"meta-bindings":n.value,"url-params-bindings":l.value},null,8,["url","titles","published","old-url-path","meta-bindings","url-params-bindings"])]),_:1},8,["title"]),c(a,{title:o(d)("common.HTMLMeta"),"data-cy":"meta"},{default:m(()=>[c($,{list:o(y),"meta-bindings":n.value,onDelete:s[3]||(s[3]=r=>t.model.metas=o(y).filter(E=>E!==r)),onAddOrUpdate:o(b)},null,8,["list","meta-bindings","onAddOrUpdate"])]),_:1},8,["title"]),t.hideStyles?D("",!0):(v(),V(a,{key:0,title:o(d)("common.style"),"data-cy":"style"},{default:m(()=>[c(w,{list:o(K),onSort:o(k),onInsert:o(U),onDelete:o(p)},null,8,["list","onSort","onInsert","onDelete"])]),_:1},8,["title"])),t.hideScripts?D("",!0):(v(),V(a,{key:1,title:o(d)("common.scripts"),"data-cy":"script"},{default:m(()=>[c(q,{list:o(I),"hidde-body":"",onSort:o(C),onDelete:o(h),onInsert:o(B)},null,8,["list","onSort","onDelete","onInsert"])]),_:1},8,["title"])),c(a,{title:o(d)("common.cache"),"data-cy":"cache"},{default:m(()=>[c(T,{enable:t.model.enableCache,"onUpdate:enable":s[4]||(s[4]=r=>t.model.enableCache=r),enableVersion:t.model.cacheByVersion,"onUpdate:enableVersion":s[5]||(s[5]=r=>t.model.cacheByVersion=r),minutes:t.model.cacheMinutes,"onUpdate:minutes":s[6]||(s[6]=r=>t.model.cacheMinutes=r),queryKeys:t.model.cacheQueryKeys,"onUpdate:queryKeys":s[7]||(s[7]=r=>t.model.cacheQueryKeys=r)},null,8,["enable","enableVersion","minutes","queryKeys"])]),_:1},8,["title"])]),_:1})}}});var nt=H(W,[["__scopeId","data-v-284b8341"]]);export{nt as P};
