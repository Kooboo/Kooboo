var V=(s,d,u)=>new Promise((f,a)=>{var m=n=>{try{o(u.next(n))}catch(c){a(c)}},p=n=>{try{o(u.throw(n))}catch(c){a(c)}},o=n=>n.done?f(n.value):Promise.resolve(n.value).then(m,p);o((u=u.apply(s,d)).next())});import{f as D}from"./index.d75a71d9.js";import{b as q}from"./_baseUniq.c69c2d82.js";import{E,a as I}from"./index.0d2684bf.js";import{d as C,g as v,h as Q,i as L,o as g,j as x,w as M,a as O,b6 as $,F as A}from"./url.2e6a77c4.js";function F(s){return s&&s.length?q(s):[]}const j=C({props:{inputValue:null,disableQuery:{type:Boolean}},emits:["update:modelValue"],setup(s,{emit:d}){const u=s,f=e=>e.trim().replace(/<\s+/g,"<").replace(/\s+>/g,">").replace(/([^<])</g,"$1 <"),a=v(),m=v(""),p=v(),o=v(""),n=v(!0),c=e=>{n.value?e.input.focus():n.value=!0,a.value.query="",o.value=""};Q(()=>{a.value.input.onclick=e=>e.stopPropagation()});const b=e=>{o.value=e.query},h=e=>{var t,l;[";","Tab"].includes(e.key)&&(e.preventDefault(),_(e),(l=(t=a.value)==null?void 0:t.input)==null||l.focus())},w=e=>{var l;const t=(l=e.clipboardData)==null?void 0:l.getData("text");if(e.preventDefault(),t){const i=t.split(";");y(i)}},_=function(e){var t;if(o.value){if(e.preventDefault(),!u.inputValue.includes(o.value))y([m.value]);else{let l=u.inputValue.indexOf(o.value);u.inputValue.splice(l,1)}(t=e.target)==null||t.focus()}else n.value=!1;o.value="",a.value.query=""};L(()=>{var e;return(e=a.value)==null?void 0:e.query},e=>{e?m.value=e:p.value=[]});const k=e=>V(this,null,function*(){e&&!u.disableQuery?D(e).then(t=>p.value=t).catch(()=>p.value=[]):p.value=[]}),y=e=>{const t=[...u.inputValue,...e].map(l=>l.trim()).filter(l=>l).map(f);d("update:modelValue",F(t))};function B(e){var i;if(!((i=e==null?void 0:e.target)!=null&&i.value))return;var t=e.target.value;const l=u.inputValue.length;setTimeout(()=>{l==u.inputValue.length&&(e.target.value=t,_(e))},200)}return(e,t)=>{const l=E,i=I;return g(),x(i,{ref_key:"inputRef",ref:a,"model-value":s.inputValue,placeholder:" ",class:"w-480px ellipsis el-hover-title selectInput",multiple:"",filterable:"","allow-create":"",remote:"","popper-class":"el-select-popper","default-first-option":"","reserve-keyword":!1,"remote-method":k,"fit-input-width":"","onUpdate:modelValue":t[0]||(t[0]=r=>d("update:modelValue",r.map(f))),onKeydown:h,onChange:t[1]||(t[1]=r=>c(a.value)),onInput:t[2]||(t[2]=r=>b(a.value)),onPaste:w,onBlur:B},{default:M(()=>[(g(!0),O(A,null,$(p.value,r=>(g(),x(l,{key:r,label:r,value:r,title:r},null,8,["label","value","title"]))),128))]),_:1},8,["model-value"])}}});export{j as _};
