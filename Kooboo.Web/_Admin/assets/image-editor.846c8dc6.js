import{d as L,g as p,E as Q,o as b,a as _,f as a,t as f,u as o,bz as W,b as r,w as u,aF as X,aH as R,F as Y,b6 as G,n as E,b3 as J,b1 as K}from"./url.2e6a77c4.js";import{a as O,s as P}from"./validate.efc4a5c0.js";import{b as Z}from"./image-editor.vue_vue_type_style_index_0_scoped_true_lang.f6d26366.js";import{g as ee}from"./i18n.48bd28ac.js";import{_ as te}from"./plugin-vue_export-helper.21dcd24c.js";import{E as ae}from"./index.fc90f5ad.js";import{E as le,a as oe}from"./index.6855d037.js";import{E as ne}from"./index.2bc50276.js";const w=l=>(J("data-v-734893f0"),l=l(),K(),l),se={class:"edit-image p-24 h-min-750px"},ie={class:"text-2l font-bold mb-24 dark:text-gray"},de={class:"flex mb-32"},re={class:"w-390px mr-21px"},ce={class:"py-24 pt-28px px-24px bg-fff dark:bg-444 rounded-normal shadow-s-10"},ue={class:"min-h-80px max-h-261px h-[calc(100vh-600px)] overflow-hidden shadow-l-20 flex items-center justify-center rounded-6px"},me=["src"],he={class:"mt-24 space-y-12 file-info"},pe=["href","title"],fe={class:"p-24 bg-fff dark:bg-444 rounded-normal shadow-s-10 mt-16"},ve={class:"flex justify-between"},xe=["data-cy","onClick"],ge={class:"edit-image__tool2 mt-16 flex justify-between items-center"},be={class:"flex items-center"},_e=w(()=>a("span",{class:"px-12"},"X",-1)),we=w(()=>a("span",{class:"px-12"},"Y",-1)),ye=w(()=>a("div",{class:"px-12 relative"},[a("span",{class:"absolute bottom-[-12px] left-4"},"\u3002")],-1)),ke={class:"space-x-24 text-right mt-18px"},Ce={class:"rounded-normal px-24 w-720px flex items-center justify-center h-auto shadow-s-10"},Ie={class:"flex justify-center min-h-300px min-w-300px max-h-562px"},Ve=L({props:{name:null,url:null,siteUrl:null,alt:null,base64:null,ext:null},emits:["update:alt","update:name","update:base64"],setup(l,{expose:N,emit:S}){var C;const{t:i}=ee(),v=p(),c=p(),h=p(0),U=[{text:i("common.free"),ratio:0},{text:"16:9",ratio:16/9},{text:"4:3",ratio:4/5},{text:"1:1",ratio:1/1},{text:"2:3",ratio:2/3}],d=p(0),s=Q({width:0,height:0}),j=p(),F=[O(i("common.nameRequiredTips")),P()],T=t=>W(t,{t:Date.now()});function $(){if(!c.value)return;const{canvas:t}=c.value.getResult();t&&S("update:base64",t.toDataURL())}function y(){setTimeout(()=>{if(c.value){const{coordinates:t}=c.value.getResult();s.width=t.width,s.height=t.height}},100)}function z(t){var e;(e=c.value)==null||e.reset(),d.value=t.ratio,y()}function k(t){var m;const e={width:t};d.value>0&&(e.height=s.width*d.value),(m=c.value)==null||m.setCoordinates(e)}function B(){var t;if(d.value>0){const e=s.height*d.value;k(e)}else(t=c.value)==null||t.setCoordinates({height:s.height})}function D(){y()}let x=h.value;function M(){var t;if(isNaN(h.value)){h.value=x;return}(t=c.value)==null||t.rotate(h.value-x),x=h.value}function q(){d.value?d.value=0:s.height>0&&s.width>0&&(d.value=s.width/s.height)}return N({validate(t){var e;(e=v.value)==null||e.validate(t)},reset:(C=v.value)==null?void 0:C.resetFields}),(t,e)=>{var I,V;const m=ae,g=le,A=oe,H=ne;return b(),_("div",se,[a("div",ie,f(o(i)("common.editImage")),1),a("div",de,[a("div",re,[a("div",ce,[a("div",ue,[a("img",{ref_key:"img",ref:j,src:l.base64||T((I=l.siteUrl)!=null?I:l.url),class:"rounded-6px w-full h-full object-contain","data-cy":"preview-image"},null,8,me)]),a("div",he,[r(A,{ref_key:"form",ref:v,class:"el-form--label-normal","label-position":"left","label-width":"120px",model:{name:l.name,alt:l.alt,url:l.url}},{default:u(()=>[r(g,{label:o(i)("common.fileName"),class:"pb-16",prop:"name",rules:F},{default:u(()=>[r(m,{"model-value":l.name,placeholder:o(i)("common.fileName"),"data-cy":"fileName",onInput:e[0]||(e[0]=n=>t.$emit("update:name",n))},X({_:2},[l.ext?{name:"append",fn:u(()=>[R(f(l.ext),1)])}:void 0]),1032,["model-value","placeholder"])]),_:1},8,["label"]),r(g,{label:o(i)("common.altText"),prop:"alt",class:"pb-16"},{default:u(()=>[r(m,{"model-value":l.alt,placeholder:o(i)("common.altText"),"data-cy":"alt",onInput:e[1]||(e[1]=n=>t.$emit("update:alt",n))},null,8,["model-value","placeholder"])]),_:1},8,["label"]),r(g,{class:"mb-16",label:o(i)("common.url")},{default:u(()=>[a("a",{class:"text-[#999] break-all hover:underline",href:l.url,target:"_blank",title:o(i)("common.preview"),"data-cy":"url"},f(l.url),9,pe)]),_:1},8,["label"])]),_:1},8,["model"])])]),a("div",fe,[a("div",ve,[(b(!0),_(Y,null,G(o(U),n=>(b(),_("div",{key:n.text,class:E(["k-button dark:text-gray",{"k-button--checked":d.value===n.ratio}]),"data-cy":`radio-${n.text}`,onClick:Re=>z(n)},f(n.text),11,xe))),128))]),a("div",ge,[a("div",be,[r(m,{modelValue:o(s).width,"onUpdate:modelValue":e[2]||(e[2]=n=>o(s).width=n),modelModifiers:{number:!0},placeholder:o(i)("common.width"),class:"mr-4","data-cy":"width",onChange:e[3]||(e[3]=n=>k(o(s).width))},{append:u(()=>[_e]),_:1},8,["modelValue","placeholder"]),a("div",{class:E(["iconfont icon-lock text-m mx-6px cursor-pointer text-444",d.value?"icon-lock":"icon-unlock"]),onClick:q},null,2),r(m,{modelValue:o(s).height,"onUpdate:modelValue":e[4]||(e[4]=n=>o(s).height=n),modelModifiers:{number:!0},placeholder:o(i)("common.height"),class:"ml-4","data-cy":"height",onChange:B},{append:u(()=>[we]),_:1},8,["modelValue","placeholder"])]),a("div",null,[r(m,{modelValue:h.value,"onUpdate:modelValue":e[5]||(e[5]=n=>h.value=n),modelModifiers:{number:!0},placeholder:o(i)("common.angle"),onChange:M},{append:u(()=>[ye]),_:1},8,["modelValue","placeholder"])])]),a("div",ke,[r(H,{type:"primary",round:"",class:"min-w-134px","data-cy":"crop",onClick:$},{default:u(()=>[R(f(o(i)("common.crop")),1)]),_:1})])])]),a("div",Ce,[a("div",Ie,[r(o(Z),{ref_key:"cropper",ref:c,class:"cropper",src:l.base64||((V=l.siteUrl)!=null?V:l.url),"stencil-props":{aspectRatio:d.value},onChange:D},null,8,["src","stencil-props"])])])])])}}});var ze=te(Ve,[["__scopeId","data-v-734893f0"]]);export{ze as I};
