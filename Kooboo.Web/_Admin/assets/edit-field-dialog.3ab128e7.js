var Me=Object.defineProperty;var ae=Object.getOwnPropertySymbols;var Re=Object.prototype.hasOwnProperty,Oe=Object.prototype.propertyIsEnumerable;var te=(r,s,i)=>s in r?Me(r,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[s]=i,oe=(r,s)=>{for(var i in s||(s={}))Re.call(s,i)&&te(r,i,s[i]);if(ae)for(var i of ae(s))Oe.call(s,i)&&te(r,i,s[i]);return r};var ne=(r,s,i)=>new Promise((m,b)=>{var o=g=>{try{R(i.next(g))}catch(S){b(S)}},V=g=>{try{R(i.throw(g))}catch(S){b(S)}},R=g=>g.done?m(g.value):Promise.resolve(g.value).then(o,V);R((i=i.apply(r,s)).next())});import{_ as De}from"./tooltip.28a451cc.js";import{g as re,o as A,w as ie}from"./i18n.48bd28ac.js";import{u as P,_ as Be,g as Ie}from"./index.453b96b0.js";import{_ as Ae}from"./key-value-editor.b270c5cd.js";import{_ as Ue,a as $e}from"./selection-editor.b60c224d.js";import{d as H,c as y,o as d,j as v,u as a,a as U,f as q,t as k,b as u,w as n,L as Ke,g as M,h as Le,i as ze,n as qe,aH as h,k as T,b6 as Pe,F as He}from"./url.2e6a77c4.js";import{_ as me}from"./plugin-vue_export-helper.21dcd24c.js";import{a as ce,E as Je}from"./index.6855d037.js";import{T as We}from"./index.f83f40c4.js";import{_ as je}from"./dev-mode.c4133b5a.js";import{b as Ge,p as Qe}from"./config.9fb52765.js";import{a as se,r as Xe,l as ue,o as Ye}from"./validate.efc4a5c0.js";import{_ as Ze}from"./index.a731e53b.js";import{u as el}from"./main.ea42d807.js";import{a as ll,i as al}from"./string.955a924b.js";import{i as tl}from"./isEmpty.dc565ae5.js";import{c as ol}from"./cloneDeep.ff43c1f8.js";import{E as nl}from"./index.fc90f5ad.js";import{E as il}from"./index.77edae39.js";import{E as sl,a as ul}from"./index.0d2684bf.js";import{E as dl,a as rl}from"./index.be352e91.js";import{E as ml}from"./index.a439b087.js";import{E as cl}from"./index.c4e9b529.js";const pe=H({props:{field:null,model:null,overrideField:null,rules:null},setup(r){const s=r,{getControlType:i}=P(),m=y(()=>i(s.field.controlType)),b=y(()=>{var o,V;return oe({lang:"",name:s.field.name,displayName:s.field.displayName||s.field.name,multipleValue:s.field.multipleValue,isMultilingual:!1,prop:s.field.name,toolTip:s.field.tooltip||"",settings:(o=s.field.settings)!=null?o:{},selectionOptions:((V=m.value)==null?void 0:V.value)==="Selection"?[]:s.field.selectionOptions,controlType:s.field.controlType},s.overrideField)});return(o,V)=>(d(),v(Be,{field:a(b),model:r.model,rules:r.rules},null,8,["field","model","rules"]))}});const pl={class:"mt-16"},fl={class:"font-bold py-5px"},vl={class:"bg-gray/60 rounded-4px p-10px pointer-events-none dark:bg-[#333]","data-cy":"preview"},yl=H({props:{field:null},setup(r){const s=r,{t:i}=re(),{getControlType:m}=P(),b=y(()=>m(s.field.controlType)),o=y(()=>{let V="";return b.value&&(b.value.value==="Switch"?V=!1:b.value.value==="CheckBox"&&(V=[])),{[s.field.name]:V}});return(V,R)=>{const g=ce;return d(),U("div",pl,[q("div",fl,k(a(i)("common.preview")),1),q("div",vl,[u(g,{"label-position":"top"},{default:n(()=>[u(pe,{field:r.field,model:a(o)},null,8,["field","model"])]),_:1})])])}}});var de=me(yl,[["__scopeId","data-v-59cef87a"]]);const gl={class:"w-full flex items-center"},_l={key:1},bl=H({props:{modelValue:{type:Boolean},fields:null,field:null,options:null,showDefaultValue:{type:Boolean},hidePreviewField:{type:Boolean},enableDynamicOptions:{type:Boolean}},emits:["update:modelValue"],setup(r,{emit:s}){const i=r;Ge(),Qe();const{site:m}=el(),{fields:b}=Ke(i),{t:o}=re(),V=M(!0),R=`const products = k.commerce.product.list();
return products.map(it => {
    return {
        key: it.title,
        value: it.id,
    }
});`.replaceAll(`
`,"<br/>").replaceAll(" ","&nbsp;"),g=[{displayName:o("common.basic"),value:"Basic"},{displayName:o("common.advanced"),value:"Advanced"},{displayName:o("common.validation"),value:"Validation"}],S=M("Basic"),$=M(),K=M(),J=M(),I=M(),W=()=>({name:"",displayName:"",controlType:"TextBox",dataType:"String",isSummaryField:!1,multipleLanguage:!0,editable:!0,tooltip:"",maxLength:0,validations:[],settings:{},isSystemField:!1,multipleValue:!1,displayInSearchResult:!0,selectionOptions:[],order:0}),e=M(W()),D=y(()=>!i.field);let j;const fe=y(()=>{var t;return{name:"defaultValue",prop:"defaultValue",displayName:o("common.defaultValue"),selectionOptions:(t=e.value.selectionOptions)!=null?t:[]}}),ve=y(()=>{var l,p;const t=["MediaFile","AdvancedMediaFile","File","CheckBox","RadioBox","RichEditor","TextArea"].includes((p=(l=C.value)==null?void 0:l.value)!=null?p:"TextBox");return{"field-default-value":!0,"w-full":t,"w-3/5":!t}}),ye=y(()=>!tl(e.value.settings.defaultValue)),ge=y(()=>Ie(e.value)),G=y(()=>i.enableDynamicOptions&&e.value.settings.isDynamicOptions);Le(()=>{var t,l,p,_;if(V.value){(t=$.value)==null||t.resetFields(),(l=Z.value)==null||l.resetFields(),(p=K.value)==null||p.resetFields(),(_=I.value)==null||_.resetFields(),S.value="Basic",i.field?(e.value=i.field,j=JSON.stringify(i.field)):e.value=W();const{tinymceSettings:c,enableTinymceToolbarSettings:O}=m!=null?m:{};O&&(!e.value.settings.toolbar&&c.toolbar&&(e.value.settings.toolbar=c.toolbar),!e.value.settings.font_formats&&c.font_formats&&(e.value.settings.font_formats=c.font_formats),!e.value.settings.font_size_formats&&c.font_size_formats&&(e.value.settings.font_size_formats=c.font_size_formats)),ee()}});const _e={name:[D.value?se(o("common.fieldRequiredTips")):"",Xe(1,50),ue(),Ye(D,b)],options:[{validator(t,l,p){e.value.selectionOptions.length===0?p(new Error(o("common.fieldRequiredTips"))):p()},trigger:"blur"}]},{controlTypes:be,getControlType:Ve,getAvailableControlTypes:Te,defaultAdvancedMediaFileOptions:Fe}=P(),Q=y(()=>i.field?i.field.controlType==="AdvancedMediaFile"?[]:Te(i.field.dataType):be),we=y(()=>[se(o("common.nameRequiredTips")),{validator:(t,l)=>!ll(["src"],l),message:()=>o("common.columnIsReservedWord",{columnName:"src"})},{validator:(t,l)=>{if(!l)return!0;const{pattern:p}=ue();return p.test(l)},message:()=>o("common.letterAndDigitsAllowedToStarting")},{validator(t,l){var p;return((p=e.value.settings.meta)!=null?p:[]).filter(_=>_.key&&al(_.key,l)).length<=1},message:()=>o("common.keyHasBeenTakenTips")}]);ze(()=>e.value.controlType,()=>{var t;e.value.dataType=((t=C.value)==null?void 0:t.dataType)||"String"});const C=y(()=>{var t;if(e.value.controlType)return Ve((t=e.value)==null?void 0:t.controlType)}),X=y(()=>L(["selection","checkbox","radiobox"])),ke=y(()=>L(["mediafile","file","advancedmediafile"])),Y=y(()=>{var l;if((l=i.options)!=null&&l.hideMultipleLanguage)return!1;let t=["TextBox","TextArea","RichEditor","MediaFile","KeyValues"];return!!(C.value&&t.includes(C.value.value))}),Se=y(()=>{var t;return!((t=i.options)!=null&&t.hideValidation)&&!e.value.isSystemField&&!L(["boolean","switch"])}),Z=y(()=>{var t;return(t=J.value)==null?void 0:t.form});function L(t){return e.value.controlType?t.includes(e.value.controlType.toLowerCase()):!1}function B(){return ne(this,null,function*(){var l,p,_,c,O;try{yield(l=$.value)==null?void 0:l.validate(),yield(p=K.value)==null?void 0:p.validate(),console.log("basic success")}catch(x){S.value="Basic";return}try{yield(_=I.value)==null?void 0:_.validate(),console.log("advanced success")}catch(x){S.value="Advanced";return}try{yield(c=Z.value)==null?void 0:c.validate(),console.log("validation success")}catch(x){S.value="Validation";return}const t=ol(e.value);if(Y.value||(t.multipleLanguage=!1),t.displayName||(t.displayName=t.name),(O=t.validations)==null||O.forEach(x=>{delete x.name}),D.value){const x=b.value.findIndex(E=>E.isSystemField),N=b.value.filter(E=>!E.isSystemField).map(E=>E.order);t.order=N.length?Math.max(...N)+1:0,b.value.splice(x,0,t)}else if(j!==JSON.stringify(e.value)){const x=b.value.findIndex(N=>N.name===t.name);b.value[x]=t}m!=null&&m.enableTinymceToolbarSettings&&(t.settings.toolbar===(m==null?void 0:m.tinymceSettings.toolbar)&&delete t.settings.toolbar,t.settings.font_formats===(m==null?void 0:m.tinymceSettings.font_formats)&&delete t.settings.font_formats,t.settings.font_size_formats===(m==null?void 0:m.tinymceSettings.font_size_formats)&&delete t.settings.font_size_formats),V.value=!1})}function xe(){e.value.settings.defaultValue=void 0}function ee(){e.value.controlType==="AdvancedMediaFile"&&(e.value.settings=e.value.settings||{},e.value.settings.meta=e.value.settings.meta||[{key:"alt",value:"{{alt}}"}])}function Ee(t){const l=m.tinymceSettings;e.value.settings[t]=l[t]||void 0}return(t,l)=>{const p=nl,_=il,c=Je,O=sl,x=ul,N=De,E=ce,z=dl,he=rl,Ce=ml,Ne=cl;return d(),v(Ne,{"model-value":V.value,width:"700px","close-on-click-modal":!1,title:a(o)("common.fieldEditor"),"custom-class":"el-dialog--zero-padding",onClosed:l[19]||(l[19]=f=>s("update:modelValue",!1))},{footer:n(()=>[u(Ze,{permission:{feature:"contentType",action:"edit"},onConfirm:B,onCancel:l[18]||(l[18]=f=>V.value=!1)})]),default:n(()=>[u(Ce,{"max-height":"60vh"},{default:n(()=>[u(he,{modelValue:S.value,"onUpdate:modelValue":l[17]||(l[17]=f=>S.value=f),class:qe({"hide-tab":e.value.isSystemField})},{default:n(()=>[u(z,{label:a(g)[0].displayName,name:a(g)[0].value},{default:n(()=>[u(E,{ref_key:"form",ref:$,model:e.value,rules:_e,"label-position":"top",onKeydown:A(B,["enter"])},{default:n(()=>[u(c,{prop:"name",label:a(o)("common.name")},{default:n(()=>{var f;return[q("div",gl,[u(p,{modelValue:e.value.name,"onUpdate:modelValue":l[0]||(l[0]=F=>e.value.name=F),disabled:!a(D),class:"w-3/5","data-cy":"field-name-input"},null,8,["modelValue","disabled"]),!((f=r.options)!=null&&f.hideSummaryField)&&!e.value.isSystemField?(d(),v(_,{key:0,modelValue:e.value.isSummaryField,"onUpdate:modelValue":l[1]||(l[1]=F=>e.value.isSummaryField=F),class:"ml-12","data-cy":"summary-field"},{default:n(()=>[h(k(a(o)("common.summaryField")),1)]),_:1},8,["modelValue"])):T("",!0)])]}),_:1},8,["label"]),u(c,{label:a(o)("common.displayName")},{default:n(()=>[u(p,{modelValue:e.value.displayName,"onUpdate:modelValue":l[2]||(l[2]=f=>e.value.displayName=f),class:"w-3/5","data-cy":"display-name-input"},null,8,["modelValue"])]),_:1},8,["label"]),e.value.isSystemField?(d(),v(c,{key:0},{default:n(()=>[u(_,{modelValue:e.value.editable,"onUpdate:modelValue":l[3]||(l[3]=f=>e.value.editable=f),"data-cy":"user-editable"},{default:n(()=>[h(k(a(o)("common.userEditable")),1)]),_:1},8,["modelValue"])]),_:1})):T("",!0),e.value.isSystemField?T("",!0):(d(),v(c,{key:1,label:a(o)("common.controlType")},{default:n(()=>{var f;return[a(Q).length>1?(d(),v(x,{key:0,modelValue:e.value.controlType,"onUpdate:modelValue":l[4]||(l[4]=F=>e.value.controlType=F),class:"w-3/5","data-cy":"control-type-dropdown",onChange:ee},{default:n(()=>[(d(!0),U(He,null,Pe(a(Q),F=>(d(),v(O,{key:F.value,value:F.value,label:F.displayName,"data-cy":"control-type-opt"},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])):(d(),U("p",_l,k(((f=a(C))==null?void 0:f.displayName)||e.value.controlType),1)),a(X)?(d(),v(_,{key:2,modelValue:e.value.settings.isDynamicOptions,"onUpdate:modelValue":l[5]||(l[5]=F=>e.value.settings.isDynamicOptions=F),class:"ml-12","data-cy":"dynamic-options"},{default:n(()=>[h(k(a(o)("common.dynamicOptions")),1)]),_:1},8,["modelValue"])):T("",!0)]}),_:1},8,["label"])),a(X)?(d(),v(c,{key:2},{label:n(()=>[h(k(a(o)("common.options"))+" ",1),a(G)?(d(),v(N,{key:0,"enable-html":!0,tip:a(o)("common.dynamicOptionsTips",{example:a(R)}),"custom-class":"ml-4"},null,8,["tip"])):T("",!0)]),default:n(()=>[a(G)?(d(),U("div",{key:0,class:"w-full border border-solid border-[#cccccc] focus-within:border-[#2296f3]",onKeydown:l[7]||(l[7]=A(ie(()=>{},["stop"]),["enter"]))},[u(je,{modelValue:e.value.settings.code,"onUpdate:modelValue":l[6]||(l[6]=f=>e.value.settings.code=f),language:"typescript","k-script":""},null,8,["modelValue"])],32)):(d(),v(Ue,{key:1,options:e.value.selectionOptions},null,8,["options"]))]),_:1})):T("",!0),a(ke)?(d(),v(c,{key:3},{default:n(()=>[u(_,{modelValue:e.value.multipleValue,"onUpdate:modelValue":l[8]||(l[8]=f=>e.value.multipleValue=f),disabled:!a(D)||a(ye),"data-cy":"enable-multiple",onChange:xe},{default:n(()=>[h(k(a(o)("common.enableMultiple")),1)]),_:1},8,["modelValue","disabled"])]),_:1})):T("",!0)]),_:1},8,["model","onKeydown"]),r.showDefaultValue?(d(),v(E,{key:0,ref_key:"defaultValueForm",ref:K,"label-position":"top",model:e.value.settings,onKeydown:A(B,["enter"])},{default:n(()=>[u(pe,{"data-cy":"field-default-value",field:e.value,model:e.value.settings,rules:a(ge),"override-field":a(fe),"css-class":a(ve)},null,8,["field","model","rules","override-field","css-class"])]),_:1},8,["model","onKeydown"])):T("",!0),r.hidePreviewField?T("",!0):(d(),v(de,{key:1,field:e.value},null,8,["field"]))]),_:1},8,["label","name"]),e.value.isSystemField?T("",!0):(d(),v(z,{key:0,label:a(g)[1].displayName,name:a(g)[1].value},{default:n(()=>[u(E,{ref_key:"advancedForm",ref:I,"label-position":"top",model:e.value.settings,onKeydown:A(B,["enter"]),onSubmit:l[16]||(l[16]=ie(()=>{},["prevent"]))},{default:n(()=>{var f,F,le;return[((f=a(C))==null?void 0:f.value)==="AdvancedMediaFile"?(d(),v(c,{key:0,label:a(o)("common.meta")},{label:n(()=>[h(k(a(o)("common.meta"))+" ",1),u(N,{"enable-html":!0,tip:a(o)("common.mediaFileAdvancedTips",{parameter:"{{name}}"}),"custom-class":"ml-4"},null,8,["tip"])]),default:n(()=>[u(Ae,{modelValue:e.value.settings.meta,"onUpdate:modelValue":l[9]||(l[9]=w=>e.value.settings.meta=w),prop:"meta","value-input-attributes":{placeholder:a(o)("common.defaultValue")},"key-rules":a(we),"default-options":a(Fe),onDelete:l[10]||(l[10]=()=>{var w;return(w=I.value)==null?void 0:w.validate()})},null,8,["modelValue","value-input-attributes","key-rules","default-options"])]),_:1},8,["label"])):T("",!0),u(c,{label:a(o)("common.tooltip")},{default:n(()=>[u(p,{modelValue:e.value.tooltip,"onUpdate:modelValue":l[11]||(l[11]=w=>e.value.tooltip=w),class:"w-3/5",placeholder:a(o)("common.fieldTooltip"),"data-cy":"tooltip"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),u(c,null,{default:n(()=>[u(_,{modelValue:e.value.editable,"onUpdate:modelValue":l[12]||(l[12]=w=>e.value.editable=w),"data-cy":"user-editable"},{default:n(()=>[h(k(a(o)("common.userEditable")),1)]),_:1},8,["modelValue"])]),_:1}),a(Y)?(d(),v(c,{key:1},{default:n(()=>[u(_,{modelValue:e.value.multipleLanguage,"onUpdate:modelValue":l[13]||(l[13]=w=>e.value.multipleLanguage=w),"data-cy":"enable-multilingual"},{default:n(()=>[h(k(a(o)("common.enableMultilingual")),1)]),_:1},8,["modelValue"])]),_:1})):T("",!0),(F=r.options)!=null&&F.hideDisplayInSearchResult?T("",!0):(d(),v(c,{key:2},{default:n(()=>[u(_,{modelValue:e.value.displayInSearchResult,"onUpdate:modelValue":l[14]||(l[14]=w=>e.value.displayInSearchResult=w),"data-cy":"enable-search"},{default:n(()=>[h(k(a(o)("common.displayInSearchResult")),1)]),_:1},8,["modelValue"])]),_:1})),((le=a(C))==null?void 0:le.value)==="RichEditor"?(d(),v(c,{key:3},{default:n(()=>[u(We,{modelValue:e.value.settings,"onUpdate:modelValue":l[15]||(l[15]=w=>e.value.settings=w),onReset:Ee},null,8,["modelValue"])]),_:1})):T("",!0)]}),_:1},8,["model","onKeydown"]),u(de,{field:e.value},null,8,["field"])]),_:1},8,["label","name"])),a(Se)?(d(),v(z,{key:1,label:a(g)[2].displayName,name:a(g)[2].value},{default:n(()=>[u($e,{ref_key:"fieldValidation",ref:J,field:e.value,onSave:B},null,8,["field"])]),_:1},8,["label","name"])):T("",!0)]),_:1},8,["modelValue","class"])]),_:1})]),_:1},8,["model-value","title"])}}});var Pl=me(bl,[["__scopeId","data-v-0b90412a"]]);export{Pl as E};
