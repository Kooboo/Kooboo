var y=(s,d,u)=>new Promise((f,n)=>{var m=a=>{try{o(u.next(a))}catch(c){n(c)}},p=a=>{try{o(u.throw(a))}catch(c){n(c)}},o=a=>a.done?f(a.value):Promise.resolve(a.value).then(m,p);o((u=u.apply(s,d)).next())});import{x as q}from"./index.3e5d2d38.js";import{e as B}from"./search-provider.8815ed27.js";import{E,a as I}from"./index.9a7a049b.js";import{d as C,g as v,h as L,i as M,o as g,j as x,w as O,a as $,b6 as A,F}from"./url.8f5ec20c.js";function K(s){return s&&s.length?B(s):[]}const j=C({props:{inputValue:null},emits:["update:modelValue"],setup(s,{emit:d}){const u=s,f=e=>e.trim().replace(/<\s+/g,"<").replace(/\s+>/g,">").replace(/([^<])</g,"$1 <"),n=v(),m=v(""),p=v(),o=v(""),a=v(!0),c=e=>{a.value?e.input.focus():a.value=!0,n.value.query="",o.value=""};L(()=>{n.value.input.onclick=e=>e.stopPropagation()});const h=e=>{o.value=e.query},w=e=>{var t,l;[";","Tab"].includes(e.key)&&(e.preventDefault(),_(e),(l=(t=n.value)==null?void 0:t.input)==null||l.focus())},b=e=>{var l;const t=(l=e.clipboardData)==null?void 0:l.getData("text");if(e.preventDefault(),t){const i=t.split(";");V(i)}},_=function(e){var t;if(o.value){if(e.preventDefault(),!u.inputValue.includes(o.value))V([m.value]);else{let l=u.inputValue.indexOf(o.value);u.inputValue.splice(l,1)}(t=e.target)==null||t.focus()}else a.value=!1;o.value="",n.value.query=""};M(()=>{var e;return(e=n.value)==null?void 0:e.query},e=>{e?m.value=e:p.value=[]});const k=e=>y(this,null,function*(){e?q(e).then(t=>p.value=t).catch(()=>p.value=[]):p.value=[]}),V=e=>{const t=[...u.inputValue,...e].map(l=>l.trim()).filter(l=>l).map(f);d("update:modelValue",K(t))};function D(e){var i;if(!((i=e==null?void 0:e.target)!=null&&i.value))return;var t=e.target.value;const l=u.inputValue.length;setTimeout(()=>{l==u.inputValue.length&&(e.target.value=t,_(e))},200)}return(e,t)=>{const l=E,i=I;return g(),x(i,{ref_key:"inputRef",ref:n,"model-value":s.inputValue,placeholder:" ",class:"w-480px ellipsis el-hover-title selectInput",multiple:"",filterable:"","allow-create":"",remote:"","popper-class":"el-select-popper","default-first-option":"","reserve-keyword":!1,"remote-method":k,"fit-input-width":"","onUpdate:modelValue":t[0]||(t[0]=r=>d("update:modelValue",r.map(f))),onKeydown:w,onChange:t[1]||(t[1]=r=>c(n.value)),onInput:t[2]||(t[2]=r=>h(n.value)),onPaste:b,onBlur:D},{default:O(()=>[(g(!0),$(F,null,A(p.value,r=>(g(),x(l,{key:r,label:r,value:r,title:r},null,8,["label","value","title"]))),128))]),_:1},8,["model-value"])}}});export{j as _};
