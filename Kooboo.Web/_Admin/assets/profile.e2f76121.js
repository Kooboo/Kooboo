var oe=Object.defineProperty;var G=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var H=(y,p,e)=>p in y?oe(y,p,{enumerable:!0,configurable:!0,writable:!0,value:e}):y[p]=e,M=(y,p)=>{for(var e in p||(p={}))le.call(p,e)&&H(y,e,p[e]);if(G)for(var e of G(p))ae.call(p,e)&&H(y,e,p[e]);return y};var P=(y,p,e)=>new Promise((s,t)=>{var v=_=>{try{a(e.next(_))}catch(r){t(r)}},n=_=>{try{a(e.throw(_))}catch(r){t(r)}},a=_=>_.done?s(_.value):Promise.resolve(_.value).then(v,n);a((e=e.apply(y,p)).next())});import{_ as se}from"./avatar.3578cce6.js";import{g as S,w as J,o as j,C as te}from"./i18n.25caaace.js";import{_ as W,a as ne}from"./verify-button.5feead40.js";import{p as re,a as B,G as me,A as X,e as ue,I as de,E as ie,C as ce,F as pe}from"./validate.f3c0b03b.js";import{_ as K}from"./index.50326354.js";import{s as fe,u as ve,a as _e,b as we,g as ye,d as be,e as ge,f as Ve}from"./index.ab12ea9e.js";import{E as q,a as F,S as he}from"./index.94998415.js";import{E as D}from"./index.f571dfc9.js";import{E as I}from"./index.a5d96e5a.js";import{d as T,g as w,c as Y,B as L,o as V,j as U,w as c,b as u,u as o,f as m,E as Ne,i as Z,a as A,b6 as xe,F as ee,t as g,aH as Ce,k as R,b2 as Q,aT as ke}from"./url.8f5ec20c.js";import{E as Pe}from"./index.ae7dda3a.js";import{E as Ue,a as $e}from"./index.960b9732.js";import{Q as Ee,b as Be}from"./main.1c3b59e3.js";import"./country-and-region-codes.c36488d2.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./plugin-vue_export-helper.41ffa612.js";import"./windi.a815125a.js";import"./index.e281bb71.js";import"./index.c6488b3c.js";import"./error.7e8331f1.js";import"./index.e9f8834a.js";import"./index.1e7e06b8.js";import"./index.878e2bbf.js";import"./index.adb17f32.js";import"./replace-all.b35629e7.js";import"./index.b065185c.js";import"./index.b1b64a44.js";import"./style.1b77b3a2.js";import"./toNumber.6efebd6a.js";import"./_baseIsEqual.0a4e01e5.js";import"./_baseClone.885c975f.js";import"./isEqual.2e410d13.js";import"./event.776e7e11.js";import"./isNil.98bb3b88.js";import"./index.1d16d007.js";import"./scroll.0cf77af8.js";import"./index.f9c89813.js";import"./focus-trap.81e4fb05.js";import"./refs.d2253dd4.js";import"./index.158cdd11.js";import"./event.53b2ad83.js";import"./debounce.730e1961.js";import"./index.c93fe8e7.js";import"./validator.9b0d789f.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";const Re={class:"flex items-center space-x-8"},Ae=T({props:{modelValue:{type:Boolean},phone:null},emits:["update:modelValue"],setup(y,{emit:p}){const e=y,{t:s}=S(),t=w(!0),v=w(),n=w({phone:"",code:"",regionCode:""}),a=Y(()=>({phone:[re,B(s("common.inputPhoneTips")),me(n.value.regionCode,e.phone.tel)],code:[B(s("common.inputSecurityCodeTips")),X]})),_=w(!0),r=(i,f)=>{i==="phone"&&(_.value=!f)},h=()=>P(this,null,function*(){yield fe(n.value.regionCode+n.value.phone)}),x=()=>{!e.phone||(n.value.regionCode="+86")},l=()=>P(this,null,function*(){yield v.value.validate(),yield ve(n.value.regionCode+n.value.phone,Number(n.value.code)),N(),t.value=!1});x();const N=L("reloadUser");return(i,f)=>{const k=ne,d=q,C=D,b=F,O=I;return V(),U(O,{"model-value":t.value,title:e.phone.tel?o(s)("common.changePhone"):o(s)("common.bindPhone"),width:"400px","custom-class":"!overflow-visible",onClosed:f[5]||(f[5]=$=>p("update:modelValue",!1))},{footer:c(()=>[u(K,{"confirm-label":e.phone.tel?o(s)("common.change"):o(s)("common.bind"),onConfirm:l,onCancel:f[4]||(f[4]=$=>t.value=!1)},null,8,["confirm-label"])]),default:c(()=>[u(b,{ref_key:"form",ref:v,model:n.value,rules:o(a),"label-position":"top",onSubmit:f[3]||(f[3]=J(()=>{},["prevent"])),onKeypress:j(l,["enter"]),onValidate:r},{default:c(()=>[u(d,{prop:"phone",label:o(s)("common.phone")},{default:c(()=>[u(k,{modelValue:n.value.phone,"onUpdate:modelValue":f[0]||(f[0]=$=>n.value.phone=$),regionCode:n.value.regionCode,"onUpdate:regionCode":f[1]||(f[1]=$=>n.value.regionCode=$),"data-cy":"phone-number"},null,8,["modelValue","regionCode"])]),_:1},8,["label"]),u(d,{label:o(s)("common.securityCode"),prop:"code"},{default:c(()=>[m("div",Re,[u(C,{modelValue:n.value.code,"onUpdate:modelValue":f[2]||(f[2]=$=>n.value.code=$),class:"phone_login__code_input",maxlength:"4","data-cy":"security-code"},null,8,["modelValue"]),u(W,{disabled:_.value,"data-cy":"send-security-code",onClick:h},null,8,["disabled"])])]),_:1},8,["label"])]),_:1},8,["model","rules","onKeypress"])]),_:1},8,["model-value","title"])}}}),Se={class:"flex items-center space-x-8"},Te=T({props:{modelValue:{type:Boolean},email:null},emits:["update:modelValue"],setup(y,{emit:p}){const e=y,{t:s}=S(),t=w(!0),v=w(),n=Ne({email:"",code:""}),a=Y(()=>({email:[ue,B(s("common.inputEmailTips")),de(e.email)],code:[B(s("common.inputSecurityCodeTips")),X]})),_=w(!0),r=(N,i)=>{N==="email"&&(_.value=!i)},h=()=>P(this,null,function*(){yield Pe(n.email)}),x=()=>P(this,null,function*(){try{v.value.validate(),yield _e(n.email,+n.code),l(),t.value=!1}catch(N){}}),l=L("reloadUser");return(N,i)=>{const f=D,k=q,d=F,C=I;return V(),U(C,{"close-on-click-modal":!1,"model-value":t.value,title:e.email?o(s)("common.changeEmail"):o(s)("common.bindEmail"),width:"400px","custom-class":"!overflow-visible",onClosed:i[4]||(i[4]=b=>p("update:modelValue",!1))},{footer:c(()=>[u(K,{"confirm-label":e.email?o(s)("common.change"):o(s)("common.bind"),onConfirm:x,onCancel:i[3]||(i[3]=b=>t.value=!1)},null,8,["confirm-label"])]),default:c(()=>[u(d,{ref_key:"form",ref:v,model:o(n),rules:o(a),"label-position":"top",onSubmit:i[2]||(i[2]=J(()=>{},["prevent"])),onKeypress:j(x,["enter"]),onValidate:r},{default:c(()=>[u(k,{label:o(s)("common.email"),prop:"email"},{default:c(()=>[u(f,{modelValue:o(n).email,"onUpdate:modelValue":i[0]||(i[0]=b=>o(n).email=b),"data-cy":"email"},null,8,["modelValue"])]),_:1},8,["label"]),u(k,{label:o(s)("common.securityCode"),prop:"code"},{default:c(()=>[m("div",Se,[u(f,{modelValue:o(n).code,"onUpdate:modelValue":i[1]||(i[1]=b=>o(n).code=b),class:"phone_login__code_input",maxlength:"4","data-cy":"security-code"},null,8,["modelValue"]),u(W,{disabled:_.value,"data-cy":"send-security-code",onClick:h},null,8,["disabled"])])]),_:1},8,["label"])]),_:1},8,["model","rules","onKeypress"])]),_:1},8,["model-value","title"])}}}),Ke=T({props:{modelValue:{type:Boolean},username:null},emits:["update:modelValue"],setup(y,{emit:p}){const e=y,s=w(),t=()=>P(this,null,function*(){a.value.confirmPassword.length>0&&(yield s.value.validateField("confirmPassword"))}),{t:v}=S(),n=w(!0),a=w({confirmPassword:"",password:"",oldPassword:""}),_={oldPassword:B(v("common.fieldRequiredTips"),!1),password:[B(v("common.fieldRequiredTips"),!1),ie,ce],confirmPassword:[B(v("common.fieldRequiredTips"),!1),pe(a.value)]},r=new he(_);Z(()=>a,x=>{x&&r.validate(a,l=>{l||s.value.clearValidate()})},{deep:!0});const h=()=>P(this,null,function*(){if(yield s.value.validate(),a.value.password===a.value.confirmPassword){const x={confirmPassword:a.value.confirmPassword,newPassword:a.value.password,oldPassword:a.value.oldPassword,username:e.username};try{yield we(M({},x)),n.value=!1}catch(l){console.log(l)}}});return(x,l)=>{const N=D,i=q,f=F,k=I;return V(),U(k,{modelValue:n.value,"onUpdate:modelValue":l[5]||(l[5]=d=>n.value=d),width:"400px",title:o(v)("common.changePassword"),onClosed:l[6]||(l[6]=d=>p("update:modelValue",!1))},{footer:c(()=>[u(K,{"confirm-label":o(v)("profile.change"),onConfirm:l[3]||(l[3]=d=>h()),onCancel:l[4]||(l[4]=d=>n.value=!1)},null,8,["confirm-label"])]),default:c(()=>[u(f,{ref_key:"changePasswordForm",ref:s,rules:o(_),"label-position":"top",model:a.value,onKeydown:j(h,["enter"])},{default:c(()=>[u(i,{label:o(v)("common.oldPassword"),prop:"oldPassword"},{default:c(()=>[u(N,{modelValue:a.value.oldPassword,"onUpdate:modelValue":l[0]||(l[0]=d=>a.value.oldPassword=d),type:"password","data-cy":"old-password"},null,8,["modelValue"])]),_:1},8,["label"]),u(i,{label:o(v)("common.newPassword"),prop:"password"},{default:c(()=>[u(N,{modelValue:a.value.password,"onUpdate:modelValue":l[1]||(l[1]=d=>a.value.password=d),type:"password","data-cy":"new-password",onBlur:t},null,8,["modelValue"])]),_:1},8,["label"]),u(i,{label:o(v)("common.confirmPassword"),prop:"confirmPassword"},{default:c(()=>[u(N,{modelValue:a.value.confirmPassword,"onUpdate:modelValue":l[2]||(l[2]=d=>a.value.confirmPassword=d),type:"password","data-cy":"confirm-password"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["rules","model","onKeydown"])]),_:1},8,["modelValue","title"])}}}),qe=T({props:{modelValue:{type:Boolean},currency:null},emits:["update:modelValue"],setup(y,{emit:p}){const e=y,{t:s}=S(),t=w(!0),v=w(),n=w({currency:""}),a=w(),_=()=>P(this,null,function*(){a.value=yield ye(),n.value.currency=JSON.parse(JSON.stringify(e.currency))}),r=()=>P(this,null,function*(){a.value=yield be(n.value.currency),h(),t.value=!1});_();const h=L("reloadUser");return(x,l)=>{const N=Ue,i=$e,f=q,k=F,d=I;return V(),U(d,{"model-value":t.value,title:o(s)("common.changeCurrency"),width:"400px",onClosed:l[2]||(l[2]=C=>p("update:modelValue",!1))},{footer:c(()=>[u(K,{onConfirm:r,onCancel:l[1]||(l[1]=C=>t.value=!1)})]),default:c(()=>[u(k,{ref_key:"form",ref:v,"label-position":"top"},{default:c(()=>[u(f,{prop:"phone",label:o(s)("common.currency")},{default:c(()=>[u(i,{modelValue:n.value.currency,"onUpdate:modelValue":l[0]||(l[0]=C=>n.value.currency=C),class:"w-full","data-cy":"servers"},{default:c(()=>[(V(!0),A(ee,null,xe(a.value,C=>(V(),U(N,{key:C,label:C,value:C,"data-cy":"server-opt"},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},512)]),_:1},8,["model-value","title"])}}}),Fe=T({props:{modelValue:{type:Boolean},name:null},emits:["update:modelValue"],setup(y,{emit:p}){const e=y,{t:s}=S(),t=w(!0),v=w(),n={firstName:B(s("common.fieldRequiredTips")),lastName:B(s("common.fieldRequiredTips"))},a=w({firstName:"",lastName:""}),_=()=>{a.value.firstName=e.name.firstName,a.value.lastName=e.name.lastName},r=()=>P(this,null,function*(){yield v.value.validate(),yield ge(a.value.firstName,a.value.lastName),h(),t.value=!1});_();const h=L("reloadUser");return(x,l)=>{const N=D,i=q,f=F,k=I;return V(),U(k,{"model-value":t.value,title:o(s)("common.editName"),width:"400px",onClosed:l[6]||(l[6]=d=>p("update:modelValue",!1))},{footer:c(()=>[u(K,{onConfirm:r,onCancel:l[5]||(l[5]=d=>t.value=!1)})]),default:c(()=>[u(f,{ref_key:"form",ref:v,model:a.value,rules:o(n),"label-position":"top",onSubmit:l[4]||(l[4]=J(()=>{},["prevent"])),onKeypress:j(r,["enter"])},{default:c(()=>[u(i,{prop:"firstName",label:o(s)("common.firstName")},{default:c(()=>[u(N,{modelValue:a.value.firstName,"onUpdate:modelValue":l[0]||(l[0]=d=>a.value.firstName=d),onBlur:l[1]||(l[1]=d=>a.value.firstName=a.value.firstName.replace(/(^\s*)|(\s*$)/g,""))},null,8,["modelValue"])]),_:1},8,["label"]),u(i,{prop:"lastName",label:o(s)("common.lastName")},{default:c(()=>[u(N,{modelValue:a.value.lastName,"onUpdate:modelValue":l[2]||(l[2]=d=>a.value.lastName=d),onBlur:l[3]||(l[3]=d=>a.value.lastName=a.value.lastName.replace(/(^\s*)|(\s*$)/g,""))},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules","onKeypress"])]),_:1},8,["model-value","title"])}}}),Ie={class:"p-24 bg-fff dark:bg-[#333] rounded-t-normal shadow-s-10 mb-1px","data-cy":"username-abbr"},Oe={class:"flex items-center"},je={class:"text-l text-black dark:text-fff/86 flex items-center","data-cy":"username"},De={class:"mr-8"},Le={class:"p-24 bg-fff dark:bg-[#333] rounded-b-normal shadow-s-10 mb-24"},Je={class:"dark:text-fff/80 text-m"},ze={class:"h-36px leading-9"},Ge={class:"pr-32"},He={class:"flex items-center"},Me=["title"],Qe={key:0,class:"h-36px leading-9"},We={class:"pr-32"},Xe=m("td",{class:"w-200px relative"},[m("span",{class:"absolute top-4"},"********")],-1),Ye={class:"h-36px leading-9"},Ze={class:"pr-32"},eo={class:"flex items-center"},oo=["title"],lo={key:1},ao={class:"h-36px leading-9"},so={class:"pr-32"},to={class:"w-200px"},no={class:""},ro={key:1,class:"h-36px leading-9"},mo={class:"pr-32"},uo={class:"w-200px"},io={class:""},co=T({props:{userName:null,emailAddress:null,tel:null,firstName:null,lastName:null,password:null,currency:null,fullName:null},emits:["reload"],setup(y,{emit:p}){const e=y,s=new te,{t}=S(),v=s.get("jwt_token"),n=Ee(v),a=Be(),_=w({tel:""}),r=w({phone:!1,email:!1,password:!1,name:!1,currency:!1}),h=w({firstName:"",lastName:""}),x=w(""),l=w(""),N=()=>{r.value.phone=!0,_.value.tel=e.tel},i=()=>{r.value.name=!0,h.value.firstName=e.firstName,h.value.lastName=e.lastName},f=()=>{r.value.password=!0,x.value=e.userName},k=()=>{r.value.email=!0,l.value=e.emailAddress,x.value=e.userName},d=()=>{r.value.currency=!0};return Z(()=>r.value,C=>{C.phone||(_.value.tel=""),C.name||(h.value.firstName="",h.value.lastName="")}),(C,b)=>{var O,$,z;return V(),A(ee,null,[m("div",Ie,[m("div",Oe,[u(se,{username:e.userName,size:96,class:"mr-16"},null,8,["username"]),m("div",je,[m("div",De,g(o(t)("common.username"))+":",1),Ce(" "+g(e.userName),1)])])]),m("div",Le,[m("table",Je,[m("tr",ze,[m("td",Ge,g(o(t)("common.email"))+":",1),m("td",He,[m("span",{class:"ellipsis w-200px",title:e.emailAddress||o(t)("common.notBound")},g(e.emailAddress||o(t)("common.notBound")),9,Me)]),m("td",null,[m("div",{class:"text-blue cursor-pointer ml-8","data-cy":"change-email",onClick:k},g(e.emailAddress?o(t)("common.change"):o(t)("common.bind")),1)])]),o(n)?(V(),A("tr",Qe,[m("td",We,g(o(t)("common.password"))+":",1),Xe,m("td",null,[m("div",{class:"text-blue cursor-pointer ml-8","data-cy":"change-password",onClick:f},g(o(t)("profile.change")),1)])])):R("",!0),m("tr",Ye,[m("td",Ze,g(o(t)("profile.name"))+":",1),m("td",eo,[((O=e.firstName)==null?void 0:O.length)+(($=e.lastName)==null?void 0:$.length)?(V(),A("span",{key:0,class:"w-200px ellipsis",title:e.fullName},g(e.fullName),9,oo)):(V(),A("span",lo,g(o(t)("common.none")),1))]),m("td",null,[m("div",{class:"text-blue cursor-pointer ml-8",onClick:i},g(o(t)("common.edit")),1)])]),m("tr",ao,[m("td",so,g(o(t)("profile.phone"))+":",1),m("td",to,[m("div",no,g(e.tel||o(t)("common.notBound")),1)]),m("td",null,[m("div",{class:"text-blue cursor-pointer ml-8",onClick:N},g(e.tel?o(t)("common.change"):o(t)("common.bind")),1)])]),(z=o(a).currentOrg)!=null&&z.isAdmin?(V(),A("tr",ro,[m("td",mo,g(o(t)("common.currency"))+":",1),m("td",uo,[m("div",io,g(e.currency),1)]),m("td",null,[m("div",{class:"text-blue cursor-pointer ml-8",onClick:d},g(o(t)("common.changeCurrency")),1)])])):R("",!0)])]),r.value.phone?(V(),U(Ae,{key:0,modelValue:r.value.phone,"onUpdate:modelValue":b[0]||(b[0]=E=>r.value.phone=E),phone:_.value},null,8,["modelValue","phone"])):R("",!0),r.value.email?(V(),U(Te,{key:1,modelValue:r.value.email,"onUpdate:modelValue":b[1]||(b[1]=E=>r.value.email=E),email:l.value},null,8,["modelValue","email"])):R("",!0),r.value.name?(V(),U(Fe,{key:2,modelValue:r.value.name,"onUpdate:modelValue":b[2]||(b[2]=E=>r.value.name=E),name:h.value},null,8,["modelValue","name"])):R("",!0),r.value.password?(V(),U(Ke,{key:3,modelValue:r.value.password,"onUpdate:modelValue":b[3]||(b[3]=E=>r.value.password=E),username:x.value},null,8,["modelValue","username"])):R("",!0),r.value.currency?(V(),U(qe,{key:4,modelValue:r.value.currency,"onUpdate:modelValue":b[4]||(b[4]=E=>r.value.currency=E),currency:e.currency},null,8,["modelValue","currency"])):R("",!0)],64)}}}),po={class:"w-535px mx-auto mt-32"},fo={class:"text-3l text-black dark:text-fff/86 font-medium mb-32"},ml=T({setup(y){const{t:p}=S(),e=w({userName:"",emailAddress:"",tel:"",firstName:"",lastName:"",fullName:"",password:"",currency:""}),s=()=>P(this,null,function*(){e.value=yield Ve()});return s(),Q("user",e),Q("reloadUser",s),(t,v)=>(V(),A("div",po,[m("div",fo,g(o(p)("common.profile")),1),u(co,ke({userName:e.value.userName,emailAddress:e.value.emailAddress,tel:e.value.tel,firstName:e.value.firstName,lastName:e.value.lastName,fullName:e.value.fullName,password:e.value.password,currency:e.value.currency},{onReload:s}),null,16)]))}});export{ml as default};
