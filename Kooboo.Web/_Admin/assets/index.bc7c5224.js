var I=(N,d,_)=>new Promise((s,p)=>{var e=w=>{try{E(_.next(w))}catch(b){p(b)}},C=w=>{try{E(_.throw(w))}catch(b){p(b)}},E=w=>w.done?s(w.value):Promise.resolve(w.value).then(e,C);E((_=_.apply(N,d)).next())});import{_ as Ve}from"./tooltip.66155ff7.js";import{_ as ge}from"./index.9250b320.js";import{B as we}from"./breadcrumb.f4d80c95.js";import{g as M,k as xe,d as Se}from"./i18n.a87944a4.js";import{u as Fe}from"./use-shortcuts.ff4b1f52.js";import{u as Ee,O as Ce,P as ke,G as Ne}from"./commerce.ded2851e.js";import{r as Ue}from"./monaco.c080bc0a.js";import{_ as ee}from"./index.0e5d639d.js";import{a as Te,_ as $e}from"./selection-editor.988365ad.js";import{a as z,r as le,l as ae}from"./validate.bb56f9e3.js";import{_ as te}from"./index.f0d5f031.js";import{f as O}from"./custom-field.e7199f85.js";import{g as oe}from"./content-folder.c0a1e8dd.js";import{i as ne,a as se}from"./string.955a924b.js";import{_ as de}from"./plugin-vue_export-helper.21dcd24c.js";import{E as ie}from"./index.178b9e08.js";import{E as ue}from"./index.42922617.js";import{E as K,a as Q}from"./index.9fd79879.js";import{E as P,a as G,c as me}from"./index.7c862087.js";import{E as he,a as De}from"./index.4d2ce883.js";import{E as re}from"./index.fd96ea36.js";import{E as pe}from"./index.c003dfa1.js";import{d as q,g as F,c as W,i as X,o as m,j as v,w as a,b as l,u as t,f as x,aI as T,t as g,a as D,b7 as R,F as L,k as U,aA as ce}from"./url.4cb47a7a.js";import{a as Ie,p as Be,c as Oe}from"./useLabels.aeaf94fa.js";import{E as Re}from"./index.6918f0a5.js";import"./windi.6360286d.js";import"./index.d96452a6.js";import"./focus-trap.50a00b7f.js";import"./isNil.98bb3b88.js";import"./event.53b2ad83.js";import"./index.7b8c5aef.js";import"./index.361e2245.js";import"./replace-all.56d2c1f7.js";import"./main.9fdfea92.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";/* empty css                                                               */import"./plugin-vue_export-helper.41ffa612.js";import"./classCompletion.a22e38a6.js";import"./userWorker.b3a6730b.js";import"./editor.main.d2800f63.js";import"./guid.c1a40312.js";import"./vuedraggable.umd.af323a53.js";import"./cloneDeep.c5011aa2.js";import"./_baseClone.b8903935.js";import"./_baseIsEqual.dc9e64c4.js";import"./index.6f16842c.js";import"./event.776e7e11.js";import"./index.4d568055.js";import"./error.7e8331f1.js";import"./index.e3f90979.js";import"./index.d24a40b9.js";import"./index.f23f1e38.js";import"./index.a24f458a.js";import"./index.1fd72ea8.js";import"./index.abe211fa.js";import"./style.c350d462.js";import"./toNumber.47eea968.js";import"./isEqual.4cab74e3.js";import"./scroll.16983984.js";import"./debounce.4e0c106e.js";import"./index.66319a92.js";import"./validator.b5df2420.js";import"./index.c10802d9.js";import"./refs.3132cbdb.js";const Le={class:"w-full flex items-center"},Me={class:"w-full flex items-center"},qe={class:"w-full flex items-center"},Ae=q({props:{modelValue:{type:Boolean},field:null,fields:null},emits:["update:modelValue","success"],setup(N,{emit:d}){const _=N,{t:s}=M(),p=F(!0),e=F(JSON.parse(JSON.stringify(_.field))),C=W(()=>_.fields.filter(f=>!ne(f.name,_.field.name))),E=F([]),w=F(),b=F(),r=[{displayName:s("common.basic"),value:"Basic"},{displayName:s("common.advanced"),value:"Advanced"},{displayName:s("common.validation"),value:"Validation"}],c=F("Basic"),o={name:[z(s("common.fieldRequiredTips")),le(1,50),ae(),{validator(f,n){const k=n==null?void 0:n.toLowerCase();return!C.value.find($=>$.name.toLowerCase()==k)},message:()=>s("common.valueHasBeenTakenTips")}],contentFolder:e.value.isSystemField?[]:[z(s("common.fieldRequiredTips"))]},i=W(()=>xe(e.value,"options.disableMultiple",!1));function V(){return I(this,null,function*(){var f,n;try{yield(n=(f=w.value)==null?void 0:f.form)==null?void 0:n.validate()}catch(k){throw c.value="Validation",Error("Validation not valid")}try{yield b.value.validate()}catch(k){throw c.value="Basic",Error("Basic not valid")}d("success",e.value),p.value=!1})}return X(()=>e.value.type,f=>I(this,null,function*(){var n;se(["Content","RichEditor"],f)&&(e.value.isSummaryField=!1),(n=E.value)!=null&&n.length||(E.value=yield oe())}),{immediate:!0}),(f,n)=>{const k=ie,$=ue,u=K,A=P,y=G,J=$e,ve=Q,H=he,_e=De,ye=re,be=pe;return m(),v(be,{"model-value":p.value,width:"700px","close-on-click-modal":!1,title:t(s)("common.fieldEditor"),"custom-class":"el-dialog--zero-padding",onClosed:n[12]||(n[12]=h=>d("update:modelValue",!1))},{footer:a(()=>[l(te,{onConfirm:V,onCancel:n[11]||(n[11]=h=>p.value=!1)})]),default:a(()=>[l(ye,{"max-height":"60vh"},{default:a(()=>[l(_e,{modelValue:c.value,"onUpdate:modelValue":n[10]||(n[10]=h=>c.value=h)},{default:a(()=>[l(H,{label:t(r)[0].displayName,name:t(r)[0].value},{default:a(()=>[l(ve,{ref_key:"form",ref:b,model:e.value,rules:o,"label-position":"top"},{default:a(()=>{var h;return[l(u,{prop:"name",label:t(s)("common.name")},{default:a(()=>[x("div",Le,[l(k,{modelValue:e.value.name,"onUpdate:modelValue":n[0]||(n[0]=S=>e.value.name=S),disabled:!!e.value.name&&e.value.isSystemField,class:"w-3/5","data-cy":"field-name-input"},null,8,["modelValue","disabled"]),l($,{modelValue:e.value.isSummaryField,"onUpdate:modelValue":n[1]||(n[1]=S=>e.value.isSummaryField=S),class:"ml-12","data-cy":"summary-field"},{default:a(()=>[T(g(t(s)("common.summaryField")),1)]),_:1},8,["modelValue"])])]),_:1},8,["label"]),l(u,{label:t(s)("common.displayName")},{default:a(()=>[l(k,{modelValue:e.value.displayName,"onUpdate:modelValue":n[2]||(n[2]=S=>e.value.displayName=S),class:"w-3/5","data-cy":"display-name-input"},null,8,["modelValue"])]),_:1},8,["label"]),l(u,{prop:"type",label:t(s)("common.controlType")},{default:a(()=>{var S;return[x("div",Me,[l(y,{modelValue:e.value.type,"onUpdate:modelValue":n[3]||(n[3]=B=>e.value.type=B),disabled:e.value.isSystemField,class:"w-3/5","data-cy":"control-type-dropdown"},{default:a(()=>[(m(!0),D(L,null,R(t(O),(B,Y)=>(m(),v(A,{key:Y,value:Y,label:B.displayName},null,8,["value","label"]))),128))]),_:1},8,["modelValue","disabled"]),(S=t(O)[e.value.type])!=null&&S.multiple?(m(),v($,{key:0,modelValue:e.value.multiple,"onUpdate:modelValue":n[4]||(n[4]=B=>e.value.multiple=B),disabled:t(i),class:"ml-12","data-cy":"enable-multiple"},{default:a(()=>[T(g(t(s)("common.enableMultiple")),1)]),_:1},8,["modelValue","disabled"])):U("",!0)])]}),_:1},8,["label"]),(h=t(O)[e.value.type])!=null&&h.selection?(m(),v(u,{key:0,label:t(s)("common.options")},{default:a(()=>[l(J,{options:e.value.selectionOptions},null,8,["options"])]),_:1},8,["label"])):U("",!0),e.value.type=="Content"?(m(),v(u,{key:1,label:t(s)("common.contentFolder"),prop:"contentFolder"},{default:a(()=>[x("div",qe,[l(y,{modelValue:e.value.contentFolder,"onUpdate:modelValue":n[5]||(n[5]=S=>e.value.contentFolder=S),class:"w-3/5"},{default:a(()=>[(m(!0),D(L,null,R(E.value,S=>(m(),v(A,{key:S.name,value:S.name,label:S.name||S.displayName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"]),l($,{modelValue:e.value.embedded,"onUpdate:modelValue":n[6]||(n[6]=S=>e.value.embedded=S),class:"ml-12","data-cy":"enable-embedded"},{default:a(()=>[T(g(t(s)("common.embedded")),1)]),_:1},8,["modelValue"])])]),_:1},8,["label"])):U("",!0)]}),_:1},8,["model"])]),_:1},8,["label","name"]),e.value.isSystemField?U("",!0):(m(),v(H,{key:0,label:t(r)[1].displayName,name:t(r)[1].value},{default:a(()=>[l(u,null,{default:a(()=>[l($,{modelValue:e.value.editable,"onUpdate:modelValue":n[7]||(n[7]=h=>e.value.editable=h)},{default:a(()=>[T(g(t(s)("common.userEditable")),1)]),_:1},8,["modelValue"])]),_:1}),t(O)[e.value.type].multilingual?(m(),v(u,{key:0},{default:a(()=>[l($,{modelValue:e.value.multilingual,"onUpdate:modelValue":n[8]||(n[8]=h=>e.value.multilingual=h)},{default:a(()=>[T(g(t(s)("common.enableMultilingual")),1)]),_:1},8,["modelValue"])]),_:1})):U("",!0),e.value.multiple&&e.value.type=="Content"?(m(),v(u,{key:1},{default:a(()=>[l($,{modelValue:e.value.allowRepetition,"onUpdate:modelValue":n[9]||(n[9]=h=>e.value.allowRepetition=h)},{default:a(()=>[T(g(t(s)("common.allowRepetition")),1)]),_:1},8,["modelValue"])]),_:1})):U("",!0)]),_:1},8,["label","name"])),e.value.isSystemField?U("",!0):(m(),v(H,{key:1,label:t(r)[2].displayName,name:t(r)[2].value},{default:a(()=>[l(Te,{ref_key:"fieldValidation",ref:w,field:{controlType:e.value.type,validations:e.value.validations},onSave:V},null,8,["field"])]),_:1},8,["label","name"]))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model-value","title"])}}});var Je=de(Ae,[["__scopeId","data-v-c8f20512"]]);const Pe={class:"w-full"},Ge={class:"flex items-center"},We={class:"ellipsis flex-1"},Z=q({props:{data:null,labels:null},setup(N){const d=N,{t:_}=M(),{getFieldDisplayName:s}=Ie(d.labels),p=F(!1),e=F();let C=-1;function E(){e.value={name:"",type:"TextBox",displayName:"",editable:!0,validations:[],multiple:!1,selectionOptions:[],isSystemField:!1,isSummaryField:!1,multilingual:!1,embedded:!1},C=-1,p.value=!0}function w(o,i){e.value=i,C=d.data.indexOf(i),p.value=!0}function b(o){C==-1?d.data.push(o):d.data.splice(C,1,o)}function r(o){const i=d.data.findIndex(V=>V.name==o);i>-1&&d.data.splice(i,1)}function c(o){const i=d.data.splice(o.oldIndex,1)[0];d.data.splice(o.newIndex,0,i)}return(o,i)=>{const V=me,f=ee;return m(),D("div",Pe,[l(f,{"wrapper-class":"space-y-4 w-full",list:N.data,"id-prop":"name",editable:"","disable-actions":{delete:n=>n.isSystemField},"delete-tip":n=>n.isSystemField?t(_)("common.systemFieldNotSupportDelete"):"",onAdd:E,onDelete:r,onSort:c,onEdit:w},{default:a(({item:n})=>[x("div",Ge,[x("div",We,g(t(s)(n)),1),n.isSummaryField?(m(),v(V,{key:0,round:"",class:"mr-4",type:"warning"},{default:a(()=>[T(g(t(_)("common.summaryField")),1)]),_:1})):U("",!0),l(V,{round:""},{default:a(()=>{var k;return[T(g((k=t(O)[n.type])==null?void 0:k.displayName),1)]}),_:2},1024)])]),_:1},8,["list","disable-actions","delete-tip"]),(m(),v(ce,{to:"body"},[p.value&&e.value?(m(),v(Je,{key:0,modelValue:p.value,"onUpdate:modelValue":i[0]||(i[0]=n=>p.value=n),field:e.value,fields:N.data,onSuccess:b},null,8,["modelValue","field","fields"])):U("",!0)]))])}}}),j=Se.global.t,fe={string:j("common.string"),number:j("common.number"),dateTime:j("common.dateTime")};const He={class:"w-full flex items-center"},je={class:"w-full flex items-center"},ze=q({props:{modelValue:{type:Boolean},field:null,fields:null},emits:["update:modelValue","success"],setup(N,{emit:d}){const _=N,{t:s}=M(),p=F(!0),e=F(JSON.parse(JSON.stringify(_.field))),C=W(()=>_.fields.filter(c=>!ne(c.name,_.field.name))),E=F([]),w=F(),b={name:[z(s("common.fieldRequiredTips")),le(1,50),ae(),{validator(c,o){const i=o==null?void 0:o.toLowerCase();return!C.value.find(V=>V.name.toLowerCase()==i)},message:()=>s("common.valueHasBeenTakenTips")}]};function r(){return I(this,null,function*(){try{yield w.value.validate()}catch(c){throw Error("Basic not valid")}d("success",e.value),p.value=!1})}return X(()=>e.value.type,c=>I(this,null,function*(){var o;se(["Content","RichEditor"],c)&&(e.value.isSummaryField=!1),(o=E.value)!=null&&o.length||(E.value=yield oe())}),{immediate:!0}),(c,o)=>{const i=ie,V=ue,f=K,n=P,k=G,$=Q,u=re,A=pe;return m(),v(A,{"model-value":p.value,width:"700px","close-on-click-modal":!1,title:t(s)("common.fieldEditor"),onClosed:o[9]||(o[9]=y=>d("update:modelValue",!1))},{footer:a(()=>[l(te,{onConfirm:r,onCancel:o[8]||(o[8]=y=>p.value=!1)})]),default:a(()=>[l(u,{"max-height":"60vh"},{default:a(()=>[l($,{ref_key:"form",ref:w,model:e.value,rules:b,"label-position":"top"},{default:a(()=>[l(f,{prop:"name",label:t(s)("common.name")},{default:a(()=>[x("div",He,[l(i,{modelValue:e.value.name,"onUpdate:modelValue":o[0]||(o[0]=y=>e.value.name=y),class:"w-3/5","data-cy":"field-name-input"},null,8,["modelValue"]),l(V,{modelValue:e.value.isSummaryField,"onUpdate:modelValue":o[1]||(o[1]=y=>e.value.isSummaryField=y),class:"ml-12","data-cy":"summary-field"},{default:a(()=>[T(g(t(s)("common.summaryField")),1)]),_:1},8,["modelValue"])])]),_:1},8,["label"]),e.value.isSummaryField?(m(),v(f,{key:0,label:t(s)("common.columnWidth")},{default:a(()=>[l(i,{modelValue:e.value.width,"onUpdate:modelValue":o[2]||(o[2]=y=>e.value.width=y),modelModifiers:{number:!0},class:"w-3/5"},null,8,["modelValue"])]),_:1},8,["label"])):U("",!0),l(f,{label:t(s)("common.displayName")},{default:a(()=>[l(i,{modelValue:e.value.displayName,"onUpdate:modelValue":o[3]||(o[3]=y=>e.value.displayName=y),class:"w-3/5","data-cy":"display-name-input"},null,8,["modelValue"])]),_:1},8,["label"]),l(f,{prop:"type",label:t(s)("common.dataType")},{default:a(()=>[x("div",je,[l(k,{modelValue:e.value.type,"onUpdate:modelValue":o[4]||(o[4]=y=>e.value.type=y),class:"w-3/5"},{default:a(()=>[(m(!0),D(L,null,R(t(fe),(y,J)=>(m(),v(n,{key:J,value:J,label:y},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])])]),_:1},8,["label"]),l(f,null,{default:a(()=>[l(V,{modelValue:e.value.editable,"onUpdate:modelValue":o[5]||(o[5]=y=>e.value.editable=y)},{default:a(()=>[T(g(t(s)("common.editable")),1)]),_:1},8,["modelValue"]),l(V,{modelValue:e.value.filterable,"onUpdate:modelValue":o[6]||(o[6]=y=>e.value.filterable=y)},{default:a(()=>[T(g(t(s)("common.filterable")),1)]),_:1},8,["modelValue"]),l(V,{modelValue:e.value.exportable,"onUpdate:modelValue":o[7]||(o[7]=y=>e.value.exportable=y)},{default:a(()=>[T(g(t(s)("common.exportable")),1)]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["model-value","title"])}}});var Ke=de(ze,[["__scopeId","data-v-43e8558a"]]);const Qe={class:"w-full"},Xe={class:"flex items-center"},Ye={class:"ellipsis flex-1"},Ze=q({props:{data:null},setup(N){const d=N,{t:_}=M(),s=F(!1),p=F();let e=-1;function C(){p.value={name:"",type:"string",displayName:"",editable:!1,isSummaryField:!1,exportable:!1,filterable:!1,width:120},e=-1,s.value=!0}function E(c,o){p.value=o,e=d.data.indexOf(o),s.value=!0}function w(c){e==-1?d.data.push(c):d.data.splice(e,1,c)}function b(c){const o=d.data.findIndex(i=>i.name==c);o>-1&&d.data.splice(o,1)}function r(c){const o=d.data.splice(c.oldIndex,1)[0];d.data.splice(c.newIndex,0,o)}return(c,o)=>{const i=me,V=ee;return m(),D("div",Qe,[l(V,{"wrapper-class":"space-y-4 w-full",list:N.data,"id-prop":"name",editable:"",onAdd:C,onDelete:b,onSort:r,onEdit:E},{default:a(({item:f})=>[x("div",Xe,[x("div",Ye,g(f.displayName||f.name),1),f.isSummaryField?(m(),v(i,{key:0,round:"",class:"mr-4",type:"warning"},{default:a(()=>[T(g(t(_)("common.summaryField")),1)]),_:1})):U("",!0),l(i,{round:""},{default:a(()=>[T(g(t(fe)[f.type]||f.type),1)]),_:2},1024)])]),_:1},8,["list"]),(m(),v(ce,{to:"body"},[s.value&&p.value?(m(),v(Ke,{key:0,modelValue:s.value,"onUpdate:modelValue":o[0]||(o[0]=f=>s.value=f),field:p.value,fields:N.data,onSuccess:w},null,8,["modelValue","field","fields"])):U("",!0)]))])}}}),el={class:"p-24 pb-150px"},ll={class:"rounded-normal bg-fff dark:bg-[#252526] mt-16 mb-24 py-24 px-56px"},al={class:"max-w-504px"},tl={class:"rounded-normal bg-fff dark:bg-[#252526] mt-16 mb-24 py-24 px-56px"},ol={class:"max-w-504px"},nl={class:"rounded-normal bg-fff dark:bg-[#252526] mt-16 mb-24 py-24 px-56px"},sl={class:"max-w-504px"},Va=q({setup(N){const{t:d}=M(),_=F([]),s=F([]),p=Ee();p.loadTypes(),Ce().then(b=>{_.value=b}),ke().then(b=>{s.value=b});const e=F(),C=()=>I(this,null,function*(){yield Ne(e.value),p.loadSettings(),Ue()});function E(b){if(!!_.value){var r=_.value.find(c=>c.code==b);r&&(e.value.currencySymbol=r.symbolNative)}}const w=W(()=>p.types.some(b=>b.isDigital));return X(()=>p.settings,()=>{e.value=JSON.parse(JSON.stringify(p.settings))},{immediate:!0}),Fe("save",C),(b,r)=>{const c=P,o=G,i=K,V=P,f=G,n=Ve,k=Re,$=Q;return m(),D("div",el,[l(we,{name:t(d)("commerce.commerceSettings")},null,8,["name"]),e.value?(m(),v($,{key:0,"label-position":"top"},{default:a(()=>[x("div",ll,[x("div",al,[l(i,{label:t(d)("common.currency")},{default:a(()=>[l(o,{modelValue:e.value.currencyCode,"onUpdate:modelValue":r[0]||(r[0]=u=>e.value.currencyCode=u),class:"w-full",onChange:E},{default:a(()=>[(m(!0),D(L,null,R(_.value,u=>(m(),v(c,{key:u.code,value:u.code,label:`${u.namePlural} - ${u.code} - ${u.symbolNative}`},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(i,{label:t(d)("common.weightUnit")},{default:a(()=>[l(f,{modelValue:e.value.weightUnit,"onUpdate:modelValue":r[1]||(r[1]=u=>e.value.weightUnit=u),class:"w-full"},{default:a(()=>[l(V,{label:"KG",value:"kg"}),l(V,{label:"G",value:"g"})]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(i,null,{label:a(()=>[x("span",null,g(t(d)("commerce.availablePaymentMethods")),1),l(n,{tip:t(d)("commerce.paymentsTip"),"custom-class":"ml-4"},null,8,["tip"])]),default:a(()=>[l(f,{modelValue:e.value.payments,"onUpdate:modelValue":r[2]||(r[2]=u=>e.value.payments=u),multiple:"",class:"w-full"},{default:a(()=>[(m(!0),D(L,null,R(s.value,u=>(m(),v(V,{key:u.key,label:u.value,value:u.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),x("div",tl,[x("div",ol,[l(i,null,{label:a(()=>[x("span",null,g(t(d)("commerce.productFields")),1),l(n,{tip:t(d)("common.productFieldsTip"),"custom-class":"ml-4"},null,8,["tip"])]),default:a(()=>[l(Z,{data:e.value.productCustomFields,labels:t(Be)},null,8,["data","labels"])]),_:1}),l(i,null,{label:a(()=>[x("span",null,g(t(d)("commerce.categoryFields")),1),l(n,{tip:t(d)("common.categoryFieldsTip"),"custom-class":"ml-4"},null,8,["tip"])]),default:a(()=>[l(Z,{data:e.value.categoryCustomFields,labels:t(Oe)},null,8,["data","labels"])]),_:1}),l(i,null,{label:a(()=>[x("span",null,g(t(d)("commerce.orderExtensionFields")),1)]),default:a(()=>[l(Ze,{data:e.value.orderExtensionFields},null,8,["data"])]),_:1})])]),x("div",nl,[x("div",sl,[l(i,{label:t(d)("commerce.hideAttributes")},{default:a(()=>[l(k,{modelValue:e.value.hideAttributes,"onUpdate:modelValue":r[3]||(r[3]=u=>e.value.hideAttributes=u),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1},8,["label"]),l(i,{label:t(d)("commerce.hideVariants")},{default:a(()=>[l(k,{modelValue:e.value.hideVariants,"onUpdate:modelValue":r[4]||(r[4]=u=>e.value.hideVariants=u),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1},8,["label"]),t(w)?(m(),v(i,{key:0,label:t(d)("commerce.productDigitalItemRequired")},{default:a(()=>[l(k,{modelValue:e.value.productDigitalItemRequired,"onUpdate:modelValue":r[5]||(r[5]=u=>e.value.productDigitalItemRequired=u),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1},8,["label"])):U("",!0)])])]),_:1})):U("",!0),l(ge,{"hidden-cancel":"",onSave:C})])}}});export{Va as default};
