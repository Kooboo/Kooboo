var D=(k,i,p)=>new Promise((s,c)=>{var e=u=>{try{w(p.next(u))}catch(d){c(d)}},V=u=>{try{w(p.throw(u))}catch(d){c(d)}},w=u=>u.done?s(u.value):Promise.resolve(u.value).then(e,V);w((p=p.apply(k,i)).next())});import{_ as te}from"./tooltip.28a451cc.js";import{_ as oe}from"./index.f237f871.js";import{B as ne}from"./breadcrumb.80c136b8.js";import{g as q,k as se}from"./i18n.48bd28ac.js";import{u as ie}from"./use-shortcuts.21ce2d8e.js";import{u as me,J as ue,K as de,C as re}from"./commerce.f8d3336c.js";import{_ as pe,r as ce}from"./index.0f940e7f.js";import{a as fe,_ as ve}from"./selection-editor.b60c224d.js";import{a as H,r as _e,l as ye}from"./validate.efc4a5c0.js";import{_ as be}from"./index.a731e53b.js";import{f as O}from"./custom-field.74b8b7fb.js";import{g as ge}from"./content-folder.151b44e9.js";import{i as Ve,a as we}from"./string.955a924b.js";import{_ as Fe}from"./plugin-vue_export-helper.21dcd24c.js";import{E as Se}from"./index.fc90f5ad.js";import{E as xe}from"./index.77edae39.js";import{E as W,a as Q}from"./index.6855d037.js";import{E as M,a as J,c as Ee}from"./index.0d2684bf.js";import{E as Ce,a as ke}from"./index.be352e91.js";import{E as Ne}from"./index.a439b087.js";import{E as Te}from"./index.c4e9b529.js";import{d as P,g as S,c as K,i as X,o as m,j as v,w as a,b as t,u as o,f as F,aH as $,t as x,a as B,b6 as R,F as I,k as C,az as Ue}from"./url.2e6a77c4.js";import{a as $e,p as Be,c as he}from"./useLabels.456dfc28.js";import"./windi.a5b0b048.js";import"./index.379e80ad.js";import"./focus-trap.23f44899.js";import"./isNil.98bb3b88.js";import"./event.53b2ad83.js";import"./index.ff0264f3.js";import"./index.2bc50276.js";import"./replace-all.7cf5f327.js";import"./main.ea42d807.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";/* empty css                                                               */import"./plugin-vue_export-helper.41ffa612.js";import"./classCompletion.a22e38a6.js";import"./userWorker.b3a6730b.js";import"./editor.main.d2800f63.js";import"./guid.c1a40312.js";import"./vuedraggable.umd.5840ebc7.js";import"./cloneDeep.ff43c1f8.js";import"./_baseClone.adbc92f5.js";import"./_baseIsEqual.c0d7e77a.js";import"./index.d4bbb472.js";import"./event.776e7e11.js";import"./index.fcc3ea42.js";import"./error.7e8331f1.js";import"./index.e3f90979.js";import"./index.d75a71d9.js";import"./index.aba77680.js";import"./index.6d45a031.js";import"./index.31f26a0f.js";import"./index.60af85f4.js";import"./style.19d0c187.js";import"./toNumber.574be4f1.js";import"./isEqual.f1ae9fb3.js";import"./scroll.f51de5d8.js";import"./debounce.61c67278.js";import"./index.064c7de9.js";import"./validator.e2869aba.js";import"./index.603c1365.js";import"./refs.4001ce17.js";const Oe={class:"w-full flex items-center"},De={class:"w-full flex items-center"},Re=P({props:{modelValue:{type:Boolean},field:null,fields:null},emits:["update:modelValue","success"],setup(k,{emit:i}){const p=k,{t:s}=q(),c=S(!0),e=S(JSON.parse(JSON.stringify(p.field))),V=K(()=>p.fields.filter(y=>!Ve(y.name,p.field.name))),w=S([]),u=S(),d=S(),b=[{displayName:s("common.basic"),value:"Basic"},{displayName:s("common.advanced"),value:"Advanced"},{displayName:s("common.validation"),value:"Validation"}],N=S("Basic"),r={name:[H(s("common.fieldRequiredTips")),_e(1,50),ye(),{validator(y,l){const n=l==null?void 0:l.toLowerCase();return!V.value.find(U=>U.name.toLowerCase()==n)},message:()=>s("common.valueHasBeenTakenTips")}],contentFolder:e.value.isSystemField?[]:[H(s("common.fieldRequiredTips"))]},f=K(()=>se(e.value,"options.disableMultiple",!1));function E(){return D(this,null,function*(){var y,l;try{yield(l=(y=u.value)==null?void 0:y.form)==null?void 0:l.validate()}catch(n){throw N.value="Validation",Error("Validation not valid")}try{yield d.value.validate()}catch(n){throw N.value="Basic",Error("Basic not valid")}i("success",e.value),c.value=!1})}return X(()=>e.value.type,y=>D(this,null,function*(){var l;we(["Content","RichEditor"],y)&&(e.value.isSummaryField=!1),(l=w.value)!=null&&l.length||(w.value=yield ge())}),{immediate:!0}),(y,l)=>{const n=Se,U=xe,T=W,A=M,z=J,Y=ve,Z=Q,L=Ce,ee=ke,le=Ne,ae=Te;return m(),v(ae,{"model-value":c.value,width:"700px","close-on-click-modal":!1,title:o(s)("common.fieldEditor"),"custom-class":"el-dialog--zero-padding",onClosed:l[11]||(l[11]=g=>i("update:modelValue",!1))},{footer:a(()=>[t(be,{onConfirm:E,onCancel:l[10]||(l[10]=g=>c.value=!1)})]),default:a(()=>[t(le,{"max-height":"60vh"},{default:a(()=>[t(ee,{modelValue:N.value,"onUpdate:modelValue":l[9]||(l[9]=g=>N.value=g)},{default:a(()=>[t(L,{label:o(b)[0].displayName,name:o(b)[0].value},{default:a(()=>[t(Z,{ref_key:"form",ref:d,model:e.value,rules:r,"label-position":"top"},{default:a(()=>{var g;return[t(T,{prop:"name",label:o(s)("common.name")},{default:a(()=>[F("div",Oe,[t(n,{modelValue:e.value.name,"onUpdate:modelValue":l[0]||(l[0]=_=>e.value.name=_),disabled:!!e.value.name&&e.value.isSystemField,class:"w-3/5","data-cy":"field-name-input"},null,8,["modelValue","disabled"]),t(U,{modelValue:e.value.isSummaryField,"onUpdate:modelValue":l[1]||(l[1]=_=>e.value.isSummaryField=_),class:"ml-12","data-cy":"summary-field"},{default:a(()=>[$(x(o(s)("common.summaryField")),1)]),_:1},8,["modelValue"])])]),_:1},8,["label"]),t(T,{label:o(s)("common.displayName")},{default:a(()=>[t(n,{modelValue:e.value.displayName,"onUpdate:modelValue":l[2]||(l[2]=_=>e.value.displayName=_),class:"w-3/5","data-cy":"display-name-input"},null,8,["modelValue"])]),_:1},8,["label"]),t(T,{prop:"type",label:o(s)("common.controlType")},{default:a(()=>{var _;return[F("div",De,[t(z,{modelValue:e.value.type,"onUpdate:modelValue":l[3]||(l[3]=h=>e.value.type=h),disabled:e.value.isSystemField,class:"w-3/5","data-cy":"control-type-dropdown"},{default:a(()=>[(m(!0),B(I,null,R(o(O),(h,G)=>(m(),v(A,{key:G,value:G,label:h.displayName},null,8,["value","label"]))),128))]),_:1},8,["modelValue","disabled"]),(_=o(O)[e.value.type])!=null&&_.multiple?(m(),v(U,{key:0,modelValue:e.value.multiple,"onUpdate:modelValue":l[4]||(l[4]=h=>e.value.multiple=h),disabled:o(f),class:"ml-12","data-cy":"enable-multiple"},{default:a(()=>[$(x(o(s)("common.enableMultiple")),1)]),_:1},8,["modelValue","disabled"])):C("",!0)])]}),_:1},8,["label"]),(g=o(O)[e.value.type])!=null&&g.selection?(m(),v(T,{key:0,label:o(s)("common.options")},{default:a(()=>[t(Y,{options:e.value.selectionOptions},null,8,["options"])]),_:1},8,["label"])):C("",!0),e.value.type=="Content"?(m(),v(T,{key:1,label:o(s)("common.contentFolder"),prop:"contentFolder"},{default:a(()=>[t(z,{modelValue:e.value.contentFolder,"onUpdate:modelValue":l[5]||(l[5]=_=>e.value.contentFolder=_),class:"w-3/5"},{default:a(()=>[(m(!0),B(I,null,R(w.value,_=>(m(),v(A,{key:_.name,value:_.name,label:_.name||_.displayName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])):C("",!0)]}),_:1},8,["model"])]),_:1},8,["label","name"]),e.value.isSystemField?C("",!0):(m(),v(L,{key:0,label:o(b)[1].displayName,name:o(b)[1].value},{default:a(()=>[t(T,null,{default:a(()=>[t(U,{modelValue:e.value.editable,"onUpdate:modelValue":l[6]||(l[6]=g=>e.value.editable=g)},{default:a(()=>[$(x(o(s)("common.userEditable")),1)]),_:1},8,["modelValue"])]),_:1}),o(O)[e.value.type].multilingual?(m(),v(T,{key:0},{default:a(()=>[t(U,{modelValue:e.value.multilingual,"onUpdate:modelValue":l[7]||(l[7]=g=>e.value.multilingual=g)},{default:a(()=>[$(x(o(s)("common.enableMultilingual")),1)]),_:1},8,["modelValue"])]),_:1})):C("",!0),e.value.multiple&&e.value.type=="Content"?(m(),v(T,{key:1},{default:a(()=>[t(U,{modelValue:e.value.allowRepetition,"onUpdate:modelValue":l[8]||(l[8]=g=>e.value.allowRepetition=g)},{default:a(()=>[$(x(o(s)("common.allowRepetition")),1)]),_:1},8,["modelValue"])]),_:1})):C("",!0)]),_:1},8,["label","name"])),e.value.isSystemField?C("",!0):(m(),v(L,{key:1,label:o(b)[2].displayName,name:o(b)[2].value},{default:a(()=>[t(fe,{ref_key:"fieldValidation",ref:u,field:{controlType:e.value.type,validations:e.value.validations},onSave:E},null,8,["field"])]),_:1},8,["label","name"]))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model-value","title"])}}});var Ie=Fe(Re,[["__scopeId","data-v-a6bbb1d6"]]);const Le={class:"w-full"},Me={class:"flex items-center"},Je={class:"ellipsis flex-1"},j=P({props:{data:null,labels:null},setup(k){const i=k,{t:p}=q(),{getFieldDisplayName:s}=$e(i.labels),c=S(!1),e=S();let V=-1;function w(){e.value={name:"",type:"TextBox",displayName:"",editable:!0,validations:[],multiple:!1,selectionOptions:[],isSystemField:!1,isSummaryField:!1,multilingual:!1},V=-1,c.value=!0}function u(r,f){e.value=f,V=i.data.indexOf(f),c.value=!0}function d(r){V==-1?i.data.push(r):i.data.splice(V,1,r)}function b(r){const f=i.data.findIndex(E=>E.name==r);f>-1&&i.data.splice(f,1)}function N(r){const f=i.data.splice(r.oldIndex,1)[0];i.data.splice(r.newIndex,0,f)}return(r,f)=>{const E=Ee,y=pe;return m(),B("div",Le,[t(y,{"wrapper-class":"space-y-4 w-full",list:k.data,"id-prop":"name",editable:"","disable-actions":{delete:l=>l.isSystemField},"delete-tip":l=>l.isSystemField?o(p)("common.systemFieldNotSupportDelete"):"",onAdd:w,onDelete:b,onSort:N,onEdit:u},{default:a(({item:l})=>[F("div",Me,[F("div",Je,x(o(s)(l)),1),l.isSummaryField?(m(),v(E,{key:0,round:"",class:"mr-4",type:"warning"},{default:a(()=>[$(x(o(p)("common.summaryField")),1)]),_:1})):C("",!0),t(E,{round:""},{default:a(()=>{var n;return[$(x((n=o(O)[l.type])==null?void 0:n.displayName),1)]}),_:2},1024)])]),_:1},8,["list","disable-actions","delete-tip"]),(m(),v(Ue,{to:"body"},[c.value&&e.value?(m(),v(Ie,{key:0,modelValue:c.value,"onUpdate:modelValue":f[0]||(f[0]=l=>c.value=l),field:e.value,fields:k.data,onSuccess:d},null,8,["modelValue","field","fields"])):C("",!0)]))])}}}),qe={class:"p-24 pb-150px"},Pe={class:"rounded-normal bg-fff dark:bg-[#252526] mt-16 mb-24 py-24 px-56px"},Ae={class:"max-w-504px"},ze={class:"rounded-normal bg-fff dark:bg-[#252526] mt-16 mb-24 py-24 px-56px"},Ge={class:"max-w-504px"},aa=P({setup(k){const{t:i}=q(),p=S([]),s=S([]),c=me();ue().then(u=>{p.value=u}),de().then(u=>{s.value=u});const e=S(),V=()=>D(this,null,function*(){yield re(e.value),c.loadSettings(),ce()});function w(u){if(!!p.value){var d=p.value.find(b=>b.code==u);d&&(e.value.currencySymbol=d.symbolNative)}}return X(()=>c.settings,()=>{e.value=JSON.parse(JSON.stringify(c.settings))},{immediate:!0}),ie("save",V),(u,d)=>{const b=M,N=J,r=W,f=M,E=J,y=te,l=Q;return m(),B("div",qe,[t(ne,{name:o(i)("commerce.commerceSettings")},null,8,["name"]),e.value?(m(),v(l,{key:0,"label-position":"top"},{default:a(()=>[F("div",Pe,[F("div",Ae,[t(r,{label:o(i)("common.currency")},{default:a(()=>[t(N,{modelValue:e.value.currencyCode,"onUpdate:modelValue":d[0]||(d[0]=n=>e.value.currencyCode=n),class:"w-full",onChange:w},{default:a(()=>[(m(!0),B(I,null,R(p.value,n=>(m(),v(b,{key:n.code,value:n.code,label:`${n.namePlural} - ${n.code} - ${n.symbolNative}`},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(r,{label:o(i)("common.weightUnit")},{default:a(()=>[t(E,{modelValue:e.value.weightUnit,"onUpdate:modelValue":d[1]||(d[1]=n=>e.value.weightUnit=n),class:"w-full"},{default:a(()=>[t(f,{label:"KG",value:"kg"}),t(f,{label:"G",value:"g"})]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(r,null,{label:a(()=>[F("span",null,x(o(i)("commerce.availablePaymentMethods")),1),t(y,{tip:o(i)("commerce.paymentsTip"),"custom-class":"ml-4"},null,8,["tip"])]),default:a(()=>[t(E,{modelValue:e.value.payments,"onUpdate:modelValue":d[2]||(d[2]=n=>e.value.payments=n),multiple:"",class:"w-full"},{default:a(()=>[(m(!0),B(I,null,R(s.value,n=>(m(),v(f,{key:n.key,label:n.value,value:n.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),F("div",ze,[F("div",Ge,[t(r,null,{label:a(()=>[F("span",null,x(o(i)("commerce.productFields")),1),t(y,{tip:o(i)("common.productFieldsTip"),"custom-class":"ml-4"},null,8,["tip"])]),default:a(()=>[t(j,{data:e.value.productCustomFields,labels:o(Be)},null,8,["data","labels"])]),_:1}),t(r,null,{label:a(()=>[F("span",null,x(o(i)("commerce.categoryFields")),1),t(y,{tip:o(i)("common.categoryFieldsTip"),"custom-class":"ml-4"},null,8,["tip"])]),default:a(()=>[t(j,{data:e.value.categoryCustomFields,labels:o(he)},null,8,["data","labels"])]),_:1})])])]),_:1})):C("",!0),t(oe,{"hidden-cancel":"",onSave:V})])}}});export{aa as default};
