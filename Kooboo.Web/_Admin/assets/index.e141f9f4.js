var C=(a,d,_)=>new Promise((c,y)=>{var i=e=>{try{m(_.next(e))}catch(U){y(U)}},g=e=>{try{m(_.throw(e))}catch(U){y(U)}},m=e=>e.done?c(e.value):Promise.resolve(e.value).then(i,g);m((_=_.apply(a,d)).next())});import{_ as N}from"./k-table.c13bd7f5.js";import{d as E}from"./main.1c3b59e3.js";import{G as W}from"./index.3be79fd5.js";import{g as F,o as X}from"./i18n.25caaace.js";import{g as H}from"./confirm.629bcef4.js";import{_ as Y}from"./index.50326354.js";import{f as Z}from"./index.7247b296.js";import{E as M,a as J,c as ee}from"./index.960b9732.js";import{E as oe,a as te}from"./index.94998415.js";import{E as O}from"./index.a5d96e5a.js";import{d as K,g as v,c as Q,o as f,j as V,w as t,b as l,u as o,a as L,b6 as P,F as j,f as A,t as S,aH as D,k as I}from"./url.8f5ec20c.js";import{u as q}from"./use-date.55b953fa.js";import{E as le}from"./windi.a815125a.js";import{E as z}from"./index.e9f8834a.js";import{E as ae,a as ne,b as se}from"./index.a0b57910.js";import{E as R}from"./index.5388dbc8.js";import{E as re}from"./index.93cb5a2c.js";import"./sortable.esm.a99254e8.js";import"./icon-button.0e134c9b.js";import"./index.158cdd11.js";import"./focus-trap.81e4fb05.js";import"./isNil.98bb3b88.js";import"./event.53b2ad83.js";import"./index.1e7e06b8.js";import"./index.0c2ced08.js";import"./index.f9c89813.js";import"./index.a9a077b4.js";import"./isEqual.2e410d13.js";import"./_baseIsEqual.0a4e01e5.js";import"./index.f571dfc9.js";import"./event.776e7e11.js";import"./error.7e8331f1.js";import"./index.2e51d36e.js";import"./index.5b499f72.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";import"./replace-all.b35629e7.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./logo-transparent.1566007e.js";import"./index.60799c00.js";import"./index.1d16d007.js";import"./scroll.0cf77af8.js";import"./aria.75ec5909.js";import"./validator.9b0d789f.js";import"./index.c6488b3c.js";import"./debounce.730e1961.js";import"./toNumber.6efebd6a.js";import"./index.c93fe8e7.js";import"./_baseClone.885c975f.js";import"./refs.d2253dd4.js";import"./dayjs.min.2044f1dd.js";import"./dropdown.fed924b2.js";import"./index.e3f90979.js";const ie=()=>E.get("SearchConsole/GetAuthUrl",{callbackUrl:location.href}),me=()=>E.get("SearchConsole/GetSiteList",void 0,{hiddenError:!0}),ue=a=>E.post("SearchConsole/DeleteSite",{siteUrl:a}),ce=a=>E.post("SearchConsole/AddSite",{siteUrl:a}),pe=(a,d)=>E.post("SearchConsole/ValidSite",{siteUrl:a,onGoogle:d}),de=a=>E.get("SearchConsole/GetSitemapList",{siteUrl:a}),fe=(a,d)=>E.post("SearchConsole/DeleteSitemap",{siteUrl:a,feedPath:d}),_e=(a,d)=>E.post("SearchConsole/SubmitSitemap",{siteUrl:a,feedPath:d}),ve=a=>E.post("sitemap/Feeds",{domain:a}),ye=a=>E.post("SearchConsole/GetSearchAnalytics",a),be=K({props:{modelValue:{type:Boolean},excludes:null},emits:["update:modelValue","reload"],setup(a,{emit:d}){const _=a,c=v([]),{t:y}=F(),i=v(!0),g=v(),m=v({url:""});Z().then(h=>c.value=h);const e=()=>C(this,null,function*(){!m.value.url||(yield ce(m.value.url),d("reload"),i.value=!1)}),U=Q(()=>{var h=[];for(const k of c.value){var s=`sc-domain:${k.domainName}`;_.excludes.find(b=>b==s)||h.push(s)}return h});return(h,s)=>{const k=M,b=J,x=oe,$=te,p=O;return f(),V(p,{"model-value":i.value,width:"600px","close-on-click-modal":!1,title:o(y)("common.addSite"),onClosed:s[2]||(s[2]=n=>d("update:modelValue",!1))},{footer:t(()=>[l(Y,{disabled:!m.value.url,onConfirm:e,onCancel:s[1]||(s[1]=n=>i.value=!1)},null,8,["disabled"])]),default:t(()=>[l($,{ref_key:"form",ref:g,"label-position":"top",model:m.value,onKeydown:X(e,["enter"])},{default:t(()=>[l(x,{label:o(y)("common.site"),prop:"name"},{default:t(()=>[l(b,{modelValue:m.value.url,"onUpdate:modelValue":s[0]||(s[0]=n=>m.value.url=n),class:"w-full"},{default:t(()=>[(f(!0),L(j,null,P(o(U),n=>(f(),V(k,{key:n,label:n,value:n},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","onKeydown"])]),_:1},8,["model-value","title"])}}}),ge={class:"flex items-center pb-24 space-x-16"},ke=K({props:{modelValue:{type:Boolean},siteUrl:null},emits:["update:modelValue","reload"],setup(a,{emit:d}){const _=a,c=v([]),y=v([]),{t:i}=F(),g=v(!0);ve(_.siteUrl.split(":")[1]).then(s=>{y.value=s});function m(){return C(this,null,function*(){c.value=yield de(_.siteUrl)})}m();function e(s){return C(this,null,function*(){yield H();for(const k of s)yield fe(_.siteUrl,k.path);yield m()})}function U(s){return C(this,null,function*(){yield _e(_.siteUrl,s),yield m()})}const h=Q(()=>{const s=[];for(const k of y.value)c.value.find(b=>b.path==k)||s.push(k);return s});return(s,k)=>{const b=le,x=z,$=ae,p=ne,n=se,w=R,T=N,B=O;return f(),V(B,{"model-value":g.value,width:"1000px","close-on-click-modal":!1,title:o(i)("common.sitemap"),onClosed:k[0]||(k[0]=u=>d("update:modelValue",!1))},{default:t(()=>[A("div",null,[A("div",ge,[l(n,{trigger:"click",class:"ml-10px",disabled:!o(h).length,onCommand:U},{dropdown:t(()=>[l(p,null,{default:t(()=>[(f(!0),L(j,null,P(o(h),u=>(f(),V($,{key:u,command:u},{default:t(()=>[A("span",null,S(u),1)]),_:2},1032,["command"]))),128))]),_:1})]),default:t(()=>[l(x,{round:"","data-cy":"new-page"},{default:t(()=>[l(b,{class:"iconfont icon-a-addto"}),D(" "+S(o(i)("common.submit")),1)]),_:1})]),_:1},8,["disabled"])]),l(T,{data:c.value,"show-check":"",onDelete:e},{default:t(()=>[l(w,{label:o(i)("common.path"),prop:"path"},null,8,["label"]),l(w,{label:o(i)("common.lastSubmitted"),prop:"errors"},{default:t(({row:u})=>[D(S(o(q)(u.lastSubmitted)),1)]),_:1},8,["label"]),l(w,{label:o(i)("common.lastDownloaded"),prop:"errors"},{default:t(({row:u})=>[D(S(u.lastDownloaded?o(q)(u.lastDownloaded):""),1)]),_:1},8,["label"]),l(w,{label:o(i)("common.error"),prop:"errors",width:"80"},null,8,["label"]),l(w,{label:o(i)("common.warning"),prop:"warnings",width:"80"},null,8,["label"])]),_:1},8,["data"])])]),_:1},8,["model-value","title"])}}}),we={class:"flex items-center pb-24 space-x-16 flex"},he=K({props:{modelValue:{type:Boolean},siteUrl:null},emits:["update:modelValue","reload"],setup(a,{emit:d}){const _=a,c=new Date,y=new Date,i=v("auto");y.setTime(y.getTime()-3600*1e3*24*30);const g=v([y,c]),m=v([]),{t:e}=F(),U=v(!0);function h(){return C(this,null,function*(){m.value=(yield ye({siteUrl:_.siteUrl,startDate:g.value[0],endDate:g.value[1],aggregationType:i.value})).rows})}h();const s=[{key:"auto",value:e("common.auto")},{key:"byPage",value:e("console.byPage")},{key:"byProperty",value:e("common.byProperty")}];return(k,b)=>{const x=M,$=J,p=re,n=z,w=R,T=N,B=O;return f(),V(B,{"model-value":U.value,width:"1000px","close-on-click-modal":!1,title:o(e)("common.analytics"),onClosed:b[2]||(b[2]=u=>d("update:modelValue",!1))},{default:t(()=>[A("div",null,[A("div",we,[l($,{modelValue:i.value,"onUpdate:modelValue":b[0]||(b[0]=u=>i.value=u)},{default:t(()=>[(f(),L(j,null,P(s,u=>l(x,{key:u.key,value:u.key,label:u.value},null,8,["value","label"])),64))]),_:1},8,["modelValue"]),l(p,{modelValue:g.value,"onUpdate:modelValue":b[1]||(b[1]=u=>g.value=u),type:"daterange","unlink-panels":"","range-separator":o(e)("common.to"),"start-placeholder":o(e)("common.startDate"),"end-placeholder":o(e)("common.endDate")},null,8,["modelValue","range-separator","start-placeholder","end-placeholder"]),l(n,{type:"primary",round:"",onClick:h},{default:t(()=>[D(S(o(e)("common.search")),1)]),_:1})]),l(T,{data:m.value},{default:t(()=>[l(w,{label:o(e)("common.clicks"),prop:"clicks"},null,8,["label"]),l(w,{label:o(e)("common.ctr"),prop:"ctr"},null,8,["label"]),l(w,{label:o(e)("common.impressions"),prop:"impressions"},null,8,["label"]),l(w,{label:o(e)("console.keys"),prop:"keys"},{default:t(({row:u})=>{var r;return[D(S((r=u.keys)==null?void 0:r.join(" ")),1)]}),_:1},8,["label"])]),_:1},8,["data"])])]),_:1},8,["model-value","title"])}}}),Se={key:1,class:"px-24"},Ue=A("div",{class:"flex items-center py-24 space-x-16"},null,-1),Ve=["onClick"],Ee={key:1},xo=K({setup(a){const d=v(),_=v([]),{t:c}=F(),y=v(!1),i=v(!1),g=v(!1),m=v();function e(){return C(this,null,function*(){try{_.value=(yield me()).sort((p,n)=>p.siteUrl>n.siteUrl?1:-1)}catch(p){d.value=yield ie()}})}e();function U(){location.href=d.value}function h(p,n){return C(this,null,function*(){yield pe(p.split(":")[1],n),e()})}function s(p){return C(this,null,function*(){yield H();for(const n of p)yield ue(n.siteUrl);e()})}function k(p){return p.permissionLevel!="siteUnverifiedUser"}function b(p){m.value=p,i.value=!0}function x(p){m.value=p,g.value=!0}const $={siteOwner:c("common.siteOwner"),siteUnverifiedUser:c("common.siteUnverifiedUser")};return(p,n)=>{const w=z,T=R,B=ee,u=N;return f(),L("div",null,[d.value?(f(),V(W,{key:0},{button:t(()=>[l(w,{type:"primary",onClick:U},{default:t(()=>[D(S(o(c)("common.login")),1)]),_:1})]),default:t(()=>[A("p",null,S(o(c)("common.searchConsoleLoginTip")),1)]),_:1})):(f(),L("div",Se,[Ue,l(u,{data:_.value,onDelete:s},{default:t(()=>[l(T,{label:o(c)("common.site"),prop:"siteUrl"},{default:t(({row:r})=>{var G;return[k(r)?(f(),L("span",{key:0,class:"text-blue cursor-pointer",onClick:Ce=>x(r)},S((G=r.siteUrl)==null?void 0:G.replace("sc-domain:","")),9,Ve)):(f(),L("span",Ee,S(r.siteUrl),1))]}),_:1},8,["label"]),l(T,{label:o(c)("common.permission"),align:"center"},{default:t(({row:r})=>[l(B,{class:"rounded-full"},{default:t(()=>[D(S($[r.permissionLevel]||r.permissionLevel),1)]),_:2},1024)]),_:1},8,["label"]),l(T,{align:"right"},{default:t(({row:r})=>[k(r)?(f(),V(w,{key:1,type:"primary",round:"",plain:"",size:"small",onClick:G=>b(r)},{default:t(()=>[D(S(o(c)("common.sitemap")),1)]),_:2},1032,["onClick"])):(f(),V(w,{key:0,type:"danger",round:"",size:"small",onClick:G=>h(r.siteUrl,r.onGoogle)},{default:t(()=>[D(S(o(c)("common.validation")),1)]),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data"])])),y.value?(f(),V(be,{key:2,modelValue:y.value,"onUpdate:modelValue":n[0]||(n[0]=r=>y.value=r),excludes:_.value.map(r=>r.siteUrl),onReload:e},null,8,["modelValue","excludes"])):I("",!0),i.value?(f(),V(ke,{key:3,modelValue:i.value,"onUpdate:modelValue":n[1]||(n[1]=r=>i.value=r),"site-url":m.value.siteUrl},null,8,["modelValue","site-url"])):I("",!0),g.value?(f(),V(he,{key:4,modelValue:g.value,"onUpdate:modelValue":n[2]||(n[2]=r=>g.value=r),"site-url":m.value.siteUrl},null,8,["modelValue","site-url"])):I("",!0)])}}});export{xo as default};
