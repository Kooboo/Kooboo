var S=Object.defineProperty;var x=Object.getOwnPropertySymbols;var C=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var w=(p,i,a)=>i in p?S(p,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):p[i]=a,k=(p,i)=>{for(var a in i||(i={}))C.call(i,a)&&w(p,a,i[a]);if(x)for(var a of x(i))N.call(i,a)&&w(p,a,i[a]);return p};var I=(p,i,a)=>new Promise((v,y)=>{var n=s=>{try{f(a.next(s))}catch(o){y(o)}},d=s=>{try{f(a.throw(s))}catch(o){y(o)}},f=s=>s.done?v(s.value):Promise.resolve(s.value).then(n,d);f((a=a.apply(p,i)).next())});import{_ as T}from"./index.5f37a601.js";import{d as U,cd as $,x as A,g as _,h as M,i as P,o as R,a as z,b as l,u as r,f as h,w as g,F as G}from"./url.2e6a77c4.js";import{B as K}from"./breadcrumb.0ef7e7c4.js";import{g as Q}from"./i18n.97105311.js";import{c as j}from"./product.b50cc736.js";import{u as q,g as H}from"./commerce.c633c6e0.js";import{u as J}from"./replace-all.8fa5a83d.js";import{_ as L,a as W,V as X}from"./option-group-editor.72b028d4.js";import{_ as Y}from"./key-value-editor.12c3b400.js";import{e as Z}from"./guid.c1a40312.js";import{u as tt,c as ot}from"./product-variant.9535432a.js";import{_ as it}from"./index.b3ad0c7f.js";import{z as rt}from"./main.52487121.js";import{u as at}from"./useFields.b5861b0a.js";import{_ as et}from"./plugin-vue_export-helper.21dcd24c.js";import{E as mt,a as pt}from"./index.317a7f30.js";import"./index.b09a9f00.js";import"./windi.539ebeab.js";import"./index.9e96921b.js";/* empty css                                                               */import"./plugin-vue_export-helper.41ffa612.js";import"./index.f997a738.js";import"./error.7e8331f1.js";import"./image-cover.dadeb856.js";import"./media-dialog.fc4bbfea.js";import"./index.9ffc2c80.js";import"./media.a886aaea.js";import"./media-list.vue_vue_type_style_index_0_scoped_true_lang.3ed42952.js";import"./index.f1409b26.js";/* empty css                                                          */import"./index.6302b2c1.js";import"./event.776e7e11.js";import"./index.9589f7cf.js";import"./focus-trap.de18cf8f.js";import"./isNil.98bb3b88.js";import"./event.53b2ad83.js";import"./search-provider.675d8cd3.js";import"./toNumber.574be4f1.js";import"./last.e7aa49db.js";import"./_baseIndexOf.4d7985be.js";import"./style.f835519e.js";import"./_baseIsEqual.abb55a3a.js";import"./_baseUniq.c477b8f6.js";import"./use-operation-dialog.6127483f.js";import"./file.c7952a49.js";import"./validate.98ddbafd.js";import"./index.99641a60.js";import"./index.77759eed.js";import"./index.b1fe55d8.js";import"./index.51a59403.js";import"./index.29d7c76d.js";import"./index.4587e608.js";import"./index.4b289bae.js";import"./index.07e210fb.js";import"./scroll.8babc10c.js";import"./index.bc93d068.js";import"./refs.4001ce17.js";import"./folder.8308bb9d.js";import"./use-date.88693eba.js";import"./dayjs.min.378b3d72.js";import"./relations-tag.64683fac.js";import"./icon-button.e1f3bfd2.js";import"./index.975a8825.js";import"./page.d86e40bb.js";import"./index.d267cbe6.js";import"./aria.75ec5909.js";import"./validator.1d438d08.js";import"./index.f3d28a97.js";import"./debounce.61c67278.js";import"./index.c1764395.js";import"./index.a46fa52c.js";import"./index.afee24fe.js";import"./isEqual.3700b7f1.js";import"./use-copy-text.81d01785.js";import"./index.0f4f13de.js";import"./browser.dd2c8c17.js";import"./throttle.041b2553.js";import"./index.7a88a6b5.js";import"./search-input.1597a477.js";/* empty css                                                                 *//* empty css                                                          */import"./layout.89b59bcc.js";import"./index.6137c0c9.js";import"./position.b1ced824.js";import"./utils.fb6ded14.js";import"./confirm.46f27373.js";import"./logo-transparent.1566007e.js";import"./index.069e95d0.js";import"./use-file-upload.f6d4a33c.js";import"./index.57372297.js";import"./index.fbe2a003.js";import"./index.0187f789.js";import"./index.13bfae9f.js";import"./file.5d2fc29a.js";/* empty css                                                         */import"./image-editor.vue_vue_type_style_index_0_scoped_true_lang.4f5fb1ef.js";import"./index.795c7a65.js";import"./dropdown.87a7678e.js";import"./editable-tags.c6ea279e.js";import"./_baseClone.f10ff33c.js";import"./dropdown-input.7bd605f7.js";import"./index.3fcd2f53.js";import"./useTag.7902b861.js";import"./index.1d8a0bb0.js";import"./index.e3f90979.js";import"./index.00cc1b15.js";import"./digital-items-editor.e051fafb.js";import"./index.e24e2872.js";import"./dark.ea14b486.js";import"./dev-mode.2a667dd5.js";import"./use-shortcuts.21ce2d8e.js";import"./userWorker.b3a6730b.js";import"./editor.main.d2800f63.js";import"./preload-helper.13a99eb0.js";import"./config.97fa1cfe.js";import"./index.f03e2503.js";import"./monaco.6a3362ef.js";import"./classCompletion.a22e38a6.js";import"./extraLib.d94bb2b4.js";import"./use-save-tip.aeb07244.js";import"./vuedraggable.umd.e0027d17.js";import"./index.56d91124.js";import"./index.232e741a.js";import"./index.a163a028.js";import"./alert.583ccfe6.js";import"./index.b1dc9dfd.js";import"./image-editor.3291a85e.js";import"./index.cdaadc8a.js";import"./cloneDeep.5cd857a3.js";import"./main.esm.319d8703.js";import"./index.e98ba728.js";import"./pick.3dd070b2.js";import"./_basePickBy.1154a60f.js";import"./index.aea1b33f.js";import"./_createCompounder.591d8488.js";import"./color-picker.f11d48f2.js";import"./index.a34c327d.js";import"./string.955a924b.js";import"./truncate-content.b4da0a61.js";import"./useLabels.14342caf.js";import"./index.d7cf0025.js";import"./tooltip.7fc982a4.js";import"./commerce.5a632190.js";import"./index.eb337ef3.js";import"./list-editor.6914f1ec.js";import"./index.01dc3ec0.js";import"./k-table.e9121736.js";import"./sortable.esm.a99254e8.js";import"./content-effect.e965bc7a.js";import"./textContent.49dfc8fa.js";import"./omitBy.7923fe31.js";import"./pickBy.ae56c3eb.js";import"./isEmpty.fff03236.js";import"./edit-content.352b36f1.js";import"./custom-field.2a857ed5.js";import"./index.50c16ae5.js";const nt={class:"px-24 pt-0 pb-84px space-y-12"},st={class:"bg-fff dark:bg-[#252526] px-24 py-16 rounded-normal"},lt=U({setup(p){const{t:i}=Q(),a=$(),v=A("typeId");q().loadCategories();const n=_(),d=_([]),f=_(),s=_();let o=tt();o.addVariant(ot([],""));const{fields:V,customFields:B}=at(),m=_({categories:[],attributes:[],title:"",seoName:"",description:"",featuredImage:"",images:[],active:!0,variants:[],tags:[],customData:{},variantOptions:[],isDigital:!1});M(()=>I(this,null,function*(){if(v&&v!=Z&&(n.value=yield H(v)),n.value){for(const t of n.value.attributes)d.value.push({key:t.name,value:"",options:t.type=="Selection"?t.options:[]});for(const t of n.value.options)o.options.value.push(t.name);for(const t of n.value.options){for(const e of t.options)o.addOptionItem(t.name,e,"");setTimeout(()=>{const e=m.value.variantOptions.find(c=>c.name==t.name);e&&(e.type=t.valueType)})}m.value.isDigital=n.value.isDigital,m.value.maxDownloadCount=n.value.maxDownloadCount,m.value.maxDownloadDay=n.value.maxDownloadDay}}));function D(){a.goBackOrTo(J({name:"product management"}))}function E(){return I(this,null,function*(){var e,c;try{yield f.value.form.validate(),yield(c=(e=s.value)==null?void 0:e.form)==null?void 0:c.validate()}catch(u){throw rt(),u}const t=k({},m.value);t.attributes=d.value.map(u=>({key:u.key,value:u.value})),o.list.value.forEach((u,O)=>u.order=O),t.variants=o.list.value,yield j(t),D()})}return P(()=>{var t;return(t=m.value)==null?void 0:t.featuredImage},t=>{if(!!t)for(const e of o.list.value)e.image||(e.image=t)}),(t,e)=>{const c=mt,u=pt,O=T;return R(),z(G,null,[l(K,{class:"p-24","crumb-path":[{name:r(i)("common.productManagement"),route:{name:"product management"}},{name:r(i)("common.create")}]},null,8,["crumb-path"]),h("div",nt,[l(L,{ref_key:"basicInfo",ref:f,model:m.value,fields:r(V)},{default:g(()=>[l(c,{label:r(i)("common.attributes")},{default:g(()=>[l(Y,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=b=>d.value=b),"key-input-attributes":{placeholder:r(i)("common.attributeSamples")},"value-input-attributes":{placeholder:r(i)("common.value")},lass:"max-w-600px space-y-8 w-full"},null,8,["modelValue","key-input-attributes","value-input-attributes"])]),_:1},8,["label"])]),_:1},8,["model","fields"]),l(it,{ref_key:"customData",ref:s,data:m.value.customData,"custom-fields":r(B)},null,8,["data","custom-fields"]),h("div",st,[l(u,{"label-position":"top"},{default:g(()=>[l(c,{label:r(i)("commerce.variantOptions")},{default:g(()=>[l(W,{options:r(o).options.value,variants:r(o).list.value,"variant-options":m.value.variantOptions,class:"max-w-600px",onUpdateOptionItem:r(o).updateOptionItem,onUpdateOptionName:r(o).updateOptionName,onAddOptionItem:e[1]||(e[1]=(b,F)=>r(o).addOptionItem(b,F,m.value.featuredImage)),onDeleteOptionItem:r(o).deleteOptionItem,onDeleteOption:r(o).deleteOption,onAddOption:r(o).addOption},null,8,["options","variants","variant-options","onUpdateOptionItem","onUpdateOptionName","onDeleteOptionItem","onDeleteOption","onAddOption"])]),_:1},8,["label"]),l(X,{variants:r(o).list.value,options:r(o).options.value,"default-image":m.value.featuredImage,"variant-options":m.value.variantOptions,"is-digital":m.value.isDigital},null,8,["variants","options","default-image","variant-options","is-digital"])]),_:1})])]),l(O,{permission:{feature:"productManagement",action:"edit"},onCancel:D,onSave:E})],64)}}});var pr=et(lt,[["__scopeId","data-v-5e130037"]]);export{pr as default};
