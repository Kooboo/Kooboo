var _=(o,y,t)=>new Promise((s,a)=>{var n=e=>{try{u(t.next(e))}catch(d){a(d)}},i=e=>{try{u(t.throw(e))}catch(d){a(d)}},u=e=>e.done?s(e.value):Promise.resolve(e.value).then(n,i);u((t=t.apply(o,y)).next())});import{_ as B}from"./alert.8fe5500a.js";import{d as K,g as S,w as I}from"./i18n.25caaace.js";import{a as f}from"./replace-all.b35629e7.js";import{d as v}from"./main.1c3b59e3.js";import{a as w,l as M,i as T}from"./validate.f3c0b03b.js";import{_ as $}from"./index.50326354.js";import{E as D}from"./index.f571dfc9.js";import{E as z,a as A}from"./index.94998415.js";import{E as F}from"./index.a5d96e5a.js";import{d as L,g as V,o as b,j as E,w as c,b as r,k as j,f as H,u as p}from"./url.8f5ec20c.js";const U=K.global.t,ne=()=>v.get(f("KeyValue/list")),G=o=>v.get(f("KeyValue/get"),{key:o}),ue=o=>v.post(f("KeyValue/Deletes"),o,void 0,{successMessage:U("common.deleteSuccess")}),J=o=>v.post(f("KeyValue/Update"),o,void 0,{successMessage:U("common.saveSuccess")}),O=o=>v.get(f("KeyValue/isUniqueName"),{name:o},{hiddenLoading:!0,hiddenError:!0}),P={class:"px-32 py-24"},me=L({props:{modelValue:{type:Boolean},current:null,alert:null},emits:["update:modelValue","success"],setup(o,{emit:y}){const t=o,s=V(!0),{t:a}=S(),n=!t.current,i=V(),u=V(!1),e=V({key:t.current,value:""});_(this,null,function*(){n||(e.value.value=yield G(e.value.key))});const d={value:[w(a("common.fieldRequiredTips"))],key:[w(a("common.fieldRequiredTips")),M(),n?T(O,a("common.keyHasBeenTakenTips")):void 0]};function q(){return _(this,null,function*(){!i.value||(yield i.value.validate(),yield J(e.value),u.value=!0,s.value=!1)})}const N=()=>{y("success",u.value),y("update:modelValue",!1)};return(Q,l)=>{const x=B,g=D,k=z,C=A,R=F;return b(),E(R,{modelValue:s.value,"onUpdate:modelValue":l[4]||(l[4]=m=>s.value=m),width:"600px","close-on-click-modal":!1,title:n?p(a)("common.new"):p(a)("common.edit"),"custom-class":"el-dialog--zero-padding",onClose:N},{footer:c(()=>[r($,{permission:{feature:"keyValue",action:"edit"},onConfirm:q,onCancel:l[3]||(l[3]=m=>s.value=!1)})]),default:c(()=>[o.alert?(b(),E(x,{key:0,content:o.alert},null,8,["content"])):j("",!0),H("div",P,[r(C,{ref_key:"form",ref:i,model:e.value,rules:p(d),"label-position":"top",onSubmit:l[2]||(l[2]=I(()=>{},["prevent"]))},{default:c(()=>[r(k,{prop:"key",label:p(a)("common.key")},{default:c(()=>[r(g,{modelValue:e.value.key,"onUpdate:modelValue":l[0]||(l[0]=m=>e.value.key=m),disabled:!n,"data-cy":"key"},null,8,["modelValue","disabled"])]),_:1},8,["label"]),r(k,{prop:"value",label:p(a)("common.value")},{default:c(()=>[r(g,{modelValue:e.value.value,"onUpdate:modelValue":l[1]||(l[1]=m=>e.value.value=m),type:"textarea",autosize:"","data-cy":"value"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])])]),_:1},8,["modelValue","title"])}}});export{me as _,ue as d,ne as g};
