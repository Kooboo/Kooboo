var U=(e,d,r)=>new Promise((i,n)=>{var p=u=>{try{f(r.next(u))}catch(s){n(s)}},y=u=>{try{f(r.throw(u))}catch(s){n(s)}},f=u=>u.done?i(u.value):Promise.resolve(u.value).then(p,y);f((r=r.apply(e,d)).next())});import{_ as le}from"./k-table.e9121736.js";import{d as B,g as C,i as te,o as m,j as x,w as a,a as V,b as o,f as g,u as l,aF as P,F as O,b6 as T,k as E,aH as L,t as w,m as ne,M as ae,h as me,b7 as de,e as ie}from"./url.2e6a77c4.js";import{B as se}from"./breadcrumb.0ef7e7c4.js";import{g as I,o as ue,w as K}from"./i18n.97105311.js";import{c as ce,e as re,u as pe,d as fe}from"./commerce.c633c6e0.js";import{b as ve}from"./confirm.46f27373.js";import{_ as G}from"./index.9ffc2c80.js";import{_ as Q}from"./icon-button.e1f3bfd2.js";import{i as ye}from"./main.52487121.js";import{a as be}from"./product-variant.9535432a.js";import{E as H,a as q,c as ge}from"./index.afee24fe.js";import{E as R}from"./index.4587e608.js";import{E as A,a as z}from"./index.317a7f30.js";import{E as _e}from"./index.a34c327d.js";import{E as W}from"./index.b09a9f00.js";import{E as Ve}from"./index.d7cf0025.js";import{_ as xe}from"./tooltip.7fc982a4.js";import{E as he}from"./index.00cc1b15.js";import{E as Ee}from"./index.c1764395.js";import{E as ke}from"./index.1d8a0bb0.js";import{E as X}from"./index.4b289bae.js";import{_ as we}from"./boolean-tag.47fe23dc.js";import{E as Ce}from"./windi.539ebeab.js";import{E as De}from"./index.f3d28a97.js";import{E as $e}from"./index.9589f7cf.js";import"./sortable.esm.a99254e8.js";import"./index.7a88a6b5.js";import"./index.bc93d068.js";import"./isEqual.3700b7f1.js";import"./_baseIsEqual.abb55a3a.js";import"./error.7e8331f1.js";import"./index.6302b2c1.js";import"./event.776e7e11.js";import"./index.9e96921b.js";import"./replace-all.8fa5a83d.js";/* empty css                                                               */import"./plugin-vue_export-helper.21dcd24c.js";import"./plugin-vue_export-helper.41ffa612.js";import"./index.f997a738.js";import"./logo-transparent.1566007e.js";import"./index.d267cbe6.js";import"./index.07e210fb.js";import"./scroll.8babc10c.js";import"./aria.75ec5909.js";import"./event.53b2ad83.js";import"./focus-trap.de18cf8f.js";import"./isNil.98bb3b88.js";import"./validator.1d438d08.js";import"./index.975a8825.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";import"./guid.c1a40312.js";import"./debounce.61c67278.js";import"./toNumber.574be4f1.js";import"./index.a46fa52c.js";import"./_baseClone.f10ff33c.js";import"./position.b1ced824.js";import"./index.e3f90979.js";import"./refs.4001ce17.js";const Se={key:0},Oe={class:"space-y-12"},Te={class:"flex gap-4 w-full"},Ne={class:"space-y-4 w-full"},Be={class:"flex items-center justify-between mt-12"},Ie={class:"truncate flex-1 text-l font-bold"},Ue={key:0,class:"flex gap-8 flex-wrap"},Fe=B({props:{model:null,forceSelection:{type:Boolean},editing:{type:Boolean},nameLabel:null,valueLabel:null,namePlaceholder:null},emits:["changeName","changeOption","addOption","deleteOption","delete"],setup(e,{emit:d}){const r=e,i=C(r.editing),{t:n}=I(),p=C(),y=C(""),f=[{name:"Selection",display:n("common.selection")},{name:"Custom",display:n("common.custom")}];function u(t,c){const h=r.model.options[t];r.model.options.includes(c)?(ye(n("common.valueExist")),p.value.options[t]=h):c?d("changeOption",h,c):p.value.options[t]=h}function s(t){d("changeName",t),p.value=JSON.parse(JSON.stringify(r.model))}function _(t){y.value="",t=t==null?void 0:t.trim(),!(!t||r.model.options.includes(t))&&d("addOption",t)}return te(()=>r.model,()=>{p.value=JSON.parse(JSON.stringify(r.model))},{deep:!0,immediate:!0}),(t,c)=>{const h=H,k=q,$=R,M=H,j=q,F=A,b=_e,D=Q,Z=z,ee=W,oe=Ve;return m(),x(oe,{shadow:"never"},{default:a(()=>[i.value?(m(),V("div",Se,[o(Z,{"label-position":"top"},{default:a(()=>[g("div",Oe,[o(F,{label:e.nameLabel||l(n)("commerce.optionName")},{default:a(()=>[g("div",Te,[o($,{modelValue:e.model.name,"onUpdate:modelValue":c[1]||(c[1]=v=>e.model.name=v),placeholder:e.namePlaceholder||l(n)("commerce.variantSamples"),onChange:s},P({_:2},[e.forceSelection?{name:"append",fn:a(()=>[o(k,{modelValue:e.model.valueType,"onUpdate:modelValue":c[0]||(c[0]=v=>e.model.valueType=v),placeholder:l(n)("common.type"),class:"w-120px !m-0"},{default:a(()=>[(m(!0),V(O,null,T(l(be),v=>(m(),x(h,{key:v.key,label:v.value,value:v.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])])}:void 0]),1032,["modelValue","placeholder"]),e.forceSelection?E("",!0):(m(),x(j,{key:0,modelValue:e.model.type,"onUpdate:modelValue":c[2]||(c[2]=v=>e.model.type=v),class:"w-220px"},{default:a(()=>[(m(),V(O,null,T(f,v=>o(M,{key:v.name,label:v.display,value:v.name},null,8,["label","value"])),64))]),_:1},8,["modelValue"]))])]),_:1},8,["label"]),e.model.type=="Selection"?(m(),x(F,{key:0,label:e.valueLabel||l(n)("commerce.optionValues")},{default:a(()=>[g("div",Ne,[(m(!0),V(O,null,T(p.value.options,(v,S)=>(m(),x($,{key:S,"model-value":v,readonly:e.model.valueType=="color","onUpdate:modelValue":N=>p.value.options[S]=N,onChange:N=>u(S,N)},P({suffix:a(()=>[o(D,{class:"hover:text-orange",tip:l(n)("common.delete"),icon:"icon-delete",onClick:N=>d("deleteOption",S)},null,8,["tip","onClick"])]),_:2},[e.model.valueType=="color"?{name:"prepend",fn:a(()=>[o(b,{"model-value":v,"onUpdate:modelValue":N=>u(S,N)},null,8,["model-value","onUpdate:modelValue"])])}:void 0]),1032,["model-value","readonly","onUpdate:modelValue","onChange"]))),128)),o($,{modelValue:y.value,"onUpdate:modelValue":c[3]||(c[3]=v=>y.value=v),readonly:e.model.valueType=="color",placeholder:e.model.options.length?l(n)("common.addAnotherValue"):l(n)("common.addValue"),onChange:_,onKeydown:c[4]||(c[4]=ue(K(v=>_(y.value),["prevent"]),["tab"]))},P({_:2},[e.model.valueType=="color"?{name:"prepend",fn:a(()=>[o(b,{"onUpdate:modelValue":_})])}:void 0]),1032,["modelValue","readonly","placeholder"]),y.value?(m(),x($,{key:0,readonly:e.model.valueType=="color",placeholder:l(n)("common.addAnotherValue")},P({_:2},[e.model.valueType=="color"?{name:"prepend",fn:a(()=>[o(b,{"onUpdate:modelValue":_})])}:void 0]),1032,["readonly","placeholder"])):E("",!0)])]),_:1},8,["label"])):E("",!0)])]),_:1}),g("div",Be,[o(D,{circle:"",class:"hover:text-orange text-orange",icon:"icon-delete ",tip:l(n)("common.delete"),onClick:c[5]||(c[5]=v=>d("delete"))},null,8,["tip"]),o(ee,{round:"",type:"primary",onClick:c[6]||(c[6]=v=>i.value=!1)},{default:a(()=>[L(w(l(n)("common.done")),1)]),_:1})])])):(m(),V("div",{key:1,class:"space-y-8 cursor-pointer",onClick:c[7]||(c[7]=v=>i.value=!0)},[g("div",Ie,w(e.model.name),1),e.model.type=="Selection"?(m(),V("div",Ue,[(m(!0),V(O,null,T(e.model.options,(v,S)=>(m(),V("div",{key:S,class:"bg-999/30 px-8 rounded-normal flex items-center gap-4"},[g("span",null,w(v),1),e.model.valueType=="color"?(m(),V("div",{key:0,style:ne({backgroundColor:v}),class:"w-12 h-12 rounded-full shadow-s-4"},null,4)):E("",!0)]))),128))])):E("",!0)]))]),_:1})}}}),Pe={class:"space-y-8 w-full"},J=B({props:{model:null,forceSelection:{type:Boolean},nameLabel:null,valueLabel:null,namePlaceholder:null},setup(e){const d=e,{t:r}=I();function i(){d.model.push({name:"",type:d.forceSelection?"Selection":"Custom",valueType:"text",options:[]})}function n(y,f){d.model.find(u=>u.name==f)||(y.name=f)}function p(y,f,u){const s=y.options.indexOf(f);s>-1&&y.options.splice(s,1,u)}return(y,f)=>{const u=Q;return m(),V("div",Pe,[(m(!0),V(O,null,T(d.model,(s,_)=>(m(),x(Fe,{key:_,model:s,"force-selection":e.forceSelection,editing:!s.name,"name-label":e.nameLabel,"value-label":e.valueLabel,"name-placeholder":e.namePlaceholder,onChangeName:t=>n(s,t),onChangeOption:(t,c)=>p(s,t,c),onAddOption:t=>s.options.push(t),onDeleteOption:t=>s.options.splice(t,1),onDelete:t=>d.model.splice(d.model.indexOf(s),1)},null,8,["model","force-selection","editing","name-label","value-label","name-placeholder","onChangeName","onChangeOption","onAddOption","onDeleteOption","onDelete"]))),128)),o(u,{circle:"",class:"text-blue",icon:"icon-a-addto",tip:l(r)("common.add"),onClick:i},null,8,["tip"])])}}}),Le={class:"h-24"},Je={key:0,class:"flex items-center gap-4"},Ae={class:"h-24"},Me={key:1,class:"flex items-center gap-4"},Y=B({props:{model:null},setup(e){const{t:d}=I();return(r,i)=>{const n=xe,p=he,y=Ee,f=ke,u=A;return m(),x(u,null,{label:a(()=>[g("span",null,w(l(d)("common.isDigitalProduct")),1),o(n,{tip:l(d)("common.digitalProductTip"),"custom-class":"ml-4"},null,8,["tip"])]),default:a(()=>[g("div",null,[g("div",null,[o(p,{modelValue:e.model.isDigital,"onUpdate:modelValue":i[0]||(i[0]=s=>e.model.isDigital=s)},null,8,["modelValue"])]),g("div",null,[g("div",Le,[e.model.isDigital?(m(),x(y,{key:0,label:l(d)("common.limitDownloadCount"),"model-value":!!e.model.maxDownloadCount,onClick:i[1]||(i[1]=K(s=>e.model.maxDownloadCount=e.model.maxDownloadCount?void 0:3,["stop","prevent"]))},null,8,["label","model-value"])):E("",!0)]),e.model.maxDownloadCount?(m(),V("div",Je,[o(f,{modelValue:e.model.maxDownloadCount,"onUpdate:modelValue":i[2]||(i[2]=s=>e.model.maxDownloadCount=s),min:1},null,8,["modelValue"]),g("span",null,w(l(d)("common.times")),1)])):E("",!0),g("div",Ae,[e.model.isDigital?(m(),x(y,{key:0,label:l(d)("common.limitDownloadTime"),"model-value":!!e.model.maxDownloadDay,onClick:i[3]||(i[3]=K(s=>e.model.maxDownloadDay=e.model.maxDownloadDay?void 0:3,["stop","prevent"]))},null,8,["label","model-value"])):E("",!0)]),e.model.maxDownloadDay?(m(),V("div",Me,[o(f,{modelValue:e.model.maxDownloadDay,"onUpdate:modelValue":i[4]||(i[4]=s=>e.model.maxDownloadDay=s),min:1},null,8,["modelValue"]),g("span",null,w(l(d)("common.days")),1)])):E("",!0)])])]),_:1})}}}),je=B({props:{modelValue:{type:Boolean}},emits:["update:modelValue","reload"],setup(e,{emit:d}){const{t:r}=I(),i=C(!0),n=C({name:"",attributes:[],options:[],isDigital:!1,maxDownloadCount:void 0});function p(){return U(this,null,function*(){yield ce(n.value),d("reload"),i.value=!1})}return(y,f)=>{const u=R,s=A,_=z,t=G,c=X;return m(),x(c,{"model-value":i.value,width:"600px",title:l(r)("common.create"),"close-on-click-modal":!1,onClosed:f[2]||(f[2]=h=>d("update:modelValue",!1))},{footer:a(()=>[o(t,{onConfirm:p,onCancel:f[1]||(f[1]=h=>i.value=!1)})]),default:a(()=>[o(_,{"label-position":"top"},{default:a(()=>[o(s,{label:l(r)("common.name")},{default:a(()=>[o(u,{modelValue:n.value.name,"onUpdate:modelValue":f[0]||(f[0]=h=>n.value.name=h)},null,8,["modelValue"])]),_:1},8,["label"]),o(s,{label:l(r)("common.attributes")},{default:a(()=>[o(J,{model:n.value.attributes,"name-label":l(r)("common.name"),"value-label":l(r)("common.value"),"name-placeholder":l(r)("common.attributeSamples")},null,8,["model","name-label","value-label","name-placeholder"])]),_:1},8,["label"]),o(s,{label:l(r)("commerce.variantOptions")},{default:a(()=>[o(J,{model:n.value.options,"force-selection":""},null,8,["model"])]),_:1},8,["label"]),o(Y,{model:n.value},null,8,["model"])]),_:1})]),_:1},8,["model-value","title"])}}}),Ke=B({props:{modelValue:{type:Boolean},model:null},emits:["update:modelValue","reload"],setup(e,{emit:d}){const r=e,{t:i}=I(),n=C(!0),p=C(JSON.parse(JSON.stringify(r.model)));function y(){return U(this,null,function*(){yield re(p.value),d("reload"),n.value=!1})}return(f,u)=>{const s=R,_=A,t=z,c=G,h=X;return m(),x(h,{"model-value":n.value,width:"600px",title:l(i)("common.edit"),"close-on-click-modal":!1,onClosed:u[2]||(u[2]=k=>d("update:modelValue",!1))},{footer:a(()=>[o(c,{onConfirm:y,onCancel:u[1]||(u[1]=k=>n.value=!1)})]),default:a(()=>[o(t,{"label-position":"top"},{default:a(()=>[o(_,{label:l(i)("common.name")},{default:a(()=>[o(s,{modelValue:p.value.name,"onUpdate:modelValue":u[0]||(u[0]=k=>p.value.name=k)},null,8,["modelValue"])]),_:1},8,["label"]),o(_,{label:l(i)("common.attributes")},{default:a(()=>[o(J,{model:p.value.attributes,"name-label":l(i)("common.name"),"value-label":l(i)("common.value"),"name-placeholder":l(i)("common.attributeSamples")},null,8,["model","name-label","value-label","name-placeholder"])]),_:1},8,["label"]),o(_,{label:l(i)("commerce.variantOptions")},{default:a(()=>[o(J,{model:p.value.options,"force-selection":""},null,8,["model"])]),_:1},8,["label"]),o(Y,{model:p.value},null,8,["model"])]),_:1})]),_:1},8,["model-value","title"])}}}),Re={class:"p-24"},ze={class:"flex items-center py-24"},He={class:"flex items-center"},qe={class:"flex items-center"},Ge={class:"text-black dark:text-[#cfd3dc]"},Qe={key:0,class:"flex items-center space-x-4 justify-center"},We={key:0,class:"flex items-center space-x-4 justify-center"},Xe={class:"flex items-center"},al=B({setup(e){const{t:d}=I(),i=ae().meta.title,n=pe(),p=C(!1),y=C(!1),f=C();function u(_){return U(this,null,function*(){yield ve(_.length),yield fe(_.map(t=>t.id)),n.loadTypes()})}me(()=>U(this,null,function*(){n.loadTypes()}));function s(_){f.value=_,y.value=!0}return(_,t)=>{const c=Ce,h=W,k=De,$=ge,M=$e,j=le,F=de("hasPermission");return m(),V("div",Re,[o(se,{name:l(i)},null,8,["name"]),g("div",ze,[ie((m(),x(h,{round:"",onClick:t[0]||(t[0]=b=>p.value=!0)},{default:a(()=>[g("div",He,[o(c,{class:"mr-16 iconfont icon-a-addto"}),L(" "+w(l(d)("common.create")),1)])]),_:1})),[[F,{feature:"productTypes",action:"edit"}]])]),o(j,{data:l(n).types,"show-check":"",onDelete:u},{default:a(()=>[o(k,{label:l(d)("common.name")},{default:a(({row:b})=>[g("div",qe,[g("span",Ge,w(b.name),1)])]),_:1},8,["label"]),o(k,{label:l(d)("common.attributes"),align:"center"},{default:a(({row:b})=>[b.attributes.length?(m(),V("div",Qe,[(m(!0),V(O,null,T(b.attributes,D=>(m(),x($,{key:D.name,round:"",type:"warning"},{default:a(()=>[L(w(D.name),1)]),_:2},1024))),128))])):E("",!0)]),_:1},8,["label"]),o(k,{label:l(d)("commerce.variantOptions"),align:"center"},{default:a(({row:b})=>[b.options.length?(m(),V("div",We,[(m(!0),V(O,null,T(b.options,D=>(m(),x($,{key:D.name,round:"",type:"success"},{default:a(()=>[L(w(D.name),1)]),_:2},1024))),128))])):E("",!0)]),_:1},8,["label"]),o(k,{label:l(d)("common.isDigitalProduct")},{default:a(({row:b})=>[g("div",Xe,[o(we,{value:b.isDigital},null,8,["value"])])]),_:1},8,["label"]),o(k,{align:"right",width:"60"},{default:a(({row:b})=>[o(M,{placement:"top",content:l(d)("common.edit")},{default:a(()=>[o(c,{class:"iconfont icon-a-writein hover:text-blue text-l",onClick:D=>s(b)},null,8,["onClick"])]),_:2},1032,["content"])]),_:1})]),_:1},8,["data"]),p.value?(m(),x(je,{key:0,modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=b=>p.value=b),onReload:t[2]||(t[2]=b=>l(n).loadTypes())},null,8,["modelValue"])):E("",!0),y.value?(m(),x(Ke,{key:1,modelValue:y.value,"onUpdate:modelValue":t[3]||(t[3]=b=>y.value=b),model:f.value,onReload:t[4]||(t[4]=b=>l(n).loadTypes())},null,8,["modelValue","model"])):E("",!0)])}}});export{al as default};
