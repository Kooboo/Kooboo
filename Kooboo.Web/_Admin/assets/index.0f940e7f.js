var k=(e,s,i)=>new Promise((b,r)=>{var C=d=>{try{c(i.next(d))}catch(t){r(t)}},h=d=>{try{c(i.throw(d))}catch(t){r(t)}},c=d=>d.done?b(d.value):Promise.resolve(d.value).then(C,h);c((i=i.apply(e,s)).next())});import{a as Q,r as R}from"./classCompletion.a22e38a6.js";import{a as v}from"./replace-all.7cf5f327.js";import{d as y}from"./main.ea42d807.js";import{C as U,w as A}from"./i18n.48bd28ac.js";import{x as M,d as j,o as f,a as m,t as D,k as S,b as l,u as F,w as E,r as P,n as I,I as J,f as g}from"./url.2e6a77c4.js";import{n as O}from"./guid.c1a40312.js";import{V as W}from"./vuedraggable.umd.5840ebc7.js";import{E as X}from"./windi.a5b0b048.js";import{E as Y}from"./index.379e80ad.js";import{E as Z}from"./index.2bc50276.js";import{c as _}from"./cloneDeep.ff43c1f8.js";const tt=()=>y.get(v("KScript/GetDefine")),et=()=>y.get(v("KScript/GetKViewSuggestions")),ot=()=>y.get(v("KScript/GetClassSuggestions")),St=(e,s,i)=>y.get(v("KScript/getcolumns"),{database:e,table:s,moduleId:i},{hiddenLoading:!0,hiddenError:!0}),It=(e,s)=>y.get(v("KScript/gettables"),{database:e,moduleId:s},{hiddenLoading:!0,hiddenError:!0}),N=new U;let G,L,x,H,p=new Date().getTime();function xt(){p=new Date().getTime()}function it(){return et()}function Dt(){return k(this,null,function*(){const e=M("siteId"),s=N.get("_site_version_");return x&&e+s+p==G||(x=(()=>k(this,null,function*(){const i=yield it();return yield Q(i),yield tt()}))(),G=e+s+p),x})}function Et(){return k(this,null,function*(){const e=M("siteId"),s=N.get("_site_version_");e+s+p!=L&&(H=ot(),L=e+s+p),R(yield H)})}const st={key:0,class:"font-bold"},nt={key:0,class:"pr-8 w-32"},at={class:"overflow-hidden leading-40px flex-1 mr-8 ellipsis","data-cy":"text"},dt=["title"],lt={key:1,class:"p-4"},rt={class:"p-4"},ct={key:2,class:"p-4"},Pt=j({props:{list:null,idProp:{default:void 0},displayProp:{default:void 0},group:{default:O()},title:{default:void 0},wrapperClass:{default:void 0},editable:{type:Boolean},deleteTip:null,disableActions:{default:void 0}},emits:["delete","sort","add","edit","change"],setup(e,{emit:s}){const i=e;function b(t,o){const n=_(J(o));t.moved?(n.splice(t.moved.oldIndex,1),n.splice(t.moved.newIndex,0,t.moved.element)):t.added?n.splice(t.added.newIndex,0,t.added.element):t.removed&&n.splice(t.removed.oldIndex,1),s("change",n)}function r(t){var n;const o=(n=i.disableActions)==null?void 0:n.edit;return h(t,o)}function C(t){var n;const o=(n=i.disableActions)==null?void 0:n.delete;return h(t,o)}function h(t,o){if(!!o)return typeof o=="function"?o(t):o||void 0}function c(t,o){r(t)||s("edit",i.idProp?t[i.idProp]:t,t,{index:o,list:i.list})}function d(t,o){C(t)||s("delete",i.idProp?t[i.idProp]:t,t,{index:o,list:i.list})}return(t,o)=>{var K,T;const n=X,q=Y,z=Z;return f(),m("div",{class:I((K=e.wrapperClass)!=null?K:"space-y-4 px-24 py-16")},[e.title?(f(),m("h3",st,D(e.title),1)):S("",!0),l(F(W),{"model-value":e.list,group:e.group,disabled:e.list.length<2,"item-key":(T=e.idProp)!=null?T:"",class:"space-y-4",onSort:o[0]||(o[0]=a=>s("sort",a)),onChange:o[1]||(o[1]=a=>b(a,e.list))},{item:E(({element:a,index:u})=>{var V,$;return[g("div",{class:I(["text-666 dark:text-fff/67 flex items-center pl-16 pr-8 w-full border-line dark:border-666 rounded-normal border border-solid ellipsis bg-fff dark:bg-[#333]",{"cursor-move":e.list.length>1}]),"data-cy":"added-item"},[e.list.length>1?(f(),m("div",nt,"# "+D(u+1),1)):S("",!0),g("div",at,[P(t.$slots,"default",{item:a,index:u},()=>{var w,B;return[g("span",{title:(w=a[e.displayProp||""])==null?void 0:w.trim(),"data-cy":"name"},D((B=a[e.displayProp||""])==null?void 0:B.trim()),9,dt)]})]),g("div",null,[P(t.$slots,"right",{item:a,index:u})]),e.editable?(f(),m("div",lt,[l(n,{class:I(["iconfont icon-a-setup",[r(a)?"cursor-not-allowed text-opacity-50":"cursor-pointer"]]),"data-cy":"edit",onClick:A(w=>c(a,u),["stop"])},null,8,["class","onClick"])])):S("",!0),g("div",rt,[l(q,{placement:"top-start",content:(V=e.deleteTip)==null?void 0:V.call(e,a),disabled:!(($=e.deleteTip)!=null&&$.call(e,a))},{default:E(()=>[l(n,{class:I(["text-orange iconfont icon-delete",[C(a)?"cursor-not-allowed text-opacity-50":"cursor-pointer"]]),color:"#fab6b6","data-cy":"remove",onClick:A(w=>d(a,u),["stop"])},null,8,["class","onClick"])]),_:2},1032,["content","disabled"])]),e.list.length>1?(f(),m("div",ct,[l(n,{class:"iconfont icon-move","data-cy":"move"})])):S("",!0)],2)]}),_:3},8,["model-value","group","disabled","item-key"]),P(t.$slots,"bottom",{},()=>[l(z,{circle:"","data-cy":"add",onClick:o[2]||(o[2]=a=>t.$emit("add"))},{default:E(()=>[l(n,{class:"text-blue iconfont icon-a-addto"})]),_:1})])],2)}}});export{Pt as _,St as a,Et as b,It as g,xt as r,Dt as u};
