var v=(o,c,s)=>new Promise((u,n)=>{var d=e=>{try{l(s.next(e))}catch(r){n(r)}},h=e=>{try{l(s.throw(e))}catch(r){n(r)}},l=e=>e.done?u(e.value):Promise.resolve(e.value).then(d,h);l((s=s.apply(o,c)).next())});import{_ as H}from"./layout.4bc43a3b.js";import{g as T}from"./i18n.2d8b30eb.js";import{d as _,E as C}from"./main.d8c6ef59.js";import{a as y}from"./replace-all.dd6016f2.js";import{d as I,c as N,g as w,b7 as O,o as f,j as b,w as D,a as E,b6 as R,f as m,u as p,e as U,aH as j,t as q,b as z,F as A,x as Q}from"./url.8f5ec20c.js";import{M as G}from"./userWorker.b3a6730b.js";import{i as F}from"./style.ad574a57.js";import{E as J}from"./index.b3663d55.js";import{E as K}from"./index.96970839.js";function W(o){return{onlineSearch:n=>_.get(y(`online-${o}/SearchOnline`),n),getSearchProviders:()=>_.get(y(`online-${o}/Providers`)),download:(n,d)=>_.post(y(`online-${o}/Download`),{file:d},{path:n},{hiddenLoading:!0,hiddenError:!0})}}const X=["title"],Y={class:"flex-1 text-l font-bold ellipsis"},Z=["data-cy","innerHTML"],ee=["data-cy","innerHTML"],fe=I({props:{module:null},emits:["reload"],setup(o,{expose:c,emit:s}){const u=o,{getSearchProviders:n,onlineSearch:d,download:h}=N(()=>W(u.module)).value,l=w(!1),{t:e}=T(),r=w(),x=w([]),k=()=>v(this,null,function*(){x.value=yield n()});function L(a){return v(this,null,function*(){return yield d(a)})}function M(a){var i;a.loading=!0,h((i=Q("folder"))!=null?i:"/",a).then(()=>{a.installed=!0,s("reload")}).catch(()=>{a.installed=!1,C.error(e("common.installationFailed"))}).finally(()=>{G(),a.loading=!1})}k();function $(){var a;l.value=!0,(a=r.value)==null||a.reset()}return c({show:$}),(a,i)=>{const P=K,V=J,B=O("hasPermission");return f(),b(H,{ref_key:"searchDialogRef",ref:r,modelValue:l.value,"onUpdate:modelValue":i[0]||(i[0]=g=>l.value=g),"fetch-data":L,providers:x.value},{default:D(({list:g,keyword:S})=>[(f(!0),E(A,null,R(g,t=>(f(),E("div",{key:t.id,class:"hover:bg-[#EFF6FF] dark:hover:bg-666 px-32"},[m("div",{class:"flex items-center pt-12 pb-4",title:t.name+`
`+t.description},[m("div",Y,[m("p",{class:"ellipsis h-auto","data-cy":`${o.module}-name`,innerHTML:p(F)(t.name,S)},null,8,Z),m("p",{class:"font-light text-m text-999 p-4 ellipsis","data-cy":`${o.module}-description`,innerHTML:p(F)(t.description,S)},null,8,ee)]),U((f(),b(P,{type:"primary",size:"small",round:"","data-cy":"install",loading:t.loading,disabled:t.loading||t.installed,onClick:ae=>M(t)},{default:D(()=>[j(q(t.installed?p(e)("common.hasInstall"):p(e)("common.install")),1)]),_:2},1032,["loading","disabled","onClick"])),[[B,{feature:o.module,action:"edit"}]])],8,X),z(V,{class:"m-0"})]))),128))]),_:1},8,["modelValue","providers"])}}});export{fe as _};
