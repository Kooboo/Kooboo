var C=(V,g,v)=>new Promise((h,e)=>{var m=c=>{try{f(v.next(c))}catch(a){e(a)}},t=c=>{try{f(v.throw(c))}catch(a){e(a)}},f=c=>c.done?h(c.value):Promise.resolve(c.value).then(m,t);f((v=v.apply(V,g)).next())});import{_ as ie}from"./icon-button.e30c79ea.js";import{_ as se}from"./k-table.f75c31cc.js";import{B as Y,C as me,D as Z,I as re,E as ue,F as de,G as ce}from"./dev-mode.e5eea554.js";import{B as pe}from"./breadcrumb.79da4f07.js";import{g as F,d as fe,C as _e}from"./i18n.2d8b30eb.js";import{_ as ee}from"./index.ed88cf90.js";import{E as P}from"./index.a4ff385c.js";import{d as j,g as _,o as i,j as p,w as d,b as s,u as n,ce as ve,f as w,a as A,F as W,b6 as Q,aH as I,t as x,k as $,c as ge,N as ke,b7 as ye,e as R,cg as X}from"./url.8f5ec20c.js";import{m as Ve}from"./marked.esm.30e9f73c.js";import{_ as he}from"./index.47274d5a.js";import{a as oe,u as we}from"./replace-all.dd6016f2.js";import{d as te,u as be}from"./main.d8c6ef59.js";import{E as Ce}from"./index.21d7e739.js";import{E as le}from"./index.745dc8e0.js";import{E as Se,a as $e}from"./index.ab4ed870.js";import{E as xe}from"./index.bb5499e2.js";import{E as Ee,a as De}from"./index.a141884f.js";import{b as Ue,s as Me}from"./confirm.617d359f.js";import{_ as Be}from"./package-search.6b8fcfbe.js";import{E as Ie}from"./windi.bf752d69.js";import{E as Ne}from"./index.96970839.js";import{E as Te}from"./index.bc06171b.js";import"./index.ec785feb.js";import"./focus-trap.3f074800.js";import"./isNil.98bb3b88.js";import"./event.53b2ad83.js";import"./index.a595fe6d.js";import"./index.e87fdc52.js";import"./index.0535d5fe.js";import"./sortable.esm.a99254e8.js";import"./index.14993118.js";import"./isEqual.c3e9e9f4.js";import"./_baseIsEqual.2f38f7c3.js";import"./error.7e8331f1.js";import"./index.4c9af567.js";import"./event.776e7e11.js";import"./index.0a83bb10.js";import"./guid.c1a40312.js";import"./index.8143a7f0.js";import"./classCompletion.a22e38a6.js";import"./userWorker.b3a6730b.js";import"./editor.main.d2800f63.js";import"./preload-helper.13a99eb0.js";import"./vuedraggable.umd.8a5464a3.js";import"./cloneDeep.b77ba92c.js";import"./_baseClone.29a8cd97.js";import"./index.593106e3.js";import"./config.589cc0cd.js";import"./dark.7c26a0d3.js";import"./page.c26fc024.js";import"./validate.348f94d6.js";import"./index.37979027.js";import"./index.3dc39d21.js";import"./index.832f2769.js";import"./index.b3e4ff8e.js";import"./index.5af167df.js";import"./style.ad574a57.js";import"./toNumber.6efebd6a.js";import"./index.80a4dc1a.js";import"./index.bf8ed8c6.js";import"./scroll.54c27fbd.js";import"./aria.75ec5909.js";import"./validator.1bcd6e6a.js";import"./index.35ae15db.js";import"./dropdown.d7a15792.js";import"./refs.d2253dd4.js";import"./use-copy-text.67d6617b.js";import"./index.68d24a68.js";import"./toggleComment.5b29ca87.js";import"./use-save-tip.ee41ca28.js";import"./index.b3d1cf25.js";import"./index.3be79fd5.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./index.5f2a659f.js";import"./index.06224119.js";import"./index.14aabd47.js";import"./alert.8fe5500a.js";import"./index.b4ac73b5.js";/* empty css                                                               */import"./media-list.vue_vue_type_style_index_0_scoped_true_lang.a31db113.js";/* empty css                                                          */import"./file.52d8e05a.js";import"./use-date.28e9a8a3.js";import"./dayjs.min.35b12e7a.js";/* empty css                                                          *//* empty css                                                                 */import"./use-file-upload.1cd07d1f.js";/* empty css                                                         */import"./image-editor.vue_vue_type_style_index_0_scoped_true_lang.7c6ede25.js";import"./image-editor.404a4df5.js";import"./main.esm.f3ac04a5.js";import"./index.a330b59f.js";import"./plugin-vue_export-helper.41ffa612.js";import"./index.50c16ae5.js";import"./index.e3f90979.js";import"./debounce.730e1961.js";import"./index.b68af8a1.js";import"./logo-transparent.1566007e.js";import"./layout.4bc43a3b.js";import"./search-input.770da843.js";import"./index.47676836.js";import"./position.edbf0f94.js";import"./throttle.3f3ee457.js";import"./index.b3663d55.js";const Oe=j({props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(V,{emit:g}){const{t:v}=F(),h=Y(),e=_(!0),m=_(),t=_({name:""}),f=()=>C(this,null,function*(){yield m.value.validate(),yield h.createModule(t.value.name),e.value=!1});return(c,a)=>{const k=P;return i(),p(k,{"model-value":e.value,width:"600px","close-on-click-modal":!1,title:n(v)("common.newModule"),onClosed:a[1]||(a[1]=b=>g("update:modelValue",!1))},{footer:d(()=>[s(ee,{onConfirm:f,onCancel:a[0]||(a[0]=b=>e.value=!1)})]),default:d(()=>[s(me,{ref_key:"form",ref:m,model:t.value,onSave:f},null,8,["model"])]),_:1},8,["model-value","title"])}}}),Re={class:"px-12"},Ae=j({props:{modelValue:{type:Boolean},id:null},emits:["update:modelValue"],setup(V,{emit:g}){const v=V,{t:h}=F(),e=_(!0),m=_("");Z("root",v.id,"Readme.md").then(f=>{m.value=Ve.parse(f)});const t=ve(()=>`<div style="padding:10px;">${m.value}<div>`);return(f,c)=>{const a=P;return i(),p(a,{"custom-class":"el-dialog--zero-padding","model-value":e.value,width:"1000px","close-on-click-modal":!1,title:n(h)("common.description"),onClosed:c[0]||(c[0]=k=>g("update:modelValue",!1))},{default:d(()=>[w("div",Re,[s(he,{class:"h-400px",content:n(t)},null,8,["content"])])]),_:1},8,["model-value","title"])}}}),Fe=fe.global.t,Pe=V=>te.get(oe("ModuleSetting/GetSetting"),{id:V}),je=(V,g)=>te.post(oe("ModuleSetting/UpdateSetting"),{id:V,json:g},void 0,{successMessage:Fe("common.saveSuccess")}),ze={key:0},Je={class:"text-m font-bold ellipsis"},qe=["title"],Ge=j({props:{modelValue:{type:Boolean},id:null},emits:["update:modelValue"],setup(V,{emit:g}){const v=V,{t:h}=F(),e=_(!0),m=_(),t=_({});C(this,null,function*(){var c=yield Z("root",v.id,"module.config");m.value=JSON.parse(c);const a=yield Pe(v.id);if(a)t.value=JSON.parse(a);else if(m.value.settingDefines)for(const k of m.value.settingDefines)t.value[k.name]=k.defaultValue});const f=()=>C(this,null,function*(){m.value.setting=t.value,yield je(v.id,JSON.stringify(t.value,null,2)),e.value=!1});return(c,a)=>{const k=le,b=Ce,E=Se,M=$e,z=xe,J=Ee,q=De,G=P;return i(),p(G,{"model-value":e.value,width:"600px","close-on-click-modal":!1,title:n(h)("common.setting"),onClosed:a[1]||(a[1]=D=>g("update:modelValue",!1))},{footer:d(()=>[s(ee,{permission:{feature:"module",action:"edit"},onConfirm:f,onCancel:a[0]||(a[0]=D=>e.value=!1)})]),default:d(()=>[s(q,{"label-position":"top"},{default:d(()=>{var D;return[(D=m.value)!=null&&D.settingDefines?(i(),A("div",ze,[(i(!0),A(W,null,Q(m.value.settingDefines,r=>(i(),p(J,{key:r.name},{label:d(()=>[w("p",Je,[I(x(r.display||r.name),1),w("span",{class:"font-normal text-s px-4",title:r.description},x(r.description),9,qe)])]),default:d(()=>[r.type==="switch"?(i(),p(k,{key:0,modelValue:t.value[r.name],"onUpdate:modelValue":y=>t.value[r.name]=y},null,8,["modelValue","onUpdate:modelValue"])):r.type==="number"?(i(),p(b,{key:1,modelValue:t.value[r.name],"onUpdate:modelValue":y=>t.value[r.name]=y,modelModifiers:{number:!0}},null,8,["modelValue","onUpdate:modelValue"])):r.type==="select"?(i(),p(M,{key:2,modelValue:t.value[r.name],"onUpdate:modelValue":y=>t.value[r.name]=y,modelModifiers:{number:!0},class:"w-full"},{default:d(()=>[(i(!0),A(W,null,Q(r.options,(y,K)=>(i(),p(E,{key:K,label:y,value:y},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):(i(),p(z,{key:3,modelValue:t.value[r.name],"onUpdate:modelValue":y=>t.value[r.name]=y,modelModifiers:{number:!0},type:r.type=="textarea"?"textarea":""},null,8,["modelValue","onUpdate:modelValue","type"]))]),_:2},1024))),128))])):$("",!0)]}),_:1})]),_:1},8,["model-value","title"])}}}),Ke={class:"p-24"},Le={class:"flex items-center py-24 space-x-16"},He={class:"flex items-center"},We={class:"flex items-center"},Qe={class:"flex items-center"},Xe={class:"text-blue cursor-pointer"},Ye=["src"],Xt=j({setup(V){const g=_();function v(){var l;(l=g.value)==null||l.show()}const h=new _e,{t:e}=F(),m=Y(),t=be(),f=_(!1),c=_(!1),a=_(!1),k=_(!1),b=_(!1),E=_(),M=_(),z=l=>C(this,null,function*(){yield Ue(l.length),yield m.deleteModules(l.map(u=>u.id))}),J=l=>C(this,null,function*(){!t.hasAccess("module","edit")||(yield Me(e("common.shareModuleConfirm")),yield ue(l))}),q=l=>{E.value=l,a.value=!0},G=l=>{E.value=l,k.value=!0},D=l=>C(this,null,function*(){!t.hasAccess("module","edit")||(yield de(l.id,!l.online),m.load())}),r=l=>{!t.hasAccess("module","edit")||ce(l)},y=ge(()=>{if(!M.value)return;const l=h.get("jwt_token")||localStorage.getItem("TOKEN");return M.value+"?access_token="+l}),K=l=>{const u=h.get("jwt_token")||localStorage.getItem("TOKEN"),S=new URL(l),U=t.site.siteType=="p",L=location.protocol=="https:"&&S.protocol=="http:";U?L?X(l):(M.value=l,b.value=!0):(l=`${S.origin}/_Admin/login?permission=${t.site.siteType}&returnurl=${S.pathname}&&access_token=${u}`,X(l))},H=()=>C(this,null,function*(){yield m.load()});return H(),(l,u)=>{const S=Ie,U=Ne,L=ke("router-link"),N=Te,ae=le,T=ie,ne=P,O=ye("hasPermission");return i(),A("div",Ke,[s(pe,{name:n(e)("common.modules")},null,8,["name"]),w("div",Le,[R((i(),p(U,{round:"","data-cy":"create-module",onClick:u[0]||(u[0]=o=>f.value=!0)},{default:d(()=>[w("div",He,[s(S,{class:"mr-16 iconfont icon-a-addto"}),I(" "+x(n(e)("common.create")),1)])]),_:1})),[[O,{feature:"module",action:"edit"}]]),R((i(),p(U,{round:"","data-cy":"import",onClick:u[1]||(u[1]=o=>c.value=!0)},{default:d(()=>[w("div",We,[s(S,{class:"mr-16 iconfont icon-a-Pullin"}),I(" "+x(n(e)("common.import")),1)])]),_:1})),[[O,{feature:"module",action:"edit"}]]),R((i(),p(U,{round:"","data-cy":"search",onClick:v},{default:d(()=>[w("div",Qe,[s(S,{class:"mr-16 iconfont icon-search"}),I(" "+x(n(e)("common.search")),1)])]),_:1})),[[O,{feature:"module",action:"edit"}]])]),n(m).list?(i(),p(n(se),{key:0,data:n(m).list,"show-check":"",sort:"creationDate",permission:{feature:"module",action:"delete"},onDelete:z},{default:d(()=>[s(N,{label:n(e)("common.name")},{default:d(({row:o})=>[s(L,{to:n(we)({name:"dev-mode",query:{activity:"modules",moduleId:o.id}}),"data-cy":"name"},{default:d(()=>[w("span",Xe,x(o.name),1)]),_:2},1032,["to"])]),_:1},8,["label"]),s(N,{label:n(e)("common.online"),width:"150"},{default:d(({row:o})=>[R(s(ae,{"model-value":o.online,"data-cy":"online",onClick:B=>D(o)},null,8,["model-value","onClick"]),[[O,{feature:"module",action:"edit"}]])]),_:1},8,["label"]),s(N,{width:"100",label:n(e)("common.backend")},{default:d(({row:o})=>[o.backendViewUrl?(i(),p(U,{key:0,size:"small",type:"primary",round:"","data-cy":"",class:"leading-6",onClick:B=>K(o.backendViewUrl)},{default:d(()=>[I(x(n(e)("common.manage")),1)]),_:2},1032,["onClick"])):$("",!0)]),_:1},8,["label"]),s(N,{align:"right",width:"180px",prop:"creationDate"},{default:d(({row:o})=>[s(T,{icon:"icon-a-setup",tip:n(e)("common.settings"),"data-cy":"setting",onClick:B=>G(o.id)},null,8,["tip","onClick"]),s(T,{icon:"icon-page",tip:n(e)("common.description"),"data-cy":"description",onClick:B=>q(o.id)},null,8,["tip","onClick"]),s(T,{permission:{feature:"module",action:"edit"},icon:"icon-share",tip:n(e)("common.export"),"data-cy":"export",onClick:B=>r(o.name)},null,8,["tip","onClick"]),s(T,{permission:{feature:"module",action:"edit"},icon:"icon-link !bg-transparent",tip:n(e)("common.share"),"data-cy":"share",onClick:B=>J(o.id)},null,8,["tip","onClick"])]),_:1})]),_:1},8,["data"])):$("",!0),f.value?(i(),p(Oe,{key:1,modelValue:f.value,"onUpdate:modelValue":u[2]||(u[2]=o=>f.value=o)},null,8,["modelValue"])):$("",!0),c.value?(i(),p(re,{key:2,modelValue:c.value,"onUpdate:modelValue":u[3]||(u[3]=o=>c.value=o)},null,8,["modelValue"])):$("",!0),a.value?(i(),p(Ae,{key:3,id:E.value,modelValue:a.value,"onUpdate:modelValue":u[4]||(u[4]=o=>a.value=o)},null,8,["id","modelValue"])):$("",!0),k.value?(i(),p(Ge,{key:4,id:E.value,modelValue:k.value,"onUpdate:modelValue":u[5]||(u[5]=o=>k.value=o)},null,8,["id","modelValue"])):$("",!0),s(ne,{modelValue:b.value,"onUpdate:modelValue":u[6]||(u[6]=o=>b.value=o),width:"1000px","close-on-click-modal":!1,"custom-class":"el-dialog--zero-padding",title:n(e)("common.manage"),onClosed:u[7]||(u[7]=o=>b.value=!1)},{default:d(()=>[w("iframe",{src:n(y),class:"w-full h-500px"},null,8,Ye)]),_:1},8,["modelValue","title"]),s(Be,{ref_key:"searchDialog",ref:g,module:"module",onReload:H},null,512)])}}});export{Xt as default};
