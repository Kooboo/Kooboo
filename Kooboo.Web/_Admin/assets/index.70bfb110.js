var U=(e,i,p)=>new Promise((s,m)=>{var u=d=>{try{_(p.next(d))}catch(c){m(c)}},f=d=>{try{_(p.throw(d))}catch(c){m(c)}},_=d=>d.done?s(d.value):Promise.resolve(d.value).then(u,f);_((p=p.apply(e,i)).next())});import{_ as te}from"./k-table.b1a54b80.js";import{d as I,g as C,i as ne,o as n,j as b,w as a,a as h,b as l,f as V,u as o,aG as P,F as O,b7 as T,k as x,aI as L,t as w,m as ae,N as me,h as ie,b8 as de,e as se}from"./url.4cb47a7a.js";import{B as ue}from"./breadcrumb.f4d80c95.js";import{g as B,o as ce,w as K}from"./i18n.a87944a4.js";import{u as H,c as re,e as pe,d as fe}from"./commerce.ded2851e.js";import{b as ve}from"./confirm.b60b5d2f.js";import{_ as Q}from"./index.f0d5f031.js";import{_ as W}from"./icon-button.74ccc970.js";import{i as ye}from"./main.9fdfea92.js";import{a as be}from"./product-variant.afdebca6.js";import{E as G,a as q,c as ge}from"./index.7c862087.js";import{E as R}from"./index.178b9e08.js";import{E as J,a as z}from"./index.9fd79879.js";import{E as _e}from"./index.f43a3c1f.js";import{E as X}from"./index.361e2245.js";import{E as Ve}from"./index.7df1cda1.js";import{_ as he}from"./tooltip.66155ff7.js";import{E as xe}from"./index.6918f0a5.js";import{E as ke}from"./index.42922617.js";import{E as Ee}from"./index.6f16842c.js";import{E as Y}from"./index.c003dfa1.js";import{_ as we}from"./boolean-tag.ce58483a.js";import{E as Ce}from"./windi.6360286d.js";import{E as De}from"./index.b38edc72.js";import{E as $e}from"./index.d96452a6.js";import"./sortable.esm.a99254e8.js";import"./index.c6da2706.js";import"./index.4d568055.js";import"./isEqual.4cab74e3.js";import"./_baseIsEqual.dc9e64c4.js";import"./error.7e8331f1.js";import"./index.f15f695e.js";import"./event.776e7e11.js";import"./index.7b8c5aef.js";import"./replace-all.56d2c1f7.js";/* empty css                                                               */import"./plugin-vue_export-helper.21dcd24c.js";import"./plugin-vue_export-helper.41ffa612.js";import"./index.fd96ea36.js";import"./logo-transparent.1566007e.js";import"./index.f2c1b903.js";import"./index.c10802d9.js";import"./scroll.16983984.js";import"./aria.75ec5909.js";import"./event.53b2ad83.js";import"./focus-trap.50a00b7f.js";import"./isNil.98bb3b88.js";import"./validator.b5df2420.js";import"./index.4f90a917.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";import"./guid.c1a40312.js";import"./debounce.4e0c106e.js";import"./toNumber.47eea968.js";import"./index.66319a92.js";import"./_baseClone.b8903935.js";import"./position.7590de53.js";import"./index.e3f90979.js";import"./refs.3132cbdb.js";const Se={key:0},Oe={class:"space-y-12"},Te={class:"flex gap-4 w-full"},Ne={class:"space-y-4 w-full"},Ie={class:"flex items-center justify-between mt-12"},Be={class:"truncate flex-1 text-l font-bold"},Ue={key:0,class:"flex gap-8 flex-wrap"},Fe=I({props:{model:null,forceSelection:{type:Boolean},editing:{type:Boolean},nameLabel:null,valueLabel:null,namePlaceholder:null},emits:["changeName","changeOption","addOption","deleteOption","delete"],setup(e,{emit:i}){const p=e,s=C(p.editing),{t:m}=B(),u=C(),f=C(""),_=[{name:"Selection",display:m("common.selection")},{name:"Custom",display:m("common.custom")}];function d(t,r){const E=p.model.options[t];p.model.options.includes(r)?(ye(m("common.valueExist")),u.value.options[t]=E):r?i("changeOption",E,r):u.value.options[t]=E}function c(t){i("changeName",t),u.value=JSON.parse(JSON.stringify(p.model))}function g(t){f.value="",t=t==null?void 0:t.trim(),!(!t||p.model.options.includes(t))&&i("addOption",t)}return ne(()=>p.model,()=>{u.value=JSON.parse(JSON.stringify(p.model))},{deep:!0,immediate:!0}),(t,r)=>{const E=G,k=q,$=R,j=G,M=q,F=J,y=_e,D=W,ee=z,oe=X,le=Ve;return n(),b(le,{shadow:"never"},{default:a(()=>[s.value?(n(),h("div",Se,[l(ee,{"label-position":"top"},{default:a(()=>[V("div",Oe,[l(F,{label:e.nameLabel||o(m)("commerce.optionName")},{default:a(()=>[V("div",Te,[l($,{modelValue:e.model.name,"onUpdate:modelValue":r[1]||(r[1]=v=>e.model.name=v),placeholder:e.namePlaceholder||o(m)("commerce.variantSamples"),onChange:c},P({_:2},[e.forceSelection?{name:"append",fn:a(()=>[l(k,{modelValue:e.model.valueType,"onUpdate:modelValue":r[0]||(r[0]=v=>e.model.valueType=v),placeholder:o(m)("common.type"),class:"w-120px !m-0"},{default:a(()=>[(n(!0),h(O,null,T(o(be),v=>(n(),b(E,{key:v.key,label:v.value,value:v.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])])}:void 0]),1032,["modelValue","placeholder"]),e.forceSelection?x("",!0):(n(),b(M,{key:0,modelValue:e.model.type,"onUpdate:modelValue":r[2]||(r[2]=v=>e.model.type=v),class:"w-220px"},{default:a(()=>[(n(),h(O,null,T(_,v=>l(j,{key:v.name,label:v.display,value:v.name},null,8,["label","value"])),64))]),_:1},8,["modelValue"]))])]),_:1},8,["label"]),e.model.type=="Selection"?(n(),b(F,{key:0,label:e.valueLabel||o(m)("commerce.optionValues")},{default:a(()=>[V("div",Ne,[(n(!0),h(O,null,T(u.value.options,(v,S)=>(n(),b($,{key:S,"model-value":v,readonly:e.model.valueType=="color","onUpdate:modelValue":N=>u.value.options[S]=N,onChange:N=>d(S,N)},P({suffix:a(()=>[l(D,{class:"hover:text-orange",tip:o(m)("common.delete"),icon:"icon-delete",onClick:N=>i("deleteOption",S)},null,8,["tip","onClick"])]),_:2},[e.model.valueType=="color"?{name:"prepend",fn:a(()=>[l(y,{"model-value":v,"onUpdate:modelValue":N=>d(S,N)},null,8,["model-value","onUpdate:modelValue"])])}:void 0]),1032,["model-value","readonly","onUpdate:modelValue","onChange"]))),128)),l($,{modelValue:f.value,"onUpdate:modelValue":r[3]||(r[3]=v=>f.value=v),readonly:e.model.valueType=="color",placeholder:e.model.options.length?o(m)("common.addAnotherValue"):o(m)("common.addValue"),onChange:g,onKeydown:r[4]||(r[4]=ce(K(v=>g(f.value),["prevent"]),["tab"]))},P({_:2},[e.model.valueType=="color"?{name:"prepend",fn:a(()=>[l(y,{"onUpdate:modelValue":g})])}:void 0]),1032,["modelValue","readonly","placeholder"]),f.value?(n(),b($,{key:0,readonly:e.model.valueType=="color",placeholder:o(m)("common.addAnotherValue")},P({_:2},[e.model.valueType=="color"?{name:"prepend",fn:a(()=>[l(y,{"onUpdate:modelValue":g})])}:void 0]),1032,["readonly","placeholder"])):x("",!0)])]),_:1},8,["label"])):x("",!0)])]),_:1}),V("div",Ie,[l(D,{circle:"",class:"hover:text-orange text-orange",icon:"icon-delete ",tip:o(m)("common.delete"),onClick:r[5]||(r[5]=v=>i("delete"))},null,8,["tip"]),l(oe,{round:"",type:"primary",onClick:r[6]||(r[6]=v=>s.value=!1)},{default:a(()=>[L(w(o(m)("common.done")),1)]),_:1})])])):(n(),h("div",{key:1,class:"space-y-8 cursor-pointer",onClick:r[7]||(r[7]=v=>s.value=!0)},[V("div",Be,w(e.model.name),1),e.model.type=="Selection"?(n(),h("div",Ue,[(n(!0),h(O,null,T(e.model.options,(v,S)=>(n(),h("div",{key:S,class:"bg-999/30 px-8 rounded-normal flex items-center gap-4"},[V("span",null,w(v),1),e.model.valueType=="color"?(n(),h("div",{key:0,style:ae({backgroundColor:v}),class:"w-12 h-12 rounded-full shadow-s-4"},null,4)):x("",!0)]))),128))])):x("",!0)]))]),_:1})}}}),Pe={class:"space-y-8 w-full"},A=I({props:{model:null,forceSelection:{type:Boolean},nameLabel:null,valueLabel:null,namePlaceholder:null},setup(e){const i=e,{t:p}=B();function s(){i.model.push({name:"",type:i.forceSelection?"Selection":"Custom",valueType:"text",options:[]})}function m(f,_){i.model.find(d=>d.name==_)||(f.name=_)}function u(f,_,d){const c=f.options.indexOf(_);c>-1&&f.options.splice(c,1,d)}return(f,_)=>{const d=W;return n(),h("div",Pe,[(n(!0),h(O,null,T(i.model,(c,g)=>(n(),b(Fe,{key:g,model:c,"force-selection":e.forceSelection,editing:!c.name,"name-label":e.nameLabel,"value-label":e.valueLabel,"name-placeholder":e.namePlaceholder,onChangeName:t=>m(c,t),onChangeOption:(t,r)=>u(c,t,r),onAddOption:t=>c.options.push(t),onDeleteOption:t=>c.options.splice(t,1),onDelete:t=>i.model.splice(i.model.indexOf(c),1)},null,8,["model","force-selection","editing","name-label","value-label","name-placeholder","onChangeName","onChangeOption","onAddOption","onDeleteOption","onDelete"]))),128)),l(d,{circle:"",class:"text-blue",icon:"icon-a-addto",tip:o(p)("common.add"),onClick:s},null,8,["tip"])])}}}),Le={class:"h-24"},Ae={key:0,class:"flex items-center gap-4"},Je={class:"h-24"},je={key:1,class:"flex items-center gap-4"},Z=I({props:{model:null},setup(e){const{t:i}=B();return(p,s)=>{const m=he,u=xe,f=ke,_=Ee,d=J;return n(),b(d,null,{label:a(()=>[V("span",null,w(o(i)("common.isDigitalProduct")),1),l(m,{tip:o(i)("common.digitalProductTip"),"custom-class":"ml-4"},null,8,["tip"])]),default:a(()=>[V("div",null,[V("div",null,[l(u,{modelValue:e.model.isDigital,"onUpdate:modelValue":s[0]||(s[0]=c=>e.model.isDigital=c)},null,8,["modelValue"])]),V("div",null,[V("div",Le,[e.model.isDigital?(n(),b(f,{key:0,label:o(i)("common.limitDownloadCount"),"model-value":!!e.model.maxDownloadCount,onClick:s[1]||(s[1]=K(c=>e.model.maxDownloadCount=e.model.maxDownloadCount?void 0:3,["stop","prevent"]))},null,8,["label","model-value"])):x("",!0)]),e.model.maxDownloadCount?(n(),h("div",Ae,[l(_,{modelValue:e.model.maxDownloadCount,"onUpdate:modelValue":s[2]||(s[2]=c=>e.model.maxDownloadCount=c),min:1},null,8,["modelValue"]),V("span",null,w(o(i)("common.times")),1)])):x("",!0),V("div",Je,[e.model.isDigital?(n(),b(f,{key:0,label:o(i)("common.limitDownloadTime"),"model-value":!!e.model.maxDownloadDay,onClick:s[3]||(s[3]=K(c=>e.model.maxDownloadDay=e.model.maxDownloadDay?void 0:3,["stop","prevent"]))},null,8,["label","model-value"])):x("",!0)]),e.model.maxDownloadDay?(n(),h("div",je,[l(_,{modelValue:e.model.maxDownloadDay,"onUpdate:modelValue":s[4]||(s[4]=c=>e.model.maxDownloadDay=c),min:1},null,8,["modelValue"]),V("span",null,w(o(i)("common.days")),1)])):x("",!0)])])]),_:1})}}}),Me=I({props:{modelValue:{type:Boolean}},emits:["update:modelValue","reload"],setup(e,{emit:i}){const{t:p}=B(),s=C(!0),m=H(),u=C({name:"",attributes:[],options:[],isDigital:!1,maxDownloadCount:void 0});function f(){return U(this,null,function*(){yield re(u.value),i("reload"),s.value=!1})}return(_,d)=>{const c=R,g=J,t=z,r=Q,E=Y;return n(),b(E,{"model-value":s.value,width:"600px",title:o(p)("common.create"),"close-on-click-modal":!1,onClosed:d[2]||(d[2]=k=>i("update:modelValue",!1))},{footer:a(()=>[l(r,{onConfirm:f,onCancel:d[1]||(d[1]=k=>s.value=!1)})]),default:a(()=>[l(t,{"label-position":"top"},{default:a(()=>[l(g,{label:o(p)("common.name")},{default:a(()=>[l(c,{modelValue:u.value.name,"onUpdate:modelValue":d[0]||(d[0]=k=>u.value.name=k)},null,8,["modelValue"])]),_:1},8,["label"]),o(m).settings.hideAttributes?x("",!0):(n(),b(g,{key:0,label:o(p)("common.attributes")},{default:a(()=>[l(A,{model:u.value.attributes,"name-label":o(p)("common.name"),"value-label":o(p)("common.value"),"name-placeholder":o(p)("common.attributeSamples")},null,8,["model","name-label","value-label","name-placeholder"])]),_:1},8,["label"])),o(m).settings.hideVariants?x("",!0):(n(),b(g,{key:1,label:o(p)("commerce.variantOptions")},{default:a(()=>[l(A,{model:u.value.options,"force-selection":""},null,8,["model"])]),_:1},8,["label"])),l(Z,{model:u.value},null,8,["model"])]),_:1})]),_:1},8,["model-value","title"])}}}),Ke=I({props:{modelValue:{type:Boolean},model:null},emits:["update:modelValue","reload"],setup(e,{emit:i}){const p=e,{t:s}=B(),m=C(!0),u=C(JSON.parse(JSON.stringify(p.model)));function f(){return U(this,null,function*(){yield pe(u.value),i("reload"),m.value=!1})}return(_,d)=>{const c=R,g=J,t=z,r=Q,E=Y;return n(),b(E,{"model-value":m.value,width:"600px",title:o(s)("common.edit"),"close-on-click-modal":!1,onClosed:d[2]||(d[2]=k=>i("update:modelValue",!1))},{footer:a(()=>[l(r,{onConfirm:f,onCancel:d[1]||(d[1]=k=>m.value=!1)})]),default:a(()=>[l(t,{"label-position":"top"},{default:a(()=>[l(g,{label:o(s)("common.name")},{default:a(()=>[l(c,{modelValue:u.value.name,"onUpdate:modelValue":d[0]||(d[0]=k=>u.value.name=k)},null,8,["modelValue"])]),_:1},8,["label"]),l(g,{label:o(s)("common.attributes")},{default:a(()=>[l(A,{model:u.value.attributes,"name-label":o(s)("common.name"),"value-label":o(s)("common.value"),"name-placeholder":o(s)("common.attributeSamples")},null,8,["model","name-label","value-label","name-placeholder"])]),_:1},8,["label"]),l(g,{label:o(s)("commerce.variantOptions")},{default:a(()=>[l(A,{model:u.value.options,"force-selection":""},null,8,["model"])]),_:1},8,["label"]),l(Z,{model:u.value},null,8,["model"])]),_:1})]),_:1},8,["model-value","title"])}}}),Re={class:"p-24"},ze={class:"flex items-center py-24"},Ge={class:"flex items-center"},qe={class:"flex items-center"},He={class:"text-black dark:text-[#cfd3dc]"},Qe={key:0,class:"flex items-center space-x-4 justify-center"},We={key:0,class:"flex items-center space-x-4 justify-center"},Xe={class:"flex items-center"},al=I({setup(e){const{t:i}=B(),s=me().meta.title,m=H(),u=C(!1),f=C(!1),_=C();function d(g){return U(this,null,function*(){yield ve(g.length),yield fe(g.map(t=>t.id)),m.loadTypes()})}ie(()=>U(this,null,function*(){m.loadTypes()}));function c(g){_.value=g,f.value=!0}return(g,t)=>{const r=Ce,E=X,k=De,$=ge,j=$e,M=te,F=de("hasPermission");return n(),h("div",Re,[l(ue,{name:o(s)},null,8,["name"]),V("div",ze,[se((n(),b(E,{round:"",onClick:t[0]||(t[0]=y=>u.value=!0)},{default:a(()=>[V("div",Ge,[l(r,{class:"mr-16 iconfont icon-a-addto"}),L(" "+w(o(i)("common.create")),1)])]),_:1})),[[F,{feature:"productTypes",action:"edit"}]])]),l(M,{data:o(m).types,"show-check":"",onDelete:d},{default:a(()=>[l(k,{label:o(i)("common.name")},{default:a(({row:y})=>[V("div",qe,[V("span",He,w(y.name),1)])]),_:1},8,["label"]),o(m).settings.hideAttributes?x("",!0):(n(),b(k,{key:0,label:o(i)("common.attributes"),align:"center"},{default:a(({row:y})=>[y.attributes.length?(n(),h("div",Qe,[(n(!0),h(O,null,T(y.attributes,D=>(n(),b($,{key:D.name,round:"",type:"warning"},{default:a(()=>[L(w(D.name),1)]),_:2},1024))),128))])):x("",!0)]),_:1},8,["label"])),o(m).settings.hideVariants?x("",!0):(n(),b(k,{key:1,label:o(i)("commerce.variantOptions"),align:"center"},{default:a(({row:y})=>[y.options.length?(n(),h("div",We,[(n(!0),h(O,null,T(y.options,D=>(n(),b($,{key:D.name,round:"",type:"success"},{default:a(()=>[L(w(D.name),1)]),_:2},1024))),128))])):x("",!0)]),_:1},8,["label"])),l(k,{label:o(i)("common.isDigitalProduct")},{default:a(({row:y})=>[V("div",Xe,[l(we,{value:y.isDigital},null,8,["value"])])]),_:1},8,["label"]),l(k,{align:"right",width:"60"},{default:a(({row:y})=>[l(j,{placement:"top",content:o(i)("common.edit")},{default:a(()=>[l(r,{class:"iconfont icon-a-writein hover:text-blue text-l",onClick:D=>c(y)},null,8,["onClick"])]),_:2},1032,["content"])]),_:1})]),_:1},8,["data"]),u.value?(n(),b(Me,{key:0,modelValue:u.value,"onUpdate:modelValue":t[1]||(t[1]=y=>u.value=y),onReload:t[2]||(t[2]=y=>o(m).loadTypes())},null,8,["modelValue"])):x("",!0),f.value?(n(),b(Ke,{key:1,modelValue:f.value,"onUpdate:modelValue":t[3]||(t[3]=y=>f.value=y),model:_.value,onReload:t[4]||(t[4]=y=>o(m).loadTypes())},null,8,["modelValue","model"])):x("",!0)])}}});export{al as default};
