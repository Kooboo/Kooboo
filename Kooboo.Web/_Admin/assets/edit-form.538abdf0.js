var B=Object.defineProperty;var h=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var w=(r,s,o)=>s in r?B(r,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[s]=o,E=(r,s)=>{for(var o in s||(s={}))S.call(s,o)&&w(r,o,s[o]);if(h)for(var o of h(s))$.call(s,o)&&w(r,o,s[o]);return r};var y=(r,s,o)=>new Promise((p,u)=>{var c=l=>{try{e(o.next(l))}catch(t){u(t)}},f=l=>{try{e(o.throw(l))}catch(t){u(t)}},e=l=>l.done?p(l.value):Promise.resolve(l.value).then(c,f);e((o=o.apply(r,s)).next())});import{g as q}from"./i18n.a87944a4.js";import{b as P,e as M}from"./product.9d71c7fc.js";import{u as R}from"./commerce.ded2851e.js";import{_ as j,a as z,V as G}from"./option-group-editor.28278c7c.js";import{_ as H}from"./key-value-editor.7ab17885.js";import{u as J}from"./product-variant.afdebca6.js";import{_ as K}from"./index.711cccea.js";import{i as L,z as Q}from"./main.9fdfea92.js";import{u as T}from"./useFields.23cc2d07.js";import{E as W,a as X}from"./index.9fd79879.js";import{d as Y,g as b,h as Z,o as I,a as tt,b as v,w as O,u as a,j as x,k,f as et}from"./url.4cb47a7a.js";const at={key:0,class:"px-24 pt-0 pb-84px space-y-12"},ot={class:"bg-fff dark:bg-[#252526] px-24 py-16 rounded-normal"},gt=Y({props:{id:null},setup(r,{expose:s}){const o=r,p=b([]),{t:u}=q(),c=R(),f=b();c.loadCategories();let e=J();const l=b(),t=b(),{fields:F,customFields:N}=T();Z(()=>y(this,null,function*(){t.value=yield P(o.id),t.value.tags||(t.value.tags=[]),p.value=t.value.attributes.map(n=>({key:n.key,value:n.value,options:[]}));const m=t.value.variants.sort((n,d)=>n.order>d.order?1:-1);for(const n of m)e.addVariant(n)}));function C(){return y(this,null,function*(){var n,d,g;try{if(yield f.value.form.validate(),yield(d=(n=l.value)==null?void 0:n.form)==null?void 0:d.validate(),c.settings.productDigitalItemRequired&&t.value.isDigital&&e.list.value.some(i=>i.digitalItems.length==0))throw L(u("common.digitalItemsRequired")),Error("Digital items required")}catch(i){throw Q(),i}const m=E({},t.value);m.attributes=p.value.map(i=>({key:i.key,value:i.value})),e.list.value.forEach((i,_)=>i.order=_),m.variants=e.list.value,m.variantOptions=(g=m.variantOptions)==null?void 0:g.filter(i=>i.items.length),yield M(m)})}return s({onSave:C}),(m,n)=>{const d=W,g=X;return t.value?(I(),tt("div",at,[v(j,{ref_key:"basicInfo",ref:f,model:t.value,fields:a(F)},{default:O(()=>[a(c).settings.hideAttributes?k("",!0):(I(),x(d,{key:0,label:a(u)("common.attributes")},{default:O(()=>[v(H,{modelValue:p.value,"onUpdate:modelValue":n[0]||(n[0]=i=>p.value=i),"key-input-attributes":{placeholder:a(u)("common.attributeSamples")},"value-input-attributes":{placeholder:a(u)("common.value")},class:"max-w-600px space-y-8 w-full"},null,8,["modelValue","key-input-attributes","value-input-attributes"])]),_:1},8,["label"]))]),_:1},8,["model","fields"]),v(K,{ref_key:"customData",ref:l,data:t.value.customData,"custom-fields":a(N)},null,8,["data","custom-fields"]),et("div",ot,[v(g,{"label-position":"top"},{default:O(()=>{var i,_;return[a(c).settings.hideVariants?k("",!0):(I(),x(d,{key:0,label:a(u)("commerce.variantOptions")},{default:O(()=>[v(z,{options:a(e).options.value,variants:a(e).list.value,"variant-options":t.value.variantOptions,class:"max-w-600px",onUpdateOptionItem:a(e).updateOptionItem,onUpdateOptionName:a(e).updateOptionName,onAddOptionItem:n[1]||(n[1]=(U,A)=>{var D,V;return a(e).addOptionItem(U,A,(V=(D=t.value)==null?void 0:D.featuredImage)!=null?V:"")}),onDeleteOptionItem:a(e).deleteOptionItem,onDeleteOption:a(e).deleteOption,onAddOption:a(e).addOption},null,8,["options","variants","variant-options","onUpdateOptionItem","onUpdateOptionName","onDeleteOptionItem","onDeleteOption","onAddOption"])]),_:1},8,["label"])),v(G,{"variant-options":t.value.variantOptions,variants:a(e).list.value,options:a(e).options.value,"default-image":(_=(i=t.value)==null?void 0:i.featuredImage)!=null?_:"","is-digital":t.value.isDigital},null,8,["variant-options","variants","options","default-image","is-digital"])]}),_:1})])])):k("",!0)}}});export{gt as _};
