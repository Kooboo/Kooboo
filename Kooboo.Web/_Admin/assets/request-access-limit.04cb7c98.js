var v=(t,a,n)=>new Promise((r,u)=>{var e=c=>{try{m(n.next(c))}catch(o){u(o)}},f=c=>{try{m(n.throw(c))}catch(o){u(o)}},m=c=>c.done?r(c.value):Promise.resolve(c.value).then(e,f);m((n=n.apply(t,a)).next())});import{d as F,g as $}from"./i18n.a87944a4.js";import{_ as K}from"./tooltip.66155ff7.js";import{u as P,h as z,m as J,E as T}from"./main.9fdfea92.js";import{r as j}from"./monaco.c080bc0a.js";import{g as k,d as w,u as l,o as g,a as V,b as i,w as p,f as b,t as x,j as C,k as _,r as D,F as R,aI as G,b7 as H}from"./url.4cb47a7a.js";import{E as I}from"./index.6918f0a5.js";import{E as h}from"./index.9fd79879.js";import{_ as A}from"./list-editor.97a4c003.js";import{_ as N}from"./icon-button.74ccc970.js";import{E as W}from"./index.178b9e08.js";import{E as M}from"./index.6f16842c.js";import{E as X}from"./index.361e2245.js";import{E as Q}from"./index.7df1cda1.js";import{b as E,t as U}from"./replace-all.56d2c1f7.js";const s=k(),y=P(),Y=F.global.t,d={},Ee=["application/zip","application/x-zip","application/octet-stream","application/x-zip-compressed"],O=()=>v(void 0,null,function*(){s.value=JSON.parse(JSON.stringify(y.site))}),Ue=t=>v(void 0,null,function*(){if(t.name.indexOf(".")>-1&&t.name.split(".").reverse()[0]==="zip"){const a=new FormData;a.append("file",t.raw),yield J(a),yield y.loadSite(),O()}else T.error(Y("common.fileFormatIsIncorrect"))}),Be=()=>v(void 0,null,function*(){var a,n,r,u,e,f,m;(a=s.value)!=null&&a.specialPath&&(s.value.specialPath=Array.from(new Set(s.value.specialPath.filter(c=>c.trim()!==""))));const t=JSON.parse(JSON.stringify(s.value));(n=d.onPwaSave)==null||n.call(d,t),(r=d.onMultilingualSave)==null||r.call(d,t),(u=d.onVisitorCountryRestrictionsSave)==null||u.call(d,t),(e=d.onLighthouseSave)==null||e.call(d,t),(f=d.onCustomSettingsSave)==null||f.call(d,t),(m=d.onRequestAccessLimit)==null||m.call(d,t),yield z(t),yield y.loadSite(),O(),y.loadSites(),j()}),Z={class:"flex items-center flex-1 max-w-504px"},ee={class:"font-bold dark:text-fff/86"},te=b("div",{class:"flex-1"},null,-1),le={key:0,class:"!-ml-56px !-mr-56px !px-56px bg-[#fafafa] dark:bg-[#333]"},ie={class:"max-w-504px py-16 mb-18px"},B=w({props:{modelValue:{type:Boolean},label:null,tooltipLabel:null},emits:["update:modelValue"],setup(t,{emit:a}){return(n,r)=>{const u=K,e=I,f=h;return l(s)?(g(),V(R,{key:0},[i(f,null,{default:p(()=>[b("div",Z,[b("span",ee,x(t.label),1),t.tooltipLabel?(g(),C(u,{key:0,tip:t.tooltipLabel,"custom-class":"ml-4"},null,8,["tip"])):_("",!0),te,i(e,{"model-value":t.modelValue,"data-cy":t.label.replace(/\s+/g,"-"),"onUpdate:modelValue":r[0]||(r[0]=m=>a("update:modelValue",!!m))},null,8,["model-value","data-cy"])])]),_:1}),t.modelValue?(g(),V("div",le,[b("div",ie,[D(n.$slots,"default")])])):_("",!0)],64)):_("",!0)}}}),oe={key:0,class:"space-y-8"},ae={class:"flex items-center gap-4"},se={class:"flex items-end"},ne={class:"grid grid-cols-2 w-full"},me={class:"dark:text-[#cfd3dc]"},ue=w({props:{item:null,placeholder:null},emits:["remove"],setup(t){const a=t,{t:n}=$(),r=k(!!a.item.editing);return(u,e)=>{const f=W,m=N,c=M,o=h,L=X;return r.value?(g(),V("div",oe,[b("div",ae,[i(f,{modelValue:t.item.key,"onUpdate:modelValue":e[0]||(e[0]=S=>t.item.key=S),placeholder:t.placeholder},null,8,["modelValue","placeholder"]),i(m,{circle:"",class:"hover:text-orange text-orange",icon:"icon-delete ",tip:l(n)("common.delete"),onClick:e[1]||(e[1]=S=>u.$emit("remove"))},null,8,["tip"])]),b("div",se,[b("div",ne,[i(o,{label:l(n)("common.withinSeconds")},{default:p(()=>[i(c,{modelValue:t.item.value.withinSeconds,"onUpdate:modelValue":e[2]||(e[2]=S=>t.item.value.withinSeconds=S),min:1},null,8,["modelValue"])]),_:1},8,["label"]),i(o,{label:l(n)("common.permitLimit")},{default:p(()=>[i(c,{modelValue:t.item.value.permitLimit,"onUpdate:modelValue":e[3]||(e[3]=S=>t.item.value.permitLimit=S),min:1},null,8,["modelValue"])]),_:1},8,["label"])]),i(L,{round:"",type:"primary",onClick:e[4]||(e[4]=S=>r.value=!1)},{default:p(()=>[G(x(l(n)("common.done")),1)]),_:1})])])):(g(),V("div",{key:1,class:"cursor-pointer",onClick:e[5]||(e[5]=S=>r.value=!0)},[b("span",me,x(l(n)("common.rateLimitTip",{ip:t.item.key,seconds:t.item.value.withinSeconds,count:t.item.value.permitLimit})),1)]))}}}),de={class:"space-y-8 w-full"},q=w({props:{modelValue:null,placeholder:null},emits:["update:model-value"],setup(t,{emit:a}){const n=t,{t:r}=$();function u(){a("update:model-value",[...n.modelValue,{key:"",value:{permitLimit:10,withinSeconds:3},editing:!0}])}function e(f){a("update:model-value",n.modelValue.filter(m=>m!=f))}return(f,m)=>{const c=Q,o=N;return g(),V("div",de,[(g(!0),V(R,null,H(t.modelValue,(L,S)=>(g(),C(c,{key:S,class:"relative mb-8 w-500px",shadow:!1},{default:p(()=>[i(ue,{placeholder:t.placeholder,item:L,onRemove:fe=>e(L)},null,8,["placeholder","item","onRemove"])]),_:2},1024))),128)),i(o,{circle:"",class:"text-blue",icon:"icon-a-addto",tip:l(r)("common.add"),onClick:u},null,8,["tip"])])}}}),re={key:0,class:"grid grid-cols-2"},ce={key:1},pe={class:"grid grid-cols-2"},qe=w({setup(t){const{t:a}=$();d.onRequestAccessLimit=u=>{u.rateLimitSettings.ipLimits=E(n.value.filter(e=>e.key.trim())),u.rateLimitSettings.userAgentLimits=E(r.value.filter(e=>e.key.trim())),u.accessLimitSettings.blockUserAgentKeywords=u.accessLimitSettings.blockUserAgentKeywords.filter(e=>e==null?void 0:e.trim()),u.accessLimitSettings.ipBlacklist=u.accessLimitSettings.ipBlacklist.filter(e=>e==null?void 0:e.trim())};const n=k(U(s.value.rateLimitSettings.ipLimits)),r=k(U(s.value.rateLimitSettings.userAgentLimits));return(u,e)=>{const f=I,m=h,c=M;return l(s)?(g(),V(R,{key:0},[i(B,{modelValue:l(s).rateLimitSettings.enable,"onUpdate:modelValue":e[5]||(e[5]=o=>l(s).rateLimitSettings.enable=o),label:l(a)("common.ipRequestRateLimit")},{default:p(()=>[i(m,{label:l(a)("common.limitAllRequest")},{default:p(()=>[i(f,{modelValue:l(s).rateLimitSettings.limitAllRequest,"onUpdate:modelValue":e[0]||(e[0]=o=>l(s).rateLimitSettings.limitAllRequest=o)},null,8,["modelValue"])]),_:1},8,["label"]),l(s).rateLimitSettings.limitAllRequest?(g(),V("div",re,[i(m,{label:l(a)("common.withinSeconds")},{default:p(()=>[i(c,{modelValue:l(s).rateLimitSettings.allRequestRateSettings.withinSeconds,"onUpdate:modelValue":e[1]||(e[1]=o=>l(s).rateLimitSettings.allRequestRateSettings.withinSeconds=o),min:1},null,8,["modelValue"])]),_:1},8,["label"]),i(m,{label:l(a)("common.permitLimit")},{default:p(()=>[i(c,{modelValue:l(s).rateLimitSettings.allRequestRateSettings.permitLimit,"onUpdate:modelValue":e[2]||(e[2]=o=>l(s).rateLimitSettings.allRequestRateSettings.permitLimit=o),min:1},null,8,["modelValue"])]),_:1},8,["label"])])):(g(),V("div",ce,[i(m,{label:l(a)("common.ipRateLimit")},{default:p(()=>[i(q,{modelValue:n.value,"onUpdate:modelValue":e[3]||(e[3]=o=>n.value=o),placeholder:"1.2.3.4"},null,8,["modelValue"])]),_:1},8,["label"]),i(m,{label:l(a)("common.userAgentRateLimit")},{default:p(()=>[i(q,{modelValue:r.value,"onUpdate:modelValue":e[4]||(e[4]=o=>r.value=o),placeholder:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.2 Safari/605.1.15"},null,8,["modelValue"])]),_:1},8,["label"])]))]),_:1},8,["modelValue","label"]),i(B,{modelValue:l(s).accessLimitSettings.enable,"onUpdate:modelValue":e[8]||(e[8]=o=>l(s).accessLimitSettings.enable=o),label:l(a)("common.requestForbidden")},{default:p(()=>[b("div",pe,[i(m,{label:l(a)("common.ipBlacklist"),class:"col-span-2"},{default:p(()=>[i(A,{modelValue:l(s).accessLimitSettings.ipBlacklist,"onUpdate:modelValue":e[6]||(e[6]=o=>l(s).accessLimitSettings.ipBlacklist=o),class:"w-full"},null,8,["modelValue"])]),_:1},8,["label"]),i(m,{label:l(a)("common.userAgentBlacklist"),class:"col-span-2"},{default:p(()=>[i(A,{modelValue:l(s).accessLimitSettings.blockUserAgentKeywords,"onUpdate:modelValue":e[7]||(e[7]=o=>l(s).accessLimitSettings.blockUserAgentKeywords=o),class:"w-full"},null,8,["modelValue"])]),_:1},8,["label"])])]),_:1},8,["modelValue","label"])],64)):_("",!0)}}});export{B as _,s as a,qe as b,d as e,Ee as i,O as l,Ue as o,Be as s};
