var I=(y,a,i)=>new Promise((p,s)=>{var u=n=>{try{e(i.next(n))}catch(b){s(b)}},h=n=>{try{e(i.throw(n))}catch(b){s(b)}},e=n=>n.done?p(n.value):Promise.resolve(n.value).then(u,h);e((i=i.apply(y,a)).next())});import{_ as K}from"./index.5f37a601.js";import{d as $,o as m,a as x,F as R,b6 as q,b as o,w as r,u as d,f as U,t as S,g as k,i as A,j as E,aH as B,k as g,cd as W,c as X,cj as Y,x as Z}from"./url.2e6a77c4.js";import{u as ee}from"./replace-all.8fa5a83d.js";import{g as N,w as oe}from"./i18n.97105311.js";import{w as le,a as P,r as te,l as ae,i as re,q as j}from"./validate.98ddbafd.js";import{E as se,a as ue,c as ne}from"./index.afee24fe.js";import{E as O}from"./index.4587e608.js";import{E as G,a as H}from"./index.317a7f30.js";import{E as me}from"./windi.539ebeab.js";import{E as ie}from"./index.b09a9f00.js";import{f as pe,i as de,c as ce,h as ve}from"./index.77759eed.js";import{_ as _e}from"./alert.583ccfe6.js";import{_ as L}from"./dev-mode.2a667dd5.js";import{e as fe}from"./guid.c1a40312.js";import{u as ye}from"./use-save-tip.aeb07244.js";import{E as be,a as xe}from"./index.6302b2c1.js";import{E as he}from"./index.00cc1b15.js";import{E as Ve}from"./index.d7cf0025.js";import{E as ge}from"./index.f997a738.js";import"./index.99641a60.js";import"./main.52487121.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";import"./index.b1fe55d8.js";import"./index.51a59403.js";import"./index.29d7c76d.js";import"./style.f835519e.js";import"./toNumber.574be4f1.js";import"./_baseIsEqual.abb55a3a.js";import"./index.9589f7cf.js";import"./focus-trap.de18cf8f.js";import"./isNil.98bb3b88.js";import"./event.53b2ad83.js";import"./index.9e96921b.js";import"./index.bc93d068.js";import"./error.7e8331f1.js";import"./event.776e7e11.js";import"./scroll.8babc10c.js";import"./isEqual.3700b7f1.js";import"./debounce.61c67278.js";import"./index.a46fa52c.js";import"./validator.1d438d08.js";import"./_baseClone.f10ff33c.js";import"./use-shortcuts.21ce2d8e.js";import"./userWorker.b3a6730b.js";import"./editor.main.d2800f63.js";import"./config.97fa1cfe.js";import"./dark.ea14b486.js";import"./page.d86e40bb.js";import"./index.d267cbe6.js";import"./index.07e210fb.js";import"./aria.75ec5909.js";import"./index.3fcd2f53.js";import"./dropdown.87a7678e.js";import"./refs.4001ce17.js";import"./use-copy-text.81d01785.js";import"./index.f03e2503.js";import"./monaco.6a3362ef.js";import"./classCompletion.a22e38a6.js";import"./extraLib.d94bb2b4.js";import"./confirm.46f27373.js";import"./logo-transparent.1566007e.js";import"./index.9ffc2c80.js";import"./index.4b289bae.js";import"./icon-button.e1f3bfd2.js";import"./index.975a8825.js";import"./vuedraggable.umd.e0027d17.js";import"./index.56d91124.js";import"./index.c1764395.js";import"./index.232e741a.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./index.a163a028.js";import"./index.57372297.js";import"./index.fbe2a003.js";import"./index.b1dc9dfd.js";/* empty css                                                               */import"./media-list.vue_vue_type_style_index_0_scoped_true_lang.3ed42952.js";/* empty css                                                          */import"./file.c7952a49.js";import"./use-date.88693eba.js";import"./dayjs.min.378b3d72.js";/* empty css                                                          *//* empty css                                                                 */import"./use-file-upload.f6d4a33c.js";/* empty css                                                         */import"./image-editor.vue_vue_type_style_index_0_scoped_true_lang.4f5fb1ef.js";import"./image-editor.3291a85e.js";import"./index.cdaadc8a.js";import"./cloneDeep.5cd857a3.js";import"./main.esm.319d8703.js";import"./index.e98ba728.js";const ke={class:"space-y-4"},Ee={class:"px-12 text-blue"},Ue=$({props:{list:null},setup(y){const{t:a}=N(),i={expiresIn:[le(a("common.integerRuleTips"))]};return(p,s)=>{const u=se,h=ue,e=O,n=G,b=H,C=me,T=ie;return m(),x("div",ke,[(m(!0),x(R,null,q(y.list,(c,w)=>(m(),x("div",{key:w,class:"flex items-center space-x-4"},[o(h,{modelValue:c.method,"onUpdate:modelValue":v=>c.method=v,class:"w-138px"},{default:r(()=>[o(u,{value:"Get",label:"GET","data-cy":"method-get"}),o(u,{value:"Put",label:"PUT","data-cy":"method-put"}),o(u,{value:"Post",label:"POST","data-cy":"method-post"}),o(u,{value:"Delete",label:"DELETE","data-cy":"method-delete"}),o(u,{value:"Options",label:"OPTIONS","data-cy":"method-options"}),o(u,{value:"Head",label:"HEAD","data-cy":"method-head"}),o(u,{value:"Patch",label:"PATCH","data-cy":"method-patch"}),o(u,{value:"Trace",label:"TRACE","data-cy":"method-trace"}),o(u,{value:"All",label:"ALL","data-cy":"method-all"})]),_:2},1032,["modelValue","onUpdate:modelValue"]),o(e,{modelValue:c.pattern,"onUpdate:modelValue":v=>c.pattern=v,placeholder:d(a)("common.inputCachePathTips"),class:"w-400px","data-cy":"cache-path"},null,8,["modelValue","onUpdate:modelValue","placeholder"]),o(b,{model:c,rules:d(i),onSubmit:s[0]||(s[0]=oe(()=>{},["prevent"]))},{default:r(()=>[o(n,{prop:"expiresIn"},{default:r(()=>[o(e,{modelValue:c.expiresIn,"onUpdate:modelValue":v=>c.expiresIn=v,modelModifiers:{number:!0},class:"w-138px"},{append:r(()=>[U("div",Ee,S(d(a)("common.minutes")),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1032,["model","rules"]),U("div",null,[o(T,{circle:"",class:"text-orange","data-cy":"delete",onClick:v=>y.list.splice(w,1)},{default:r(()=>[o(C,{class:"iconfont icon-delete"})]),_:2},1032,["onClick"])])]))),128)),o(T,{circle:"",class:"text-blue","data-cy":"add",onClick:s[1]||(s[1]=c=>y.list.push({method:"Get",expiresIn:1,pattern:""}))},{default:r(()=>[o(C,{class:"iconfont icon-a-addto"})]),_:1})])}}}),Ce={class:"space-x-4 space-y-4"},Te=$({props:{id:null},emits:["change"],setup(y,{emit:a}){const i=k([]),p=k();return A(p,s=>{s&&a("change",s)}),pe().then(s=>i.value=s.data),(s,u)=>{var e;const h=ne;return m(),x("div",null,[U("div",Ce,[(m(!0),x(R,null,q(i.value,n=>(m(),E(h,{key:n._id,type:n._id===y.id?"success":"info",class:"cursor-pointer rounded-full px-24",size:"large",onClick:b=>p.value=n},{default:r(()=>[B(S(n.name),1)]),_:2},1032,["type","onClick"]))),128))]),(e=p.value)!=null&&e.description?(m(),E(_e,{key:0,class:"mt-12 rounded-normal text-444",content:p.value.description},null,8,["content"])):g("",!0)])}}}),we={class:"w-1120px mx-auto pt-32 pb-150px"},Ie=B("OpenApi"),Re={class:"rounded-normal w-full border border-solid border-blue/30 overflow-hidden"},Ae={class:"w-full"},$e={key:0,class:"mt-18px border-line border border-solid dark:border-opacity-50 w-full p-4 overflow-hidden"},bl=$({setup(y){const{t:a}=N(),i=W(),p=k(),s=k(),u=ye(),h=[{key:"url",value:"URL"},{key:"code",value:a("common.code")},{key:"template",value:a("common.template")}],e=k({name:"",type:"url",url:"",jsonData:"",caches:[],templateId:"",authUrl:"",customAuthorization:"",useCustomCode:!1,code:`// sample code.. 
// request.headers.Authorization='bearer xxxx'
// request.querys.token='xxxx'
// request.paths.id='xxxx'
// request.cookies.id='xxxx'
// request.body.token='xxxx'`,useCommaArray:!1,id:fe,baseUrl:""}),n=X(()=>({name:s.value?[]:[P(a("common.fieldRequiredTips")),te(1,50),ae(),re(de,a("common.nameExistsTips"))],baseUrl:[j(a("common.urlInvalidTips"))],url:e.value.type==="url"?[P(a("common.fieldRequiredTips")),j(a("common.urlInvalidTips"))]:[]})),b=k("https://openapi_template.kooboo.net"),C=_=>`${b.value}/detail?id=${_}`,T=_=>{var t;return((t=/id=(.*)/i.exec(_))==null?void 0:t[1].replace(/&.*/g,""))||""},c=()=>I(this,null,function*(){const _=Z("id");_?(s.value=!0,e.value=yield ce(_)):s.value=!1,u.init(e.value)});Y((_,t,V)=>I(this,null,function*(){_.name==="login"?V():yield u.check(e.value).then(()=>{V()}).catch(()=>{V(!1)})}));const w=()=>I(this,null,function*(){!e.value||(yield p.value.validate(),yield ve(e.value),u.init(e.value),v())}),v=()=>{i.goBackOrTo(ee({name:"openapis"}))};return A(()=>e.value.type,()=>{setTimeout(()=>{p.value.clearValidate()})}),A(()=>e.value,()=>{u.changed(e.value)},{deep:!0}),c(),(_,t)=>{const V=O,f=G,F=be,z=xe,D=he,M=H,Q=Ve,J=ge;return m(),x(R,null,[o(J,null,{default:r(()=>[U("div",we,[o(Q,null,{header:r(()=>[Ie]),default:r(()=>[o(M,{ref_key:"form",ref:p,"label-width":"138px",class:"pr-64",model:e.value,rules:d(n)},{default:r(()=>[o(f,{label:d(a)("common.name"),prop:"name"},{default:r(()=>[o(V,{modelValue:e.value.name,"onUpdate:modelValue":t[0]||(t[0]=l=>e.value.name=l),readonly:s.value,disabled:!!s.value,"data-cy":"openapi-name"},null,8,["modelValue","readonly","disabled"])]),_:1},8,["label"]),o(f,{label:"Base URL",prop:"baseUrl"},{default:r(()=>[o(V,{modelValue:e.value.baseUrl,"onUpdate:modelValue":t[1]||(t[1]=l=>e.value.baseUrl=l),placeholder:d(a)("common.optionalHttp"),"data-cy":"base-url"},null,8,["modelValue","placeholder"])]),_:1}),s.value?g("",!0):(m(),E(f,{key:0,label:d(a)("common.type")},{default:r(()=>[o(z,{modelValue:e.value.type,"onUpdate:modelValue":t[2]||(t[2]=l=>e.value.type=l),class:"el-radio-group--rounded"},{default:r(()=>[(m(),x(R,null,q(h,l=>o(F,{key:l.key,label:l.key,"data-cy":`type-${l.key}`},{default:r(()=>[B(S(l.value),1)]),_:2},1032,["label","data-cy"])),64))]),_:1},8,["modelValue"])]),_:1},8,["label"])),e.value.type=="url"?(m(),E(f,{key:1,prop:"url",label:d(a)("common.url")},{default:r(()=>[o(V,{modelValue:e.value.url,"onUpdate:modelValue":t[3]||(t[3]=l=>e.value.url=l),placeholder:"https://generator3.swagger.io/openapi.json","data-cy":"url",onInput:t[4]||(t[4]=l=>e.value.url=e.value.url.replace(/\s+/g,""))},null,8,["modelValue"])]),_:1},8,["label"])):g("",!0),e.value.type==="code"?(m(),E(f,{key:2},{default:r(()=>[U("div",Re,[o(L,{modelValue:e.value.jsonData,"onUpdate:modelValue":t[5]||(t[5]=l=>e.value.jsonData=l),class:"h-64",language:"json"},null,8,["modelValue"])])]),_:1})):g("",!0),e.value.type=="template"?(m(),E(f,{key:3},{default:r(()=>[o(Te,{id:T(e.value.url),onChange:t[6]||(t[6]=l=>{e.value.templateId=l._id,e.value.baseUrl=l.baseUrl,e.value.url=C(l._id),e.value.name||(e.value.name=l.name),e.value.authUrl=l.authUrl})},null,8,["id"])]),_:1})):g("",!0),o(f,{label:d(a)("common.cache")},{default:r(()=>[o(Ue,{list:e.value.caches},null,8,["list"])]),_:1},8,["label"]),o(f,{label:d(a)("common.useCommaArray")},{default:r(()=>[o(D,{modelValue:e.value.useCommaArray,"onUpdate:modelValue":t[7]||(t[7]=l=>e.value.useCommaArray=l),"data-cy":"enable-comma-array"},null,8,["modelValue"])]),_:1},8,["label"]),o(f,{label:d(a)("common.customAuth")},{default:r(()=>[U("div",Ae,[o(D,{modelValue:e.value.useCustomCode,"onUpdate:modelValue":t[8]||(t[8]=l=>e.value.useCustomCode=l),"data-cy":"enable-custom-auth"},null,8,["modelValue"]),e.value.useCustomCode?(m(),x("div",$e,[o(L,{modelValue:e.value.code,"onUpdate:modelValue":t[9]||(t[9]=l=>e.value.code=l),class:"h-64",language:"typescript","k-script":""},null,8,["modelValue"])])):g("",!0)])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1})])]),_:1}),o(K,{back:"",permission:{feature:"openApi",action:"edit"},onCancel:v,onSave:w})],64)}}});export{bl as default};
