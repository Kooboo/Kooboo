var ce=Object.defineProperty,de=Object.defineProperties;var fe=Object.getOwnPropertyDescriptors;var H=Object.getOwnPropertySymbols;var me=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable;var Z=(u,r,s)=>r in u?ce(u,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):u[r]=s,O=(u,r)=>{for(var s in r||(r={}))me.call(r,s)&&Z(u,s,r[s]);if(H)for(var s of H(r))ve.call(r,s)&&Z(u,s,r[s]);return u},M=(u,r)=>de(u,fe(r));import{i as J,w as pe,v as ge,T as be,u as T}from"./i18n.25caaace.js";import{b as we,d as ke,m as _e,a2 as he,a3 as Ie,u as xe,f as Ce,E as k,B as ye,O as ze,P as Ne,a4 as Ee,a5 as Oe,a6 as Te,a7 as Le,_ as De,c as I,a8 as Me,w as Ve}from"./windi.a815125a.js";import{i as $e}from"./browser.06df4d2e.js";import{u as Ae}from"./index.f9c89813.js";import{d as Re,D as j,g as y,C as Se,aq as Be,c as x,i as W,K as Xe,h as Ye,o as z,j as q,b as l,w as b,f as m,n as f,u as a,k as N,a as V,F as G,l as Fe,b6 as Pe,e as He,m as K,r as Ze,az as je}from"./url.8f5ec20c.js";import{t as $}from"./throttle.3f3ee457.js";const We=we({urlList:{type:ke(Array),default:()=>_e([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0}}),qe={close:()=>!0,switch:u=>J(u)},Ge=["src"],Ke={name:"ElImageViewer"},Je=Re(M(O({},Ke),{props:We,emits:qe,setup(u,{emit:r}){const s=u,C={CONTAIN:{name:"contain",icon:j(he)},ORIGINAL:{name:"original",icon:j(Ie)}},Q=$e()?"DOMMouseScroll":"mousewheel",{t:U}=Ae(),o=xe("image-viewer"),{nextZIndex:ee}=Ce(),L=y(),A=y([]),R=Se(),_=y(!0),v=y(s.initialIndex),E=Be(C.CONTAIN),i=y({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),ae=x(()=>{const{urlList:e}=s;return e.length<=1}),S=x(()=>v.value===0),B=x(()=>v.value===s.urlList.length-1),te=x(()=>s.urlList[v.value]),se=x(()=>{const{scale:e,deg:t,offsetX:n,offsetY:c,enableTransition:p}=i.value;let d=n/e,g=c/e;switch(t%360){case 90:case-270:[d,g]=[g,-d];break;case 180:case-180:[d,g]=[-d,-g];break;case 270:case-90:[d,g]=[-g,d];break}const h={transform:`scale(${e}) rotate(${t}deg) translate(${d}px, ${g}px)`,transition:p?"transform .3s":""};return E.value.name===C.CONTAIN.name&&(h.maxWidth=h.maxHeight="100%"),h}),ne=x(()=>J(s.zIndex)?s.zIndex:ee());function D(){le(),r("close")}function oe(){const e=$(n=>{switch(n.code){case I.esc:s.closeOnPressEscape&&D();break;case I.space:Y();break;case I.left:F();break;case I.up:w("zoomIn");break;case I.right:P();break;case I.down:w("zoomOut");break}}),t=$(n=>{(n.wheelDelta?n.wheelDelta:-n.detail)>0?w("zoomIn",{zoomRate:1.2,enableTransition:!1}):w("zoomOut",{zoomRate:1.2,enableTransition:!1})});R.run(()=>{T(document,"keydown",e),T(document,Q,t)})}function le(){R.stop()}function re(){_.value=!1}function ie(e){_.value=!1,e.target.alt=U("el.image.error")}function ue(e){if(_.value||e.button!==0||!L.value)return;i.value.enableTransition=!1;const{offsetX:t,offsetY:n}=i.value,c=e.pageX,p=e.pageY,d=$(h=>{i.value=M(O({},i.value),{offsetX:t+h.pageX-c,offsetY:n+h.pageY-p})}),g=T(document,"mousemove",d);T(document,"mouseup",()=>{g()}),e.preventDefault()}function X(){i.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function Y(){if(_.value)return;const e=Me(C),t=Object.values(C),n=E.value.name,p=(t.findIndex(d=>d.name===n)+1)%e.length;E.value=C[e[p]],X()}function F(){if(S.value&&!s.infinite)return;const e=s.urlList.length;v.value=(v.value-1+e)%e}function P(){if(B.value&&!s.infinite)return;const e=s.urlList.length;v.value=(v.value+1)%e}function w(e,t={}){if(_.value)return;const{zoomRate:n,rotateDeg:c,enableTransition:p}=O({zoomRate:1.4,rotateDeg:90,enableTransition:!0},t);switch(e){case"zoomOut":i.value.scale>.2&&(i.value.scale=Number.parseFloat((i.value.scale/n).toFixed(3)));break;case"zoomIn":i.value.scale<7&&(i.value.scale=Number.parseFloat((i.value.scale*n).toFixed(3)));break;case"clockwise":i.value.deg+=c;break;case"anticlockwise":i.value.deg-=c;break}i.value.enableTransition=p}return W(te,()=>{Xe(()=>{const e=A.value[0];e!=null&&e.complete||(_.value=!0)})}),W(v,e=>{X(),r("switch",e)}),Ye(()=>{var e,t;oe(),(t=(e=L.value)==null?void 0:e.focus)==null||t.call(e)}),(e,t)=>(z(),q(je,{to:"body",disabled:!e.teleported},[l(be,{name:"viewer-fade",appear:""},{default:b(()=>[m("div",{ref_key:"wrapper",ref:L,tabindex:-1,class:f(a(o).e("wrapper")),style:K({zIndex:a(ne)})},[m("div",{class:f(a(o).e("mask")),onClick:t[0]||(t[0]=pe(n=>e.hideOnClickModal&&D(),["self"]))},null,2),N(" CLOSE "),m("span",{class:f([a(o).e("btn"),a(o).e("close")]),onClick:D},[l(a(k),null,{default:b(()=>[l(a(ye))]),_:1})],2),N(" ARROW "),a(ae)?N("v-if",!0):(z(),V(G,{key:0},[m("span",{class:f([a(o).e("btn"),a(o).e("prev"),a(o).is("disabled",!e.infinite&&a(S))]),onClick:F},[l(a(k),null,{default:b(()=>[l(a(ze))]),_:1})],2),m("span",{class:f([a(o).e("btn"),a(o).e("next"),a(o).is("disabled",!e.infinite&&a(B))]),onClick:P},[l(a(k),null,{default:b(()=>[l(a(Ne))]),_:1})],2)],64)),N(" ACTIONS "),m("div",{class:f([a(o).e("btn"),a(o).e("actions")])},[m("div",{class:f(a(o).e("actions__inner"))},[l(a(k),{onClick:t[1]||(t[1]=n=>w("zoomOut"))},{default:b(()=>[l(a(Ee))]),_:1}),l(a(k),{onClick:t[2]||(t[2]=n=>w("zoomIn"))},{default:b(()=>[l(a(Oe))]),_:1}),m("i",{class:f(a(o).e("actions__divider"))},null,2),l(a(k),{onClick:Y},{default:b(()=>[(z(),q(Fe(a(E).icon)))]),_:1}),m("i",{class:f(a(o).e("actions__divider"))},null,2),l(a(k),{onClick:t[3]||(t[3]=n=>w("anticlockwise"))},{default:b(()=>[l(a(Te))]),_:1}),l(a(k),{onClick:t[4]||(t[4]=n=>w("clockwise"))},{default:b(()=>[l(a(Le))]),_:1})],2)],2),N(" CANVAS "),m("div",{class:f(a(o).e("canvas"))},[(z(!0),V(G,null,Pe(e.urlList,(n,c)=>He((z(),V("img",{ref_for:!0,ref:p=>A.value[c]=p,key:n,src:n,style:K(a(se)),class:f(a(o).e("img")),onLoad:re,onError:ie,onMousedown:ue},null,46,Ge)),[[ge,c===v.value]])),128))],2),Ze(e.$slots,"default")],6)]),_:3})],8,["disabled"]))}}));var Qe=De(Je,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const la=Ve(Qe);export{la as E};
