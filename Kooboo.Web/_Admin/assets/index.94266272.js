var C=(E,s,o)=>new Promise((u,r)=>{var l=v=>{try{_(o.next(v))}catch(m){r(m)}},g=v=>{try{_(o.throw(v))}catch(m){r(m)}},_=v=>v.done?u(v.value):Promise.resolve(v.value).then(l,g);_((o=o.apply(E,s)).next())});import{_ as ee}from"./k-table.e9121736.js";import{b as M,X as oe,Y as te,Z as ae,_ as le,w as ne,$ as se,a0 as re,a1 as me}from"./main.52487121.js";import{g as B,o as ie,w as H}from"./i18n.97105311.js";import{a as ue}from"./use-date.88693eba.js";import{s as I}from"./confirm.46f27373.js";import{_ as X}from"./index.9ffc2c80.js";import{a as R,s as de,S as L,C as ce,e as pe,p as fe}from"./validate.98ddbafd.js";import{E as Y}from"./index.4587e608.js";import{E as Z,a as G}from"./index.317a7f30.js";import{E as j}from"./index.4b289bae.js";import{d as T,g as V,o as b,j as O,w as n,b as a,u as e,cd as _e,c as P,b7 as ve,aH as N,t as d,k as U,e as be,f as t,a as S,b6 as ge,n as xe,F as J,N as we,aF as Ve}from"./url.2e6a77c4.js";import{E as Q}from"./windi.539ebeab.js";import{E as ye}from"./index.f997a738.js";import{E as W}from"./index.b09a9f00.js";import{u as he}from"./replace-all.8fa5a83d.js";import{E as Oe}from"./index.f3d28a97.js";import"./sortable.esm.a99254e8.js";import"./icon-button.e1f3bfd2.js";import"./index.9589f7cf.js";import"./focus-trap.de18cf8f.js";import"./isNil.98bb3b88.js";import"./event.53b2ad83.js";import"./index.9e96921b.js";import"./index.975a8825.js";import"./index.bc93d068.js";import"./index.7a88a6b5.js";import"./index.afee24fe.js";import"./error.7e8331f1.js";import"./event.776e7e11.js";import"./scroll.8babc10c.js";import"./isEqual.3700b7f1.js";import"./_baseIsEqual.abb55a3a.js";import"./debounce.61c67278.js";import"./toNumber.574be4f1.js";import"./index.a46fa52c.js";import"./validator.1d438d08.js";import"./index.c1764395.js";import"./index.6302b2c1.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";import"./dayjs.min.378b3d72.js";import"./logo-transparent.1566007e.js";import"./index.d267cbe6.js";import"./index.07e210fb.js";import"./aria.75ec5909.js";import"./index.99641a60.js";import"./index.77759eed.js";import"./index.b1fe55d8.js";import"./index.51a59403.js";import"./index.29d7c76d.js";import"./style.f835519e.js";import"./_baseClone.f10ff33c.js";import"./refs.4001ce17.js";const ke=T({props:{modelValue:{type:Boolean}},emits:["update:modelValue","addSuccess"],setup(E,{emit:s}){const o=M(),{t:u}=B(),r=V(),l=V({userName:"",organizationId:o.currentOrg.id}),g=V(!0),_=V({userName:[R(u("common.fieldRequiredTips")),de()]}),v=()=>C(this,null,function*(){yield r.value.validate(),yield oe(l.value),g.value=!1,l.value.userName="",s("addSuccess")});return(m,p)=>{const k=Y,y=Z,c=G,i=X,f=j;return b(),O(f,{modelValue:g.value,"onUpdate:modelValue":p[3]||(p[3]=h=>g.value=h),width:"400px",title:e(u)("common.addMember"),onClosed:p[4]||(p[4]=h=>s("update:modelValue",!1))},{footer:n(()=>[a(i,{"confirm-label":e(u)("common.add"),onConfirm:v,onCancel:p[2]||(p[2]=h=>g.value=!1)},null,8,["confirm-label"])]),default:n(()=>[a(c,{ref_key:"form",ref:r,modal:l.value,rules:_.value,"label-position":"top",model:l.value,onSubmit:p[1]||(p[1]=H(()=>{},["prevent"]))},{default:n(()=>[a(y,{prop:"userName",label:e(u)("common.username")},{default:n(()=>[a(k,{modelValue:l.value.userName,"onUpdate:modelValue":p[0]||(p[0]=h=>l.value.userName=h),onKeydown:ie(v,["enter"])},null,8,["modelValue","onKeydown"])]),_:1},8,["label"])]),_:1},8,["modal","rules","model"])]),_:1},8,["modelValue","title"])}}}),Ce={class:"px-16 mt-8 space-y-8"},Ue=["onClick"],$e={class:"flex justify-between items-center py-24 pr-4"},Ne={class:"flex items-center justify-between w-[460px]"},Ee={class:"flex items-center"},ze=["title"],Se={key:0,class:"flex-1 text-12px flex items-center bg-blue/10 text-blue px-10px h-20px rounded-full mx-12"},Ae=T({props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(E,{emit:s}){const{t:o}=B(),u=M(),r=_e(),l=V(),g=P(()=>{var f;const i=(f=_.value)==null?void 0:f.find(h=>h.id===l.value);return i?i.isAdmin===!0:!1}),_=V(),v=V(!0),m=()=>C(this,null,function*(){yield I(o("common.switchOrganizationTips")),yield te(l.value),u.logout(),r.push({name:"login"})}),p=()=>C(this,null,function*(){yield I(o("common.departOrganizationTips")),yield ae(l.value),u.logout(),r.push({name:"login"})}),k=P(()=>{var i;return!((i=_.value)!=null&&i.some(f=>f.isAdmin===!0))}),y=()=>C(this,null,function*(){yield le(),c()}),c=()=>C(this,null,function*(){_.value=yield ne(),l.value=u.currentOrg.id});return c(),(i,f)=>{const h=Q,z=ye,$=W,A=j,D=ve("hasPermission");return b(),O(A,{modelValue:v.value,"onUpdate:modelValue":f[1]||(f[1]=x=>v.value=x),width:"650px",title:e(o)("common.organizationAdmin"),"custom-class":"el-dialog--zero-padding",onClosed:f[2]||(f[2]=x=>s("update:modelValue",!1))},{footer:n(()=>[a($,{"data-cy":"cancel-in-dialog",onClick:f[0]||(f[0]=x=>v.value=!1)},{default:n(()=>[N(d(e(o)("common.cancel")),1)]),_:1}),a($,{round:"",disabled:e(g)||!l.value,onClick:p},{default:n(()=>[N(d(e(o)("common.depart")),1)]),_:1},8,["disabled"]),e(k)?(b(),O($,{key:0,round:"",onClick:y},{default:n(()=>[N(d(e(o)("common.createOwnOrg")),1)]),_:1})):U("",!0),be((b(),O($,{round:"",type:"primary",disabled:e(u).currentOrg.id===l.value||!l.value,onClick:m},{default:n(()=>[N(d(e(o)("domain.switch")),1)]),_:1},8,["disabled"])),[[D,{feature:"style",action:"edit"}]])]),default:n(()=>[a(z,{"max-height":"240px",always:""},{default:n(()=>[t("ul",Ce,[(b(!0),S(J,null,ge(_.value,x=>(b(),S("li",{key:x.id,class:xe(["pl-16 pr-8 cursor-pointer border-transparent hover:border-blue border-1 border-solid rounded-normal hover:bg-[#2296F3] hover:bg-opacity-10",x.id===l.value?"  bg-[#2296F3] bg-opacity-10 !border-blue":""]),onClick:F=>l.value=x.id},[t("div",$e,[t("div",Ne,[t("div",Ee,[t("span",{class:"ellipsis max-w-200px leading-5",title:x.name},d(x.name),9,ze),x.id===e(u).currentOrg.id?(b(),S("span",Se,d(e(o)("common.currentOrganization")),1)):U("",!0)]),t("span",null,d(x.members)+" "+d(e(o)("organization.members")),1)]),t("div",null,[x.id===l.value?(b(),O(h,{key:0,class:"iconfont icon-Select2 text-green text-xl"})):U("",!0)])])],10,Ue))),128))])]),_:1})]),_:1},8,["modelValue","title"])}}}),De=T({props:{modelValue:{type:Boolean}},emits:["update:modelValue","create-success"],setup(E,{emit:s}){const{t:o}=B(),u=V(!0),r=V({userName:"",password:"",email:"",phone:""}),l=V(),g={userName:[R(o("common.fieldRequiredTips")),L(o("common.username"),2,30)],password:[ce,R(o("common.inputPasswordTips")),L(o("common.password"),2,30)],email:[pe,R(o("common.inputEmailTips"))],phone:[fe]},_=()=>C(this,null,function*(){yield l.value.validate(),yield se(r.value),u.value=!1,s("create-success")});return(v,m)=>{const p=Y,k=Z,y=G,c=j;return b(),O(c,{"model-value":u.value,width:"670px",title:e(o)("common.create"),onClosed:m[6]||(m[6]=i=>s("update:modelValue",!1))},{footer:n(()=>[a(X,{onConfirm:_,onCancel:m[5]||(m[5]=i=>u.value=!1)})]),default:n(()=>[a(y,{ref_key:"form",ref:l,class:"el-form--label-normal",model:r.value,rules:g,"label-position":"left","label-width":"150px",onSubmit:m[4]||(m[4]=H(()=>{},["prevent"]))},{default:n(()=>[a(k,{prop:"userName",label:e(o)("common.username")},{default:n(()=>[a(p,{modelValue:r.value.userName,"onUpdate:modelValue":m[0]||(m[0]=i=>r.value.userName=i),class:"w-400px"},null,8,["modelValue"])]),_:1},8,["label"]),a(k,{prop:"password",label:e(o)("common.password")},{default:n(()=>[a(p,{modelValue:r.value.password,"onUpdate:modelValue":m[1]||(m[1]=i=>r.value.password=i),class:"w-400px",type:"password"},null,8,["modelValue"])]),_:1},8,["label"]),a(k,{prop:"email",label:e(o)("common.email")},{default:n(()=>[a(p,{modelValue:r.value.email,"onUpdate:modelValue":m[2]||(m[2]=i=>r.value.email=i),class:"w-400px"},null,8,["modelValue"])]),_:1},8,["label"]),a(k,{prop:"phone",label:e(o)("common.phone")},{default:n(()=>[a(p,{modelValue:r.value.phone,"onUpdate:modelValue":m[3]||(m[3]=i=>r.value.phone=i),class:"w-400px"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["model-value","title"])}}}),Re={class:"p-24 space-y-16"},Be={class:"flex gap-8 items-center dark:text-gray"},Te={class:"flex space-x-24"},Fe={class:"text-blue ml-8"},Ie={class:"text-blue ml-8"},Me={class:"text-blue ml-8"},je=t("div",{class:"flex-1"},null,-1),qe={class:"flex items-center"},Ke={class:"flex items-center"},Le={class:"h-60px flex items-center justify-between px-16"},Pe={class:"flex items-center"},He={class:"flex items-center"},Xe={class:"flex items-center"},Ye={key:0,class:"text-12px flex items-center bg-blue/10 text-blue px-10px h-20px rounded-full ml-16"},Go=T({setup(E){const{t:s}=B(),o=M(),u=V([]),r=V(!1),l=V(!1),g=V(!1),_=()=>C(this,null,function*(){var y;u.value=yield re((y=o.currentOrg)==null?void 0:y.id),u.value.forEach(c=>{c.$DisabledSelect=c.isAdmin})}),v=()=>{r.value=!0},m=()=>{g.value=!0},p=()=>{l.value=!0},k=y=>C(this,null,function*(){yield I(s("common.removeMemberTips"));const c={organizationId:o.currentOrg.id,userName:y[0].userName};yield me(c),_()});return _(),(y,c)=>{var A,D,x,F,q;const i=Q,f=W,h=we("router-link"),z=Oe,$=ee;return b(),S(J,null,[t("div",Re,[t("div",Be,[t("ul",Te,[t("li",null,[t("span",null,d(e(s)("common.currentOrganization"))+":",1),t("span",Fe,d((A=e(o).currentOrg)==null?void 0:A.name),1)]),t("li",null,[N(d(e(s)("common.members"))+":",1),t("span",Ie,d((D=u.value)==null?void 0:D.length),1)]),t("li",null,[N(d(e(s)("common.identity"))+":",1),t("span",Me,d((x=e(o).currentOrg)!=null&&x.isAdmin?e(s)("common.admin"):e(s)("common.member")),1)])]),je,t("div",null,[a(h,{to:e(he)({name:"departments"}),class:"mx-8"},{default:n(()=>[a(f,{round:""},{default:n(()=>[a(i,{class:"iconfont icon-module1 text-blue"}),t("div",qe,d(e(s)("common.departments")),1)]),_:1})]),_:1},8,["to"])]),t("div",null,[a(f,{round:"",onClick:p},{default:n(()=>[a(i,{class:"iconfont icon-qiehuanjiaose text-blue"}),t("div",Ke,d(e(s)("common.organizationAdmin")),1)]),_:1})])]),a($,{data:u.value,"show-check":(F=e(o).currentOrg)==null?void 0:F.isAdmin,"is-radio":!0,onDelete:k},Ve({default:n(()=>[a(z,{label:e(s)("common.userName")},{default:n(({row:w})=>[t("div",Xe,[t("span",null,d(w.userName),1),w.isAdmin?(b(),S("span",Ye,d(e(s)("common.admin")),1)):U("",!0)])]),_:1},8,["label"]),a(z,{prop:"emailAddress",label:e(s)("common.email")},null,8,["label"]),a(z,{label:e(s)("common.joinDate")},{default:n(({row:w})=>[t("span",null,d(e(ue)(w.joinDate)),1)]),_:1},8,["label"])]),_:2},[(q=e(o).currentOrg)!=null&&q.isAdmin?{name:"leftBar",fn:n(()=>{var w,K;return[t("div",Le,[(w=e(o).currentOrg)!=null&&w.isAdmin?(b(),O(f,{key:0,round:"",onClick:v},{default:n(()=>[a(i,{class:"iconfont icon-a-addto"}),t("div",Pe,d(e(s)("common.addMember")),1)]),_:1})):U("",!0),(K=e(o).currentOrg)!=null&&K.isAdmin?(b(),O(f,{key:1,round:"",onClick:m},{default:n(()=>[a(i,{class:"iconfont icon-a-addto"}),t("div",He,d(e(s)("common.createMember")),1)]),_:1})):U("",!0)])]})}:void 0]),1032,["data","show-check"])]),r.value?(b(),O(ke,{key:0,modelValue:r.value,"onUpdate:modelValue":c[0]||(c[0]=w=>r.value=w),onAddSuccess:_},null,8,["modelValue"])):U("",!0),g.value?(b(),O(De,{key:1,modelValue:g.value,"onUpdate:modelValue":c[1]||(c[1]=w=>g.value=w),onCreateSuccess:c[2]||(c[2]=w=>_())},null,8,["modelValue"])):U("",!0),l.value?(b(),O(Ae,{key:2,modelValue:l.value,"onUpdate:modelValue":c[3]||(c[3]=w=>l.value=w)},null,8,["modelValue"])):U("",!0)],64)}}});export{Go as default};
