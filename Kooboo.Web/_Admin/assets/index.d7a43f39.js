var L=(_,o,l)=>new Promise((n,v)=>{var m=u=>{try{f(l.next(u))}catch(s){v(s)}},h=u=>{try{f(l.throw(u))}catch(s){v(s)}},f=u=>u.done?n(u.value):Promise.resolve(u.value).then(m,h);f((l=l.apply(_,o)).next())});import{g as P,v as X}from"./i18n.48bd28ac.js";import{a as N}from"./replace-all.7cf5f327.js";import{d as V,u as M,b as G,k as A}from"./main.ea42d807.js";import{_ as C}from"./k-table.d4486972.js";import{d as E,g as I,i as B,o as d,j as y,w as a,b as i,f as c,t as r,u as t,a as w,aH as T,k as x,F as U,cn as J,c0 as q,b6 as H,e as Y,l as ee}from"./url.2e6a77c4.js";import{u as Z}from"./use-date.01b82ce0.js";import{E as W}from"./index.b494e80e.js";import{c as O,E as te,a as ae}from"./index.0d2684bf.js";import{E as K}from"./index.a439b087.js";import{E as Q}from"./index.968f79fd.js";import{_ as le}from"./chart-js.8991e1aa.js";import{B as se}from"./breadcrumb.80c136b8.js";import{w as oe}from"./date.99e830d5.js";import{E as ne,a as ie}from"./index.be352e91.js";import"./index.50c16ae5.js";import"./windi.a5b0b048.js";import"./preload-helper.13a99eb0.js";import"./sortable.esm.a99254e8.js";import"./icon-button.3313e42d.js";import"./index.2bc50276.js";import"./index.ff0264f3.js";import"./index.379e80ad.js";import"./focus-trap.23f44899.js";import"./isNil.98bb3b88.js";import"./event.53b2ad83.js";import"./index.8262f5ef.js";import"./index.fcc3ea42.js";import"./index.7034978e.js";import"./isEqual.f1ae9fb3.js";import"./_baseIsEqual.c0d7e77a.js";import"./index.fc90f5ad.js";import"./event.776e7e11.js";import"./error.7e8331f1.js";import"./index.77edae39.js";import"./index.695d0284.js";import"./dayjs.min.0a66969b.js";import"./debounce.61c67278.js";import"./toNumber.574be4f1.js";import"./index.064c7de9.js";import"./scroll.f51de5d8.js";import"./validator.e2869aba.js";import"./dropdown.0507a1c7.js";import"./dark.ddf8665a.js";import"./cloneDeep.ff43c1f8.js";import"./_baseClone.adbc92f5.js";/* empty css                                                               */import"./plugin-vue_export-helper.21dcd24c.js";import"./plugin-vue_export-helper.41ffa612.js";const re=()=>V.get(N("VisitorLog/WeekNames")),ce=_=>V.get(N("VisitorLog/TopPages"),{weekname:_}),ue=_=>V.get(N("VisitorLog/TopBots"),{weekname:_}),pe=_=>V.get(N("VisitorLog/TopReferer"),{weekname:_}),me=_=>V.get(N("VisitorLog/TopImages"),{weekname:_}),de=()=>V.get(N("VisitorLog/Monthly")),_e=(_,o)=>V.get(N("VisitorLog/errors"),{weekname:_,pageNr:o}),fe=(_,o)=>V.get(N("VisitorLog/list"),{weekname:_,pageNr:o}),be=(_,o)=>V.get(N("VisitorLog/BotList"),{weekname:_,pageNr:o}),ge={"data-cy":"ip"},ve=["title","href"],he={"data-cy":"start-time"},ye={class:"space-y-4"},ke={key:0},we={class:"mr-4"},$e={class:"mr-4"},xe={key:1},Te=["title"],Ie={key:0,class:"text-s flex space-x-4 items-center"},ze=["title"],Se=E({props:{week:null},setup(_){const o=_,{t:l}=P(),n=I(),v=M(),m=G(),h=s=>L(this,null,function*(){n.value=yield fe(o.week,s)}),f=s=>J(q(v.site.baseUrl,s));function u(s){var k,p,b,g,S;return`${s.clientInfo.os||""} ${((k=s.clientInfo)==null?void 0:k.platform)||""} ${((b=(p=s.clientInfo)==null?void 0:p.application)==null?void 0:b.name)||""} ${((S=(g=s.clientInfo)==null?void 0:g.application)==null?void 0:S.version)||""} ${(s==null?void 0:s.userAgent)||""}`}return B(()=>o.week,s=>{s&&h(1)},{immediate:!0}),(s,k)=>{var D;const p=W,b=O,g=K,S=Q,j=O;return n.value?(d(),y(t(C),{key:0,data:(D=n.value)==null?void 0:D.list,pagination:{currentPage:n.value.pageNr,pageCount:n.value.totalPages,pageSize:n.value.pageSize},onChange:h},{default:a(()=>{var R;return[i(p,{label:"IP",width:"140"},{default:a(({row:e})=>[c("span",ge,r(e.clientIP),1)]),_:1}),(R=t(m).header)!=null&&R.isOnlineServer?(d(),w(U,{key:0},[i(p,{label:t(l)("common.state")},{default:a(({row:e})=>[e.state?(d(),y(b,{key:0,type:"success",size:"small",class:"rounded-full","data-cy":"state"},{default:a(()=>[T(r(e.state),1)]),_:2},1024)):x("",!0)]),_:1},8,["label"]),i(p,{label:t(l)("common.country")},{default:a(({row:e})=>[e.country?(d(),y(b,{key:0,type:"success",size:"small",class:"rounded-full","data-cy":"country"},{default:a(()=>[T(r(e.country),1)]),_:2},1024)):x("",!0)]),_:1},8,["label"])],64)):x("",!0),i(p,{label:t(l)("common.page")},{default:a(({row:e})=>[c("a",{title:e.url,class:"text-blue ellipsis",href:f(e.url),target:"_blank","data-cy":"page-url"},r(e.url),9,ve)]),_:1},8,["label"]),i(p,{label:t(l)("common.startTime"),width:"180"},{default:a(({row:e})=>[c("span",he,r(t(Z)(e.begin)),1)]),_:1},8,["label"]),i(p,{label:t(l)("common.timeElapsed")},{default:a(({row:e})=>[i(S,{width:"auto",trigger:"hover",placement:"right","popper-style":"padding: 0;"},{reference:a(()=>[e.timeSpan?(d(),y(b,{key:0,type:"success",size:"small",class:"rounded-full cursor-pointer","data-cy":"time-elapsed"},{default:a(()=>[T(r(e.timeSpan)+" ms ",1)]),_:2},1024)):x("",!0)]),default:a(()=>[i(g,{"max-height":"98vh","view-style":"padding: 12px;"},{default:a(()=>{var z;return[c("div",ye,[(z=e.entries)!=null&&z.length?(d(),w("table",ke,[c("tbody",null,[(d(!0),w(U,null,H(e.entries,($,F)=>(d(),w("tr",{key:F},[c("td",null,[c("span",we,r($.name),1)]),c("td",null,[c("span",$e,r($.value),1)]),c("td",null,[i(b,{type:"success",size:"small",class:"rounded-full cursor-pointer","data-cy":"time-elapsed"},{default:a(()=>[T(r(new Date($.endTime).getTime()-new Date($.startTime).getTime())+" ms ",1)]),_:2},1024)])]))),128))])])):(d(),w("div",xe,r(t(l)("common.empty")),1))])]}),_:2},1024)]),_:2},1024)]),_:1},8,["label"]),i(p,{label:t(l)("common.referer")},{default:a(({row:e})=>[c("div",{class:"ellipsis",title:e.referer},r(e.refererHost),9,Te)]),_:1},8,["label"]),i(p,{label:t(l)("common.clientInfo")},{default:a(({row:e})=>{var z,$;return[e.clientInfo?(d(),w("div",Ie,[($=(z=e.clientInfo)==null?void 0:z.application)!=null&&$.isWebBrowser?(d(),y(j,{key:0,round:"",size:"small"},{default:a(()=>[T(r(t(l)("common.webBrowser")),1)]),_:1})):x("",!0),c("div",{class:"ellipsis",title:u(e)},r(u(e)),9,ze)])):x("",!0)]}),_:1},8,["label"]),i(p,{label:t(l)("common.size"),width:"120"},{default:a(({row:e})=>[c("span",null,r(t(A)(e.size)),1)]),_:1},8,["label"])]}),_:1},8,["data","pagination"])):x("",!0)}}}),Le=E({props:{week:null},setup(_){const o=_,{t:l}=P(),n=I([]),v=()=>L(this,null,function*(){n.value=yield ce(o.week)});return B(()=>o.week,m=>{m&&v()},{immediate:!0}),(m,h)=>{const f=W;return d(),y(t(C),{data:n.value},{default:a(()=>[i(f,{label:t(l)("common.name")},{default:a(({row:u})=>[T(r(u.name),1)]),_:1},8,["label"]),i(f,{label:t(l)("common.size")},{default:a(({row:u})=>[T(r(t(A)(u.size)),1)]),_:1},8,["label"]),i(f,{label:t(l)("visitorLog.views"),prop:"count"},null,8,["label"])]),_:1},8,["data"])}}}),Ne=E({props:{week:null},setup(_){const o=_,{t:l}=P(),n=I([]),v=()=>L(this,null,function*(){n.value=yield pe(o.week)});return B(()=>o.week,m=>{m&&v()},{immediate:!0}),(m,h)=>{const f=W;return d(),y(t(C),{data:n.value},{default:a(()=>[i(f,{label:"URL",prop:"name"}),i(f,{label:t(l)("visitorLog.views"),prop:"count"},null,8,["label"])]),_:1},8,["data"])}}}),Ve={class:"flex items-center"},Ee={class:"w-80px h-44px mr-24 flex items-center justify-center"},Pe=["src"],Be=["title"],Ce=E({props:{week:null},setup(_){const o=_,{t:l}=P(),n=I([]),v=M(),m=()=>L(this,null,function*(){n.value=yield me(o.week)});return B(()=>o.week,h=>{h&&m()},{immediate:!0}),(h,f)=>{const u=W;return d(),y(t(C),{data:n.value},{default:a(()=>[i(u,{label:"URL"},{default:a(({row:s})=>[c("div",Ve,[c("div",Ee,[c("img",{src:t(q)(t(v).site.baseUrl,s.thumbNail)},null,8,Pe)]),c("span",{class:"text-l font-bold flex-1 ellipsis",title:s.name},r(s.name),9,Be)])]),_:1}),i(u,{label:t(l)("common.size")},{default:a(({row:s})=>[T(r(t(A)(s.size)),1)]),_:1},8,["label"]),i(u,{label:t(l)("visitorLog.views"),prop:"count",width:"100px",align:"center"},null,8,["label"])]),_:1},8,["data"])}}}),We={class:"p-16 rounded-normal bg-fff dark:bg-444"},Ue=E({setup(_){const o=I([]),l=I(!1),n=I({type:"bar",data:{labels:[],datasets:[{label:"PV",data:[],backgroundColor:["rgb(54, 162, 235,0.6)"]}]},options:{scales:{y:{beginAtZero:!0}}}});return(()=>L(this,null,function*(){if(o.value=yield de(),o.value.length<16)for(let m=0;m<16-o.value.length;m++)n.value.data.labels.push(""),n.value.data.datasets[0].data.push(0);n.value.data.labels.push(...o.value.map(m=>m.name)),n.value.data.datasets[0].data.push(...o.value.map(m=>m.count)),l.value=!0}))(),(m,h)=>(d(),w("div",We,[c("div",null,[i(le,{height:"180",options:n.value},null,8,["options"])])]))}}),De={"data-cy":"ip"},Re=["href"],Ae={"data-cy":"start-time"},He=E({props:{week:null},setup(_){const o=_,{t:l}=P(),n=I(),v=m=>L(this,null,function*(){n.value=yield _e(o.week,m)});return B(()=>o.week,m=>{m&&v(1)},{immediate:!0}),(m,h)=>{var u,s,k,p;const f=W;return d(),y(t(C),{data:(u=n.value)==null?void 0:u.dataList,pagination:{currentPage:(s=n.value)==null?void 0:s.pageNr,pageCount:(k=n.value)==null?void 0:k.totalPages,pageSize:(p=n.value)==null?void 0:p.pageSize},onChange:v},{default:a(()=>[i(f,{label:"IP",width:"140"},{default:a(({row:b})=>[c("span",De,r(b.clientIP),1)]),_:1}),i(f,{label:"URL"},{default:a(({row:b})=>[c("a",{class:"text-blue ellipsis",href:b.previewUrl,target:"_blank"},r(b.url),9,Re)]),_:1}),i(f,{label:t(l)("common.startTime"),width:"180"},{default:a(({row:b})=>[c("span",Ae,r(t(Z)(b.startTime)),1)]),_:1},8,["label"]),i(f,{label:t(l)("common.message"),prop:"message"},null,8,["label"]),i(f,{label:t(l)("common.status"),prop:"statusCode"},null,8,["label"])]),_:1},8,["data","pagination"])}}}),Oe={"data-cy":"ip"},je=["title","href"],Fe={"data-cy":"start-time"},Me={class:"space-y-4"},qe={key:0},Ze={class:"mr-4"},Ge={class:"mr-4"},Je={key:1},Ke=["title"],Qe={key:0,class:"text-s flex space-x-4 items-center"},Xe=["title"],Ye=E({props:{week:null},setup(_){const o=_,{t:l}=P(),n=I(),v=M(),m=G(),h=s=>L(this,null,function*(){n.value=yield be(o.week,s)}),f=s=>J(q(v.site.baseUrl,s));function u(s){var k,p,b,g,S;return`${s.clientInfo.os||""} ${((k=s.clientInfo)==null?void 0:k.platform)||""} ${((b=(p=s.clientInfo)==null?void 0:p.application)==null?void 0:b.name)||""} ${((S=(g=s.clientInfo)==null?void 0:g.application)==null?void 0:S.version)||""} ${(s==null?void 0:s.userAgent)||""}`}return B(()=>o.week,s=>{s&&h(1)},{immediate:!0}),(s,k)=>{var D;const p=W,b=O,g=K,S=Q,j=O;return n.value?(d(),y(t(C),{key:0,data:(D=n.value)==null?void 0:D.list,pagination:{currentPage:n.value.pageNr,pageCount:n.value.totalPages,pageSize:n.value.pageSize},onChange:h},{default:a(()=>{var R;return[i(p,{label:"IP",width:"140"},{default:a(({row:e})=>[c("span",Oe,r(e.clientIP),1)]),_:1}),(R=t(m).header)!=null&&R.isOnlineServer?(d(),w(U,{key:0},[i(p,{label:t(l)("common.state")},{default:a(({row:e})=>[e.state?(d(),y(b,{key:0,type:"success",size:"small",class:"rounded-full","data-cy":"state"},{default:a(()=>[T(r(e.state),1)]),_:2},1024)):x("",!0)]),_:1},8,["label"]),i(p,{label:t(l)("common.country")},{default:a(({row:e})=>[e.country?(d(),y(b,{key:0,type:"success",size:"small",class:"rounded-full","data-cy":"country"},{default:a(()=>[T(r(e.country),1)]),_:2},1024)):x("",!0)]),_:1},8,["label"])],64)):x("",!0),i(p,{label:t(l)("common.page")},{default:a(({row:e})=>[c("a",{title:e.url,class:"text-blue ellipsis",href:f(e.url),target:"_blank","data-cy":"page-url"},r(e.url),9,je)]),_:1},8,["label"]),i(p,{label:t(l)("common.startTime"),width:"180"},{default:a(({row:e})=>[c("span",Fe,r(t(Z)(e.begin)),1)]),_:1},8,["label"]),i(p,{label:t(l)("common.timeElapsed")},{default:a(({row:e})=>[i(S,{width:"auto",trigger:"hover",placement:"right","popper-style":"padding: 0;"},{reference:a(()=>[e.timeSpan?(d(),y(b,{key:0,type:"success",size:"small",class:"rounded-full cursor-pointer","data-cy":"time-elapsed"},{default:a(()=>[T(r(e.timeSpan)+" ms ",1)]),_:2},1024)):x("",!0)]),default:a(()=>[i(g,{"max-height":"98vh","view-style":"padding: 12px;"},{default:a(()=>{var z;return[c("div",Me,[(z=e.entries)!=null&&z.length?(d(),w("table",qe,[c("tbody",null,[(d(!0),w(U,null,H(e.entries,($,F)=>(d(),w("tr",{key:F},[c("td",null,[c("span",Ze,r($.name),1)]),c("td",null,[c("span",Ge,r($.value),1)]),c("td",null,[i(b,{type:"success",size:"small",class:"rounded-full cursor-pointer","data-cy":"time-elapsed"},{default:a(()=>[T(r(new Date($.endTime).getTime()-new Date($.startTime).getTime())+" ms ",1)]),_:2},1024)])]))),128))])])):(d(),w("div",Je,r(t(l)("common.empty")),1))])]}),_:2},1024)]),_:2},1024)]),_:1},8,["label"]),i(p,{label:t(l)("common.referer")},{default:a(({row:e})=>[c("div",{class:"ellipsis",title:e.referer},r(e.refererHost),9,Ke)]),_:1},8,["label"]),i(p,{label:t(l)("common.clientInfo")},{default:a(({row:e})=>{var z,$;return[e.clientInfo?(d(),w("div",Qe,[($=(z=e.clientInfo)==null?void 0:z.application)!=null&&$.isWebBrowser?(d(),y(j,{key:0,round:"",size:"small"},{default:a(()=>[T(r(t(l)("common.webBrowser")),1)]),_:1})):x("",!0),c("div",{class:"ellipsis",title:u(e)},r(u(e)),9,Xe)])):x("",!0)]}),_:1},8,["label"]),i(p,{label:t(l)("common.size"),width:"120"},{default:a(({row:e})=>[c("span",null,r(t(A)(e.size)),1)]),_:1},8,["label"])]}),_:1},8,["data","pagination"])):x("",!0)}}}),et=E({props:{week:null},setup(_){const o=_,{t:l}=P(),n=I([]),v=()=>L(this,null,function*(){n.value=yield ue(o.week)});return B(()=>o.week,m=>{m&&v()},{immediate:!0}),(m,h)=>{const f=W;return d(),y(t(C),{data:n.value},{default:a(()=>[i(f,{label:t(l)("common.name")},{default:a(({row:u})=>[T(r(u.name),1)]),_:1},8,["label"]),i(f,{label:t(l)("common.size")},{default:a(({row:u})=>[T(r(t(A)(u.size)),1)]),_:1},8,["label"]),i(f,{label:t(l)("visitorLog.views"),prop:"count"},null,8,["label"])]),_:1},8,["data"])}}}),tt={class:"p-24"},at={class:"absolute top-16 right-24"},lt={class:"text-black dark:text-fff/86 mr-12"},Yt=E({setup(_){const{t:o}=P(),l=I([]),n=I(),v=I(!0);re().then(f=>{l.value=f.sort((u,s)=>{const k=u.split("-").map(b=>parseInt(b)),p=s.split("-").map(b=>parseInt(b));return k[0]===p[0]?p[1]-k[1]:p[0]-k[0]}),n.value=f[0]});const m=[{displayName:o("common.visitors"),value:"All",component:Se,showWeek:!0},{displayName:o("common.topPages"),value:"topPages",component:Le,showWeek:!0},{displayName:o("common.topReferer"),value:"topReferer",component:Ne,showWeek:!0},{displayName:o("common.topImages"),value:"topImages",component:Ce,showWeek:!0},{displayName:o("common.chart"),value:"chart",component:Ue,showWeek:!1},{displayName:o("common.errorList"),value:"errorList",component:He,showWeek:!0},{displayName:o("common.bots"),value:"botList",component:Ye,showWeek:!0},{displayName:o("common.topBots"),value:"topBots",component:et,showWeek:!0}],h=I(m[0].value);return B(()=>h.value,()=>{v.value=m.find(f=>f.value===h.value).showWeek}),(f,u)=>{const s=te,k=ae,p=ne,b=ie;return d(),w("div",null,[c("div",tt,[i(se,{name:t(o)("common.visitorLogs")},null,8,["name"]),Y(c("div",at,[c("span",lt,r(t(o)("common.week")),1),i(k,{modelValue:n.value,"onUpdate:modelValue":u[0]||(u[0]=g=>n.value=g),class:"w-240px"},{default:a(()=>[(d(!0),w(U,null,H(l.value,g=>(d(),y(s,{key:g,value:g,label:t(oe)(g),"data-cy":"week-opt"},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])],512),[[X,v.value]])]),i(b,{modelValue:h.value,"onUpdate:modelValue":u[1]||(u[1]=g=>h.value=g)},{default:a(()=>[(d(),w(U,null,H(m,g=>i(p,{key:g.value,label:g.displayName,name:g.value},{default:a(()=>[h.value===g.value&&n.value?(d(),y(ee(g.component),{key:0,week:n.value},null,8,["week"])):x("",!0)]),_:2},1032,["label","name"])),64))]),_:1},8,["modelValue"])])}}});export{Yt as default};
