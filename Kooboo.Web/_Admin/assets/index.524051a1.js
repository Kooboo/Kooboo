var D=(k,i,c)=>new Promise((n,f)=>{var e=u=>{try{S(c.next(u))}catch(d){f(d)}},F=u=>{try{S(c.throw(u))}catch(d){f(d)}},S=u=>u.done?n(u.value):Promise.resolve(u.value).then(e,F);S((c=c.apply(k,i)).next())});import{_ as te}from"./tooltip.7fc982a4.js";import{_ as oe}from"./index.5f37a601.js";import{B as ne}from"./breadcrumb.0ef7e7c4.js";import{g as q,k as se}from"./i18n.97105311.js";import{u as ie}from"./use-shortcuts.21ce2d8e.js";import{u as me,O as ue,P as de,G as re}from"./commerce.c633c6e0.js";import{r as pe}from"./monaco.6a3362ef.js";import{_ as ce}from"./index.cdaadc8a.js";import{a as fe,_ as ve}from"./selection-editor.8b0c2a1d.js";import{a as H,r as _e,l as ye}from"./validate.98ddbafd.js";import{_ as be}from"./index.9ffc2c80.js";import{f as O}from"./custom-field.2a857ed5.js";import{g as Ve}from"./content-folder.a9370463.js";import{i as ge,a as we}from"./string.955a924b.js";import{_ as Fe}from"./plugin-vue_export-helper.21dcd24c.js";import{E as Se}from"./index.4587e608.js";import{E as xe}from"./index.c1764395.js";import{E as W,a as Q}from"./index.317a7f30.js";import{E as M,a as P,c as Ee}from"./index.afee24fe.js";import{E as Ce,a as ke}from"./index.13bfae9f.js";import{E as Ne}from"./index.f997a738.js";import{E as Te}from"./index.4b289bae.js";import{d as J,g as x,c as j,i as X,o as m,j as _,w as a,b as t,u as o,f as g,aH as $,t as w,a as B,b6 as R,F as I,k as C,az as Ue}from"./url.2e6a77c4.js";import{a as $e,p as Be,c as he}from"./useLabels.14342caf.js";import"./windi.539ebeab.js";import"./index.9589f7cf.js";import"./focus-trap.de18cf8f.js";import"./isNil.98bb3b88.js";import"./event.53b2ad83.js";import"./index.9e96921b.js";import"./index.b09a9f00.js";import"./replace-all.8fa5a83d.js";import"./main.52487121.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";/* empty css                                                               */import"./plugin-vue_export-helper.41ffa612.js";import"./classCompletion.a22e38a6.js";import"./userWorker.b3a6730b.js";import"./editor.main.d2800f63.js";import"./guid.c1a40312.js";import"./vuedraggable.umd.e0027d17.js";import"./cloneDeep.5cd857a3.js";import"./_baseClone.f10ff33c.js";import"./_baseIsEqual.abb55a3a.js";import"./index.1d8a0bb0.js";import"./event.776e7e11.js";import"./index.bc93d068.js";import"./error.7e8331f1.js";import"./index.e3f90979.js";import"./index.99641a60.js";import"./index.77759eed.js";import"./index.b1fe55d8.js";import"./index.51a59403.js";import"./index.29d7c76d.js";import"./style.f835519e.js";import"./toNumber.574be4f1.js";import"./isEqual.3700b7f1.js";import"./scroll.8babc10c.js";import"./debounce.61c67278.js";import"./index.a46fa52c.js";import"./validator.1d438d08.js";import"./index.07e210fb.js";import"./refs.4001ce17.js";const Oe={class:"w-full flex items-center"},De={class:"w-full flex items-center"},Re={class:"w-full flex items-center"},Ie=J({props:{modelValue:{type:Boolean},field:null,fields:null},emits:["update:modelValue","success"],setup(k,{emit:i}){const c=k,{t:n}=q(),f=x(!0),e=x(JSON.parse(JSON.stringify(c.field))),F=j(()=>c.fields.filter(y=>!ge(y.name,c.field.name))),S=x([]),u=x(),d=x(),b=[{displayName:n("common.basic"),value:"Basic"},{displayName:n("common.advanced"),value:"Advanced"},{displayName:n("common.validation"),value:"Validation"}],N=x("Basic"),r={name:[H(n("common.fieldRequiredTips")),_e(1,50),ye(),{validator(y,l){const s=l==null?void 0:l.toLowerCase();return!F.value.find(T=>T.name.toLowerCase()==s)},message:()=>n("common.valueHasBeenTakenTips")}],contentFolder:e.value.isSystemField?[]:[H(n("common.fieldRequiredTips"))]},v=j(()=>se(e.value,"options.disableMultiple",!1));function E(){return D(this,null,function*(){var y,l;try{yield(l=(y=u.value)==null?void 0:y.form)==null?void 0:l.validate()}catch(s){throw N.value="Validation",Error("Validation not valid")}try{yield d.value.validate()}catch(s){throw N.value="Basic",Error("Basic not valid")}i("success",e.value),f.value=!1})}return X(()=>e.value.type,y=>D(this,null,function*(){var l;we(["Content","RichEditor"],y)&&(e.value.isSummaryField=!1),(l=S.value)!=null&&l.length||(S.value=yield Ve())}),{immediate:!0}),(y,l)=>{const s=Se,T=xe,U=W,A=M,G=P,Y=ve,Z=Q,L=Ce,ee=ke,le=Ne,ae=Te;return m(),_(ae,{"model-value":f.value,width:"700px","close-on-click-modal":!1,title:o(n)("common.fieldEditor"),"custom-class":"el-dialog--zero-padding",onClosed:l[12]||(l[12]=V=>i("update:modelValue",!1))},{footer:a(()=>[t(be,{onConfirm:E,onCancel:l[11]||(l[11]=V=>f.value=!1)})]),default:a(()=>[t(le,{"max-height":"60vh"},{default:a(()=>[t(ee,{modelValue:N.value,"onUpdate:modelValue":l[10]||(l[10]=V=>N.value=V)},{default:a(()=>[t(L,{label:o(b)[0].displayName,name:o(b)[0].value},{default:a(()=>[t(Z,{ref_key:"form",ref:d,model:e.value,rules:r,"label-position":"top"},{default:a(()=>{var V;return[t(U,{prop:"name",label:o(n)("common.name")},{default:a(()=>[g("div",Oe,[t(s,{modelValue:e.value.name,"onUpdate:modelValue":l[0]||(l[0]=p=>e.value.name=p),disabled:!!e.value.name&&e.value.isSystemField,class:"w-3/5","data-cy":"field-name-input"},null,8,["modelValue","disabled"]),t(T,{modelValue:e.value.isSummaryField,"onUpdate:modelValue":l[1]||(l[1]=p=>e.value.isSummaryField=p),class:"ml-12","data-cy":"summary-field"},{default:a(()=>[$(w(o(n)("common.summaryField")),1)]),_:1},8,["modelValue"])])]),_:1},8,["label"]),t(U,{label:o(n)("common.displayName")},{default:a(()=>[t(s,{modelValue:e.value.displayName,"onUpdate:modelValue":l[2]||(l[2]=p=>e.value.displayName=p),class:"w-3/5","data-cy":"display-name-input"},null,8,["modelValue"])]),_:1},8,["label"]),t(U,{prop:"type",label:o(n)("common.controlType")},{default:a(()=>{var p;return[g("div",De,[t(G,{modelValue:e.value.type,"onUpdate:modelValue":l[3]||(l[3]=h=>e.value.type=h),disabled:e.value.isSystemField,class:"w-3/5","data-cy":"control-type-dropdown"},{default:a(()=>[(m(!0),B(I,null,R(o(O),(h,z)=>(m(),_(A,{key:z,value:z,label:h.displayName},null,8,["value","label"]))),128))]),_:1},8,["modelValue","disabled"]),(p=o(O)[e.value.type])!=null&&p.multiple?(m(),_(T,{key:0,modelValue:e.value.multiple,"onUpdate:modelValue":l[4]||(l[4]=h=>e.value.multiple=h),disabled:o(v),class:"ml-12","data-cy":"enable-multiple"},{default:a(()=>[$(w(o(n)("common.enableMultiple")),1)]),_:1},8,["modelValue","disabled"])):C("",!0)])]}),_:1},8,["label"]),(V=o(O)[e.value.type])!=null&&V.selection?(m(),_(U,{key:0,label:o(n)("common.options")},{default:a(()=>[t(Y,{options:e.value.selectionOptions},null,8,["options"])]),_:1},8,["label"])):C("",!0),e.value.type=="Content"?(m(),_(U,{key:1,label:o(n)("common.contentFolder"),prop:"contentFolder"},{default:a(()=>[g("div",Re,[t(G,{modelValue:e.value.contentFolder,"onUpdate:modelValue":l[5]||(l[5]=p=>e.value.contentFolder=p),class:"w-3/5"},{default:a(()=>[(m(!0),B(I,null,R(S.value,p=>(m(),_(A,{key:p.name,value:p.name,label:p.name||p.displayName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"]),t(T,{modelValue:e.value.embedded,"onUpdate:modelValue":l[6]||(l[6]=p=>e.value.embedded=p),class:"ml-12","data-cy":"enable-embedded"},{default:a(()=>[$(w(o(n)("common.embedded")),1)]),_:1},8,["modelValue"])])]),_:1},8,["label"])):C("",!0)]}),_:1},8,["model"])]),_:1},8,["label","name"]),e.value.isSystemField?C("",!0):(m(),_(L,{key:0,label:o(b)[1].displayName,name:o(b)[1].value},{default:a(()=>[t(U,null,{default:a(()=>[t(T,{modelValue:e.value.editable,"onUpdate:modelValue":l[7]||(l[7]=V=>e.value.editable=V)},{default:a(()=>[$(w(o(n)("common.userEditable")),1)]),_:1},8,["modelValue"])]),_:1}),o(O)[e.value.type].multilingual?(m(),_(U,{key:0},{default:a(()=>[t(T,{modelValue:e.value.multilingual,"onUpdate:modelValue":l[8]||(l[8]=V=>e.value.multilingual=V)},{default:a(()=>[$(w(o(n)("common.enableMultilingual")),1)]),_:1},8,["modelValue"])]),_:1})):C("",!0),e.value.multiple&&e.value.type=="Content"?(m(),_(U,{key:1},{default:a(()=>[t(T,{modelValue:e.value.allowRepetition,"onUpdate:modelValue":l[9]||(l[9]=V=>e.value.allowRepetition=V)},{default:a(()=>[$(w(o(n)("common.allowRepetition")),1)]),_:1},8,["modelValue"])]),_:1})):C("",!0)]),_:1},8,["label","name"])),e.value.isSystemField?C("",!0):(m(),_(L,{key:1,label:o(b)[2].displayName,name:o(b)[2].value},{default:a(()=>[t(fe,{ref_key:"fieldValidation",ref:u,field:{controlType:e.value.type,validations:e.value.validations},onSave:E},null,8,["field"])]),_:1},8,["label","name"]))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model-value","title"])}}});var Le=Fe(Ie,[["__scopeId","data-v-c8f20512"]]);const Me={class:"w-full"},Pe={class:"flex items-center"},qe={class:"ellipsis flex-1"},K=J({props:{data:null,labels:null},setup(k){const i=k,{t:c}=q(),{getFieldDisplayName:n}=$e(i.labels),f=x(!1),e=x();let F=-1;function S(){e.value={name:"",type:"TextBox",displayName:"",editable:!0,validations:[],multiple:!1,selectionOptions:[],isSystemField:!1,isSummaryField:!1,multilingual:!1,embedded:!1},F=-1,f.value=!0}function u(r,v){e.value=v,F=i.data.indexOf(v),f.value=!0}function d(r){F==-1?i.data.push(r):i.data.splice(F,1,r)}function b(r){const v=i.data.findIndex(E=>E.name==r);v>-1&&i.data.splice(v,1)}function N(r){const v=i.data.splice(r.oldIndex,1)[0];i.data.splice(r.newIndex,0,v)}return(r,v)=>{const E=Ee,y=ce;return m(),B("div",Me,[t(y,{"wrapper-class":"space-y-4 w-full",list:k.data,"id-prop":"name",editable:"","disable-actions":{delete:l=>l.isSystemField},"delete-tip":l=>l.isSystemField?o(c)("common.systemFieldNotSupportDelete"):"",onAdd:S,onDelete:b,onSort:N,onEdit:u},{default:a(({item:l})=>[g("div",Pe,[g("div",qe,w(o(n)(l)),1),l.isSummaryField?(m(),_(E,{key:0,round:"",class:"mr-4",type:"warning"},{default:a(()=>[$(w(o(c)("common.summaryField")),1)]),_:1})):C("",!0),t(E,{round:""},{default:a(()=>{var s;return[$(w((s=o(O)[l.type])==null?void 0:s.displayName),1)]}),_:2},1024)])]),_:1},8,["list","disable-actions","delete-tip"]),(m(),_(Ue,{to:"body"},[f.value&&e.value?(m(),_(Le,{key:0,modelValue:f.value,"onUpdate:modelValue":v[0]||(v[0]=l=>f.value=l),field:e.value,fields:k.data,onSuccess:d},null,8,["modelValue","field","fields"])):C("",!0)]))])}}}),Je={class:"p-24 pb-150px"},Ae={class:"rounded-normal bg-fff dark:bg-[#252526] mt-16 mb-24 py-24 px-56px"},Ge={class:"max-w-504px"},ze={class:"rounded-normal bg-fff dark:bg-[#252526] mt-16 mb-24 py-24 px-56px"},He={class:"max-w-504px"},oa=J({setup(k){const{t:i}=q(),c=x([]),n=x([]),f=me();ue().then(u=>{c.value=u}),de().then(u=>{n.value=u});const e=x(),F=()=>D(this,null,function*(){yield re(e.value),f.loadSettings(),pe()});function S(u){if(!!c.value){var d=c.value.find(b=>b.code==u);d&&(e.value.currencySymbol=d.symbolNative)}}return X(()=>f.settings,()=>{e.value=JSON.parse(JSON.stringify(f.settings))},{immediate:!0}),ie("save",F),(u,d)=>{const b=M,N=P,r=W,v=M,E=P,y=te,l=Q;return m(),B("div",Je,[t(ne,{name:o(i)("commerce.commerceSettings")},null,8,["name"]),e.value?(m(),_(l,{key:0,"label-position":"top"},{default:a(()=>[g("div",Ae,[g("div",Ge,[t(r,{label:o(i)("common.currency")},{default:a(()=>[t(N,{modelValue:e.value.currencyCode,"onUpdate:modelValue":d[0]||(d[0]=s=>e.value.currencyCode=s),class:"w-full",onChange:S},{default:a(()=>[(m(!0),B(I,null,R(c.value,s=>(m(),_(b,{key:s.code,value:s.code,label:`${s.namePlural} - ${s.code} - ${s.symbolNative}`},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(r,{label:o(i)("common.weightUnit")},{default:a(()=>[t(E,{modelValue:e.value.weightUnit,"onUpdate:modelValue":d[1]||(d[1]=s=>e.value.weightUnit=s),class:"w-full"},{default:a(()=>[t(v,{label:"KG",value:"kg"}),t(v,{label:"G",value:"g"})]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(r,null,{label:a(()=>[g("span",null,w(o(i)("commerce.availablePaymentMethods")),1),t(y,{tip:o(i)("commerce.paymentsTip"),"custom-class":"ml-4"},null,8,["tip"])]),default:a(()=>[t(E,{modelValue:e.value.payments,"onUpdate:modelValue":d[2]||(d[2]=s=>e.value.payments=s),multiple:"",class:"w-full"},{default:a(()=>[(m(!0),B(I,null,R(n.value,s=>(m(),_(v,{key:s.key,label:s.value,value:s.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),g("div",ze,[g("div",He,[t(r,null,{label:a(()=>[g("span",null,w(o(i)("commerce.productFields")),1),t(y,{tip:o(i)("common.productFieldsTip"),"custom-class":"ml-4"},null,8,["tip"])]),default:a(()=>[t(K,{data:e.value.productCustomFields,labels:o(Be)},null,8,["data","labels"])]),_:1}),t(r,null,{label:a(()=>[g("span",null,w(o(i)("commerce.categoryFields")),1),t(y,{tip:o(i)("common.categoryFieldsTip"),"custom-class":"ml-4"},null,8,["tip"])]),default:a(()=>[t(K,{data:e.value.categoryCustomFields,labels:o(he)},null,8,["data","labels"])]),_:1})])])]),_:1})):C("",!0),t(oe,{"hidden-cancel":"",onSave:F})])}}});export{oa as default};
