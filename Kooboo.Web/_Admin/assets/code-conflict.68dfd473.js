var I=(g,o,t)=>new Promise((s,p)=>{var b=r=>{try{n(t.next(r))}catch(_){p(_)}},a=r=>{try{n(t.throw(r))}catch(_){p(_)}},n=r=>r.done?s(r.value):Promise.resolve(r.value).then(b,a);n((t=t.apply(g,o)).next())});import{d as F,N as B,g as E,O as j,o as c,a as y,b as u,w as l,F as L,b7 as R,u as e,n as O,f as d,t as f,c as T,j as h,e as N,k as P,aI as D}from"./url.4cb47a7a.js";import{u as q,c as G}from"./main.9fdfea92.js";import{g as M,w as H}from"./i18n.a87944a4.js";import{E as A}from"./windi.6360286d.js";import{E as J,a as Q,b as W}from"./index.c86a187b.js";import{u as V}from"./replace-all.56d2c1f7.js";import{u as X}from"./dev-mode.acf56c3e.js";import{_ as Y}from"./plugin-vue_export-helper.21dcd24c.js";import{C as Z}from"./index.66319a92.js";import{E as K}from"./index.361e2245.js";import{E as ee,a as oe}from"./index.bec063d7.js";import{_ as te}from"./diff.b23bba43.js";import{a as se}from"./confirm.b60b5d2f.js";import{_ as ne}from"./index.f0d5f031.js";import{E as le}from"./index.c003dfa1.js";const re=["title"],ae={class:"flex items-center text-black dark:text-fff/86 px-16 h-full hover:bg-[#EFF6FF] dark:hover:bg-444"},ie=["title"],ce=["title"],je=F({emits:["change"],setup(g,{emit:o}){const{t}=M(),s=q(),p=B(),b=E(),a=()=>{b.value.handleClose(),o("change",!0)};return s.loadSites(),(n,r)=>{const _=A,m=J,x=j("router-link"),k=Q,S=W;return c(),y("div",{class:"flex items-center justify-center h-full cursor-pointer border-l border-solid border-line dark:border-opacity-50",title:e(t)("common.switchSite")},[u(S,{ref_key:"dropdown",ref:b,trigger:"click","max-height":"calc(100vh - 100px)",class:"h-full"},{dropdown:l(()=>[u(k,null,{default:l(()=>[(c(!0),y(L,null,R(e(s).sites,i=>(c(),y("div",{key:i.key},[u(x,{to:{name:e(p).name==="dev-mode"?"dev-mode":"dashboard",query:{SiteId:i.key}},onClick:r[0]||(r[0]=v=>a())},{default:l(()=>{var v;return[u(m,{command:i.key,style:{"max-width":"300px"},class:O({selected:i.key===((v=e(s).site)==null?void 0:v.id)})},{default:l(()=>[d("span",{class:"ellipsis",title:i.value},f(i.value),9,ce)]),_:2},1032,["command","class"])]}),_:2},1032,["to"])]))),128))]),_:1})]),default:l(()=>{var i,v,w;return[d("span",ae,[d("span",{class:"text-m ellipsis max-w-120px mr-8",title:(i=e(s).site)==null?void 0:i.displayName},f((w=(v=e(s).site)==null?void 0:v.displayName)!=null?w:e(t)("common.switchSite")),9,ie),u(_,{class:"iconfont icon-pull-down text-s leading-none"})])]}),_:1},512)],8,re)}}});const de={class:"ml-12 inline-block"},me={class:"text-000 dark:text-fff/86 font-bold mt-8 ml-8 mb-8"},ue={class:"ml-8 justify-between mb-12 h-auto mr-12"},fe={class:"text-666 dark:text-fff/60 leading-8"},pe={class:"mb-16 ml-12"},_e=F({setup(g){const{t:o}=M(),t=B(),s=X(),p=q(),b=T(()=>t.name==="dev-mode"),a=E(!1),n=E(),r=()=>{a.value=!1},_=[o("common.devModeList1"),o("common.devModeList2"),o("common.devModeList3")],m=()=>{!s.activities.length&&!p.isAdmin||(a.value=!0)};return(x,k)=>{const S=A,i=K,v=j("router-link"),w=ee,U=oe;return c(),h(w,{ref_key:"popoverRef",ref:n,visible:a.value,placement:"bottom-start",width:400,trigger:"click",content:"K"},{reference:l(()=>[N((c(),y("div",{class:O(["h-full cursor-pointer border-l border-solid border-line dark:border-opacity-50 flex items-center justify-center pr-16 pl-16 text-14px dark:bg-[#333]",[e(b)?"bg-bg-[#EFF6FF]":"",!e(s).activities.length&&!e(p).isAdmin?"hover:cursor-not-allowed text-999":"hover:bg-[#EFF6FF] dark:hover:bg-444"]]),"data-cy":"dev-mode",onClick:m},[a.value?(c(),y("div",{key:0,class:"absolute inset-0",onClick:k[0]||(k[0]=H(()=>{},["stop"]))})):P("",!0),D(" "+f(e(o)("common.devMode")),1)],2)),[[U,n.value]])]),default:l(()=>{var $;return[N((c(),y("div",de,[d("p",me,f(e(o)("common.KoobooDevMode")),1),d("ul",ue,[(c(),y(L,null,R(_,(C,z)=>d("li",{key:z,class:"mt-8 flex items-start"},[u(S,{class:"iconfont icon-yes2 text-green mr-8 pt-4 mt-8"}),d("span",fe,f(C),1)])),64))])])),[[e(Z),r]]),d("div",pe,[e(t).name==="dev-mode"?(c(),h(v,{key:0,to:e(V)({name:"dashboard"})},{default:l(()=>[u(i,{type:"primary",round:"","data-cy":"close-dev-mode"},{default:l(()=>[D(f(e(o)("common.closeDevMode")),1)]),_:1})]),_:1},8,["to"])):(c(),h(v,{key:1,to:e(V)({name:"dev-mode",query:{activity:e(s).activities.map(C=>C.name).includes(e(t).name)?e(t).name:($=e(s).activities[0])==null?void 0:$.name}}),onClick:k[1]||(k[1]=C=>a.value=!1)},{default:l(()=>[u(i,{type:"primary",round:"","data-cy":"open-dev-mode"},{default:l(()=>[D(f(e(o)("common.openDevMode")),1)]),_:1})]),_:1},8,["to"]))])]}),_:1},8,["visible"])}}});var Le=Y(_e,[["__scopeId","data-v-96ccbc88"]]);const ve={class:"flex w-full"},be={class:"flex-1 text-center"},ke={class:"flex-1 text-center"},Re=F({setup(g){const o=G(),t=E(!0),{t:s}=M(),p=()=>{var a;o.action="merge",o.model.version=(a=o.conflict)==null?void 0:a.version,t.value=!1},b=()=>I(this,null,function*(){yield se(),o.action="force",o.model.enableDiffChecker=!1,t.value=!1});return(a,n)=>{const r=K,_=le;return c(),h(_,{modelValue:t.value,"onUpdate:modelValue":n[2]||(n[2]=m=>t.value=m),width:"1200px","close-on-click-modal":!1,title:e(s)("common.versionConflict"),"destroy-on-close":"",onClosed:n[3]||(n[3]=m=>e(o).closeDialog())},{footer:l(()=>[u(ne,{onConfirm:p,onCancel:n[1]||(n[1]=m=>t.value=!1)},{"extra-buttons":l(()=>[u(r,{type:"danger",round:"",onClick:b},{default:l(()=>[D(f(e(s)("common.forceSave")),1)]),_:1})]),_:1})]),default:l(()=>{var m,x;return[d("div",ve,[d("div",be,f(e(s)("conflict.remote",{version:(m=e(o).conflict)==null?void 0:m.version})),1),d("div",ke,f(e(s)("conflict.local",{version:(x=e(o).model)==null?void 0:x.version})),1)]),e(o).conflict?(c(),h(te,{key:0,modified:e(o).model.body,"onUpdate:modified":n[0]||(n[0]=k=>e(o).model.body=k),class:"w-full h-400px",original:e(o).conflict.body,editable:""},null,8,["modified","original"])):P("",!0)]}),_:1},8,["modelValue","title"])}}});export{Le as D,Re as _,je as a};
