var de=Object.defineProperty,pe=Object.defineProperties;var _e=Object.getOwnPropertyDescriptors;var Q=Object.getOwnPropertySymbols;var fe=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable;var W=(m,e,n)=>e in m?de(m,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):m[e]=n,z=(m,e)=>{for(var n in e||(e={}))fe.call(e,n)&&W(m,n,e[n]);if(Q)for(var n of Q(e))ve.call(e,n)&&W(m,n,e[n]);return m},X=(m,e)=>pe(m,_e(e));var N=(m,e,n)=>new Promise((E,x)=>{var i=l=>{try{y(n.next(l))}catch(V){x(V)}},f=l=>{try{y(n.throw(l))}catch(V){x(V)}},y=l=>l.done?E(l.value):Promise.resolve(l.value).then(i,f);y((n=n.apply(m,e)).next())});import{_ as ge}from"./k-table.c1a07faa.js";import{d as H,g as S,c as M,h as ee,o as _,j as D,w as t,b as o,u as a,b7 as te,a as $,f as P,e as oe,aH as L,t as w,k as R,F as q,M as ye,cd as he,N as Ce,b6 as Y}from"./url.8f5ec20c.js";import{B as be}from"./breadcrumb.3432b615.js";import{g as K}from"./i18n.0d8cb6d1.js";import{u as Z}from"./replace-all.e310d26c.js";import{a as xe,b as ke,u as we,f as Ee}from"./commerce.82e7b5aa.js";import{b as Ve}from"./confirm.f89fa710.js";import{_ as ne}from"./index.d1d474c4.js";import{b as $e}from"./product.b6dfb18b.js";import{u as ae}from"./useFields.5995eb13.js";import{_ as G,c as Se}from"./index.1f093d3d.js";import{E as Pe}from"./index.ec3d8ab1.js";import{E as J,a as le}from"./index.8e0d96d6.js";import{E as se}from"./index.3d638063.js";import{E as re}from"./index.6ac167de.js";import{E as ie}from"./windi.dcba9a95.js";import{E as me}from"./index.c7806af3.js";import{E as ce}from"./index.38840738.js";import{b as De}from"./useLabels.3432d9c6.js";import{g as Be}from"./main.d919dab0.js";import{g as A}from"./string.75b81683.js";import{c as Te}from"./index.9a7a049b.js";import"./sortable.esm.a99254e8.js";import"./icon-button.a2edb33f.js";import"./index.36905e5d.js";import"./index.1d64e54f.js";import"./index.17321c3b.js";import"./isEqual.8058d1d5.js";import"./_baseIsEqual.f1f57955.js";import"./index.97ced36a.js";import"./event.776e7e11.js";import"./index.6e9a6658.js";import"./error.7e8331f1.js";import"./isNil.98bb3b88.js";import"./index.230671a2.js";/* empty css                                                               */import"./plugin-vue_export-helper.21dcd24c.js";import"./plugin-vue_export-helper.41ffa612.js";import"./logo-transparent.1566007e.js";import"./index.ab7ae43a.js";import"./index.1e651ffe.js";import"./scroll.9a94de30.js";import"./aria.75ec5909.js";import"./event.53b2ad83.js";import"./focus-trap.0c15535f.js";import"./validator.11bc55c7.js";import"./isEmpty.d2ee0b7e.js";import"./search-provider.8815ed27.js";import"./toNumber.6efebd6a.js";import"./last.e7aa49db.js";import"./_baseIndexOf.4d7985be.js";import"./style.67f0cdc4.js";import"./use-operation-dialog.1c7cf152.js";import"./media-list.vue_vue_type_style_index_0_scoped_true_lang.92552fc5.js";import"./file.f8555a01.js";import"./validate.b9ea657d.js";import"./index.3e5d2d38.js";import"./index.f2618a8f.js";import"./index.ddf78e53.js";import"./index.6943850d.js";import"./index.4ccd5d27.js";import"./index.6756a6f3.js";import"./_baseClone.24478792.js";import"./folder.8308bb9d.js";import"./use-date.3be35318.js";import"./dayjs.min.8b8ca7e9.js";import"./relations-tag.c8ada5d9.js";import"./page.be880a87.js";import"./guid.c1a40312.js";import"./use-copy-text.7801df9a.js";import"./index.43142d25.js";import"./browser.3a7f9e8c.js";import"./throttle.3f3ee457.js";import"./debounce.730e1961.js";import"./search-input.fe88eea7.js";/* empty css                                                                 */import"./_createCompounder.2027fb34.js";import"./color-picker.f4353bb4.js";import"./index.04b796f6.js";import"./position.a71853ef.js";import"./index.6d134d76.js";import"./image-cover.f73aef20.js";import"./media-dialog.6d9d43ca.js";import"./media.3136d42d.js";import"./index.ff2ed7f6.js";/* empty css                                                          *//* empty css                                                          */import"./layout.4c508974.js";import"./index.7d901c84.js";import"./utils.6f25662a.js";import"./index.66e12c37.js";import"./use-file-upload.e88ed30a.js";import"./index.337c36f2.js";import"./index.e68a3b8d.js";import"./index.fae306fc.js";import"./index.b7efef2a.js";import"./file.8c428cda.js";/* empty css                                                         */import"./image-editor.vue_vue_type_style_index_0_scoped_true_lang.8fc1c564.js";import"./refs.d2253dd4.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";const Fe=H({props:{excludes:null,modelValue:{type:Boolean}},emits:["update:modelValue","selected"],setup(m,{emit:e}){const n=m,{getColumns:E}=ae(),x=E([{name:"featuredImage",attrs:{width:80,align:"center"}},{name:"title"},{name:"variantsCount",attrs:{align:"center"}},{name:"inventory",attrs:{align:"center"}},{name:"active",attrs:{width:100,align:"center"}}]),{t:i}=K(),f=S(!0),y=S([]),l=M(()=>{let s=y.value;return n.excludes&&(s=s.filter(v=>!n.excludes.includes(v.id))),s});function V(){return N(this,null,function*(){var s=yield $e();y.value=s.map(v=>X(z({},v),{selected:!1}))})}const I=M(()=>l.value.some(s=>s.selected)&&l.value.some(s=>!s.selected)),k=M(()=>l.value.length&&l.value.every(s=>s.selected));function d(s){l.value.forEach(v=>v.selected=s)}ee(()=>{V()});function B(){e("selected",l.value.filter(s=>s.selected)),f.value=!1}return(s,v)=>{const T=Pe,p=J,r=le,C=se,c=ne,b=re;return _(),D(b,{"model-value":f.value,width:"800px",title:a(i)("common.selectProduct"),"close-on-click-modal":!1,onClosed:v[1]||(v[1]=g=>e("update:modelValue",!1))},{footer:t(()=>[o(c,{disabled:!a(l).some(g=>g.selected),onConfirm:B,onCancel:v[0]||(v[0]=g=>f.value=!1)},null,8,["disabled"])]),default:t(()=>[o(C,{"max-height":"400px"},{default:t(()=>[o(r,{data:a(l),class:"el-table--gray"},{default:t(()=>[o(p,{width:"60",align:"center"},{header:t(()=>[o(T,{size:"large",class:"!block !h-20px",indeterminate:a(I),"model-value":a(k),onChange:d},null,8,["indeterminate","model-value"])]),default:t(({row:g})=>[o(T,{modelValue:g.selected,"onUpdate:modelValue":h=>g.selected=h,size:"large"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),o(G,{columns:a(x)},null,8,["columns"])]),_:1},8,["data"])]),_:1})]),_:1},8,["model-value","title"])}}}),Ie={class:"space-y-12"},Ne={class:"flex items-center"},Ae=H({props:{editable:{type:Boolean},categoryId:null,modelValue:{type:Boolean}},emits:["update:modelValue","reload"],setup(m,{emit:e}){const n=m,{t:E}=K(),x=S(!0),i=S(),f=S(!1),{getColumns:y}=ae(),l=y([{name:"featuredImage",attrs:{width:80,align:"center"}},{name:"title"},{name:"variantsCount",attrs:{align:"center"}},{name:"inventory",attrs:{align:"center"}},{name:"active",attrs:{width:100,align:"center"}}]);xe(n.categoryId).then(k=>{i.value=k});function V(k){var d;(d=i.value)==null||d.push(...k)}function I(){return N(this,null,function*(){yield ke(n.categoryId,i.value.map(k=>k.id)),x.value=!1,e("reload")})}return(k,d)=>{var g;const B=ie,s=me,v=ce,T=J,p=le,r=se,C=ne,c=re,b=te("hasPermission");return _(),$(q,null,[o(c,{"model-value":x.value,width:"850px",title:a(E)("common.products"),"close-on-click-modal":!1,onClosed:d[2]||(d[2]=h=>e("update:modelValue",!1))},{footer:t(()=>[o(C,{onConfirm:I,onCancel:d[1]||(d[1]=h=>x.value=!1)})]),default:t(()=>[P("div",Ie,[m.editable?oe((_(),D(s,{key:0,round:"",onClick:d[0]||(d[0]=h=>f.value=!0)},{default:t(()=>[P("div",Ne,[o(B,{class:"mr-16 iconfont icon-a-addto"}),L(" "+w(a(E)("common.addProduct")),1)])]),_:1})),[[b,{feature:"productCategories",action:"edit"}]]):R("",!0),o(r,{"max-height":"400px"},{default:t(()=>[o(p,{data:i.value,class:"el-table--gray"},{default:t(()=>[o(G,{columns:a(l)},null,8,["columns"]),m.editable?(_(),D(T,{key:0,align:"right",width:"60"},{default:t(({row:h})=>[o(v,{placement:"top",content:a(E)("common.delete")},{default:t(()=>[o(B,{class:"iconfont icon-delete hover:text-blue text-l",onClick:O=>i.value=i.value.filter(j=>j.id!=h.id)},null,8,["onClick"])]),_:2},1032,["content"])]),_:1})):R("",!0)]),_:1},8,["data"])]),_:1})])]),_:1},8,["model-value","title"]),f.value?(_(),D(Fe,{key:0,modelValue:f.value,"onUpdate:modelValue":d[3]||(d[3]=h=>f.value=h),excludes:(g=i.value)==null?void 0:g.map(h=>h.id),onSelected:V},null,8,["modelValue","excludes"])):R("",!0)],64)}}}),Le={class:"p-24"},Me={class:"flex items-center py-24 space-x-16"},Re={class:"flex items-center"},Ue={class:"flex items-center"},ze={class:"text-black dark:text-[#cfd3dc]"},je={class:"inline-flex flex-wrap gap-4"},qe={key:0,class:"text-s"},He={key:0},Ke={key:1,class:"text-s"},jo=H({setup(m){const{t:e}=K(),n=ye(),E=he(),x=n.meta.title,i=we(),f=S(),y=S(!1),l=S(i.settings);i.loadSettings().then(()=>{l.value=i.settings});const{getFieldDisplayName:V}=De(),I=Be(),k={image:{width:80}},d={"min-width":180};function B(p){return N(this,null,function*(){yield Ve(p.length),yield Ee(p.map(r=>r.id)),i.loadCategories()})}const s=M(()=>{var C;const p=(C=l.value.categoryCustomFields)!=null?C:[];let r=p.filter(c=>c.isSummaryField);return r.length||(r=p.slice(0,2)),r.map(c=>({name:Se(c.name),displayName:V(c),controlType:c.type,multipleValue:c.multiple,attrs:z(z({},d),A(k,c.name))}))}),v=M(()=>{var p;return((p=i.categories)!=null?p:[]).map(r=>{var c;const C=(c=A(r,"customData"))!=null?c:{};for(const b of s.value)if(!A(r,b.name)){const g=A(C,b.name);if(!g)continue;r[b.name]=A(g,I.default)}return r})});function T(p){f.value=p,y.value=!0}return ee(()=>N(this,null,function*(){i.loadCategories()})),(p,r)=>{const C=ie,c=me,b=Te,g=ce,h=Ce("router-link"),O=J,j=ge,ue=te("hasPermission");return _(),$("div",Le,[o(be,{name:a(x)},null,8,["name"]),P("div",Me,[oe((_(),D(c,{round:"",onClick:r[0]||(r[0]=u=>a(E).push(a(Z)({name:"product category create"})))},{default:t(()=>[P("div",Re,[o(C,{class:"mr-16 iconfont icon-a-addto"}),L(" "+w(a(e)("common.create")),1)])]),_:1})),[[ue,{feature:"productCategories",action:"edit"}]])]),o(j,{data:a(v),"show-check":"",onDelete:B},{default:t(()=>[o(G,{columns:a(s)},{title:t(({row:u})=>[P("div",Ue,[P("span",ze,w(u.title),1)])]),tags:t(({row:u})=>[P("div",je,[(_(!0),$(q,null,Y(u.tags,(F,U)=>(_(),D(b,{key:U,round:"",size:"small",type:"warning"},{default:t(()=>[L(w(F),1)]),_:2},1024))),128))])]),productCount:t(({row:u})=>[o(b,{round:"",class:"cursor-pointer",type:"success",onClick:F=>T(u)},{default:t(()=>[L(w(u.productCount),1)]),_:2},1032,["onClick"])]),condition:t(({row:u})=>[u.type=="Automated"?(_(),$("div",qe,[(_(!0),$(q,null,Y(u.condition.items,(F,U)=>(_(),$("div",{key:U},[U>0?(_(),$("span",He,w(u.condition.isAny?a(e)("common.or"):a(e)("common.and")),1)):R("",!0),L(" "+w(F.option)+" "+w(F.method)+" "+w(F.value),1)]))),128))])):(_(),$("span",Ke,w(a(e)("common.manual")),1))]),_:1},8,["columns"]),o(O,{align:"right",width:"60"},{default:t(({row:u})=>[o(h,{to:a(Z)({name:"product category edit",query:{id:u.id}}),class:"mx-8"},{default:t(()=>[o(g,{placement:"top",content:a(e)("common.edit")},{default:t(()=>[o(C,{class:"iconfont icon-a-writein hover:text-blue text-l"})]),_:1},8,["content"])]),_:2},1032,["to"])]),_:1})]),_:1},8,["data"]),y.value?(_(),D(Ae,{key:0,modelValue:y.value,"onUpdate:modelValue":r[1]||(r[1]=u=>y.value=u),"category-id":f.value.id,editable:f.value.type=="Manual",onReload:r[2]||(r[2]=u=>a(i).loadCategories())},null,8,["modelValue","category-id","editable"])):R("",!0)])}}});export{jo as default};
