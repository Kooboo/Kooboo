var O=(E,f,r)=>new Promise((o,t)=>{var b=i=>{try{x(r.next(i))}catch(c){t(c)}},u=i=>{try{x(r.throw(i))}catch(c){t(c)}},x=i=>i.done?o(i.value):Promise.resolve(i.value).then(b,u);x((r=r.apply(E,f)).next())});import{_ as _e}from"./tooltip.28a451cc.js";import{g as M,w as P}from"./i18n.48bd28ac.js";import{_ as be}from"./index.f237f871.js";import{B as ye}from"./breadcrumb.80c136b8.js";import{u as Ve}from"./use-shortcuts.21ce2d8e.js";import{E as ge,F as ke,G as xe,u as we,H as Ee,I as Se,C as Te}from"./commerce.f8d3336c.js";import{r as $e}from"./index.0f940e7f.js";import{u as Ce}from"./email.196eb60e.js";import{_ as ue}from"./index.051a5017.js";import{_ as le}from"./index.a731e53b.js";import{a as L,u as he,b as Ue,q as Ne}from"./validate.efc4a5c0.js";import{_ as Ae,R as De}from"./dev-mode.c4133b5a.js";import{_ as Be}from"./index.b8d82b9a.js";import{E as oe,a as te,c as me}from"./index.0d2684bf.js";import{E as X,a as Q}from"./index.6855d037.js";import{E as Ie}from"./index.77edae39.js";import{E as re,a as ie}from"./index.695d0284.js";import{E as Re}from"./index.8ef89ff6.js";import{E as ae}from"./index.fc90f5ad.js";import{E as W}from"./index.c4e9b529.js";import{d as q,g as V,i as J,K as je,o as p,j as $,w as l,b as e,u as m,a as U,b6 as F,F as D,f as _,k as A,aH as R,t as S}from"./url.2e6a77c4.js";import{E as z}from"./windi.a5b0b048.js";import{E as ne}from"./index.2bc50276.js";import{E as Oe}from"./index.d4bbb472.js";import{E as de}from"./index.cbddf8eb.js";import{_ as pe}from"./k-table.d4486972.js";import{u as ce}from"./use-date.01b82ce0.js";import{E as ve}from"./index.b494e80e.js";import{E as fe}from"./index.379e80ad.js";import{E as qe,a as Fe}from"./index.3abc9b92.js";import{E as Le}from"./index.968f79fd.js";import"./replace-all.7cf5f327.js";import"./main.ea42d807.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";/* empty css                                                               */import"./plugin-vue_export-helper.21dcd24c.js";import"./plugin-vue_export-helper.41ffa612.js";import"./index.a439b087.js";import"./error.7e8331f1.js";import"./classCompletion.a22e38a6.js";import"./userWorker.b3a6730b.js";import"./editor.main.d2800f63.js";import"./guid.c1a40312.js";import"./vuedraggable.umd.5840ebc7.js";import"./cloneDeep.ff43c1f8.js";import"./_baseClone.adbc92f5.js";import"./_baseIsEqual.c0d7e77a.js";import"./index.d75a71d9.js";import"./index.8b079f71.js";import"./index.aba77680.js";import"./index.6d45a031.js";import"./index.31f26a0f.js";import"./index.60af85f4.js";import"./style.19d0c187.js";import"./toNumber.574be4f1.js";import"./config.9fb52765.js";import"./dark.ddf8665a.js";import"./page.831d1a45.js";import"./index.99c4f65d.js";import"./index.603c1365.js";import"./scroll.f51de5d8.js";import"./aria.75ec5909.js";import"./event.53b2ad83.js";import"./focus-trap.23f44899.js";import"./isNil.98bb3b88.js";import"./validator.e2869aba.js";import"./index.fcc3ea42.js";import"./index.ff0264f3.js";import"./index.f5a869bb.js";import"./dropdown.0507a1c7.js";import"./refs.4001ce17.js";import"./use-copy-text.a346ed23.js";import"./index.c6df1b45.js";import"./toggleComment.5b29ca87.js";import"./use-save-tip.04d9878f.js";import"./confirm.e2c924ff.js";import"./logo-transparent.1566007e.js";import"./icon-button.3313e42d.js";import"./index.8262f5ef.js";import"./index.66d5d547.js";import"./index.232e741a.js";import"./index.af90dc36.js";import"./index.470f0e7e.js";import"./index.deca86b5.js";import"./alert.583ccfe6.js";import"./index.fafb14b3.js";import"./media-list.vue_vue_type_style_index_0_scoped_true_lang.118b18f5.js";/* empty css                                                          */import"./file.b0d4cc6e.js";/* empty css                                                          *//* empty css                                                                 */import"./use-file-upload.82732353.js";/* empty css                                                         */import"./image-editor.vue_vue_type_style_index_0_scoped_true_lang.f6d26366.js";import"./image-editor.846c8dc6.js";import"./main.esm.5190fb65.js";import"./index.f01d4ffd.js";import"./_baseUniq.c69c2d82.js";import"./_baseIndexOf.4d7985be.js";import"./event.776e7e11.js";import"./isEqual.f1ae9fb3.js";import"./debounce.61c67278.js";import"./index.064c7de9.js";import"./index.e3f90979.js";import"./sortable.esm.a99254e8.js";import"./index.7034978e.js";import"./dayjs.min.0a66969b.js";const Me={class:"flex items-center space-x-8 w-full"},Je={key:0,class:"border border-line rounded-normal p-8"},Pe=q({props:{modelValue:{type:Boolean},events:null,model:null},emits:["update:model-value","success"],setup(E,{emit:f}){var a,T,k;const r=E,o=V(),{t}=M(),b=V(!0),u=V(!!((T=(a=r.model)==null?void 0:a.sendToAddresses)!=null&&T.length)),x=V("preview"),i=V(),c=[{key:"preview",value:t("common.preview")},{key:"code",value:t("common.code")}],d=V(JSON.parse(JSON.stringify((k=r.model)!=null?k:{event:"",subjectTemplate:"",bodyTemplate:"",sendToCustomer:!0,sendToAddresses:[]}))),n={event:[L(t("common.eventRequiredTips"))]};function g(){return O(this,null,function*(){yield o.value.validate(),f("success",d.value),b.value=!1})}return J([()=>x.value,()=>d.value.event],()=>O(this,null,function*(){x.value!="preview"||!d.value.event||(yield je(),i.value=yield ge(d.value))}),{immediate:!0}),J(()=>d.value.event,()=>{const y=r.events.find(s=>s.name==d.value.event);y&&(d.value.subjectTemplate=y.mailSubjectTemplate,d.value.bodyTemplate=y.mailBodyTemplate)}),J(()=>u.value,()=>{u.value||(d.value.sendToAddresses=[])}),(y,s)=>{const v=oe,h=te,B=X,N=Ie,K=re,H=ie,Y=Re,Z=ue,ee=ae,j=Q,G=W;return p(),$(G,{modelValue:b.value,"onUpdate:modelValue":s[8]||(s[8]=I=>b.value=I),width:"800px","close-on-click-modal":!1,title:m(t)("common.emailNotifications"),onClosed:s[9]||(s[9]=I=>f("update:model-value",!1))},{footer:l(()=>[e(le,{onConfirm:g,onCancel:s[7]||(s[7]=I=>b.value=!1)})]),default:l(()=>[e(j,{ref_key:"form",ref:o,model:d.value,"label-position":"top",rules:n,class:"space-y-12"},{default:l(()=>{var I,w,se;return[e(B,{label:m(t)("common.event"),prop:"event"},{default:l(()=>[e(h,{modelValue:d.value.event,"onUpdate:modelValue":s[0]||(s[0]=C=>d.value.event=C),placeholder:m(t)("common.pleaseSelect"),class:"w-full"},{default:l(()=>[(p(!0),U(D,null,F(E.events,C=>(p(),$(v,{key:C.name,value:C.name,label:C.display},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e(B,{label:m(t)("common.sendTo")},{default:l(()=>[_("div",Me,[e(N,{modelValue:d.value.sendToCustomer,"onUpdate:modelValue":s[1]||(s[1]=C=>d.value.sendToCustomer=C),class:"flex-shrink-0",label:m(t)("common.customer")},null,8,["modelValue","label"]),e(N,{modelValue:u.value,"onUpdate:modelValue":s[2]||(s[2]=C=>u.value=C),class:"flex-shrink-0",label:m(t)("common.partner")},null,8,["modelValue","label"]),u.value?(p(),$(Be,{key:0,modelValue:d.value.sendToAddresses,"onUpdate:modelValue":s[3]||(s[3]=C=>d.value.sendToAddresses=C),class:"flex-1 w-full","disable-query":"","input-value":d.value.sendToAddresses,"data-cy":"bcc"},null,8,["modelValue","input-value"])):A("",!0)])]),_:1},8,["label"]),d.value.event?(p(),U(D,{key:0},[e(H,{modelValue:x.value,"onUpdate:modelValue":s[4]||(s[4]=C=>x.value=C),class:"el-radio-group--rounded"},{default:l(()=>[(p(),U(D,null,F(c,C=>e(K,{key:C.key,label:C.key},{default:l(()=>[R(S(C.value),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"]),x.value=="preview"?(p(),U("div",Je,[_("h1",null,"Subject: "+S((I=i.value)==null?void 0:I.subjectTemplate),1),e(Y,{class:"my-12"}),e(Z,{class:"h-300px",content:(se=(w=i.value)==null?void 0:w.bodyTemplate)!=null?se:""},null,8,["content"])])):(p(),U(D,{key:1},[e(B,{label:m(t)("common.subject"),prop:"subjectTemplate"},{default:l(()=>[e(ee,{modelValue:d.value.subjectTemplate,"onUpdate:modelValue":s[5]||(s[5]=C=>d.value.subjectTemplate=C)},null,8,["modelValue"])]),_:1},8,["label"]),e(B,{label:m(t)("common.content"),prop:"bodyTemplate"},{default:l(()=>[e(Ae,{modelValue:d.value.bodyTemplate,"onUpdate:modelValue":s[6]||(s[6]=C=>d.value.bodyTemplate=C),class:"border border-999",language:"html","k-script":""},null,8,["modelValue"])]),_:1},8,["label"])],64))],64)):A("",!0)]}),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),We={class:"space-y-4 w-full"},ze={class:"text-666 dark:text-fff/67 flex items-center pl-16 pr-8 w-full border-line dark:border-666 rounded-normal border border-solid ellipsis bg-fff dark:bg-[#333]","data-cy":"added-item"},Ke={class:"overflow-hidden leading-40px flex-1 mr-8 ellipsis","data-cy":"text"},He={class:"p-4"},Ge={class:"p-4"},Xe=q({props:{items:null,events:null},setup(E){const f=E,r=V(!1),o=V();function t(){o.value=void 0,r.value=!0}function b(i){if(o.value){const c=f.items.indexOf(o.value);f.items.splice(c,1,i)}else f.items.push(i)}function u(i){o.value=i,r.value=!0}function x(i){f.items.splice(i,1)}return(i,c)=>{const d=me,n=z,g=ne;return p(),U("div",We,[(p(!0),U(D,null,F(E.items,(a,T)=>{var k;return p(),U("div",{key:T},[_("div",ze,[_("div",Ke,S((k=E.events.find(y=>y.name==a.event))==null?void 0:k.description),1),_("div",null,[e(d,{round:""},{default:l(()=>{var y;return[R(S((y=E.events.find(s=>s.name==a.event))==null?void 0:y.display),1)]}),_:2},1024)]),_("div",He,[e(n,{class:"iconfont icon-a-setup cursor-pointer","data-cy":"edit",onClick:P(y=>u(a),["stop"])},null,8,["onClick"])]),_("div",Ge,[e(n,{class:"text-orange iconfont icon-delete cursor-pointer",color:"#fab6b6","data-cy":"remove",onClick:P(y=>x(T),["stop"])},null,8,["onClick"])])])])}),128)),e(g,{circle:"","data-cy":"add",onClick:t},{default:l(()=>[e(n,{class:"text-blue iconfont icon-a-addto"})]),_:1}),_("div",null,[r.value?(p(),$(Pe,{key:0,modelValue:r.value,"onUpdate:modelValue":c[0]||(c[0]=a=>r.value=a),events:E.events,model:o.value,onSuccess:b},null,8,["modelValue","events","model"])):A("",!0)])])}}}),Qe=q({props:{modelValue:{type:Boolean},model:null},emits:["update:model-value","success"],setup(E,{emit:f}){var c;const r=E,o=V(),{t}=M(),b=V(!0),u=V(JSON.parse(JSON.stringify((c=r.model)!=null?c:{server:"",port:"",ssl:!1,userName:"",password:"",from:""}))),x={server:[he(t("common.serverUrlInvalid")),L(t("common.serverUrlRequiredTips"))],port:[Ue()],userName:[L(t("common.inputAccountTips"))],password:[L(t("common.inputPasswordTips"))]};function i(){return O(this,null,function*(){yield o.value.validate(),f("success",u.value),b.value=!1})}return(d,n)=>{const g=ae,a=X,T=Oe,k=de,y=Q,s=W;return p(),$(s,{modelValue:b.value,"onUpdate:modelValue":n[7]||(n[7]=v=>b.value=v),width:"600px","close-on-click-modal":!1,title:m(t)("common.sendingServerSettings"),onClosed:n[8]||(n[8]=v=>f("update:model-value",!1))},{footer:l(()=>[e(le,{onConfirm:i,onCancel:n[6]||(n[6]=v=>b.value=!1)})]),default:l(()=>[e(y,{ref_key:"form",ref:o,model:u.value,"label-position":"top",rules:x,class:"space-y-12"},{default:l(()=>[e(a,{label:m(t)("common.server"),prop:"server"},{default:l(()=>[e(g,{modelValue:u.value.server,"onUpdate:modelValue":n[0]||(n[0]=v=>u.value.server=v),placeholder:"smtp.qq.com"},null,8,["modelValue"])]),_:1},8,["label"]),e(a,{label:m(t)("common.port")},{default:l(()=>[e(T,{modelValue:u.value.port,"onUpdate:modelValue":n[1]||(n[1]=v=>u.value.port=v),modelModifiers:{number:!0},placeholder:"587"},null,8,["modelValue"])]),_:1},8,["label"]),e(a,{label:"SSL"},{default:l(()=>[e(k,{modelValue:u.value.ssl,"onUpdate:modelValue":n[2]||(n[2]=v=>u.value.ssl=v)},null,8,["modelValue"])]),_:1}),e(a,{label:m(t)("common.account"),prop:"userName"},{default:l(()=>[e(g,{modelValue:u.value.userName,"onUpdate:modelValue":n[3]||(n[3]=v=>u.value.userName=v),placeholder:"name@example.com"},null,8,["modelValue"])]),_:1},8,["label"]),e(a,{label:m(t)("common.password"),prop:"password"},{default:l(()=>[e(g,{modelValue:u.value.password,"onUpdate:modelValue":n[4]||(n[4]=v=>u.value.password=v),type:"password"},null,8,["modelValue"])]),_:1},8,["label"]),e(a,{label:m(t)("common.fromAddress")},{default:l(()=>[e(g,{modelValue:u.value.from,"onUpdate:modelValue":n[5]||(n[5]=v=>u.value.from=v),placeholder:"name@example.com"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),Ye=q({props:{modelValue:{type:Boolean},events:null,model:null},emits:["update:model-value","success"],setup(E,{emit:f}){var c;const r=E,o=V(),{t}=M(),b=V(!0),u=V(JSON.parse(JSON.stringify((c=r.model)!=null?c:{event:"",url:""}))),x={url:[Ne(t("common.urlInvalid")),L(t("common.urlRequiredTips"))],event:[L(t("common.eventRequiredTips"))]};function i(){return O(this,null,function*(){yield o.value.validate(),f("success",u.value),b.value=!1})}return(d,n)=>{const g=oe,a=te,T=X,k=ae,y=Q,s=W;return p(),$(s,{modelValue:b.value,"onUpdate:modelValue":n[3]||(n[3]=v=>b.value=v),width:"600px","close-on-click-modal":!1,title:"Webhook",onClosed:n[4]||(n[4]=v=>f("update:model-value",!1))},{footer:l(()=>[e(le,{onConfirm:i,onCancel:n[2]||(n[2]=v=>b.value=!1)})]),default:l(()=>[e(y,{ref_key:"form",ref:o,model:u.value,"label-position":"top",rules:x,class:"space-y-12"},{default:l(()=>[e(T,{label:m(t)("common.event"),prop:"event"},{default:l(()=>[e(a,{modelValue:u.value.event,"onUpdate:modelValue":n[0]||(n[0]=v=>u.value.event=v),placeholder:m(t)("common.pleaseSelect"),class:"w-full"},{default:l(()=>[(p(!0),U(D,null,F(E.events,v=>(p(),$(g,{key:v.name,value:v.name,label:v.display},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e(T,{label:"URL",prop:"url"},{default:l(()=>[e(k,{modelValue:u.value.url,"onUpdate:modelValue":n[1]||(n[1]=v=>u.value.url=v)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}}),Ze={class:"space-y-4 w-full"},el={class:"text-666 dark:text-fff/67 flex items-center pl-16 pr-8 w-full border-line dark:border-666 rounded-normal border border-solid ellipsis bg-fff dark:bg-[#333]","data-cy":"added-item"},ll={class:"overflow-hidden leading-40px flex-1 mr-8 ellipsis","data-cy":"text"},ol={class:"p-4"},tl={class:"p-4"},al=q({props:{items:null,events:null},setup(E){const f=E,r=V(!1),o=V();function t(){o.value=void 0,r.value=!0}function b(i){if(o.value){const c=f.items.indexOf(o.value);f.items.splice(c,1,i)}else f.items.push(i)}function u(i){o.value=i,r.value=!0}function x(i){f.items.splice(i,1)}return(i,c)=>{const d=me,n=z,g=ne;return p(),U("div",Ze,[(p(!0),U(D,null,F(E.items,(a,T)=>{var k;return p(),U("div",{key:T},[_("div",el,[_("div",ll,S((k=E.events.find(y=>y.name==a.event))==null?void 0:k.description),1),_("div",null,[e(d,{round:""},{default:l(()=>{var y;return[R(S((y=E.events.find(s=>s.name==a.event))==null?void 0:y.display),1)]}),_:2},1024)]),_("div",ol,[e(n,{class:"iconfont icon-a-setup cursor-pointer","data-cy":"edit",onClick:P(y=>u(a),["stop"])},null,8,["onClick"])]),_("div",tl,[e(n,{class:"text-orange iconfont icon-delete cursor-pointer",color:"#fab6b6","data-cy":"remove",onClick:P(y=>x(T),["stop"])},null,8,["onClick"])])])])}),128)),e(g,{circle:"","data-cy":"add",onClick:t},{default:l(()=>[e(n,{class:"text-blue iconfont icon-a-addto"})]),_:1}),_("div",null,[r.value?(p(),$(Ye,{key:0,modelValue:r.value,"onUpdate:modelValue":c[0]||(c[0]=a=>r.value=a),events:E.events,model:o.value,onSuccess:b},null,8,["modelValue","events","model"])):A("",!0)])])}}}),nl=["onClick"],sl=q({props:{modelValue:{type:Boolean}},emits:["update:model-value"],setup(E,{emit:f}){const{t:r}=M(),o=V(!0),t=V(),b=V(!1),u=V(),x=i=>O(this,null,function*(){t.value=yield ke({pagenr:i})});return x(),(i,c)=>{var y;const d=ve,n=z,g=fe,a=pe,T=W,k=ue;return p(),U(D,null,[e(T,{modelValue:o.value,"onUpdate:modelValue":c[0]||(c[0]=s=>o.value=s),width:"1000px","close-on-click-modal":!1,title:m(r)("common.log"),onClosed:c[1]||(c[1]=s=>f("update:model-value",!1))},{default:l(()=>{var s,v,h,B;return[t.value?(p(),$(a,{key:0,data:(s=t.value)==null?void 0:s.dataList,pagination:{currentPage:(v=t.value)==null?void 0:v.pageNr,pageCount:(h=t.value)==null?void 0:h.totalPages,pageSize:(B=t.value)==null?void 0:B.pageSize},onChange:x},{default:l(()=>[e(d,{label:m(r)("common.email")},{default:l(({row:N})=>[_("span",null,S(N.address),1)]),_:1},8,["label"]),e(d,{label:m(r)("common.event"),width:"180"},{default:l(({row:N})=>[_("span",null,S(N.event),1)]),_:1},8,["label"]),e(d,{label:m(r)("common.content")},{default:l(({row:N})=>[_("span",{class:"text-blue cursor-pointer",onClick:K=>{u.value=N,b.value=!0}},S(N.subject),9,nl)]),_:1},8,["label"]),e(d,{label:m(r)("common.dateTime"),width:"180"},{default:l(({row:N})=>[_("span",null,S(m(ce)(new Date(N.timestamp))),1)]),_:1},8,["label"]),e(d,{label:m(r)("common.status"),width:"80",align:"center"},{default:l(({row:N})=>[!N.sent&&N.errorCount?(p(),$(g,{key:0,placement:"top-start",content:N.error},{default:l(()=>[e(n,{class:"iconfont icon-fasongshibai text-orange"})]),_:2},1032,["content"])):A("",!0),N.sent?(p(),$(g,{key:1,placement:"top-start",content:m(r)("common.deliverySuccessful")},{default:l(()=>[e(n,{class:"iconfont icon-fasongchenggong text-green"})]),_:1},8,["content"])):A("",!0)]),_:1},8,["label"])]),_:1},8,["data","pagination"])):A("",!0)]}),_:1},8,["modelValue","title"]),u.value?(p(),$(T,{key:0,modelValue:b.value,"onUpdate:modelValue":c[2]||(c[2]=s=>b.value=s),title:(y=u.value)==null?void 0:y.subject,width:"1200px"},{default:l(()=>{var s;return[e(k,{class:"h-600px",content:(s=u.value)==null?void 0:s.content},null,8,["content"])]}),_:1},8,["modelValue","title"])):A("",!0)],64)}}}),ul=["onClick"],ml={class:"max-h-600px overflow-auto"},rl=q({props:{modelValue:{type:Boolean}},emits:["update:model-value"],setup(E,{emit:f}){const{t:r}=M(),o=V(!0),t=V(),b=V(!1),u=V(),x=i=>O(this,null,function*(){t.value=yield xe({pagenr:i})});return x(),(i,c)=>{const d=ve,n=z,g=fe,a=pe,T=W;return p(),U(D,null,[e(T,{modelValue:o.value,"onUpdate:modelValue":c[0]||(c[0]=k=>o.value=k),width:"1000px","close-on-click-modal":!1,title:m(r)("common.log"),onClosed:c[1]||(c[1]=k=>f("update:model-value",!1))},{default:l(()=>{var k,y,s,v;return[t.value?(p(),$(a,{key:0,data:(k=t.value)==null?void 0:k.dataList,pagination:{currentPage:(y=t.value)==null?void 0:y.pageNr,pageCount:(s=t.value)==null?void 0:s.totalPages,pageSize:(v=t.value)==null?void 0:v.pageSize},onChange:x},{default:l(()=>[e(d,{label:"URL"},{default:l(({row:h})=>[_("span",null,S(h.address),1)]),_:1}),e(d,{label:m(r)("common.event"),width:"180"},{default:l(({row:h})=>[_("span",null,S(h.event),1)]),_:1},8,["label"]),e(d,{label:m(r)("common.content")},{default:l(({row:h})=>[_("span",{class:"text-blue cursor-pointer truncate",onClick:B=>{u.value=h,b.value=!0}},S(h.content),9,ul)]),_:1},8,["label"]),e(d,{label:m(r)("common.dateTime"),width:"180"},{default:l(({row:h})=>[_("span",null,S(m(ce)(new Date(h.timestamp))),1)]),_:1},8,["label"]),e(d,{label:m(r)("common.status"),width:"80",align:"center"},{default:l(({row:h})=>[!h.sent&&h.errorCount?(p(),$(g,{key:0,placement:"top-start",content:h.error},{default:l(()=>[e(n,{class:"iconfont icon-fasongshibai text-orange"})]),_:2},1032,["content"])):A("",!0),h.sent?(p(),$(g,{key:1,placement:"top-start",content:m(r)("common.success")},{default:l(()=>[e(n,{class:"iconfont icon-fasongchenggong text-green"})]),_:1},8,["content"])):A("",!0)]),_:1},8,["label"])]),_:1},8,["data","pagination"])):A("",!0)]}),_:1},8,["modelValue","title"]),u.value?(p(),$(T,{key:0,modelValue:b.value,"onUpdate:modelValue":c[2]||(c[2]=k=>b.value=k),title:m(r)("common.content"),width:"1200px"},{default:l(()=>[_("div",ml,[e(De,{data:JSON.parse(u.value.content)},null,8,["data"])])]),_:1},8,["modelValue","title"])):A("",!0)],64)}}}),il={class:"p-24 pb-150px"},dl={class:"rounded-normal bg-fff dark:bg-[#252526] mt-16 mb-24 py-24 px-56px relative"},pl={class:"max-w-504px"},cl={key:0,class:"flex items-center space-x-8 mb-12"},vl={class:"text-s text-999"},fl={class:"text-s text-999"},_l={class:"text-s text-999"},bl={class:"inline-flex items-center space-x-4"},yl={key:0,class:"rounded-normal bg-fff dark:bg-[#252526] mt-16 mb-24 py-24 px-56px relative"},Vl={class:"max-w-504px"},gl={class:"flex items-center"},kl=_("span",null,"Webhooks",-1),xl=R('SHA256Hash(request.body+secret)== request.header["X-Kooboo-Hmac-SHA256"]'),St=q({setup(E){const{t:f}=M(),r=we(),o=V(),t=V([]),b=V([]),u=Ce(),x=V(!1),i=V(!1),c=V(!1);Ee().then(g=>t.value=g),Se().then(g=>b.value=g);const d=[{key:"kooboo",value:"Kooboo"},{key:"custom",value:f("common.custom")}],n=()=>O(this,null,function*(){yield Te(o.value),r.loadSettings(),$e()});return J(()=>r.settings,()=>{o.value=JSON.parse(JSON.stringify(r.settings))},{immediate:!0}),J(()=>{var g;return(g=o.value)==null?void 0:g.mailServerType},()=>{var g;((g=o.value)==null?void 0:g.mailServerType)=="kooboo"&&u.loadAddress("addresses")},{immediate:!0}),Ve("save",n),(g,a)=>{const T=de,k=X,y=re,s=ie,v=ne,h=_e,B=oe,N=te,K=z,H=qe,Y=Fe,Z=Le,ee=Q;return p(),U("div",il,[e(ye,{name:m(f)("commerce.notification")},null,8,["name"]),o.value?(p(),$(ee,{key:0,"label-position":"top"},{default:l(()=>{var j,G,I;return[_("div",dl,[_("div",pl,[e(k,{label:m(f)("common.enableEmailNotification")},{default:l(()=>[e(T,{modelValue:o.value.enableEmailNotification,"onUpdate:modelValue":a[0]||(a[0]=w=>o.value.enableEmailNotification=w)},null,8,["modelValue"])]),_:1},8,["label"]),e(k,{label:m(f)("common.mailServer")},{default:l(()=>[e(s,{modelValue:o.value.mailServerType,"onUpdate:modelValue":a[1]||(a[1]=w=>o.value.mailServerType=w),class:"el-radio-group--rounded"},{default:l(()=>[(p(),U(D,null,F(d,w=>e(y,{key:w.key,label:w.key},{default:l(()=>[R(S(w.value),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1},8,["label"]),o.value.mailServerType=="custom"?(p(),U("div",cl,[e(v,{type:"primary",size:"small",round:"",onClick:a[2]||(a[2]=w=>x.value=!0)},{default:l(()=>[R(S(m(f)("common.setServerInfo")),1)]),_:1}),_("span",vl,S((j=o.value.customMailServer)==null?void 0:j.server),1),_("span",fl,S((G=o.value.customMailServer)==null?void 0:G.port),1),_("span",_l,S((I=o.value.customMailServer)==null?void 0:I.userName),1)])):(p(),$(k,{key:1},{label:l(()=>[_("div",bl,[_("div",null,S(m(f)("common.fromAddress")),1),e(h,{tip:m(f)("common.koobooEmailAddressTip"),"custom-class":"ml-4"},null,8,["tip"])])]),default:l(()=>[e(N,{modelValue:o.value.koobooEmailAddress,"onUpdate:modelValue":a[3]||(a[3]=w=>o.value.koobooEmailAddress=w),placeholder:m(f)("common.pleaseSelect"),class:"w-250px"},{default:l(()=>[(p(!0),U(D,null,F(m(u).addressList.filter(w=>w.addressType!=="Wildcard"),w=>(p(),$(B,{key:w.id,value:w.address,label:w.address},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1})),e(k,{label:m(f)("common.event")},{default:l(()=>[e(Xe,{items:o.value.emailNotifications,events:t.value},null,8,["items","events"])]),_:1},8,["label"])]),e(v,{round:"",size:"small",type:"primary",class:"absolute top-24 right-32",plain:"",onClick:a[4]||(a[4]=w=>i.value=!0)},{default:l(()=>[R(S(m(f)("common.logs")),1)]),_:1}),x.value?(p(),$(Qe,{key:0,modelValue:x.value,"onUpdate:modelValue":a[5]||(a[5]=w=>x.value=w),model:o.value.customMailServer,onSuccess:a[6]||(a[6]=w=>o.value.customMailServer=w)},null,8,["modelValue","model"])):A("",!0)]),o.value?(p(),U("div",yl,[_("div",Vl,[e(k,{label:m(f)("common.enableWebhook")},{default:l(()=>[e(T,{modelValue:o.value.enableWebhook,"onUpdate:modelValue":a[7]||(a[7]=w=>o.value.enableWebhook=w)},null,8,["modelValue"])]),_:1},8,["label"]),e(k,null,{label:l(()=>[_("div",gl,[kl,e(Z,{placement:"top-start",width:"600"},{reference:l(()=>[e(K,{class:"ml-4 iconfont icon-problem",onClick:a[8]||(a[8]=P(()=>{},["prevent"]))})]),default:l(()=>[e(Y,{title:m(f)("common.webhookDescription"),column:1,border:""},{default:l(()=>[e(H,{label:"secret"},{default:l(()=>[R(S(o.value.webhookSecret),1)]),_:1}),e(H,{label:"Verification"},{default:l(()=>[xl]),_:1})]),_:1},8,["title"])]),_:1})])]),default:l(()=>[e(al,{events:b.value,items:o.value.webhooks},null,8,["events","items"])]),_:1})]),e(v,{round:"",size:"small",type:"primary",class:"absolute top-24 right-32",plain:"",onClick:a[9]||(a[9]=w=>c.value=!0)},{default:l(()=>[R(S(m(f)("common.logs")),1)]),_:1})])):A("",!0)]}),_:1})):A("",!0),i.value?(p(),$(sl,{key:1,modelValue:i.value,"onUpdate:modelValue":a[10]||(a[10]=j=>i.value=j)},null,8,["modelValue"])):A("",!0),c.value?(p(),$(rl,{key:2,modelValue:c.value,"onUpdate:modelValue":a[11]||(a[11]=j=>c.value=j)},null,8,["modelValue"])):A("",!0),e(be,{"hidden-cancel":"",onSave:n})])}}});export{St as default};
