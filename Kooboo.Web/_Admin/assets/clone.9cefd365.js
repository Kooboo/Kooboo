var le=Object.defineProperty,te=Object.defineProperties;var se=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var Q=(d,e,m)=>e in d?le(d,e,{enumerable:!0,configurable:!0,writable:!0,value:m}):d[e]=m,P=(d,e)=>{for(var m in e||(e={}))ne.call(e,m)&&Q(d,m,e[m]);if(G)for(var m of G(e))me.call(e,m)&&Q(d,m,e[m]);return d},z=(d,e)=>te(d,se(e));var R=(d,e,m)=>new Promise((h,D)=>{var o=f=>{try{c(m.next(f))}catch(y){D(y)}},E=f=>{try{c(m.throw(f))}catch(y){D(y)}},c=f=>f.done?h(f.value):Promise.resolve(f.value).then(o,E);c((m=m.apply(d,e)).next())});import{_ as ue}from"./k-table.d4486972.js";import{_ as ie}from"./tooltip.28a451cc.js";import{g as re,o as de}from"./i18n.48bd28ac.js";import{a as pe}from"./index.8b079f71.js";import{a as ce,b as fe,c as ve}from"./index.6d45a031.js";import{d as _e}from"./create.1dc859b7.js";import{q as be,a as V,r as J,D as ye,d as ge,c as W,i as xe,s as Ve}from"./validate.efc4a5c0.js";import{d as Te,g as _,cd as De,i as I,o as b,a as T,f as i,t as r,u as s,b as t,w as n,F as q,b6 as X,j as C,k as O,aH as N,x as Ne}from"./url.2e6a77c4.js";import{b as Ee,x as Re,H as he}from"./main.ea42d807.js";import{S as we,E as ke,a as Ue}from"./index.6855d037.js";import{E as Se}from"./index.fc90f5ad.js";import{E as Pe,a as Ie}from"./index.0d2684bf.js";import{E as qe}from"./index.77edae39.js";import{E as Ce,a as Oe}from"./index.695d0284.js";import{E as Fe}from"./index.d4bbb472.js";import{E as Le}from"./index.2bc50276.js";import{E as Ae}from"./index.b494e80e.js";import"./sortable.esm.a99254e8.js";import"./icon-button.3313e42d.js";import"./windi.a5b0b048.js";import"./index.379e80ad.js";import"./focus-trap.23f44899.js";import"./isNil.98bb3b88.js";import"./event.53b2ad83.js";import"./index.ff0264f3.js";import"./index.8262f5ef.js";import"./index.fcc3ea42.js";import"./index.7034978e.js";import"./isEqual.f1ae9fb3.js";import"./_baseIsEqual.c0d7e77a.js";import"./error.7e8331f1.js";import"./replace-all.7cf5f327.js";import"./index.d75a71d9.js";import"./index.aba77680.js";import"./index.31f26a0f.js";import"./index.60af85f4.js";import"./style.19d0c187.js";import"./toNumber.574be4f1.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";import"./_baseClone.adbc92f5.js";import"./event.776e7e11.js";import"./index.a439b087.js";import"./scroll.f51de5d8.js";import"./debounce.61c67278.js";import"./index.064c7de9.js";import"./validator.e2869aba.js";import"./index.e3f90979.js";const Be={class:"text-444 dark:text-fff/86"},$e={class:"text-3l mb-8"},He={class:"text-s"},Ke={class:"border-t border-b border-line dark:border-[#555] border-solid my-24 py-24"},je={class:"flex items-center space-x-8"},Me={key:0,class:"text-444 text-s mt-24"},Ge={key:0,class:"flex space-x-16"},Qe={class:"flex flex-col"},ze={class:"text-s mt-4"},Je={class:"flex flex-col"},We={class:"text-s mt-4"},Xe={class:"flex items-center space-x-12"},zo=Te({setup(d){const{t:e}=re(),m=_(),h=De(),D=Ee(),o=_({rootDomain:"",subDomain:"",siteName:"",url:"",TotalPages:20,Depth:2,headless:!1,convertToRoot:!1}),E={auto:e("common.auto"),semiAuto:e("common.semiAuto"),manual:e("common.manual")},c=_(Object.keys(E)[0]),f=_([]),y=_([]),F=_(!1),L=_(!1),Y=()=>R(this,null,function*(){f.value=yield ce(o.value.url,o.value.TotalPages)}),A={url:[be(e("common.urlInvalid")),V(e("common.urlRequiredTips"))],subDomain:[V(e("common.subDomainRequiredTips")),J(1,63),ye,ge(o.value)],TotalPages:[W(),V(e("common.valueRequiredTips"))],Depth:[W(),V(e("common.valueRequiredTips"))],rootDomain:V(e("common.rootDomainRequiredTips")),siteName:[J(1,50),V(e("common.nameRequiredTips")),xe(Re,e("common.siteNameExistsTips")),Ve()]},w=_(!1),B=_();pe().then(u=>{m.value=u,m.value.length&&(o.value.rootDomain=m.value[0].domainName)}),I(()=>o.value.url,()=>R(this,null,function*(){f.value=[];try{yield new we({url:A.url}).validate(o.value),w.value=!0}catch(g){w.value=!1}var u="",a=!1;try{var v=new URL(o.value.url);u=v.host}catch(g){}finally{_e.forEach(function(g){u.indexOf(g,u.length-g.length)!==-1&&(a=!0,u=u.substr(0,u.lastIndexOf(g)))});var p=u.split("."),k=p[p.length-2+(a?1:0)];o.value.subDomain=k||""}}));const $=()=>R(this,null,function*(){yield B.value.validate();const u=P({},o.value);let a;c.value==="manual"?a=yield fe(z(P({},u),{Urls:y.value})):(c.value==="auto"&&(delete u.TotalPages,delete u.Depth),a=yield ve(u));const v=Ne("currentFolder");v&&(yield he({siteIds:[a.siteId],folderName:v})),h.replace({name:"transferring",query:{siteId:a.siteId,id:a.taskId,currentFolder:v}})});return I(()=>o.value.subDomain,()=>{F.value||(o.value.siteName=o.value.subDomain)}),I(()=>o.value.siteName,()=>{L.value||(o.value.subDomain=o.value.siteName)}),(u,a)=>{const v=Se,p=ke,k=Pe,g=Ie,U=ie,H=qe,Z=Ce,ee=Oe,S=Fe,K=Le,j=Ae,oe=ue,ae=Ue;return b(),T("div",Be,[i("p",$e,r(s(e)("common.cloneSite")),1),i("p",He,r(s(e)("common.cloneTips")),1),i("div",Ke,[t(ae,{ref_key:"form",ref:B,"label-position":"top",model:o.value,rules:s(A),onKeydown:de($,["enter"])},{default:n(()=>{var M;return[t(p,{label:"URL",prop:"url"},{default:n(()=>[t(v,{modelValue:o.value.url,"onUpdate:modelValue":a[0]||(a[0]=l=>o.value.url=l),autofocus:"",tabindex:"1",class:"w-394px",placeholder:s(e)("common.inputURLTips"),"data-cy":"url"},null,8,["modelValue","placeholder"])]),_:1}),t(p,{label:s(e)("common.siteName"),prop:"siteName"},{default:n(()=>[t(v,{modelValue:o.value.siteName,"onUpdate:modelValue":a[1]||(a[1]=l=>o.value.siteName=l),class:"w-394px","data-cy":"siteName",onInput:a[2]||(a[2]=l=>F.value=!0)},null,8,["modelValue"])]),_:1},8,["label"]),i("div",je,[t(p,{label:s(e)("common.domain"),prop:"subDomain"},{default:n(()=>[t(v,{modelValue:o.value.subDomain,"onUpdate:modelValue":a[3]||(a[3]=l=>o.value.subDomain=l),tabindex:"2",class:"w-394px","data-cy":"subdomain",onInput:a[4]||(a[4]=l=>L.value=!0)},null,8,["modelValue"])]),_:1},8,["label"]),t(p,{prop:"rootDomain",class:"mt-30px"},{default:n(()=>[t(g,{modelValue:o.value.rootDomain,"onUpdate:modelValue":a[5]||(a[5]=l=>o.value.rootDomain=l)},{default:n(()=>[(b(!0),T(q,null,X(m.value,l=>(b(),C(k,{key:l.domainName,value:l.domainName,label:"."+l.domainName,"data-cy":"root-domain-opt"},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),t(p,null,{default:n(()=>{var l;return[(l=s(D).header)!=null&&l.isOnlineServer?O("",!0):(b(),C(H,{key:0,modelValue:o.value.headless,"onUpdate:modelValue":a[6]||(a[6]=x=>o.value.headless=x)},{default:n(()=>[i("span",null,r(s(e)("common.useHeadlessMode")),1),t(U,{tip:s(e)("common.useHeadlessModeTip"),"custom-class":"ml-4"},null,8,["tip"])]),_:1},8,["modelValue"])),t(H,{modelValue:o.value.convertToRoot,"onUpdate:modelValue":a[7]||(a[7]=x=>o.value.convertToRoot=x)},{default:n(()=>[i("span",null,r(s(e)("common.trimSubPath")),1),t(U,{tip:s(e)("common.trimSubPathTip"),"custom-class":"ml-4"},null,8,["tip"])]),_:1},8,["modelValue"])]}),_:1}),(M=s(D).header)!=null&&M.isOnlineServer?(b(),T("p",Me,r(s(e)("common.cloneVersionTips")),1)):(b(),T(q,{key:1},[t(p,null,{default:n(()=>[t(ee,{modelValue:c.value,"onUpdate:modelValue":a[8]||(a[8]=l=>c.value=l),class:"el-radio-group--rounded"},{default:n(()=>[(b(),T(q,null,X(E,(l,x)=>t(Z,{key:x,label:x,"data-cy":`clone-type${l}`},{default:n(()=>[N(r(l),1)]),_:2},1032,["label","data-cy"])),64))]),_:1},8,["modelValue"])]),_:1}),c.value=="semiAuto"?(b(),T("div",Ge,[t(p,{label:s(e)("common.pages"),prop:"TotalPages"},{default:n(()=>[i("div",Qe,[t(S,{modelValue:o.value.TotalPages,"onUpdate:modelValue":a[9]||(a[9]=l=>o.value.TotalPages=l),min:1,"data-cy":"semiauto-pages"},null,8,["modelValue"]),i("p",ze,r(s(e)("common.maxAmountOfPagesToClone")),1)])]),_:1},8,["label"]),t(p,{label:s(e)("common.deeps"),prop:"Depth"},{default:n(()=>[i("div",Je,[t(S,{modelValue:o.value.Depth,"onUpdate:modelValue":a[10]||(a[10]=l=>o.value.Depth=l),"data-cy":"deeps",min:1},null,8,["modelValue"]),i("p",We,r(s(e)("common.theNumberOfClicksAwayFromHomePage")),1)])]),_:1},8,["label"])])):O("",!0),c.value=="manual"?(b(),C(oe,{key:1,data:f.value,"show-check":"","hide-delete":"","onUpdate:selectedData":a[12]||(a[12]=l=>y.value=l)},{bar:n(()=>[i("div",Xe,[i("div",null,[i("span",null,r(s(e)("common.pages")),1),t(U,{tip:s(e)("common.maxAmountOfPagesToClone"),"custom-class":"ml-4"},null,8,["tip"])]),t(p,{prop:"TotalPages",class:"mb-0"},{default:n(()=>[t(S,{modelValue:o.value.TotalPages,"onUpdate:modelValue":a[11]||(a[11]=l=>o.value.TotalPages=l),min:1,"data-cy":"manual-pages"},null,8,["modelValue"])]),_:1}),t(K,{round:"",type:"primary",disabled:!w.value,"data-cy":"scan",onClick:Y},{default:n(()=>[N(r(s(e)("common.scan")),1)]),_:1},8,["disabled"])])]),default:n(()=>[t(j,{width:"50px"},{default:n(l=>[N(r(l.$index+1),1)]),_:1}),t(j,{label:"URL"},{default:n(l=>[N(r(l.row),1)]),_:1})]),_:1},8,["data"])):O("",!0)],64))]}),_:1},8,["model","rules","onKeydown"])]),t(K,{round:"",type:"primary","data-cy":"start-clone",disabled:!y.value.length&&c.value==="manual",onClick:$},{default:n(()=>[N(r(s(e)("common.startClone")),1)]),_:1},8,["disabled"])])}}});export{zo as default};
