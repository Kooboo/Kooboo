var w=(k,d,m)=>new Promise((v,n)=>{var u=e=>{try{c(m.next(e))}catch(s){n(s)}},p=e=>{try{c(m.throw(e))}catch(s){n(s)}},c=e=>e.done?v(e.value):Promise.resolve(e.value).then(u,p);c((m=m.apply(k,d)).next())});import{g as S,w as F}from"./i18n.48bd28ac.js";import{u as U}from"./use-operation-dialog.f0f37a10.js";import{m as q,a as C,r as T,d as j}from"./validate.efc4a5c0.js";import{f as A,h as M,i as O,j as G,k as H}from"./index.8b079f71.js";import{d as h,M as Q,g as b,i as z,o as x,j as E,w as l,b as i,u as t,f as D,t as y,a as B,b6 as J,F as K,G as P,E as W,aH as X,cg as Y,x as Z}from"./url.2e6a77c4.js";import{_ as ee}from"./index.a731e53b.js";import{R as oe}from"./main.ea42d807.js";import{_ as te}from"./plugin-vue_export-helper.21dcd24c.js";import{E as ae}from"./index.fc90f5ad.js";import{E as le,a as ie}from"./index.6855d037.js";import{E as ne,a as se}from"./index.0d2684bf.js";import{E as me}from"./index.c4e9b529.js";import{_ as re}from"./k-table.d4486972.js";import{b as de}from"./confirm.e2c924ff.js";import{E as ue}from"./index.2bc50276.js";import{E as pe}from"./index.b494e80e.js";import"./index.d75a71d9.js";import"./index.aba77680.js";import"./replace-all.7cf5f327.js";import"./index.6d45a031.js";import"./index.31f26a0f.js";import"./index.60af85f4.js";import"./style.19d0c187.js";import"./toNumber.574be4f1.js";import"./_baseIsEqual.c0d7e77a.js";import"./index.50c16ae5.js";import"./windi.a5b0b048.js";import"./preload-helper.13a99eb0.js";import"./event.776e7e11.js";import"./index.ff0264f3.js";import"./error.7e8331f1.js";import"./isNil.98bb3b88.js";import"./_baseClone.adbc92f5.js";import"./isEqual.f1ae9fb3.js";import"./index.379e80ad.js";import"./focus-trap.23f44899.js";import"./event.53b2ad83.js";import"./index.a439b087.js";import"./index.fcc3ea42.js";import"./scroll.f51de5d8.js";import"./debounce.61c67278.js";import"./index.064c7de9.js";import"./validator.e2869aba.js";import"./index.603c1365.js";import"./refs.4001ce17.js";import"./sortable.esm.a99254e8.js";import"./icon-button.3313e42d.js";import"./index.8262f5ef.js";import"./index.7034978e.js";import"./index.77edae39.js";import"./index.695d0284.js";import"./logo-transparent.1566007e.js";import"./index.99c4f65d.js";import"./aria.75ec5909.js";const ce=["title"],fe=h({props:{modelValue:{type:Boolean},domain:null},emits:["create-success"],setup(k,{emit:d}){const m=k,v=Q(),{t:n}=S(),{visible:u,handleClose:p}=U(m,d),c=b(),e=b(),s=b(),o=b({subDomain:"",rootDomain:"",SiteId:""}),g={subDomain:[q,C(n("common.inputValue")),T(1,63),j(o.value)],SiteId:[C(n("common.inputValue"))]};z(()=>u.value,_=>w(this,null,function*(){var a,I;_&&(c.value=yield oe(),e.value=yield A(),(a=s.value)==null||a.resetFields(),o.value.subDomain="",o.value.rootDomain=e.value.filter(V=>V.id===v.query.id)[0].domainName,o.value.SiteId=(I=c.value[0])==null?void 0:I.siteId)}));function r(){var _;(_=s.value)==null||_.validate(a=>w(this,null,function*(){a&&(yield M(o.value.subDomain,o.value.rootDomain,o.value.SiteId),p(),d("create-success"))}))}return(_,a)=>{const I=ae,V=le,N=ne,R=se,L=ie,$=me;return x(),E($,{modelValue:t(u),"onUpdate:modelValue":a[3]||(a[3]=f=>P(u)?u.value=f:null),width:"600px","close-on-click-modal":!1,title:t(n)("common.newBinding"),onClose:t(p)},{footer:l(()=>[i(ee,{"confirm-label":t(n)("common.create"),onConfirm:r,onCancel:t(p)},null,8,["confirm-label","onCancel"])]),default:l(()=>[i(L,{ref_key:"form",ref:s,class:"el-form--label-normal",model:o.value,rules:t(g),"label-position":"top",onSubmit:a[2]||(a[2]=F(()=>{},["prevent"]))},{default:l(()=>[i(V,{prop:"subDomain",label:t(n)("common.domain")},{default:l(()=>[i(I,{modelValue:o.value.subDomain,"onUpdate:modelValue":a[0]||(a[0]=f=>o.value.subDomain=f),placeholder:"www","data-cy":"subdomain"},{append:l(()=>[D("span",{disabled:"",class:"ellipsis max-w-240px px-16 dark:bg-[#222] dark:rounded-tr-normal dark:rounded-br-normal dark:border-[#4c4d4f] dark:border-1 border-solid dark:border-l-0",title:o.value.rootDomain,"data-cy":"root-domain"},"."+y(o.value.rootDomain),9,ce)]),_:1},8,["modelValue"])]),_:1},8,["label"]),i(V,{prop:"SiteId",label:t(n)("common.site")},{default:l(()=>[i(R,{modelValue:o.value.SiteId,"onUpdate:modelValue":a[1]||(a[1]=f=>o.value.SiteId=f),class:"w-full"},{default:l(()=>[(x(!0),B(K,null,J(c.value,f=>(x(),E(N,{key:f.siteId,label:f.siteDisplayName,value:f.siteId,"data-cy":"site-opt"},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title","onClose"])}}});var _e=te(fe,[["__scopeId","data-v-7327bb0f"]]);const be={class:"p-24"},ve={class:"flex items-center pb-24 space-x-16"},ge={class:"flex items-center"},we=["href"],ko=h({setup(k){const{t:d}=S(),m=W({status:!1,open(){m.status=!0}}),v=e=>{Y("//"+e)},n=b(),u=b();function p(){return w(this,null,function*(){const e=Z("id");e&&(u.value=yield O(e),n.value=yield G(e))})}p();function c(e){return w(this,null,function*(){e.length&&(yield de(e.length),yield H(e.map(s=>s.id)),p())})}return(e,s)=>{const o=ue,g=pe;return x(),B("div",be,[D("div",ve,[i(o,{round:"",onClick:t(m).open},{default:l(()=>[D("div",ge,y(t(d)("common.new")),1)]),_:1},8,["onClick"])]),i(t(re),{data:u.value,"show-check":"",onDelete:c},{default:l(()=>[i(g,{label:t(d)("common.domain")},{default:l(({row:r})=>[D("span",null,y(r.fullName),1)]),_:1},8,["label"]),i(g,{label:t(d)("common.site")},{default:l(({row:r})=>[D("a",{class:"cursor-pointer text-blue",href:`/_Admin/site?SiteId=${r.webSiteId}`,target:"_blank","data-cy":"site-name"},y(r.siteName),9,we)]),_:1},8,["label"]),i(g,{width:"150px",align:"center"},{default:l(({row:r})=>[i(o,{type:"primary",round:"",onClick:_=>v(r.fullName)},{default:l(()=>[X(y(t(d)("common.preview")),1)]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),i(_e,{modelValue:t(m).status,"onUpdate:modelValue":s[0]||(s[0]=r=>t(m).status=r),domain:n.value,onCreateSuccess:p},null,8,["modelValue","domain"])])}}});export{ko as default};
