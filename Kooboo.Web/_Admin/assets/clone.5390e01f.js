var le=Object.defineProperty,te=Object.defineProperties;var se=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var Q=(p,e,s)=>e in p?le(p,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):p[e]=s,P=(p,e)=>{for(var s in e||(e={}))ne.call(e,s)&&Q(p,s,e[s]);if(G)for(var s of G(e))me.call(e,s)&&Q(p,s,e[s]);return p},z=(p,e)=>te(p,se(e));var E=(p,e,s)=>new Promise((U,T)=>{var o=f=>{try{v(s.next(f))}catch(g){T(g)}},h=f=>{try{v(s.throw(f))}catch(g){T(g)}},v=f=>f.done?U(f.value):Promise.resolve(f.value).then(o,h);v((s=s.apply(p,e)).next())});import{_ as ue}from"./k-table.b1a54b80.js";import{_ as ie}from"./tooltip.66155ff7.js";import{g as re,o as de}from"./i18n.a87944a4.js";import{a as pe}from"./index.d2657986.js";import{a as ce,b as ve,c as fe}from"./index.a24f458a.js";import{d as _e}from"./create.030ce360.js";import{q as be,a as D,r as J,b as ge,d as ye,g as W,i as xe,s as De}from"./validate.bb56f9e3.js";import{d as Ve,g as _,cd as Te,i as R,o as b,a as V,f as r,t as d,u as n,b as t,w as m,F as q,b7 as X,j as C,k as O,aI as N,x as Ne}from"./url.4cb47a7a.js";import{b as he,x as Ee,H as Re}from"./main.9fdfea92.js";import{S as Ue,E as we,a as ke}from"./index.9fd79879.js";import{E as Se}from"./index.178b9e08.js";import{E as Ie,a as Pe}from"./index.7c862087.js";import{E as qe}from"./index.42922617.js";import{E as Ce,a as Oe}from"./index.f15f695e.js";import{E as Fe}from"./index.6f16842c.js";import{E as Le}from"./index.361e2245.js";import{E as Ae}from"./index.b38edc72.js";import"./sortable.esm.a99254e8.js";import"./icon-button.74ccc970.js";import"./windi.6360286d.js";import"./index.d96452a6.js";import"./focus-trap.50a00b7f.js";import"./isNil.98bb3b88.js";import"./event.53b2ad83.js";import"./index.7b8c5aef.js";import"./index.4f90a917.js";import"./index.4d568055.js";import"./index.c6da2706.js";import"./isEqual.4cab74e3.js";import"./_baseIsEqual.dc9e64c4.js";import"./error.7e8331f1.js";import"./replace-all.56d2c1f7.js";import"./index.d24a40b9.js";import"./index.f23f1e38.js";import"./index.1fd72ea8.js";import"./index.abe211fa.js";import"./style.c350d462.js";import"./toNumber.47eea968.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";import"./_baseClone.b8903935.js";import"./event.776e7e11.js";import"./index.fd96ea36.js";import"./scroll.16983984.js";import"./debounce.4e0c106e.js";import"./index.66319a92.js";import"./validator.b5df2420.js";import"./index.e3f90979.js";const Be={class:"text-444 dark:text-fff/86"},$e={class:"text-3l mb-8"},He={class:"text-s"},Ke={class:"border-t border-b border-line dark:border-[#555] border-solid my-24 py-24"},je={class:"flex items-center space-x-8"},Me={key:0,class:"text-444 text-s mt-24"},Ge={key:0,class:"flex space-x-16"},Qe={class:"flex flex-col"},ze={class:"text-s mt-4"},Je={class:"flex flex-col"},We={class:"text-s mt-4"},Xe={class:"flex items-center space-x-12"},zo=Ve({setup(p){const{t:e}=re(),s=_(),U=Te(),T=he(),o=_({rootDomain:"",subDomain:"",siteName:"",url:"",TotalPages:20,Depth:2,headless:!1,convertToRoot:!1}),h={auto:e("common.auto"),semiAuto:e("common.semiAuto"),manual:e("common.manual")},v=_(Object.keys(h)[0]),f=_([]),g=_([]),F=_(!1),L=_(!1),Y=()=>E(this,null,function*(){f.value=yield ce(o.value.url,o.value.TotalPages)}),A={url:[be(e("common.urlInvalid")),D(e("common.urlRequiredTips"))],subDomain:[D(e("common.subDomainRequiredTips")),J(1,63),ge,ye(o.value)],TotalPages:[W(),D(e("common.valueRequiredTips"))],Depth:[W(),D(e("common.valueRequiredTips"))],rootDomain:D(e("common.rootDomainRequiredTips")),siteName:[J(1,50),D(e("common.nameRequiredTips")),xe(Ee,e("common.siteNameExistsTips")),De()]},w=_(!1),B=_();pe().then(u=>{s.value=u,s.value.length&&(o.value.rootDomain=s.value[0].domainName)}),R(()=>o.value.url,()=>E(this,null,function*(){f.value=[];try{yield new Ue({url:A.url}).validate(o.value),w.value=!0}catch(y){w.value=!1}var u="",a=!1;try{var c=new URL(o.value.url);u=c.host}catch(y){}finally{_e.forEach(function(y){u.indexOf(y,u.length-y.length)!==-1&&(a=!0,u=u.substr(0,u.lastIndexOf(y)))});var i=u.split("."),k=i[i.length-2+(a?1:0)];o.value.subDomain=k||""}}));const $=()=>E(this,null,function*(){yield B.value.validate();const u=P({},o.value);let a;v.value==="manual"?a=yield ve(z(P({},u),{Urls:g.value})):(v.value==="auto"&&(delete u.TotalPages,delete u.Depth),a=yield fe(u));const c=Ne("currentFolder");c&&(yield Re({siteIds:[a.siteId],folderName:c})),U.replace({name:"transferring",query:{siteId:a.siteId,id:a.taskId,currentFolder:c}})});return R(()=>o.value.subDomain,()=>{F.value||(o.value.siteName=o.value.subDomain)}),R(()=>o.value.rootDomain,()=>{var u,a,c;o.value.sudDomainUseDash=(c=(a=(u=s.value)==null?void 0:u.find(i=>i.domainName==o.value.rootDomain))==null?void 0:a.sudDomainUseDash)!=null?c:!1}),R(()=>o.value.siteName,()=>{L.value||(o.value.subDomain=o.value.siteName)}),(u,a)=>{const c=Se,i=we,k=Ie,y=Pe,S=ie,H=qe,Z=Ce,ee=Oe,I=Fe,K=Le,j=Ae,oe=ue,ae=ke;return b(),V("div",Be,[r("p",$e,d(n(e)("common.cloneSite")),1),r("p",He,d(n(e)("common.cloneTips")),1),r("div",Ke,[t(ae,{ref_key:"form",ref:B,"label-position":"top",model:o.value,rules:n(A),onKeydown:de($,["enter"])},{default:m(()=>{var M;return[t(i,{label:"URL",prop:"url"},{default:m(()=>[t(c,{modelValue:o.value.url,"onUpdate:modelValue":a[0]||(a[0]=l=>o.value.url=l),autofocus:"",tabindex:"1",class:"w-304px",placeholder:n(e)("common.inputURLTips"),"data-cy":"url"},null,8,["modelValue","placeholder"])]),_:1}),t(i,{label:n(e)("common.siteName"),prop:"siteName"},{default:m(()=>[t(c,{modelValue:o.value.siteName,"onUpdate:modelValue":a[1]||(a[1]=l=>o.value.siteName=l),class:"w-304px","data-cy":"siteName",onInput:a[2]||(a[2]=l=>F.value=!0)},null,8,["modelValue"])]),_:1},8,["label"]),r("div",je,[t(i,{label:n(e)("common.domain"),prop:"subDomain"},{default:m(()=>[t(c,{modelValue:o.value.subDomain,"onUpdate:modelValue":a[3]||(a[3]=l=>o.value.subDomain=l),tabindex:"2",class:"w-304px","data-cy":"subdomain",onInput:a[4]||(a[4]=l=>L.value=!0)},null,8,["modelValue"])]),_:1},8,["label"]),t(i,{prop:"rootDomain",class:"mt-30px"},{default:m(()=>[t(y,{modelValue:o.value.rootDomain,"onUpdate:modelValue":a[5]||(a[5]=l=>o.value.rootDomain=l),class:"!w-300px"},{default:m(()=>[(b(!0),V(q,null,X(s.value,l=>(b(),C(k,{key:l.domainName,value:l.domainName,label:(l.sudDomainUseDash?"-":".")+l.domainName,"data-cy":"root-domain-opt"},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),t(i,null,{default:m(()=>{var l;return[(l=n(T).header)!=null&&l.isOnlineServer?O("",!0):(b(),C(H,{key:0,modelValue:o.value.headless,"onUpdate:modelValue":a[6]||(a[6]=x=>o.value.headless=x)},{default:m(()=>[r("span",null,d(n(e)("common.useHeadlessMode")),1),t(S,{tip:n(e)("common.useHeadlessModeTip"),"custom-class":"ml-4"},null,8,["tip"])]),_:1},8,["modelValue"])),t(H,{modelValue:o.value.convertToRoot,"onUpdate:modelValue":a[7]||(a[7]=x=>o.value.convertToRoot=x)},{default:m(()=>[r("span",null,d(n(e)("common.trimSubPath")),1),t(S,{tip:n(e)("common.trimSubPathTip"),"custom-class":"ml-4"},null,8,["tip"])]),_:1},8,["modelValue"])]}),_:1}),(M=n(T).header)!=null&&M.isOnlineServer?(b(),V("p",Me,d(n(e)("common.cloneVersionTips")),1)):(b(),V(q,{key:1},[t(i,null,{default:m(()=>[t(ee,{modelValue:v.value,"onUpdate:modelValue":a[8]||(a[8]=l=>v.value=l),class:"el-radio-group--rounded"},{default:m(()=>[(b(),V(q,null,X(h,(l,x)=>t(Z,{key:x,label:x,"data-cy":`clone-type${l}`},{default:m(()=>[N(d(l),1)]),_:2},1032,["label","data-cy"])),64))]),_:1},8,["modelValue"])]),_:1}),v.value=="semiAuto"?(b(),V("div",Ge,[t(i,{label:n(e)("common.pages"),prop:"TotalPages"},{default:m(()=>[r("div",Qe,[t(I,{modelValue:o.value.TotalPages,"onUpdate:modelValue":a[9]||(a[9]=l=>o.value.TotalPages=l),min:1,"data-cy":"semiauto-pages"},null,8,["modelValue"]),r("p",ze,d(n(e)("common.maxAmountOfPagesToClone")),1)])]),_:1},8,["label"]),t(i,{label:n(e)("common.deeps"),prop:"Depth"},{default:m(()=>[r("div",Je,[t(I,{modelValue:o.value.Depth,"onUpdate:modelValue":a[10]||(a[10]=l=>o.value.Depth=l),"data-cy":"deeps",min:1},null,8,["modelValue"]),r("p",We,d(n(e)("common.theNumberOfClicksAwayFromHomePage")),1)])]),_:1},8,["label"])])):O("",!0),v.value=="manual"?(b(),C(oe,{key:1,data:f.value,"show-check":"","hide-delete":"","onUpdate:selectedData":a[12]||(a[12]=l=>g.value=l)},{bar:m(()=>[r("div",Xe,[r("div",null,[r("span",null,d(n(e)("common.pages")),1),t(S,{tip:n(e)("common.maxAmountOfPagesToClone"),"custom-class":"ml-4"},null,8,["tip"])]),t(i,{prop:"TotalPages",class:"mb-0"},{default:m(()=>[t(I,{modelValue:o.value.TotalPages,"onUpdate:modelValue":a[11]||(a[11]=l=>o.value.TotalPages=l),min:1,"data-cy":"manual-pages"},null,8,["modelValue"])]),_:1}),t(K,{round:"",type:"primary",disabled:!w.value,"data-cy":"scan",onClick:Y},{default:m(()=>[N(d(n(e)("common.scan")),1)]),_:1},8,["disabled"])])]),default:m(()=>[t(j,{width:"50px"},{default:m(l=>[N(d(l.$index+1),1)]),_:1}),t(j,{label:"URL"},{default:m(l=>[N(d(l.row),1)]),_:1})]),_:1},8,["data"])):O("",!0)],64))]}),_:1},8,["model","rules","onKeydown"])]),t(K,{round:"",type:"primary","data-cy":"start-clone",disabled:!g.value.length&&v.value==="manual",onClick:$},{default:m(()=>[N(d(n(e)("common.startClone")),1)]),_:1},8,["disabled"])])}}});export{zo as default};
