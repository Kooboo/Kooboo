import{b as P,_ as A,a as L,c as N,d as Q,e as j}from"./basic.07a117d3.js";import{g as G,u as H}from"./main.ea42d807.js";import{K as z,L as J}from"./dev-mode.c4133b5a.js";import{e as R}from"./guid.c1a40312.js";import{c as v,d as W,g as k,aV as X,o as h,j as U,w as u,b as c,u as r,k as C}from"./url.2e6a77c4.js";import{g as Y}from"./i18n.48bd28ac.js";import{_ as Z}from"./plugin-vue_export-helper.21dcd24c.js";import{E as g,a as _}from"./index.aa73e4df.js";import{E as ee}from"./index.cbddf8eb.js";import{E as te,a as se}from"./index.6855d037.js";function ne(e){const y=G(),f=z(),a=J();e.id===R&&(e.metas=[]);const S=v(()=>{for(const t of e.metas)t.el||(t.el=P(t,y.default));return e.metas}),B=t=>{const s=e.metas.find(n=>n.el===t.el);if(s){t.el=P(t,y.default);const n=e.metas.indexOf(s);e.metas.splice(n,1,t)}else t.el=P(t,y.default),e.metas.push(t)},I=v(()=>{const t=[];if(!e.styles)return t;for(const s of e.styles){const n=f.all.find(d=>d.href===s);n?t.push({content:n.name,id:n.id}):t.push({content:s,id:""})}return t}),x=t=>{var n,d;const s=f.all.find(o=>o.id===t.id);s?e.styles=(n=e.styles)==null?void 0:n.filter(o=>o!==s.href):e.styles=(d=e.styles)==null?void 0:d.filter(o=>o!==t.content)},E=t=>{var n;const s=f.all.find(d=>d.id===t);s&&((n=e.styles)==null||n.push(s.href))},V=t=>{if(!e.styles)return;const s=e.styles.splice(t.oldIndex,1);e.styles.splice(t.newIndex,0,s[0])},M=v(()=>{const t=[];if(!e.scripts)return t;for(const s of e.scripts){const n=a.all.find(d=>d.href===s);n?t.push({content:n.name,id:n.id,position:"head"}):t.push({content:s,id:"",position:"head"})}return t});return{metas:S,addOrUpdateMeta:B,styles:I,insertStyle:E,deleteStyle:x,sortStyle:V,scripts:M,insertScript:t=>{var n;const s=a.all.find(d=>d.id===t);s&&((n=e.scripts)==null||n.push(s.href))},sortScript:t=>{if(!e.scripts)return;const s=e.scripts.splice(t.oldIndex,1);e.scripts.splice(t.newIndex,0,s[0])},deleteScript:t=>{var n,d;const s=a.all.find(o=>o.id===t.id);s?e.scripts=(n=e.scripts)==null?void 0:n.filter(o=>o!==s.href):e.scripts=(d=e.scripts)==null?void 0:d.filter(o=>o!==t.content)}}}const le=W({props:{model:null,oldUrlPath:null,layout:null,sources:null,hideStyles:{type:Boolean},hideScripts:{type:Boolean}},setup(e,{expose:y}){const f=e,{t:a}=Y(),{metas:S,addOrUpdateMeta:B,deleteScript:I,deleteStyle:x,insertScript:E,insertStyle:V,scripts:M,sortScript:w,sortStyle:K,styles:D}=ne(f.model),t=k(),s=k([]),n=k([]),d=H();return y({validate:()=>{var o;return(o=t.value)==null?void 0:o.validate()}}),X(()=>{var o;(o=f.sources)==null||o.forEach(l=>{var m,b;!l.source.metaBindings||!l.source.urlParamsBindings||(l.source.metaBindings.length&&(s.value=s.value.concat((m=l.source)==null?void 0:m.metaBindings)),l.source.urlParamsBindings.length&&(n.value=n.value.concat((b=l.source)==null?void 0:b.urlParamsBindings)))})}),(o,l)=>{const m=g,b=ee,$=te,F=se,q=_;return h(),U(q,{"model-value":"basic"},{default:u(()=>[c(m,{name:"basic",title:r(a)("common.basic")},{default:u(()=>[c(A,{ref_key:"basicForm",ref:t,url:e.model.urlPath,"onUpdate:url":l[0]||(l[0]=i=>e.model.urlPath=i),titles:e.model.contentTitle,"onUpdate:titles":l[1]||(l[1]=i=>e.model.contentTitle=i),published:e.model.published,"onUpdate:published":l[2]||(l[2]=i=>e.model.published=i),"old-url-path":e.oldUrlPath,"meta-bindings":s.value,"url-params-bindings":n.value},null,8,["url","titles","published","old-url-path","meta-bindings","url-params-bindings"])]),_:1},8,["title"]),c(m,{title:r(a)("common.HTMLMeta"),"data-cy":"meta"},{default:u(()=>[c(L,{list:r(S),"meta-bindings":s.value,onDelete:l[3]||(l[3]=i=>e.model.metas=r(S).filter(p=>p!==i)),onAddOrUpdate:r(B)},null,8,["list","meta-bindings","onAddOrUpdate"])]),_:1},8,["title"]),e.hideStyles?C("",!0):(h(),U(m,{key:0,title:r(a)("common.style"),"data-cy":"style"},{default:u(()=>{var i,p,O;return[c(N,{list:r(D),onSort:r(K),onInsert:r(V),onDelete:r(x)},null,8,["list","onSort","onInsert","onDelete"]),(O=(p=(i=r(d))==null?void 0:i.site)==null?void 0:p.unocssSettings)!=null&&O.enable?(h(),U(F,{key:0,"label-position":"top",class:"px-24"},{default:u(()=>[c($,{label:r(a)("common.disableUnocss")},{default:u(()=>[c(b,{modelValue:e.model.disableUnocss,"onUpdate:modelValue":l[4]||(l[4]=T=>e.model.disableUnocss=T)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})):C("",!0)]}),_:1},8,["title"])),e.hideScripts?C("",!0):(h(),U(m,{key:1,title:r(a)("common.scripts"),"data-cy":"script"},{default:u(()=>[c(Q,{list:r(M),"hidde-body":"",onSort:r(w),onDelete:r(I),onInsert:r(E)},null,8,["list","onSort","onDelete","onInsert"])]),_:1},8,["title"])),c(m,{title:r(a)("common.cache"),"data-cy":"cache"},{default:u(()=>[c(j,{enable:e.model.enableCache,"onUpdate:enable":l[5]||(l[5]=i=>e.model.enableCache=i),enableVersion:e.model.cacheByVersion,"onUpdate:enableVersion":l[6]||(l[6]=i=>e.model.cacheByVersion=i),minutes:e.model.cacheMinutes,"onUpdate:minutes":l[7]||(l[7]=i=>e.model.cacheMinutes=i),queryKeys:e.model.cacheQueryKeys,"onUpdate:queryKeys":l[8]||(l[8]=i=>e.model.cacheQueryKeys=i)},null,8,["enable","enableVersion","minutes","queryKeys"])]),_:1},8,["title"])]),_:1})}}});var Se=Z(le,[["__scopeId","data-v-470218d8"]]);export{Se as P};
