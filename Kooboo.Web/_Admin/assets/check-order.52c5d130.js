var C=(R,a,_)=>new Promise((f,c)=>{var b=u=>{try{i(_.next(u))}catch(k){c(k)}},h=u=>{try{i(_.throw(u))}catch(k){c(k)}},i=u=>u.done?f(u.value):Promise.resolve(u.value).then(b,h);i((_=_.apply(R,a)).next())});import{g as ae,w as le}from"./i18n.a87944a4.js";import{d as oe,cd as se,g as v,x as ne,i as J,K as re,o as r,a as p,b as n,u as s,f as t,t as m,w as x,j as E,k as g,F as N,b7 as T,n as me,aI as ie}from"./url.4cb47a7a.js";import{a as V,r as ue,W as ce}from"./validate.bb56f9e3.js";import{d as de}from"./main.9fdfea92.js";import{I as pe,B as fe,C as ve,D as xe,E as _e}from"./index.d2657986.js";import{V as be}from"./vue-qr.e4d85a42.js";import{E as he}from"./windi.6360286d.js";import{E as ye}from"./index.a7b376b1.js";import{E as ge,a as ke}from"./index.4d2ce883.js";import{E as we}from"./index.178b9e08.js";import{E as Ce,a as Ve}from"./index.9fd79879.js";import{E as Ie,a as Ee}from"./index.7c862087.js";import{E as Ne}from"./index.361e2245.js";import"./index.d24a40b9.js";import"./index.f23f1e38.js";import"./replace-all.56d2c1f7.js";import"./index.a24f458a.js";import"./index.1fd72ea8.js";import"./index.abe211fa.js";import"./style.c350d462.js";import"./toNumber.47eea968.js";import"./_baseIsEqual.dc9e64c4.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./error.7e8331f1.js";import"./event.776e7e11.js";import"./index.7b8c5aef.js";import"./isNil.98bb3b88.js";import"./_baseClone.b8903935.js";import"./isEqual.4cab74e3.js";import"./index.d96452a6.js";import"./focus-trap.50a00b7f.js";import"./event.53b2ad83.js";import"./index.fd96ea36.js";import"./index.4d568055.js";import"./scroll.16983984.js";import"./debounce.4e0c106e.js";import"./index.66319a92.js";import"./validator.b5df2420.js";const Te={class:"p-24 dark:text-[#fffa] overflow-x-hidden"},je={class:"text-000 dark:text-[#fffa] text-52px font-medium mt-4 mb-24px h-73px leading-73px"},Re={class:"jumbotron flex"},Pe={class:"px-6 pt-5 pb-32 bg-fff dark:bg-[#333] w-620px mr-40px rounded-normal shadow-s-10 flex-shrink-0"},Se={class:"flex justify-between items-center h-28px leading-28px"},qe={class:"text-20px font-medium text-000 dark:text-[#fffa]"},Oe={class:"space-y-8 text-000 dark:text-[#fffa] text-opacity-65 text-m"},Ue={class:"ellipsis"},$e=["innerHTML"],De={class:"text-20px font-medium text-000 dark:text-[#fffa] mb-4"},Be={key:0},Fe={class:"space-x-24 flex mb-28px"},Le=["onClick"],Me={class:"flex items-center"},We={class:"flex items-center justify-between space-x-16"},ze={class:"flex items-center justify-between mt-6px"},He={key:1,class:"w-180px h-220px mx-auto"},Ae={key:0,class:"flex flex-col"},Je=t("div",{class:"flex items-center justify-center h-auto"},[t("img",{class:"transform scale-80 -m-12",src:"https://td.cdn-go.cn/enterprise_payment/v0.0.9/logo.png"})],-1),Qe={class:"px-6 pt-5 pb-44px bg-fff dark:bg-[#333] text-m w-500px rounded-normal shadow-s-10 text-000 dark:text-[#fffa]",style:{height:"fit-content"}},Ye={class:"text-20px font-medium"},Ke={class:"text-000 dark:text-[#fffa]"},Ge={class:"space-y-8 mb-8"},Xe={class:"flex justify-between items-center h-5 leading-5"},Ze={class:"flex justify-between items-center h-5 leading-5"},et={class:"flex justify-between items-center font-medium h-60px text-20px mt-28px mb-37px border-t-1 border-b-1 border-[#dcdfe6] dark:border-[#4c4d4f]"},tt={class:"flex items-center justify-center"},Ht=oe({setup(R){const{t:a}=ae(),_=se(),f=v("CreditCard"),c=v(!1);let b;const h=v(),i=v(),u=v({id:"",type:"",isDefault:!1,display:""}),k=d=>{u.value=JSON.parse(JSON.stringify(d)),c.value=!1},l=v({cardNumber:"",year:"",month:"",name:"",cvc:""}),Q={name:[V(a("common.fieldRequiredTips")),ue(1,50)],cardNumber:[V(a("common.fieldRequiredTips"))],year:[V(a("common.fieldRequiredTips"))],month:[V(a("common.fieldRequiredTips"))],cvc:[V(a("common.fieldRequiredTips")),ce()]},P=v(),Y=v([1,2,3,4,5,6,7,8,9,10,11,12]),K=v([2023,2024,2025,2026,2027,2028,2029,2030,2031,2032,2033,2034,2035,2036,2037,2038,2039,2040,2041,2042,2043,2044,2045,2046,2047,2048,2049,2050,2051,2052,2053,2054,2055,2056,2057,2058,2059,2060,2061,2062,2063,2064,2065,2066,2067,2068,2069,2070,2071,2072,2073]),I=v(),y=ne("orderId"),G=()=>C(this,null,function*(){let d;c.value?(yield P.value.validate(),d=yield fe({name:l.value.name,cardNumber:l.value.cardNumber.replaceAll("-",""),year:l.value.year,month:l.value.month,cvc:l.value.cvc,orderId:y})):d=yield ve(u.value.id,y),d.success?_.push({name:"consoleOrder"}):window.location.href=d.redirectUrl});J(()=>c.value,()=>{c.value||(l.value.cardNumber="",l.value.year="",l.value.month="",l.value.name="",l.value.cvc="")}),(()=>C(this,null,function*(){y&&(i.value=yield xe(y)),h.value=yield _e(),h.value.length&&(u.value=h.value.filter(d=>d.isDefault)[0])}))();function X(){return C(this,null,function*(){var d=`marketOrder/CheckStatus?id=${I.value.requestId}`,o=yield de.get(d,void 0,{hiddenLoading:!0});o.paid&&(clearInterval(b),_.push({name:"consoleOrder"}))})}return J(()=>f.value,()=>C(this,null,function*(){f.value==="WechatPay"&&y?(I.value=yield pe(y),b=setInterval(X,1e3)):clearInterval(b)})),re(()=>{clearInterval(b)}),(d,o)=>{var D,B,F,L,M,W,z,H;const S=he,q=ye,O=ge,Z=ke,j=we,w=Ce,U=Ie,$=Ee,ee=Ve,te=Ne;return r(),p("div",Te,[n(S,{class:"iconfont icon-fanhui1 cursor-pointer hover:text-blue",title:s(a)("common.back"),onClick:o[0]||(o[0]=e=>d.$router.back())},null,8,["title"]),t("h1",je,m(s(a)("order.checkout")),1),t("div",Re,[t("div",Pe,[t("div",Se,[t("h1",qe,m((D=i.value)==null?void 0:D.title),1)]),t("ul",Oe,[t("li",Ue,[t("div",{innerHTML:(B=i.value)==null?void 0:B.summary},null,8,$e)])]),n(q,{class:"mt-28px mb-20px"}),t("h1",De,m(s(a)("common.paymentMethod")),1),n(Z,{modelValue:f.value,"onUpdate:modelValue":o[1]||(o[1]=e=>f.value=e),class:"el-tabs--hide-content partnerTab mb-28px"},{default:x(()=>{var e;return[n(O,{label:s(a)("common.creditCard"),name:"CreditCard"},null,8,["label"]),((e=i.value)==null?void 0:e.currency)=="CNY"?(r(),E(O,{key:0,label:s(a)("common.wechatPay"),name:"WechatPay"},null,8,["label"])):g("",!0)]}),_:1},8,["modelValue"]),f.value==="CreditCard"?(r(),p("div",Be,[t("div",Fe,[(r(!0),p(N,null,T(h.value,e=>{var A;return r(),p("div",{key:e.display,class:me(["w-94px h-36px rounded-full flex items-center justify-center cursor-pointer",e.id===((A=u.value)==null?void 0:A.id)&&!c.value?"bg-blue text-fff":"bg-[#192845] bg-opacity-5 dark:bg-666"]),onClick:lt=>k(e)}," *"+m(e.display),11,Le)}),128)),c.value?g("",!0):(r(),p("div",{key:0,class:"w-36px h-36px rounded-full bg-blue flex items-center justify-center cursor-pointer",onClick:o[2]||(o[2]=e=>c.value=!0)},[n(S,{class:"iconfont icon-a-addto text-fff font-medium"})]))]),c.value?(r(),E(ee,{key:0,ref_key:"form",ref:P,model:l.value,rules:Q,"label-position":"top",onSubmit:o[10]||(o[10]=le(()=>{},["prevent"]))},{default:x(()=>[t("div",Me,[n(w,{prop:"cardNumber",label:s(a)("common.cardNumber"),class:"!mr-32"},{default:x(()=>[n(j,{modelValue:l.value.cardNumber,"onUpdate:modelValue":o[3]||(o[3]=e=>l.value.cardNumber=e),class:"w-260px",maxlength:"19",placeholder:"0000-0000-0000-0000",onInput:o[4]||(o[4]=e=>l.value.cardNumber=l.value.cardNumber.replace(/\s/g,"").replace(/[^\d]/g,"").replace(/(\d{4})(?=\d)/g,"$1-"))},null,8,["modelValue"])]),_:1},8,["label"]),t("div",We,[n(w,{prop:"month",label:s(a)("common.expirationDate"),class:"flex-1"},{default:x(()=>[n($,{modelValue:l.value.month,"onUpdate:modelValue":o[5]||(o[5]=e=>l.value.month=e),class:"",placeholder:s(a)("common.month"),size:"large"},{default:x(()=>[(r(!0),p(N,null,T(Y.value,e=>(r(),E(U,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),n(w,{prop:"year",class:"flex-1 yearFormItem",label:" "},{default:x(()=>[n($,{modelValue:l.value.year,"onUpdate:modelValue":o[6]||(o[6]=e=>l.value.year=e),class:"",placeholder:s(a)("common.year"),size:"large"},{default:x(()=>[(r(!0),p(N,null,T(K.value,e=>(r(),E(U,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1})])]),t("div",ze,[n(w,{prop:"name",label:s(a)("common.nameOnCard"),class:"mr-32"},{default:x(()=>[n(j,{modelValue:l.value.name,"onUpdate:modelValue":o[7]||(o[7]=e=>l.value.name=e),class:"w-260px",placeholder:s(a)("common.enterYourNameHere")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),n(w,{prop:"cvc",label:s(a)("common.cvc"),class:"flex-1"},{default:x(()=>[n(j,{modelValue:l.value.cvc,"onUpdate:modelValue":o[8]||(o[8]=e=>l.value.cvc=e),class:"w-full",maxlength:"3",placeholder:s(a)("common.enterCVCHere"),onInput:o[9]||(o[9]=e=>l.value.cvc=l.value.cvc.replace(/\s/g,"").replace(/[^\d]/g,""))},null,8,["modelValue","placeholder"])]),_:1},8,["label"])])]),_:1},8,["model"])):g("",!0)])):g("",!0),f.value==="WechatPay"?(r(),p("div",He,[I.value?(r(),p("div",Ae,[n(be,{text:I.value.nextAction.responseData,size:2e3,class:"transform scale-75"},null,8,["text"]),Je])):g("",!0)])):g("",!0)]),t("div",Qe,[t("h1",Ye,m(s(a)("common.orderSummary")),1),(r(!0),p(N,null,T((F=i.value)==null?void 0:F.items,e=>(r(),p("div",{key:e.name,class:"flex justify-between items-center h-6 leading-6 text-m my-8"},[t("span",null,m(e.name),1),t("span",Ke,m(e.price),1)]))),128)),n(q,{class:"mb-28px mt-5"}),t("ul",Ge,[t("li",Xe,[t("span",null,m(s(a)("common.subtotal")),1),t("span",null,m((L=i.value)==null?void 0:L.subTotal),1)]),t("li",Ze,[t("span",null,m(s(a)("common.vat")),1),t("span",null,m((M=i.value)==null?void 0:M.tax),1)])]),t("div",et,[t("span",null,m(s(a)("common.total"))+" ("+m((W=i.value)==null?void 0:W.currency)+")",1),t("span",null,m((z=i.value)==null?void 0:z.total),1)]),t("span",tt,[n(te,{type:"primary",round:"",class:"w-300px",disabled:f.value==="WechatPay"||!c.value&&((H=u.value)==null?void 0:H.id)==="",onClick:G},{default:x(()=>[ie(m(f.value==="CreditCard"?s(a)("common.submitPayment"):s(a)("common.scanToPay")),1)]),_:1},8,["disabled"])])])])])}}});export{Ht as default};
