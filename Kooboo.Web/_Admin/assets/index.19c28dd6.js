var U=(i,v,u)=>new Promise((c,f)=>{var m=s=>{try{g(u.next(s))}catch(o){f(o)}},y=s=>{try{g(u.throw(s))}catch(o){f(o)}},g=s=>s.done?c(s.value):Promise.resolve(s.value).then(m,y);g((u=u.apply(i,v)).next())});import{_ as M}from"./icon-button.74ccc970.js";import{a as L,b as O}from"./replace-all.56d2c1f7.js";import{d as R,E as j,u as T}from"./main.9fdfea92.js";import{d as q,g as z,w as G,o as Q}from"./i18n.a87944a4.js";import{_ as H}from"./alert.d2815716.js";import{_ as J}from"./index.f0d5f031.js";import{E as P}from"./index.6918f0a5.js";import{E as W}from"./index.361e2245.js";import{E as X}from"./windi.6360286d.js";import{E as Y}from"./index.178b9e08.js";import{E as Z,a as A}from"./index.9fd79879.js";import{E as ee}from"./index.c003dfa1.js";import{d as K,g as w,o as a,j as _,w as r,b as d,k as B,f as k,a as x,b7 as N,aI as D,t as h,u as C,F as S,x as oe,c as te}from"./url.4cb47a7a.js";import{B as le}from"./breadcrumb.f4d80c95.js";import{E as ne,a as ae}from"./index.2bbcbf2b.js";import{E as se,a as re}from"./index.ac10ee42.js";import"./index.d96452a6.js";import"./focus-trap.50a00b7f.js";import"./isNil.98bb3b88.js";import"./event.53b2ad83.js";import"./index.7b8c5aef.js";import"./index.4f90a917.js";import"./index.4d568055.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";import"./validator.b5df2420.js";import"./event.776e7e11.js";import"./error.7e8331f1.js";import"./_baseClone.b8903935.js";import"./_baseIsEqual.dc9e64c4.js";import"./isEqual.4cab74e3.js";import"./index.c10802d9.js";import"./scroll.16983984.js";import"./refs.3132cbdb.js";/* empty css                                                               */import"./plugin-vue_export-helper.21dcd24c.js";import"./plugin-vue_export-helper.41ffa612.js";import"./index.fd96ea36.js";import"./index.77bc9666.js";const ie=q.global.t,ue=()=>R.get(L("CoreSetting/list")),ce=i=>R.get(L("CoreSetting/get"),{name:i}),me=i=>R.post(L("CoreSetting/update"),i,void 0,{successMessage:ie("common.saveSuccess")}),pe={class:"p-32"},de={key:1,class:"flex items-center space-x-12"},fe=["onChange"],_e={class:"ellipsis max-w-200px"},ve=K({props:{modelValue:{type:Boolean},config:null},emits:["update:modelValue","reload"],setup(i,{emit:v}){const u=i,{t:c}=z(),f=w(!0),m=w([]);ce(u.config.name).then(o=>m.value=o);function y(o){if(!o)return o;var t=o.indexOf("|");return t=t<0?0:t,o.substr(0,t)}function g(o,t){var l=o.target.files[0];if(!!l){if(l.size>10*1024){j.error(c("common.fileSizeLessTips")),o.target.value="";return}var n=new FileReader;n.readAsDataURL(l),n.onload=function(E){var b=E.target.result;t.value=l.name+"|"+b.substr(b.indexOf("base64,")+7)}}}const s=()=>U(this,null,function*(){if(!m.value.length)return;f.value=!1;const o=m.value.map(l=>({key:l.name,value:l.value})),t=O(o);yield me({name:u.config.name,model:t}),v("reload")});return(o,t)=>{const l=P,n=W,E=X,b=Y,$=Z,F=A,I=ee;return a(),_(I,{"model-value":f.value,"custom-class":"el-dialog--zero-padding",width:"600px","close-on-click-modal":!1,title:C(c)("common.edit"),onClosed:t[2]||(t[2]=e=>v("update:modelValue",!1))},{footer:r(()=>[d(J,{onConfirm:s,onCancel:t[1]||(t[1]=e=>f.value=!1)})]),default:r(()=>[i.config.alert?(a(),_(H,{key:0,content:i.config.alert},null,8,["content"])):B("",!0),k("div",pe,[d(F,{"label-position":"top",onSubmit:t[0]||(t[0]=G(()=>{},["prevent"])),onKeydown:Q(s,["enter"])},{default:r(()=>[(a(!0),x(S,null,N(m.value,e=>(a(),_($,{key:e.name,label:e.name},{default:r(()=>[e.type==="checkbox"?(a(),_(l,{key:0,modelValue:e.value,"onUpdate:modelValue":p=>e.value=p},null,8,["modelValue","onUpdate:modelValue"])):e.type==="file"?(a(),x("div",de,[d(n,{round:"",class:"relative"},{default:r(()=>[D(h(C(c)("common.selectFile"))+" ",1),k("input",{class:"cursor-pointer absolute inset-0 opacity-0",type:"file",onChange:p=>g(p,e)},null,40,fe)]),_:2},1024),e.value?(a(),x(S,{key:0},[k("div",_e,[k("span",null,h(y(e.value)),1)]),d(E,{class:"iconfont icon-delete text-orange cursor-pointer",onClick:p=>e.value=""},null,8,["onClick"])],64)):B("",!0)])):(a(),_(b,{key:2,modelValue:e.value,"onUpdate:modelValue":p=>e.value=p},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1032,["label"]))),128))]),_:1},8,["onKeydown"])])]),_:1},8,["model-value","title"])}}}),ge={class:"p-24"},ao=K({setup(i){const{t:v}=z(),u=w([]),c=w(!1),f=w(),m=w([]),y=oe("group"),g=T();y&&m.value.push(y);const s=()=>U(this,null,function*(){u.value=yield ue()}),o=te(()=>{const l={};for(const n of u.value)l[n.group]||(l[n.group]=[]),l[n.group].push(n);return l}),t=l=>{g.hasAccess("config","edit")&&(f.value=l,c.value=!0)};return s(),(l,n)=>{const E=ne,b=M,$=ae,F=se,I=re;return a(),x(S,null,[k("div",ge,[d(le,{name:C(v)("common.config")},null,8,["name"]),d(I,{modelValue:m.value,"onUpdate:modelValue":n[0]||(n[0]=e=>m.value=e),class:"rounded-normal bg-fff my-32 overflow-hidden el-collapse--no-border dark:bg-[#333]"},{default:r(()=>[(a(!0),x(S,null,N(C(o),(e,p)=>(a(),_(F,{key:p,title:p,name:p},{default:r(()=>[(a(!0),x(S,null,N(e,V=>(a(),_($,{key:V.name,class:"px-44px pt-16 flex items-center"},{default:r(()=>[d(E,{span:4},{default:r(()=>[D(h(V.name),1)]),_:2},1024),d(E,{span:14,class:"ellipsis",title:V.value},{default:r(()=>[D(h(V.value),1)]),_:2},1032,["title"]),d(E,{span:6},{default:r(()=>[d(b,{permission:{feature:"config",action:"edit"},circle:"",class:"text-blue ml-12",icon:"icon-a-writein ",tip:C(v)("common.edit"),"data-cy":V.name,onClick:Ee=>t(V)},null,8,["tip","data-cy","onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:2},1032,["title","name"]))),128))]),_:1},8,["modelValue"])]),c.value?(a(),_(ve,{key:0,modelValue:c.value,"onUpdate:modelValue":n[1]||(n[1]=e=>c.value=e),config:f.value,onReload:s},null,8,["modelValue","config"])):B("",!0)],64)}}});export{ao as default};
