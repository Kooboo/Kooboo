var C=Object.defineProperty;var V=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var w=(l,s,a)=>s in l?C(l,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[s]=a,x=(l,s)=>{for(var a in s||(s={}))U.call(s,a)&&w(l,a,s[a]);if(V)for(var a of V(s))S.call(s,a)&&w(l,a,s[a]);return l};var y=(l,s,a)=>new Promise((c,p)=>{var g=r=>{try{e(a.next(r))}catch(t){p(t)}},v=r=>{try{e(a.throw(r))}catch(t){p(t)}},e=r=>r.done?c(r.value):Promise.resolve(r.value).then(g,v);e((a=a.apply(l,s)).next())});import{g as $}from"./i18n.97105311.js";import{b as A,e as B}from"./product.b50cc736.js";import{u as P}from"./commerce.c633c6e0.js";import{_ as z,a as M,V as j}from"./option-group-editor.72b028d4.js";import{_ as q}from"./key-value-editor.12c3b400.js";import{u as G}from"./product-variant.9535432a.js";import{_ as H}from"./index.b3ad0c7f.js";import{z as J}from"./main.52487121.js";import{u as K}from"./useFields.b5861b0a.js";import{E as L,a as Q}from"./index.317a7f30.js";import{d as R,g as O,h as T,o as W,a as X,b as m,w as b,u as o,f as Y,k as Z}from"./url.2e6a77c4.js";const tt={key:0,class:"px-24 pt-0 pb-84px space-y-12"},at={class:"bg-fff dark:bg-[#252526] px-24 py-16 rounded-normal"},vt=R({props:{id:null},setup(l,{expose:s}){const a=l,c=O([]),{t:p}=$(),g=P(),v=O();g.loadCategories();let e=G();const r=O(),t=O(),{fields:E,customFields:D}=K();T(()=>y(this,null,function*(){t.value=yield A(a.id),t.value.tags||(t.value.tags=[]),c.value=t.value.attributes.map(i=>({key:i.key,value:i.value,options:[]}));const u=t.value.variants.sort((i,d)=>i.order>d.order?1:-1);for(const i of u)e.addVariant(i)}));function h(){return y(this,null,function*(){var i,d,f;try{yield v.value.form.validate(),yield(d=(i=r.value)==null?void 0:i.form)==null?void 0:d.validate()}catch(n){throw J(),n}const u=x({},t.value);u.attributes=c.value.map(n=>({key:n.key,value:n.value})),e.list.value.forEach((n,_)=>n.order=_),u.variants=e.list.value,u.variantOptions=(f=u.variantOptions)==null?void 0:f.filter(n=>n.items.length),yield B(u)})}return s({onSave:h}),(u,i)=>{const d=L,f=Q;return t.value?(W(),X("div",tt,[m(z,{ref_key:"basicInfo",ref:v,model:t.value,fields:o(E)},{default:b(()=>[m(d,{label:o(p)("common.attributes")},{default:b(()=>[m(q,{modelValue:c.value,"onUpdate:modelValue":i[0]||(i[0]=n=>c.value=n),"key-input-attributes":{placeholder:o(p)("common.attributeSamples")},"value-input-attributes":{placeholder:o(p)("common.value")},class:"max-w-600px space-y-8 w-full"},null,8,["modelValue","key-input-attributes","value-input-attributes"])]),_:1},8,["label"])]),_:1},8,["model","fields"]),m(H,{ref_key:"customData",ref:r,data:t.value.customData,"custom-fields":o(D)},null,8,["data","custom-fields"]),Y("div",at,[m(f,{"label-position":"top"},{default:b(()=>{var n,_;return[m(d,{label:o(p)("commerce.variantOptions")},{default:b(()=>[m(M,{options:o(e).options.value,variants:o(e).list.value,"variant-options":t.value.variantOptions,class:"max-w-600px",onUpdateOptionItem:o(e).updateOptionItem,onUpdateOptionName:o(e).updateOptionName,onAddOptionItem:i[1]||(i[1]=(F,N)=>{var I,k;return o(e).addOptionItem(F,N,(k=(I=t.value)==null?void 0:I.featuredImage)!=null?k:"")}),onDeleteOptionItem:o(e).deleteOptionItem,onDeleteOption:o(e).deleteOption,onAddOption:o(e).addOption},null,8,["options","variants","variant-options","onUpdateOptionItem","onUpdateOptionName","onDeleteOptionItem","onDeleteOption","onAddOption"])]),_:1},8,["label"]),m(j,{"variant-options":t.value.variantOptions,variants:o(e).list.value,options:o(e).options.value,"default-image":(_=(n=t.value)==null?void 0:n.featuredImage)!=null?_:"","is-digital":t.value.isDigital},null,8,["variant-options","variants","options","default-image","is-digital"])]}),_:1})])])):Z("",!0)}}});export{vt as _};
