var w=(I,d,r)=>new Promise((v,n)=>{var u=e=>{try{c(r.next(e))}catch(s){n(s)}},p=e=>{try{c(r.throw(e))}catch(s){n(s)}},c=e=>e.done?v(e.value):Promise.resolve(e.value).then(u,p);c((r=r.apply(I,d)).next())});import{g as S,w as F}from"./i18n.a87944a4.js";import{u as U}from"./use-operation-dialog.4f6d7533.js";import{b as q,a as C,r as T,d as A}from"./validate.bb56f9e3.js";import{h as O,n as j,o as G,q as H,r as M}from"./index.d2657986.js";import{d as h,N as Q,g as b,i as W,o as x,j as E,w as l,b as i,u as t,f as D,t as y,a as B,b7 as z,F as J,H as K,G as P,aI as X,cg as Y,x as Z}from"./url.4cb47a7a.js";import{_ as ee}from"./index.f0d5f031.js";import{W as oe}from"./main.9fdfea92.js";import{_ as te}from"./plugin-vue_export-helper.21dcd24c.js";import{E as ae}from"./index.178b9e08.js";import{E as le,a as ie}from"./index.9fd79879.js";import{E as ne,a as se}from"./index.7c862087.js";import{E as re}from"./index.c003dfa1.js";import{_ as me}from"./k-table.b1a54b80.js";import{b as de}from"./confirm.b60b5d2f.js";import{E as ue}from"./index.361e2245.js";import{E as pe}from"./index.b38edc72.js";import"./index.d24a40b9.js";import"./index.f23f1e38.js";import"./replace-all.56d2c1f7.js";import"./index.a24f458a.js";import"./index.1fd72ea8.js";import"./index.abe211fa.js";import"./style.c350d462.js";import"./toNumber.47eea968.js";import"./_baseIsEqual.dc9e64c4.js";import"./index.50c16ae5.js";import"./windi.6360286d.js";import"./preload-helper.13a99eb0.js";import"./event.776e7e11.js";import"./index.7b8c5aef.js";import"./error.7e8331f1.js";import"./isNil.98bb3b88.js";import"./_baseClone.b8903935.js";import"./isEqual.4cab74e3.js";import"./index.d96452a6.js";import"./focus-trap.50a00b7f.js";import"./event.53b2ad83.js";import"./index.fd96ea36.js";import"./index.4d568055.js";import"./scroll.16983984.js";import"./debounce.4e0c106e.js";import"./index.66319a92.js";import"./validator.b5df2420.js";import"./index.c10802d9.js";import"./refs.3132cbdb.js";import"./sortable.esm.a99254e8.js";import"./icon-button.74ccc970.js";import"./index.4f90a917.js";import"./index.c6da2706.js";import"./index.42922617.js";import"./index.f15f695e.js";import"./logo-transparent.1566007e.js";import"./index.f2c1b903.js";import"./aria.75ec5909.js";const ce=["title"],_e=h({props:{modelValue:{type:Boolean},domain:null},emits:["create-success"],setup(I,{emit:d}){const r=I,v=Q(),{t:n}=S(),{visible:u,handleClose:p}=U(r,d),c=b(),e=b(),s=b(),o=b({subDomain:"",rootDomain:"",SiteId:""}),g={subDomain:[q,C(n("common.inputValue")),T(1,63),A(o.value)],SiteId:[C(n("common.inputValue"))]};W(()=>u.value,f=>w(this,null,function*(){var a,k;f&&(c.value=yield oe(),e.value=yield O(),(a=s.value)==null||a.resetFields(),o.value.subDomain="",o.value.rootDomain=e.value.filter(V=>V.id===v.query.id)[0].domainName,o.value.SiteId=(k=c.value[0])==null?void 0:k.siteId)}));function m(){var f;(f=s.value)==null||f.validate(a=>w(this,null,function*(){a&&(yield j(o.value.subDomain,o.value.rootDomain,o.value.SiteId),p(),d("create-success"))}))}return(f,a)=>{const k=ae,V=le,N=ne,L=se,R=ie,$=re;return x(),E($,{modelValue:t(u),"onUpdate:modelValue":a[3]||(a[3]=_=>K(u)?u.value=_:null),width:"600px","close-on-click-modal":!1,title:t(n)("common.newBinding"),onClose:t(p)},{footer:l(()=>[i(ee,{"confirm-label":t(n)("common.create"),onConfirm:m,onCancel:t(p)},null,8,["confirm-label","onCancel"])]),default:l(()=>[i(R,{ref_key:"form",ref:s,class:"el-form--label-normal",model:o.value,rules:t(g),"label-position":"top",onSubmit:a[2]||(a[2]=F(()=>{},["prevent"]))},{default:l(()=>[i(V,{prop:"subDomain",label:t(n)("common.domain")},{default:l(()=>[i(k,{modelValue:o.value.subDomain,"onUpdate:modelValue":a[0]||(a[0]=_=>o.value.subDomain=_),placeholder:"www","data-cy":"subdomain"},{append:l(()=>[D("span",{disabled:"",class:"ellipsis max-w-240px px-16 dark:bg-[#222] dark:rounded-tr-normal dark:rounded-br-normal dark:border-[#4c4d4f] dark:border-1 border-solid dark:border-l-0",title:o.value.rootDomain,"data-cy":"root-domain"},"."+y(o.value.rootDomain),9,ce)]),_:1},8,["modelValue"])]),_:1},8,["label"]),i(V,{prop:"SiteId",label:t(n)("common.site")},{default:l(()=>[i(L,{modelValue:o.value.SiteId,"onUpdate:modelValue":a[1]||(a[1]=_=>o.value.SiteId=_),class:"w-full"},{default:l(()=>[(x(!0),B(J,null,z(c.value,_=>(x(),E(N,{key:_.siteId,label:_.siteDisplayName,value:_.siteId,"data-cy":"site-opt"},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title","onClose"])}}});var fe=te(_e,[["__scopeId","data-v-7327bb0f"]]);const be={class:"p-24"},ve={class:"flex items-center pb-24 space-x-16"},ge={class:"flex items-center"},we=["href"],Io=h({setup(I){const{t:d}=S(),r=P({status:!1,open(){r.status=!0}}),v=e=>{Y("//"+e)},n=b(),u=b();function p(){return w(this,null,function*(){const e=Z("id");e&&(u.value=yield G(e),n.value=yield H(e))})}p();function c(e){return w(this,null,function*(){e.length&&(yield de(e.length),yield M(e.map(s=>s.id)),p())})}return(e,s)=>{const o=ue,g=pe;return x(),B("div",be,[D("div",ve,[i(o,{round:"",onClick:t(r).open},{default:l(()=>[D("div",ge,y(t(d)("common.new")),1)]),_:1},8,["onClick"])]),i(t(me),{data:u.value,"show-check":"",onDelete:c},{default:l(()=>[i(g,{label:t(d)("common.domain")},{default:l(({row:m})=>[D("span",null,y(m.fullName),1)]),_:1},8,["label"]),i(g,{label:t(d)("common.site")},{default:l(({row:m})=>[D("a",{class:"cursor-pointer text-blue",href:`/_Admin/site?SiteId=${m.webSiteId}`,target:"_blank","data-cy":"site-name"},y(m.siteName),9,we)]),_:1},8,["label"]),i(g,{width:"150px",align:"center"},{default:l(({row:m})=>[i(o,{type:"primary",round:"",onClick:f=>v(m.fullName)},{default:l(()=>[X(y(t(d)("common.preview")),1)]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),i(fe,{modelValue:t(r).status,"onUpdate:modelValue":s[0]||(s[0]=m=>t(r).status=m),domain:n.value,onCreateSuccess:p},null,8,["modelValue","domain"])])}}});export{Io as default};
