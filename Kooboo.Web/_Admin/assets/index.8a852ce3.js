var I=(o,a,c)=>new Promise((u,t)=>{var p=d=>{try{f(c.next(d))}catch(i){t(i)}},v=d=>{try{f(c.throw(d))}catch(i){t(i)}},f=d=>d.done?u(d.value):Promise.resolve(d.value).then(p,v);f((c=c.apply(o,a)).next())});import{_ as Q}from"./k-table.d4486972.js";import{d as N,g as C,i as W,o as s,j as y,w as m,a as V,b as e,f as E,u as l,F as O,b6 as S,k,aH as L,t as $,M as X,h as Y,b7 as Z,e as ee}from"./url.2e6a77c4.js";import{B as oe}from"./breadcrumb.80c136b8.js";import{g as B,w as le}from"./i18n.48bd28ac.js";import{c as te,e as ne,u as ae,d as me}from"./commerce.f8d3336c.js";import{b as ie}from"./confirm.e2c924ff.js";import{_ as z}from"./index.a731e53b.js";import{_ as H}from"./icon-button.3313e42d.js";import{i as se}from"./main.ea42d807.js";import{E as j}from"./index.fc90f5ad.js";import{E as ue,a as de,c as ce}from"./index.0d2684bf.js";import{E as A,a as R}from"./index.6855d037.js";import{E as K}from"./index.2bc50276.js";import{E as re}from"./index.73bdefdb.js";import{_ as pe}from"./tooltip.28a451cc.js";import{E as fe}from"./index.cbddf8eb.js";import{E as ve}from"./index.77edae39.js";import{E as _e}from"./index.d4bbb472.js";import{E as q}from"./index.c4e9b529.js";import{_ as be}from"./boolean-tag.24c364ea.js";import{E as ge}from"./windi.a5b0b048.js";import{E as ye}from"./index.b494e80e.js";import{E as he}from"./index.379e80ad.js";import"./sortable.esm.a99254e8.js";import"./index.7034978e.js";import"./index.fcc3ea42.js";import"./isEqual.f1ae9fb3.js";import"./_baseIsEqual.c0d7e77a.js";import"./error.7e8331f1.js";import"./index.695d0284.js";import"./event.776e7e11.js";import"./index.ff0264f3.js";import"./replace-all.7cf5f327.js";/* empty css                                                               */import"./plugin-vue_export-helper.21dcd24c.js";import"./plugin-vue_export-helper.41ffa612.js";import"./index.a439b087.js";import"./logo-transparent.1566007e.js";import"./index.99c4f65d.js";import"./index.603c1365.js";import"./scroll.f51de5d8.js";import"./aria.75ec5909.js";import"./event.53b2ad83.js";import"./focus-trap.23f44899.js";import"./isNil.98bb3b88.js";import"./validator.e2869aba.js";import"./index.8262f5ef.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";import"./debounce.61c67278.js";import"./toNumber.574be4f1.js";import"./index.064c7de9.js";import"./_baseClone.adbc92f5.js";import"./index.e3f90979.js";import"./refs.4001ce17.js";const Ee={key:0},Ve={class:"space-y-12"},xe={class:"flex gap-4 w-full"},Ce={class:"space-y-4 w-full"},ke={class:"flex items-center justify-between mt-12"},we={class:"truncate flex-1 text-l font-bold"},$e={class:"flex gap-8 flex-wrap"},De=N({props:{model:null,forceSelection:{type:Boolean},editing:{type:Boolean},nameLabel:null,valueLabel:null,namePlaceholder:null},emits:["changeName","changeOption","addOption","deleteOption","delete"],setup(o,{emit:a}){const c=o,u=C(c.editing),{t}=B(),p=C(),v=C(""),f=[{name:"Selection",display:t("common.selection")},{name:"Custom",display:t("common.custom")}];function d(n,r){const b=c.model.options[n];c.model.options.includes(r)?(se(t("common.valueExist")),p.value.options[n]=b):r?a("changeOption",b,r):p.value.options[n]=b}function i(n){a("changeName",n),p.value=JSON.parse(JSON.stringify(c.model))}function h(n){v.value="",!(!n||c.model.options.includes(n))&&a("addOption",n)}return W(()=>c.model,()=>{p.value=JSON.parse(JSON.stringify(c.model))},{deep:!0,immediate:!0}),(n,r)=>{const b=j,x=ue,T=de,F=A,P=H,M=R,_=K,w=re;return s(),y(w,{shadow:"never"},{default:m(()=>[u.value?(s(),V("div",Ee,[e(M,{"label-position":"top"},{default:m(()=>[E("div",Ve,[e(F,{label:o.nameLabel||l(t)("commerce.optionName")},{default:m(()=>[E("div",xe,[e(b,{modelValue:o.model.name,"onUpdate:modelValue":r[0]||(r[0]=g=>o.model.name=g),placeholder:o.namePlaceholder||l(t)("commerce.variantSamples"),onChange:i},null,8,["modelValue","placeholder"]),o.forceSelection?k("",!0):(s(),y(T,{key:0,modelValue:o.model.type,"onUpdate:modelValue":r[1]||(r[1]=g=>o.model.type=g),class:"w-220px"},{default:m(()=>[(s(),V(O,null,S(f,g=>e(x,{key:g.name,label:g.display,value:g.name},null,8,["label","value"])),64))]),_:1},8,["modelValue"]))])]),_:1},8,["label"]),o.model.type=="Selection"?(s(),y(F,{key:0,label:o.valueLabel||l(t)("commerce.optionValues")},{default:m(()=>[E("div",Ce,[(s(!0),V(O,null,S(o.model.options,(g,D)=>(s(),y(b,{key:D,"model-value":g,"onUpdate:modelValue":U=>o.model.options[D]=U,onChange:U=>d(D,U)},{suffix:m(()=>[e(P,{class:"hover:text-orange",tip:l(t)("common.delete"),icon:"icon-delete",onClick:U=>a("deleteOption",D)},null,8,["tip","onClick"])]),_:2},1032,["model-value","onUpdate:modelValue","onChange"]))),128)),e(b,{modelValue:v.value,"onUpdate:modelValue":r[2]||(r[2]=g=>v.value=g),placeholder:o.model.options.length?l(t)("common.addAnotherValue"):l(t)("common.addValue"),onChange:h},null,8,["modelValue","placeholder"]),v.value?(s(),y(b,{key:0,placeholder:l(t)("common.addAnotherValue")},null,8,["placeholder"])):k("",!0)])]),_:1},8,["label"])):k("",!0)])]),_:1}),E("div",ke,[e(P,{circle:"",class:"hover:text-orange text-orange",icon:"icon-delete ",tip:l(t)("common.delete"),onClick:r[3]||(r[3]=g=>a("delete"))},null,8,["tip"]),e(_,{round:"",type:"primary",onClick:r[4]||(r[4]=g=>u.value=!1)},{default:m(()=>[L($(l(t)("common.done")),1)]),_:1})])])):(s(),V("div",{key:1,class:"space-y-8 cursor-pointer",onClick:r[5]||(r[5]=g=>u.value=!0)},[E("div",we,$(o.model.name),1),E("div",$e,[(s(!0),V(O,null,S(o.model.options,(g,D)=>(s(),V("div",{key:D,class:"bg-999/30 px-8 rounded-normal flex items-center gap-4"},[E("span",null,$(g),1)]))),128))])]))]),_:1})}}}),Oe={class:"space-y-8 w-full"},J=N({props:{model:null,forceSelection:{type:Boolean},nameLabel:null,valueLabel:null,namePlaceholder:null},setup(o){const a=o,{t:c}=B();function u(){a.model.push({name:"",type:a.forceSelection?"Selection":"Custom",options:[]})}function t(v,f){a.model.find(d=>d.name==f)||(v.name=f)}function p(v,f,d){const i=v.options.indexOf(f);i>-1&&v.options.splice(i,1,d)}return(v,f)=>{const d=H;return s(),V("div",Oe,[(s(!0),V(O,null,S(a.model,(i,h)=>(s(),y(De,{key:h,model:i,"force-selection":o.forceSelection,editing:!i.name,"name-label":o.nameLabel,"value-label":o.valueLabel,"name-placeholder":o.namePlaceholder,onChangeName:n=>t(i,n),onChangeOption:(n,r)=>p(i,n,r),onAddOption:n=>i.options.push(n),onDeleteOption:n=>i.options.splice(n,1),onDelete:n=>a.model.splice(a.model.indexOf(i),1)},null,8,["model","force-selection","editing","name-label","value-label","name-placeholder","onChangeName","onChangeOption","onAddOption","onDeleteOption","onDelete"]))),128)),e(d,{circle:"",class:"text-blue",icon:"icon-a-addto",tip:l(c)("common.add"),onClick:u},null,8,["tip"])])}}}),Se={class:"flex items-center gap-12"},G=N({props:{model:null},setup(o){const{t:a}=B();return(c,u)=>{const t=pe,p=fe,v=ve,f=_e,d=A;return s(),y(d,null,{label:m(()=>[E("span",null,$(l(a)("common.isDigitalProduct")),1),e(t,{tip:l(a)("common.digitalProductTip"),"custom-class":"ml-4"},null,8,["tip"])]),default:m(()=>[E("div",Se,[e(p,{modelValue:o.model.isDigital,"onUpdate:modelValue":u[0]||(u[0]=i=>o.model.isDigital=i)},null,8,["modelValue"]),o.model.isDigital?(s(),y(v,{key:0,label:l(a)("common.limitDownloadCount"),"model-value":!!o.model.maxDownloadCount,onClick:u[1]||(u[1]=le(i=>o.model.maxDownloadCount=o.model.maxDownloadCount?void 0:3,["stop","prevent"]))},null,8,["label","model-value"])):k("",!0),o.model.maxDownloadCount?(s(),y(f,{key:1,modelValue:o.model.maxDownloadCount,"onUpdate:modelValue":u[2]||(u[2]=i=>o.model.maxDownloadCount=i),min:1,size:"small"},null,8,["modelValue"])):k("",!0)])]),_:1})}}}),Ne=N({props:{modelValue:{type:Boolean}},emits:["update:modelValue","reload"],setup(o,{emit:a}){const{t:c}=B(),u=C(!0),t=C({name:"",attributes:[],options:[],isDigital:!1,maxDownloadCount:void 0});function p(){return I(this,null,function*(){yield te(t.value),a("reload"),u.value=!1})}return(v,f)=>{const d=j,i=A,h=R,n=z,r=q;return s(),y(r,{"model-value":u.value,width:"600px",title:l(c)("common.create"),"close-on-click-modal":!1,onClosed:f[2]||(f[2]=b=>a("update:modelValue",!1))},{footer:m(()=>[e(n,{onConfirm:p,onCancel:f[1]||(f[1]=b=>u.value=!1)})]),default:m(()=>[e(h,{"label-position":"top"},{default:m(()=>[e(i,{label:l(c)("common.name")},{default:m(()=>[e(d,{modelValue:t.value.name,"onUpdate:modelValue":f[0]||(f[0]=b=>t.value.name=b)},null,8,["modelValue"])]),_:1},8,["label"]),e(i,{label:l(c)("common.attributes")},{default:m(()=>[e(J,{model:t.value.attributes,"name-label":l(c)("common.name"),"value-label":l(c)("common.value"),"name-placeholder":l(c)("common.attributeSamples")},null,8,["model","name-label","value-label","name-placeholder"])]),_:1},8,["label"]),e(i,{label:l(c)("commerce.variantOptions")},{default:m(()=>[e(J,{model:t.value.options,"force-selection":""},null,8,["model"])]),_:1},8,["label"]),e(G,{model:t.value},null,8,["model"])]),_:1})]),_:1},8,["model-value","title"])}}}),Be=N({props:{modelValue:{type:Boolean},model:null},emits:["update:modelValue","reload"],setup(o,{emit:a}){const c=o,{t:u}=B(),t=C(!0),p=C(JSON.parse(JSON.stringify(c.model)));function v(){return I(this,null,function*(){yield ne(p.value),a("reload"),t.value=!1})}return(f,d)=>{const i=j,h=A,n=R,r=z,b=q;return s(),y(b,{"model-value":t.value,width:"600px",title:l(u)("common.edit"),"close-on-click-modal":!1,onClosed:d[2]||(d[2]=x=>a("update:modelValue",!1))},{footer:m(()=>[e(r,{onConfirm:v,onCancel:d[1]||(d[1]=x=>t.value=!1)})]),default:m(()=>[e(n,{"label-position":"top"},{default:m(()=>[e(h,{label:l(u)("common.name")},{default:m(()=>[e(i,{modelValue:p.value.name,"onUpdate:modelValue":d[0]||(d[0]=x=>p.value.name=x)},null,8,["modelValue"])]),_:1},8,["label"]),e(h,{label:l(u)("common.attributes")},{default:m(()=>[e(J,{model:p.value.attributes,"name-label":l(u)("common.name"),"value-label":l(u)("common.value"),"name-placeholder":l(u)("common.attributeSamples")},null,8,["model","name-label","value-label","name-placeholder"])]),_:1},8,["label"]),e(h,{label:l(u)("commerce.variantOptions")},{default:m(()=>[e(J,{model:p.value.options,"force-selection":""},null,8,["model"])]),_:1},8,["label"]),e(G,{model:p.value},null,8,["model"])]),_:1})]),_:1},8,["model-value","title"])}}}),Ie={class:"p-24"},Te={class:"flex items-center py-24"},Fe={class:"flex items-center"},Pe={class:"flex items-center"},Ue={class:"text-black dark:text-[#cfd3dc]"},Le={key:0,class:"flex items-center space-x-4 justify-center"},Je={key:0,class:"flex items-center space-x-4 justify-center"},Ae={class:"flex items-center"},zo=N({setup(o){const{t:a}=B(),u=X().meta.title,t=ae(),p=C(!1),v=C(!1),f=C();function d(h){return I(this,null,function*(){yield ie(h.length),yield me(h.map(n=>n.id)),t.loadTypes()})}Y(()=>I(this,null,function*(){t.loadTypes()}));function i(h){f.value=h,v.value=!0}return(h,n)=>{const r=ge,b=K,x=ye,T=ce,F=he,P=Q,M=Z("hasPermission");return s(),V("div",Ie,[e(oe,{name:l(u)},null,8,["name"]),E("div",Te,[ee((s(),y(b,{round:"",onClick:n[0]||(n[0]=_=>p.value=!0)},{default:m(()=>[E("div",Fe,[e(r,{class:"mr-16 iconfont icon-a-addto"}),L(" "+$(l(a)("common.create")),1)])]),_:1})),[[M,{feature:"productTypes",action:"edit"}]])]),e(P,{data:l(t).types,"show-check":"",onDelete:d},{default:m(()=>[e(x,{label:l(a)("common.name")},{default:m(({row:_})=>[E("div",Pe,[E("span",Ue,$(_.name),1)])]),_:1},8,["label"]),e(x,{label:l(a)("common.attributes"),align:"center"},{default:m(({row:_})=>[_.attributes.length?(s(),V("div",Le,[(s(!0),V(O,null,S(_.attributes,w=>(s(),y(T,{key:w.name,round:"",type:"warning"},{default:m(()=>[L($(w.name),1)]),_:2},1024))),128))])):k("",!0)]),_:1},8,["label"]),e(x,{label:l(a)("commerce.variantOptions"),align:"center"},{default:m(({row:_})=>[_.options.length?(s(),V("div",Je,[(s(!0),V(O,null,S(_.options,w=>(s(),y(T,{key:w.name,round:"",type:"success"},{default:m(()=>[L($(w.name),1)]),_:2},1024))),128))])):k("",!0)]),_:1},8,["label"]),e(x,{label:l(a)("common.isDigitalProduct")},{default:m(({row:_})=>[E("div",Ae,[e(be,{value:_.isDigital},null,8,["value"])])]),_:1},8,["label"]),e(x,{align:"right",width:"60"},{default:m(({row:_})=>[e(F,{placement:"top",content:l(a)("common.edit")},{default:m(()=>[e(r,{class:"iconfont icon-a-writein hover:text-blue text-l",onClick:w=>i(_)},null,8,["onClick"])]),_:2},1032,["content"])]),_:1})]),_:1},8,["data"]),p.value?(s(),y(Ne,{key:0,modelValue:p.value,"onUpdate:modelValue":n[1]||(n[1]=_=>p.value=_),onReload:n[2]||(n[2]=_=>l(t).loadTypes())},null,8,["modelValue"])):k("",!0),v.value?(s(),y(Be,{key:1,modelValue:v.value,"onUpdate:modelValue":n[3]||(n[3]=_=>v.value=_),model:f.value,onReload:n[4]||(n[4]=_=>l(t).loadTypes())},null,8,["modelValue","model"])):k("",!0)])}}});export{zo as default};
