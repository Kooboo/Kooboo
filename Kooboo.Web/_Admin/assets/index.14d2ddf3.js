var D=(C,i,p)=>new Promise((s,c)=>{var e=d=>{try{w(p.next(d))}catch(u){c(u)}},V=d=>{try{w(p.throw(d))}catch(u){c(u)}},w=d=>d.done?s(d.value):Promise.resolve(d.value).then(e,V);w((p=p.apply(C,i)).next())});import{_ as oe}from"./index.5f76a3ad.js";import{B as ne}from"./breadcrumb.edaec300.js";import{g as J,k as se}from"./i18n.bcd18f8a.js";import{_ as ie,c as me,r as ue}from"./index.72ccc088.js";import{u as de,r as re,t as pe,s as ce}from"./commerce.733e9edf.js";import{a as fe,_ as ve}from"./selection-editor.8e0c8e3a.js";import{a as H,r as _e,l as ye}from"./validate.238a9986.js";import{_ as be}from"./index.7a75fca3.js";import{f as O}from"./custom-field.b807d01a.js";import{g as ge}from"./content-folder.85389bae.js";import{i as Ve,a as we}from"./string.75b81683.js";import{_ as Se}from"./plugin-vue_export-helper.21dcd24c.js";import{E as W}from"./index.5cbbc5d7.js";import{E as Fe}from"./index.daafc4da.js";import{E as Q,a as X}from"./index.6d63eb53.js";import{E as M,a as q,c as xe}from"./index.6d22f937.js";import{E as Ce,a as Ee}from"./index.6c05d6c4.js";import{E as ke}from"./index.79f78425.js";import{E as Ne}from"./index.d4a6b2d5.js";import{d as A,g as F,c as j,i as Y,o as m,j as f,w as o,b as t,u as a,f as U,aH as T,t as N,a as B,b6 as I,F as R,k as x,az as Ue}from"./url.8f5ec20c.js";import{a as $e,p as Te,c as Be}from"./useLabels.a0b6497c.js";import"./index.aec72f69.js";import"./windi.19264205.js";import"./index.05e21f33.js";import"./replace-all.d441bf14.js";import"./main.582f9de6.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";/* empty css                                                               */import"./plugin-vue_export-helper.41ffa612.js";import"./classCompletion.a22e38a6.js";import"./userWorker.b3a6730b.js";import"./editor.main.d2800f63.js";import"./guid.c1a40312.js";import"./vuedraggable.umd.7929a3b6.js";import"./index.ec6ad7db.js";import"./focus-trap.eafcfd1f.js";import"./isNil.98bb3b88.js";import"./event.53b2ad83.js";import"./cloneDeep.060340c1.js";import"./_baseClone.eeff2792.js";import"./_baseIsEqual.547729d3.js";import"./tooltip.e27982e5.js";import"./index.0a8d3d17.js";import"./event.776e7e11.js";import"./index.c80f5028.js";import"./error.7e8331f1.js";import"./index.e3f90979.js";import"./index.2341329b.js";import"./index.bda83f28.js";import"./index.bff48780.js";import"./index.649f6c77.js";import"./index.a32fb6e5.js";import"./style.9c8f6403.js";import"./toNumber.6efebd6a.js";import"./isEqual.11d86bcc.js";import"./scroll.4888a9e9.js";import"./debounce.730e1961.js";import"./index.9a83ee01.js";import"./validator.b73911a9.js";import"./index.a3d8335f.js";import"./refs.d2253dd4.js";const he={class:"w-full flex items-center"},Oe={class:"w-full flex items-center"},De=A({props:{modelValue:{type:Boolean},field:null,fields:null},emits:["update:modelValue","success"],setup(C,{emit:i}){const p=C,{t:s}=J(),c=F(!0),e=F(JSON.parse(JSON.stringify(p.field))),V=j(()=>p.fields.filter(y=>!Ve(y.name,p.field.name))),w=F([]),d=F(),u=F(),b=[{displayName:s("common.basic"),value:"Basic"},{displayName:s("common.advanced"),value:"Advanced"},{displayName:s("common.validation"),value:"Validation"}],E=F("Basic"),r={name:[H(s("common.fieldRequiredTips")),_e(1,50),ye(),{validator(y,l){const n=l==null?void 0:l.toLowerCase();return!V.value.find($=>$.name.toLowerCase()==n)},message:()=>s("common.valueHasBeenTakenTips")}],contentFolder:e.value.isSystemField?[]:[H(s("common.fieldRequiredTips"))]},_=j(()=>se(e.value,"options.disableMultiple",!1));function S(){return D(this,null,function*(){var y,l;try{yield(l=(y=d.value)==null?void 0:y.form)==null?void 0:l.validate()}catch(n){throw E.value="Validation",Error("Validation not valid")}try{yield u.value.validate()}catch(n){throw E.value="Basic",Error("Basic not valid")}i("success",e.value),c.value=!1})}return Y(()=>e.value.type,y=>D(this,null,function*(){var l;we(["Content","RichEditor"],y)&&(e.value.isSummaryField=!1),(l=w.value)!=null&&l.length||(w.value=yield ge())}),{immediate:!0}),(y,l)=>{const n=W,$=Fe,k=Q,P=M,z=q,Z=ve,ee=X,L=Ce,le=Ee,ae=ke,te=Ne;return m(),f(te,{"model-value":c.value,width:"700px","close-on-click-modal":!1,title:a(s)("common.fieldEditor"),"custom-class":"el-dialog--zero-padding",onClosed:l[11]||(l[11]=g=>i("update:modelValue",!1))},{footer:o(()=>[t(be,{onConfirm:S,onCancel:l[10]||(l[10]=g=>c.value=!1)})]),default:o(()=>[t(ae,{"max-height":"60vh"},{default:o(()=>[t(le,{modelValue:E.value,"onUpdate:modelValue":l[9]||(l[9]=g=>E.value=g)},{default:o(()=>[t(L,{label:a(b)[0].displayName,name:a(b)[0].value},{default:o(()=>[t(ee,{ref_key:"form",ref:u,model:e.value,rules:r,"label-position":"top"},{default:o(()=>{var g;return[t(k,{prop:"name",label:a(s)("common.name")},{default:o(()=>[U("div",he,[t(n,{modelValue:e.value.name,"onUpdate:modelValue":l[0]||(l[0]=v=>e.value.name=v),disabled:!!e.value.name&&e.value.isSystemField,class:"w-3/5","data-cy":"field-name-input"},null,8,["modelValue","disabled"]),t($,{modelValue:e.value.isSummaryField,"onUpdate:modelValue":l[1]||(l[1]=v=>e.value.isSummaryField=v),class:"ml-12","data-cy":"summary-field"},{default:o(()=>[T(N(a(s)("common.summaryField")),1)]),_:1},8,["modelValue"])])]),_:1},8,["label"]),t(k,{label:a(s)("common.displayName")},{default:o(()=>[t(n,{modelValue:e.value.displayName,"onUpdate:modelValue":l[2]||(l[2]=v=>e.value.displayName=v),class:"w-3/5","data-cy":"display-name-input"},null,8,["modelValue"])]),_:1},8,["label"]),t(k,{prop:"type",label:a(s)("common.controlType")},{default:o(()=>{var v;return[U("div",Oe,[t(z,{modelValue:e.value.type,"onUpdate:modelValue":l[3]||(l[3]=h=>e.value.type=h),disabled:e.value.isSystemField,class:"w-3/5","data-cy":"control-type-dropdown"},{default:o(()=>[(m(!0),B(R,null,I(a(O),(h,G)=>(m(),f(P,{key:G,value:G,label:h.displayName},null,8,["value","label"]))),128))]),_:1},8,["modelValue","disabled"]),(v=a(O)[e.value.type])!=null&&v.multiple?(m(),f($,{key:0,modelValue:e.value.multiple,"onUpdate:modelValue":l[4]||(l[4]=h=>e.value.multiple=h),disabled:a(_),class:"ml-12","data-cy":"enable-multiple"},{default:o(()=>[T(N(a(s)("common.enableMultiple")),1)]),_:1},8,["modelValue","disabled"])):x("",!0)])]}),_:1},8,["label"]),(g=a(O)[e.value.type])!=null&&g.selection?(m(),f(k,{key:0,label:a(s)("common.options")},{default:o(()=>[t(Z,{options:e.value.selectionOptions},null,8,["options"])]),_:1},8,["label"])):x("",!0),e.value.type=="Content"?(m(),f(k,{key:1,label:a(s)("common.contentFolder"),prop:"contentFolder"},{default:o(()=>[t(z,{modelValue:e.value.contentFolder,"onUpdate:modelValue":l[5]||(l[5]=v=>e.value.contentFolder=v),class:"w-3/5"},{default:o(()=>[(m(!0),B(R,null,I(w.value,v=>(m(),f(P,{key:v.name,value:v.name,label:v.name||v.displayName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])):x("",!0)]}),_:1},8,["model"])]),_:1},8,["label","name"]),e.value.isSystemField?x("",!0):(m(),f(L,{key:0,label:a(b)[1].displayName,name:a(b)[1].value},{default:o(()=>[t(k,null,{default:o(()=>[t($,{modelValue:e.value.editable,"onUpdate:modelValue":l[6]||(l[6]=g=>e.value.editable=g)},{default:o(()=>[T(N(a(s)("common.userEditable")),1)]),_:1},8,["modelValue"])]),_:1}),a(O)[e.value.type].multilingual?(m(),f(k,{key:0},{default:o(()=>[t($,{modelValue:e.value.multilingual,"onUpdate:modelValue":l[7]||(l[7]=g=>e.value.multilingual=g)},{default:o(()=>[T(N(a(s)("common.enableMultilingual")),1)]),_:1},8,["modelValue"])]),_:1})):x("",!0),e.value.multiple&&e.value.type=="Content"?(m(),f(k,{key:1},{default:o(()=>[t($,{modelValue:e.value.allowRepetition,"onUpdate:modelValue":l[8]||(l[8]=g=>e.value.allowRepetition=g)},{default:o(()=>[T(N(a(s)("common.allowRepetition")),1)]),_:1},8,["modelValue"])]),_:1})):x("",!0)]),_:1},8,["label","name"])),e.value.isSystemField?x("",!0):(m(),f(L,{key:1,label:a(b)[2].displayName,name:a(b)[2].value},{default:o(()=>[t(fe,{ref_key:"fieldValidation",ref:d,field:{controlType:e.value.type,validations:e.value.validations},onSave:S},null,8,["field"])]),_:1},8,["label","name"]))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model-value","title"])}}});var Ie=Se(De,[["__scopeId","data-v-a6bbb1d6"]]);const Re={class:"w-full"},Le={class:"flex items-center"},Me={class:"ellipsis flex-1"},K=A({props:{data:null,labels:null},setup(C){const i=C,{t:p}=J(),{getFieldDisplayName:s}=$e(i.labels),c=F(!1),e=F();let V=-1;function w(){e.value={name:"",type:"TextBox",displayName:"",editable:!0,validations:[],multiple:!1,selectionOptions:[],isSystemField:!1,isSummaryField:!1,multilingual:!1},V=-1,c.value=!0}function d(r,_){e.value=_,V=i.data.indexOf(_),c.value=!0}function u(r){V==-1?i.data.push(r):i.data.splice(V,1,r)}function b(r){const _=i.data.findIndex(S=>S.name==r);_>-1&&i.data.splice(_,1)}function E(r){const _=i.data.splice(r.oldIndex,1)[0];i.data.splice(r.newIndex,0,_)}return(r,_)=>{const S=xe,y=ie;return m(),B("div",Re,[t(y,{"wrapper-class":"space-y-4 w-full",list:C.data,"id-prop":"name",editable:"","disable-actions":{delete:l=>l.isSystemField},"delete-tip":l=>l.isSystemField?a(p)("common.systemFieldNotSupportDelete"):"",onAdd:w,onDelete:b,onSort:E,onEdit:d},{default:o(({item:l})=>[U("div",Le,[U("div",Me,N(a(s)(l)),1),l.isSummaryField?(m(),f(S,{key:0,round:"",class:"mr-4",type:"warning"},{default:o(()=>[T(N(a(p)("common.summaryField")),1)]),_:1})):x("",!0),t(S,{round:""},{default:o(()=>{var n;return[T(N((n=a(O)[l.type])==null?void 0:n.displayName),1)]}),_:2},1024)])]),_:1},8,["list","disable-actions","delete-tip"]),(m(),f(Ue,{to:"body"},[c.value&&e.value?(m(),f(Ie,{key:0,modelValue:c.value,"onUpdate:modelValue":_[0]||(_[0]=l=>c.value=l),field:e.value,fields:C.data,onSuccess:u},null,8,["modelValue","field","fields"])):x("",!0)]))])}}}),qe={class:"p-24 pb-150px"},Je={class:"rounded-normal bg-fff dark:bg-[#252526] mt-16 mb-24 py-24 px-56px"},Ae={class:"max-w-504px"},Pe={class:"rounded-normal bg-fff dark:bg-[#252526] mt-16 mb-24 py-24 px-56px"},ze={class:"max-w-504px"},ea=A({setup(C){const{t:i}=J(),p=F([]),s=F([]),c=de();re().then(d=>{p.value=d}),pe().then(d=>{s.value=d});const e=F(),V=()=>D(this,null,function*(){yield ce(e.value),c.loadSettings(),ue()});function w(d){if(!!p.value){var u=p.value.find(b=>b.code==d);u&&(e.value.currencySymbol=u.symbolNative)}}return Y(()=>c.settings,()=>{e.value=JSON.parse(JSON.stringify(c.settings))},{immediate:!0}),me("save",V),(d,u)=>{const b=M,E=q,r=Q,_=W,S=M,y=q,l=X;return m(),B("div",qe,[t(ne,{name:a(i)("commerce.commerceSettings")},null,8,["name"]),e.value?(m(),f(l,{key:0,"label-position":"top"},{default:o(()=>[U("div",Je,[U("div",Ae,[t(r,{label:a(i)("common.currency")},{default:o(()=>[t(E,{modelValue:e.value.currencyCode,"onUpdate:modelValue":u[0]||(u[0]=n=>e.value.currencyCode=n),class:"w-full",onChange:w},{default:o(()=>[(m(!0),B(R,null,I(p.value,n=>(m(),f(b,{key:n.code,value:n.code,label:`${n.namePlural} - ${n.code} - ${n.symbolNative}`},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(r,{label:a(i)("commerce.shippingCost")},{default:o(()=>[t(_,{modelValue:e.value.shippingCost,"onUpdate:modelValue":u[1]||(u[1]=n=>e.value.shippingCost=n),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1},8,["label"]),t(r,{label:a(i)("common.weightUnit")},{default:o(()=>[t(y,{modelValue:e.value.weightUnit,"onUpdate:modelValue":u[2]||(u[2]=n=>e.value.weightUnit=n),class:"w-full"},{default:o(()=>[t(S,{label:"KG",value:"kg"}),t(S,{label:"G",value:"g"})]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(r,{label:a(i)("commerce.payments")},{default:o(()=>[t(y,{modelValue:e.value.payments,"onUpdate:modelValue":u[3]||(u[3]=n=>e.value.payments=n),multiple:"",class:"w-full"},{default:o(()=>[(m(!0),B(R,null,I(s.value,n=>(m(),f(S,{key:n.key,label:n.value,value:n.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])])]),U("div",Pe,[U("div",ze,[t(r,{label:a(i)("commerce.nameFields",{name:a(i)("commerce.product")})},{default:o(()=>[t(K,{data:e.value.productCustomFields,labels:a(Te)},null,8,["data","labels"])]),_:1},8,["label"]),t(r,{label:a(i)("commerce.nameFields",{name:a(i)("common.category")})},{default:o(()=>[t(K,{data:e.value.categoryCustomFields,labels:a(Be)},null,8,["data","labels"])]),_:1},8,["label"])])])]),_:1})):x("",!0),t(oe,{"hidden-cancel":"",onSave:V})])}}});export{ea as default};
