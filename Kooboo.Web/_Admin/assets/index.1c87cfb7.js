var z=Object.defineProperty;var R=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var B=(c,l,t)=>l in c?z(c,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):c[l]=t,F=(c,l)=>{for(var t in l||(l={}))G.call(l,t)&&B(c,t,l[t]);if(R)for(var t of R(l))H.call(l,t)&&B(c,t,l[t]);return c};var E=(c,l,t)=>new Promise((m,V)=>{var a=d=>{try{n(t.next(d))}catch(y){V(y)}},f=d=>{try{n(t.throw(d))}catch(y){V(y)}},n=d=>d.done?m(d.value):Promise.resolve(d.value).then(a,f);n((t=t.apply(c,l)).next())});import{_ as J}from"./k-table.d4486972.js";import{g as A,w as Q,o as W}from"./i18n.48bd28ac.js";import{b as X,c as Y,g as Z,d as ee,e as oe,i as le}from"./index.2c90a407.js";import{u as ae}from"./use-date.01b82ce0.js";import{B as se,a as T,E as I,C as D,e as te,p as ne,F as re}from"./validate.efc4a5c0.js";import{_ as h}from"./index.a731e53b.js";import{E as j}from"./index.fc90f5ad.js";import{E as q,a as K,S as me}from"./index.6855d037.js";import{E as ue,a as de}from"./index.0d2684bf.js";import{E as L}from"./index.c4e9b529.js";import{d as N,g as v,o as k,j as U,w as r,b as o,u as s,a as $,b6 as ie,F as M,k as S,i as pe,f as b,t as x,cg as ce}from"./url.2e6a77c4.js";import{E as fe}from"./index.2bc50276.js";import{E as ve}from"./index.b494e80e.js";import"./sortable.esm.a99254e8.js";import"./icon-button.3313e42d.js";import"./windi.a5b0b048.js";import"./index.379e80ad.js";import"./focus-trap.23f44899.js";import"./isNil.98bb3b88.js";import"./event.53b2ad83.js";import"./index.ff0264f3.js";import"./index.8262f5ef.js";import"./index.fcc3ea42.js";import"./main.ea42d807.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";import"./replace-all.7cf5f327.js";import"./index.7034978e.js";import"./isEqual.f1ae9fb3.js";import"./_baseIsEqual.c0d7e77a.js";import"./error.7e8331f1.js";import"./index.77edae39.js";import"./event.776e7e11.js";import"./index.695d0284.js";import"./dayjs.min.0a66969b.js";import"./index.d75a71d9.js";import"./index.aba77680.js";import"./index.6d45a031.js";import"./index.31f26a0f.js";import"./index.60af85f4.js";import"./style.19d0c187.js";import"./toNumber.574be4f1.js";import"./_baseClone.adbc92f5.js";import"./index.a439b087.js";import"./scroll.f51de5d8.js";import"./debounce.61c67278.js";import"./index.064c7de9.js";import"./validator.e2869aba.js";import"./index.603c1365.js";import"./refs.4001ce17.js";const we={key:0},_e=N({props:{modelValue:{type:Boolean},addType:null},emits:["update:modelValue","add-success"],setup(c,{emit:l}){const t=c,{t:m}=A(),V=v(!0),a=v({username:"",password:"",serverId:"",remark:"",email:"",phone:""}),f=v([]),n=v(),d={username:t.addType==="new"?se:T(m("common.inputUsernameTips")),password:t.addType==="new"?[I,D,T(m("common.inputPasswordTips"))]:[T(m("common.inputPasswordTips"))],email:te,phone:ne},y=()=>E(this,null,function*(){yield n.value.validate(),t.addType==="new"?yield X(a.value):yield Y(a.value),V.value=!1,l("add-success")});return(()=>E(this,null,function*(){f.value=yield Z(),f.value.length&&(a.value.serverId=f.value[0].id)}))(),(P,e)=>{const i=j,w=q,g=ue,u=de,_=K,O=L;return k(),U(O,{"model-value":V.value,width:"670px",title:c.addType==="new"?s(m)("common.addSubAccount"):s(m)("common.addExisting"),onClosed:e[8]||(e[8]=p=>l("update:modelValue",!1))},{footer:r(()=>[o(h,{"confirm-label":s(m)("common.add"),onConfirm:y,onCancel:e[7]||(e[7]=p=>V.value=!1)},null,8,["confirm-label"])]),default:r(()=>[o(_,{ref_key:"form",ref:n,class:"el-form--label-normal",model:a.value,rules:d,"label-position":"left","label-width":"150px",onSubmit:e[6]||(e[6]=Q(()=>{},["prevent"]))},{default:r(()=>[o(w,{prop:"username",label:s(m)("common.username")},{default:r(()=>[o(i,{modelValue:a.value.username,"onUpdate:modelValue":e[0]||(e[0]=p=>a.value.username=p),class:"w-400px"},null,8,["modelValue"])]),_:1},8,["label"]),o(w,{prop:"password",label:s(m)("common.password")},{default:r(()=>[o(i,{modelValue:a.value.password,"onUpdate:modelValue":e[1]||(e[1]=p=>a.value.password=p),class:"w-400px",type:"password"},null,8,["modelValue"])]),_:1},8,["label"]),o(w,{prop:"server",label:s(m)("common.server")},{default:r(()=>[o(u,{modelValue:a.value.serverId,"onUpdate:modelValue":e[2]||(e[2]=p=>a.value.serverId=p),class:"w-400px",placeholder:" "},{default:r(()=>[(k(!0),$(M,null,ie(f.value,p=>(k(),U(g,{key:p.id,label:p.displayName,value:p.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),c.addType==="new"?(k(),$("div",we,[o(w,{prop:"remark",label:s(m)("common.remark")},{default:r(()=>[o(i,{modelValue:a.value.remark,"onUpdate:modelValue":e[3]||(e[3]=p=>a.value.remark=p),class:"w-400px"},null,8,["modelValue"])]),_:1},8,["label"]),o(w,{prop:"email",label:s(m)("common.email")},{default:r(()=>[o(i,{modelValue:a.value.email,"onUpdate:modelValue":e[4]||(e[4]=p=>a.value.email=p),class:"w-400px"},null,8,["modelValue"])]),_:1},8,["label"]),o(w,{prop:"phone",label:s(m)("common.phone")},{default:r(()=>[o(i,{modelValue:a.value.phone,"onUpdate:modelValue":e[5]||(e[5]=p=>a.value.phone=p),class:"w-400px"},null,8,["modelValue"])]),_:1},8,["label"])])):S("",!0)]),_:1},8,["model","rules"])]),_:1},8,["model-value","title"])}}}),be=N({props:{modelValue:{type:Boolean},username:null},emits:["update:modelValue"],setup(c,{emit:l}){const t=c,m=v(),V=()=>E(this,null,function*(){n.value.confirmPassword.length>0&&(yield m.value.validateField("confirmPassword"))}),{t:a}=A(),f=v(!0),n=v({confirmPassword:"",password:""}),d={password:[T(a("common.fieldRequiredTips"),!1),I,D],confirmPassword:[T(a("common.fieldRequiredTips"),!1),re(n.value)]},y=new me(d);pe(()=>n,P=>{P&&y.validate(n,e=>{e||m.value.clearValidate()})},{deep:!0});const C=()=>E(this,null,function*(){if(yield m.value.validate(),n.value.password===n.value.confirmPassword){const P={password:n.value.password,username:t.username};try{yield ee(F({},P)),f.value=!1}catch(e){console.log(e)}}});return(P,e)=>{const i=j,w=q,g=K,u=L;return k(),U(u,{modelValue:f.value,"onUpdate:modelValue":e[4]||(e[4]=_=>f.value=_),width:"400px",title:s(a)("common.changePassword"),onClosed:e[5]||(e[5]=_=>l("update:modelValue",!1))},{footer:r(()=>[o(h,{"confirm-label":s(a)("profile.change"),onConfirm:e[2]||(e[2]=_=>C()),onCancel:e[3]||(e[3]=_=>f.value=!1)},null,8,["confirm-label"])]),default:r(()=>[o(g,{ref_key:"changePasswordForm",ref:m,rules:s(d),"label-position":"top",model:n.value,onKeydown:W(C,["enter"])},{default:r(()=>[o(w,{label:s(a)("common.newPassword"),prop:"password"},{default:r(()=>[o(i,{modelValue:n.value.password,"onUpdate:modelValue":e[0]||(e[0]=_=>n.value.password=_),type:"password","data-cy":"new-password",onBlur:V},null,8,["modelValue"])]),_:1},8,["label"]),o(w,{label:s(a)("common.confirmPassword"),prop:"confirmPassword"},{default:r(()=>[o(i,{modelValue:n.value.confirmPassword,"onUpdate:modelValue":e[1]||(e[1]=_=>n.value.confirmPassword=_),type:"password","data-cy":"confirm-password"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["rules","model","onKeydown"])]),_:1},8,["modelValue","title"])}}}),Ve={class:"p-24"},ye={class:"flex items-center pb-24 space-x-16"},ge={class:"flex items-center"},xe={class:"flex items-center"},ke={class:"flex items-center space-x-8 justify-center"},Pe=["onClick"],Ee=["onClick"],Po=N({setup(c){const{t:l}=A(),t=v([]),m=v(),V=v(),a=()=>E(this,null,function*(){t.value=yield oe()}),f=v(),n=v(!1),d=v(!1),y=e=>{f.value=e,d.value=!0},C=e=>{m.value=e,n.value=!0},P=e=>E(this,null,function*(){V.value=yield le(e),ce(V.value)});return a(),(e,i)=>{const w=fe,g=ve;return k(),$(M,null,[b("div",Ve,[b("div",ye,[o(w,{round:"",onClick:i[0]||(i[0]=u=>y("new"))},{default:r(()=>[b("div",ge,x(s(l)("common.addSubAccount")),1)]),_:1}),o(w,{round:"",onClick:i[1]||(i[1]=u=>y("existing"))},{default:r(()=>[b("div",xe,x(s(l)("common.addExisting")),1)]),_:1})]),o(s(J),{data:t.value},{default:r(()=>[o(g,{label:s(l)("common.username")},{default:r(({row:u})=>[b("span",null,x(u.userName),1)]),_:1},8,["label"]),o(g,{label:s(l)("common.remark")},{default:r(({row:u})=>[b("span",null,x(u.remark),1)]),_:1},8,["label"]),o(g,{label:s(l)("common.email")},{default:r(({row:u})=>[b("span",null,x(u.email),1)]),_:1},8,["label"]),o(g,{label:s(l)("common.phone")},{default:r(({row:u})=>[b("span",null,x(u.phone),1)]),_:1},8,["label"]),o(g,{label:s(l)("common.joinDate")},{default:r(({row:u})=>[b("span",null,x(s(ae)(u.joinDate)),1)]),_:1},8,["label"]),o(g,{label:s(l)("common.action"),align:"center",width:"260"},{default:r(({row:u})=>[b("div",ke,[b("span",{class:"text-blue cursor-pointer",onClick:_=>C(u.userName)},x(s(l)("partner.resetPassword")),9,Pe),b("span",{class:"text-blue cursor-pointer",onClick:_=>P(u.userName)},x(s(l)("common.impersonate")),9,Ee)])]),_:1},8,["label"])]),_:1},8,["data"])]),d.value?(k(),U(_e,{key:0,modelValue:d.value,"onUpdate:modelValue":i[2]||(i[2]=u=>d.value=u),"add-type":f.value,onAddSuccess:a},null,8,["modelValue","add-type"])):S("",!0),n.value?(k(),U(be,{key:1,modelValue:n.value,"onUpdate:modelValue":i[3]||(i[3]=u=>n.value=u),username:m.value},null,8,["modelValue","username"])):S("",!0)],64)}}});export{Po as default};
