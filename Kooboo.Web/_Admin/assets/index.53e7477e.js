var C=(E,s,o)=>new Promise((u,r)=>{var a=v=>{try{_(o.next(v))}catch(m){r(m)}},g=v=>{try{_(o.throw(v))}catch(m){r(m)}},_=v=>v.done?u(v.value):Promise.resolve(v.value).then(a,g);_((o=o.apply(E,s)).next())});import{_ as ee}from"./k-table.c13bd7f5.js";import{b as M,T as oe,V as te,W as le,X as ae,w as ne,Y as se,Z as re,_ as me}from"./main.1c3b59e3.js";import{g as T,o as ie,w as H}from"./i18n.25caaace.js";import{a as ue}from"./use-date.55b953fa.js";import{s as I}from"./confirm.629bcef4.js";import{_ as W}from"./index.50326354.js";import{a as R,s as de,S as L,C as ce,e as pe,p as fe}from"./validate.f3c0b03b.js";import{E as X}from"./index.f571dfc9.js";import{E as Y,a as Z}from"./index.94998415.js";import{E as j}from"./index.a5d96e5a.js";import{d as B,g as V,o as b,j as O,w as n,b as l,u as e,cd as _e,c as P,b7 as ve,aH as $,t as d,k as U,e as be,f as t,a as S,b6 as ge,n as xe,F as G,N as we,aF as Ve}from"./url.8f5ec20c.js";import{E as J}from"./windi.a815125a.js";import{E as ye}from"./index.c6488b3c.js";import{E as Q}from"./index.e9f8834a.js";import{u as he}from"./replace-all.b35629e7.js";import{E as Oe}from"./index.5388dbc8.js";import"./sortable.esm.a99254e8.js";import"./icon-button.0e134c9b.js";import"./index.158cdd11.js";import"./focus-trap.81e4fb05.js";import"./isNil.98bb3b88.js";import"./event.53b2ad83.js";import"./index.1e7e06b8.js";import"./index.0c2ced08.js";import"./index.f9c89813.js";import"./index.a9a077b4.js";import"./index.960b9732.js";import"./error.7e8331f1.js";import"./event.776e7e11.js";import"./scroll.0cf77af8.js";import"./isEqual.2e410d13.js";import"./_baseIsEqual.0a4e01e5.js";import"./debounce.730e1961.js";import"./toNumber.6efebd6a.js";import"./index.c93fe8e7.js";import"./validator.9b0d789f.js";import"./index.2e51d36e.js";import"./index.5b499f72.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";import"./dayjs.min.2044f1dd.js";import"./logo-transparent.1566007e.js";import"./index.60799c00.js";import"./index.1d16d007.js";import"./aria.75ec5909.js";import"./index.878e2bbf.js";import"./index.adb17f32.js";import"./index.b065185c.js";import"./index.ab12ea9e.js";import"./index.b1b64a44.js";import"./style.1b77b3a2.js";import"./_baseClone.885c975f.js";import"./refs.d2253dd4.js";const ke=B({props:{modelValue:{type:Boolean}},emits:["update:modelValue","addSuccess"],setup(E,{emit:s}){const o=M(),{t:u}=T(),r=V(),a=V({userName:"",organizationId:o.currentOrg.id}),g=V(!0),_=V({userName:[R(u("common.fieldRequiredTips")),de()]}),v=()=>C(this,null,function*(){yield r.value.validate(),yield oe(a.value),g.value=!1,a.value.userName="",s("addSuccess")});return(m,p)=>{const k=X,y=Y,c=Z,i=W,f=j;return b(),O(f,{modelValue:g.value,"onUpdate:modelValue":p[3]||(p[3]=h=>g.value=h),width:"400px",title:e(u)("common.addMember"),onClosed:p[4]||(p[4]=h=>s("update:modelValue",!1))},{footer:n(()=>[l(i,{"confirm-label":e(u)("common.add"),onConfirm:v,onCancel:p[2]||(p[2]=h=>g.value=!1)},null,8,["confirm-label"])]),default:n(()=>[l(c,{ref_key:"form",ref:r,modal:a.value,rules:_.value,"label-position":"top",model:a.value,onSubmit:p[1]||(p[1]=H(()=>{},["prevent"]))},{default:n(()=>[l(y,{prop:"userName",label:e(u)("common.username")},{default:n(()=>[l(k,{modelValue:a.value.userName,"onUpdate:modelValue":p[0]||(p[0]=h=>a.value.userName=h),onKeydown:ie(v,["enter"])},null,8,["modelValue","onKeydown"])]),_:1},8,["label"])]),_:1},8,["modal","rules","model"])]),_:1},8,["modelValue","title"])}}}),Ce={class:"px-16 mt-8 space-y-8"},Ue=["onClick"],Ne={class:"flex justify-between items-center py-24 pr-4"},$e={class:"flex items-center justify-between w-[460px]"},Ee={class:"flex items-center"},ze=["title"],Se={key:0,class:"flex-1 text-12px flex items-center bg-blue/10 text-blue px-10px h-20px rounded-full mx-12"},Ae=B({props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(E,{emit:s}){const{t:o}=T(),u=M(),r=_e(),a=V(),g=P(()=>{var f;const i=(f=_.value)==null?void 0:f.find(h=>h.id===a.value);return i?i.isAdmin===!0:!1}),_=V(),v=V(!0),m=()=>C(this,null,function*(){yield I(o("common.switchOrganizationTips")),yield te(a.value),u.logout(),r.push({name:"login"})}),p=()=>C(this,null,function*(){yield I(o("common.departOrganizationTips")),yield le(a.value),u.logout(),r.push({name:"login"})}),k=P(()=>{var i;return!((i=_.value)!=null&&i.some(f=>f.isAdmin===!0))}),y=()=>C(this,null,function*(){yield ae(),c()}),c=()=>C(this,null,function*(){_.value=yield ne(),a.value=u.currentOrg.id});return c(),(i,f)=>{const h=J,z=ye,N=Q,A=j,D=ve("hasPermission");return b(),O(A,{modelValue:v.value,"onUpdate:modelValue":f[1]||(f[1]=x=>v.value=x),width:"650px",title:e(o)("common.organizationAdmin"),"custom-class":"el-dialog--zero-padding",onClosed:f[2]||(f[2]=x=>s("update:modelValue",!1))},{footer:n(()=>[l(N,{"data-cy":"cancel-in-dialog",onClick:f[0]||(f[0]=x=>v.value=!1)},{default:n(()=>[$(d(e(o)("common.cancel")),1)]),_:1}),l(N,{round:"",disabled:e(g)||!a.value,onClick:p},{default:n(()=>[$(d(e(o)("common.depart")),1)]),_:1},8,["disabled"]),e(k)?(b(),O(N,{key:0,round:"",onClick:y},{default:n(()=>[$(d(e(o)("common.createOwnOrg")),1)]),_:1})):U("",!0),be((b(),O(N,{round:"",type:"primary",disabled:e(u).currentOrg.id===a.value||!a.value,onClick:m},{default:n(()=>[$(d(e(o)("domain.switch")),1)]),_:1},8,["disabled"])),[[D,{feature:"style",action:"edit"}]])]),default:n(()=>[l(z,{"max-height":"240px",always:""},{default:n(()=>[t("ul",Ce,[(b(!0),S(G,null,ge(_.value,x=>(b(),S("li",{key:x.id,class:xe(["pl-16 pr-8 cursor-pointer border-transparent hover:border-blue border-1 border-solid rounded-normal hover:bg-[#2296F3] hover:bg-opacity-10",x.id===a.value?"  bg-[#2296F3] bg-opacity-10 !border-blue":""]),onClick:F=>a.value=x.id},[t("div",Ne,[t("div",$e,[t("div",Ee,[t("span",{class:"ellipsis max-w-200px leading-5",title:x.name},d(x.name),9,ze),x.id===e(u).currentOrg.id?(b(),S("span",Se,d(e(o)("common.currentOrganization")),1)):U("",!0)]),t("span",null,d(x.members)+" "+d(e(o)("organization.members")),1)]),t("div",null,[x.id===a.value?(b(),O(h,{key:0,class:"iconfont icon-Select2 text-green text-xl"})):U("",!0)])])],10,Ue))),128))])]),_:1})]),_:1},8,["modelValue","title"])}}}),De=B({props:{modelValue:{type:Boolean}},emits:["update:modelValue","create-success"],setup(E,{emit:s}){const{t:o}=T(),u=V(!0),r=V({userName:"",password:"",email:"",phone:""}),a=V(),g={userName:[R(o("common.fieldRequiredTips")),L(o("common.username"),2,30)],password:[ce,R(o("common.inputPasswordTips")),L(o("common.password"),2,30)],email:[pe,R(o("common.inputEmailTips"))],phone:[fe]},_=()=>C(this,null,function*(){yield a.value.validate(),yield se(r.value),u.value=!1,s("create-success")});return(v,m)=>{const p=X,k=Y,y=Z,c=j;return b(),O(c,{"model-value":u.value,width:"670px",title:e(o)("common.create"),onClosed:m[6]||(m[6]=i=>s("update:modelValue",!1))},{footer:n(()=>[l(W,{onConfirm:_,onCancel:m[5]||(m[5]=i=>u.value=!1)})]),default:n(()=>[l(y,{ref_key:"form",ref:a,class:"el-form--label-normal",model:r.value,rules:g,"label-position":"left","label-width":"150px",onSubmit:m[4]||(m[4]=H(()=>{},["prevent"]))},{default:n(()=>[l(k,{prop:"userName",label:e(o)("common.username")},{default:n(()=>[l(p,{modelValue:r.value.userName,"onUpdate:modelValue":m[0]||(m[0]=i=>r.value.userName=i),class:"w-400px"},null,8,["modelValue"])]),_:1},8,["label"]),l(k,{prop:"password",label:e(o)("common.password")},{default:n(()=>[l(p,{modelValue:r.value.password,"onUpdate:modelValue":m[1]||(m[1]=i=>r.value.password=i),class:"w-400px",type:"password"},null,8,["modelValue"])]),_:1},8,["label"]),l(k,{prop:"email",label:e(o)("common.email")},{default:n(()=>[l(p,{modelValue:r.value.email,"onUpdate:modelValue":m[2]||(m[2]=i=>r.value.email=i),class:"w-400px"},null,8,["modelValue"])]),_:1},8,["label"]),l(k,{prop:"phone",label:e(o)("common.phone")},{default:n(()=>[l(p,{modelValue:r.value.phone,"onUpdate:modelValue":m[3]||(m[3]=i=>r.value.phone=i),class:"w-400px"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["model-value","title"])}}}),Re={class:"p-24 space-y-16"},Te={class:"flex gap-8 items-center dark:text-gray"},Be={class:"flex space-x-24"},Fe={class:"text-blue ml-8"},Ie={class:"text-blue ml-8"},Me={class:"text-blue ml-8"},je=t("div",{class:"flex-1"},null,-1),qe={class:"flex items-center"},Ke={class:"flex items-center"},Le={class:"h-60px flex items-center justify-between px-16"},Pe={class:"flex items-center"},He={class:"flex items-center"},We={class:"flex items-center"},Xe={key:0,class:"text-12px flex items-center bg-blue/10 text-blue px-10px h-20px rounded-full ml-16"},Zo=B({setup(E){const{t:s}=T(),o=M(),u=V([]),r=V(!1),a=V(!1),g=V(!1),_=()=>C(this,null,function*(){var y;u.value=yield re((y=o.currentOrg)==null?void 0:y.id),u.value.forEach(c=>{c.$DisabledSelect=c.isAdmin})}),v=()=>{r.value=!0},m=()=>{g.value=!0},p=()=>{a.value=!0},k=y=>C(this,null,function*(){yield I(s("common.removeMemberTips"));const c={organizationId:o.currentOrg.id,userName:y[0].userName};yield me(c),_()});return _(),(y,c)=>{var A,D,x,F,q;const i=J,f=Q,h=we("router-link"),z=Oe,N=ee;return b(),S(G,null,[t("div",Re,[t("div",Te,[t("ul",Be,[t("li",null,[t("span",null,d(e(s)("common.currentOrganization"))+":",1),t("span",Fe,d((A=e(o).currentOrg)==null?void 0:A.name),1)]),t("li",null,[$(d(e(s)("common.members"))+":",1),t("span",Ie,d((D=u.value)==null?void 0:D.length),1)]),t("li",null,[$(d(e(s)("common.identity"))+":",1),t("span",Me,d((x=e(o).currentOrg)!=null&&x.isAdmin?e(s)("common.admin"):e(s)("common.member")),1)])]),je,t("div",null,[l(h,{to:e(he)({name:"departments"}),class:"mx-8"},{default:n(()=>[l(f,{round:""},{default:n(()=>[l(i,{class:"iconfont icon-module1 text-blue"}),t("div",qe,d(e(s)("common.departments")),1)]),_:1})]),_:1},8,["to"])]),t("div",null,[l(f,{round:"",onClick:p},{default:n(()=>[l(i,{class:"iconfont icon-qiehuanjiaose text-blue"}),t("div",Ke,d(e(s)("common.organizationAdmin")),1)]),_:1})])]),l(N,{data:u.value,"show-check":(F=e(o).currentOrg)==null?void 0:F.isAdmin,"is-radio":!0,onDelete:k},Ve({default:n(()=>[l(z,{label:e(s)("common.userName")},{default:n(({row:w})=>[t("div",We,[t("span",null,d(w.userName),1),w.isAdmin?(b(),S("span",Xe,d(e(s)("common.admin")),1)):U("",!0)])]),_:1},8,["label"]),l(z,{prop:"emailAddress",label:e(s)("common.email")},null,8,["label"]),l(z,{label:e(s)("common.joinDate")},{default:n(({row:w})=>[t("span",null,d(e(ue)(w.joinDate)),1)]),_:1},8,["label"])]),_:2},[(q=e(o).currentOrg)!=null&&q.isAdmin?{name:"leftBar",fn:n(()=>{var w,K;return[t("div",Le,[(w=e(o).currentOrg)!=null&&w.isAdmin?(b(),O(f,{key:0,round:"",onClick:v},{default:n(()=>[l(i,{class:"iconfont icon-a-addto"}),t("div",Pe,d(e(s)("common.addMember")),1)]),_:1})):U("",!0),(K=e(o).currentOrg)!=null&&K.isAdmin?(b(),O(f,{key:1,round:"",onClick:m},{default:n(()=>[l(i,{class:"iconfont icon-a-addto"}),t("div",He,d(e(s)("common.createMember")),1)]),_:1})):U("",!0)])]})}:void 0]),1032,["data","show-check"])]),r.value?(b(),O(ke,{key:0,modelValue:r.value,"onUpdate:modelValue":c[0]||(c[0]=w=>r.value=w),onAddSuccess:_},null,8,["modelValue"])):U("",!0),g.value?(b(),O(De,{key:1,modelValue:g.value,"onUpdate:modelValue":c[1]||(c[1]=w=>g.value=w),onCreateSuccess:c[2]||(c[2]=w=>_())},null,8,["modelValue"])):U("",!0),a.value?(b(),O(Ae,{key:2,modelValue:a.value,"onUpdate:modelValue":c[3]||(c[3]=w=>a.value=w)},null,8,["modelValue"])):U("",!0)],64)}}});export{Zo as default};
