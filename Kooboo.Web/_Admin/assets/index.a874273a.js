var Ne=Object.defineProperty,Ce=Object.defineProperties;var Ve=Object.getOwnPropertyDescriptors;var fe=Object.getOwnPropertySymbols;var $e=Object.prototype.hasOwnProperty,Fe=Object.prototype.propertyIsEnumerable;var pe=(p,s,n)=>s in p?Ne(p,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):p[s]=n,se=(p,s)=>{for(var n in s||(s={}))$e.call(s,n)&&pe(p,n,s[n]);if(fe)for(var n of fe(s))Fe.call(s,n)&&pe(p,n,s[n]);return p},ce=(p,s)=>Ce(p,Ve(s));var q=(p,s,n)=>new Promise((a,g)=>{var M=e=>{try{r(n.next(e))}catch(u){g(u)}},m=e=>{try{r(n.throw(e))}catch(u){g(u)}},r=e=>e.done?a(e.value):Promise.resolve(e.value).then(M,m);r((n=n.apply(p,s)).next())});import{g as X,o as Ie,w as ye}from"./i18n.48bd28ac.js";import{_ as De,a as Te,s as he,h as ge}from"./use-loading.bf9e0352.js";import{u as _e}from"./use-date.01b82ce0.js";import{d as z,N as Ue,o as d,a as v,j as C,w as h,f as y,t as x,m as ve,F as O,b6 as W,g as I,b as c,u as t,k as F,cd as xe,M as me,c as ke,aH as be,n as H,i as Le,h as qe,x as Oe,K as Ae,J as je,e as Be,cg as Re}from"./url.2e6a77c4.js";import{u as oe}from"./email.196eb60e.js";import{d as ue}from"./replace-all.7cf5f327.js";import{e as Ke}from"./confirm.e2c924ff.js";import{S as He}from"./search-input.67dfc984.js";import{E as we,a as We}from"./index.0d2684bf.js";import{_ as Ye}from"./index.a731e53b.js";import{E as ze}from"./index.fc90f5ad.js";import{E as Je,a as Pe}from"./index.6855d037.js";import{E as Qe}from"./index.81036e13.js";import{E as Me}from"./index.c4e9b529.js";import{E as Ee}from"./windi.a5b0b048.js";import{E as Ge}from"./index.2bc50276.js";import{E as Se}from"./index.379e80ad.js";import{_ as Xe}from"./icon-button.3313e42d.js";import{_ as Ze}from"./k-table.d4486972.js";import{E as et}from"./index.b494e80e.js";import{E as tt}from"./index.a439b087.js";import{E as at}from"./index.968f79fd.js";import{_ as lt}from"./plugin-vue_export-helper.21dcd24c.js";import{E as st}from"./main.ea42d807.js";import{E as ot}from"./index.77edae39.js";import{E as nt,a as dt,b as rt}from"./index.f5a869bb.js";import{E as it}from"./index.8ef89ff6.js";import{E as ct}from"./index.7af8368f.js";import{E as mt}from"./index.d971d096.js";const ut={key:0},ft=["title"],pt=["title"],yt=z({props:{optionItem:null},emits:["selectFolder"],setup(p,{emit:s}){return(n,a)=>{var m,r;const g=we,M=Ue("SelectSubDropDown",!0);return(m=p.optionItem.items)!=null&&m.length?(d(),v("div",ut,[(d(),C(g,{key:p.optionItem.name,style:ve({paddingLeft:20+p.optionItem.floor*16+"px"}),value:p.optionItem.name,onClick:a[0]||(a[0]=e=>s("selectFolder",p.optionItem.name))},{default:h(()=>[y("span",{class:"ellipsis",title:p.optionItem.displayName},x(p.optionItem.displayName),9,ft)]),_:1},8,["style","value"])),(d(!0),v(O,null,W((r=p.optionItem)==null?void 0:r.items,e=>(d(),C(M,{key:e.name,"option-item":e,onSelectFolder:a[1]||(a[1]=u=>s("selectFolder",u))},null,8,["option-item"]))),128))])):(d(),C(g,{key:p.optionItem.name,style:ve({paddingLeft:20+p.optionItem.floor*16+"px"}),value:p.optionItem.name,onClick:a[2]||(a[2]=e=>s("selectFolder",p.optionItem.name))},{default:h(()=>[y("span",{class:"ellipsis",title:p.optionItem.displayName},x(p.optionItem.displayName),9,pt)]),_:1},8,["style","value"]))}}}),ht=z({props:{modelValue:{type:Boolean}},emits:["update:modelValue","searchEmail"],setup(p,{emit:s}){var U;const n=oe(),{t:a}=X(),g=I(!0),M=D=>{m.value.searchFolder=D},m=I(n.searchModel||{keyword:(U=n.messageKeyword)!=null?U:"",position:"subject",from:"",to:"",dateType:0,startDate:"",endDate:"",searchFolder:"allEmails",readOrUnread:-1}),r=I([m.value.startDate,m.value.endDate]),e=()=>{r.value&&r.value.some(D=>D!==null)?(m.value.startDate=r.value[0].toString(),m.value.endDate=r.value[1].toString()):(m.value.startDate="",m.value.endDate="")},u=I([{name:"subject",displayName:a("common.subject")},{name:"attachments",displayName:a("common.attachmentName")},{name:"emailBody",displayName:a("common.emailBody")},{name:"allContents",displayName:a("common.allContent")}]),_=I([{value:0,displayName:a("mail.any")},{value:1,displayName:a("mail.inOneDay")},{value:2,displayName:a("mail.inThreeDays")},{value:3,displayName:a("mail.inAWeek")},{value:4,displayName:a("mail.inTwoWeeks")},{value:5,displayName:a("mail.inAMonth")},{value:6,displayName:a("mail.customise")}]),$=I([{value:-1,displayName:a("mail.any")},{value:1,displayName:a("common.read")},{value:0,displayName:a("common.unread")}]),b=I([{name:"allEmails",displayName:a("common.allEmails")},{name:"inbox",displayName:a("common.inbox")},{name:"sent",displayName:a("mail.sent")},{name:"drafts",displayName:a("common.drafts")},{name:"spam",displayName:a("common.spam")},{name:"trash",displayName:a("common.trash")}]),A=()=>q(this,null,function*(){m.value.keyword=m.value.keyword.trim(),m.value.from=m.value.from.trim(),m.value.to=m.value.to.trim(),n.searchModel=m.value,s("update:modelValue",!1),s("searchEmail")});return(D,k)=>{const R=ze,T=Je,L=we,j=We,J=Qe,Y=Pe,K=Me;return d(),C(K,{modelValue:g.value,"onUpdate:modelValue":k[10]||(k[10]=f=>g.value=f),width:"550px","close-on-click-modal":!1,title:t(a)("common.advancedSearchForEmail"),onClosed:k[11]||(k[11]=f=>s("update:modelValue",!1))},{footer:h(()=>[c(Ye,{"confirm-label":t(a)("common.search"),onConfirm:A,onCancel:k[9]||(k[9]=f=>g.value=!1)},null,8,["confirm-label"])]),default:h(()=>[c(Y,{ref:"form","label-position":"left","label-width":"110px"},{default:h(()=>[c(T,{label:t(a)("common.keyword")},{default:h(()=>[c(R,{modelValue:m.value.keyword,"onUpdate:modelValue":k[0]||(k[0]=f=>m.value.keyword=f)},null,8,["modelValue"])]),_:1},8,["label"]),c(T,{label:t(a)("common.position")},{default:h(()=>[c(j,{modelValue:m.value.position,"onUpdate:modelValue":k[1]||(k[1]=f=>m.value.position=f),class:"w-full"},{default:h(()=>[(d(!0),v(O,null,W(u.value,f=>(d(),C(L,{key:f.name,label:f.displayName,value:f.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),c(T,{label:t(a)("mail.from")},{default:h(()=>[c(R,{modelValue:m.value.from,"onUpdate:modelValue":k[2]||(k[2]=f=>m.value.from=f)},null,8,["modelValue"])]),_:1},8,["label"]),c(T,{label:t(a)("mail.to")},{default:h(()=>[c(R,{modelValue:m.value.to,"onUpdate:modelValue":k[3]||(k[3]=f=>m.value.to=f)},null,8,["modelValue"])]),_:1},8,["label"]),c(T,{prop:"date",label:t(a)("common.date")},{default:h(()=>[c(j,{modelValue:m.value.dateType,"onUpdate:modelValue":k[4]||(k[4]=f=>m.value.dateType=f),class:"w-full"},{default:h(()=>[(d(!0),v(O,null,W(_.value,f=>(d(),C(L,{key:f.value,label:f.displayName,value:f.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),m.value.dateType===6?(d(),C(J,{key:0,modelValue:r.value,"onUpdate:modelValue":k[5]||(k[5]=f=>r.value=f),class:"mt-12","value-format":"YYYY-MM-DD",type:"daterange","range-separator":"To","start-placeholder":t(a)("common.startDate"),"end-placeholder":t(a)("common.endDate"),onChange:e},null,8,["modelValue","start-placeholder","end-placeholder"])):F("",!0)]),_:1},8,["label"]),c(T,{prop:"county",label:t(a)("common.folder")},{default:h(()=>[c(j,{modelValue:m.value.searchFolder,"onUpdate:modelValue":k[7]||(k[7]=f=>m.value.searchFolder=f),class:"w-full","fit-input-width":!0},{default:h(()=>[(d(!0),v(O,null,W(b.value,f=>(d(),C(L,{key:f.name,label:f.displayName,value:f.name},null,8,["label","value"]))),128)),(d(!0),v(O,null,W(t(n).folderMenuTree,f=>(d(),C(yt,{key:f.name,"option-item":f,onSelectFolder:k[6]||(k[6]=P=>M(P))},null,8,["option-item"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),c(T,{label:t(a)("common.readOrUnread")},{default:h(()=>[c(j,{modelValue:m.value.readOrUnread,"onUpdate:modelValue":k[8]||(k[8]=f=>m.value.readOrUnread=f),class:"w-full"},{default:h(()=>[(d(!0),v(O,null,W($.value,f=>(d(),C(L,{key:f.value,label:f.displayName,value:f.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},512)]),_:1},8,["modelValue","title"])}}}),gt={class:"flex items-center"},vt=z({setup(p){const s=xe(),n=me(),a=I(!1),g=oe(),{t:M}=X(),m=r=>q(this,null,function*(){var u;if(g.messageKeyword=(u=g.messageKeyword)==null?void 0:u.trim(),r==="common"&&!g.messageKeyword.trim())return;n.name==="searchEmail"&&(yield g.refreshMessageList(r),g.selectedMessage=[]);let e=r==="common"?{flag:r,keyword:g.messageKeyword}:se({flag:"advanced"},g.searchModel);s.push({name:"searchEmail",query:e})});return(r,e)=>{const u=He;return d(),v(O,null,[y("div",gt,[c(u,{modelValue:t(g).messageKeyword,"onUpdate:modelValue":e[0]||(e[0]=_=>t(g).messageKeyword=_),class:"w-300px h-42px",placeholder:t(M)("common.searchEmails"),"data-cy":"search",onKeydown:e[1]||(e[1]=Ie(_=>m("common"),["enter"]))},null,8,["modelValue","placeholder"])]),a.value?(d(),C(ht,{key:0,modelValue:a.value,"onUpdate:modelValue":e[2]||(e[2]=_=>a.value=_),onSearchEmail:e[3]||(e[3]=_=>m("advanced"))},null,8,["modelValue"])):F("",!0)],64)}}}),_t={class:"text-999 text-14px h-16 leading-4"},xt={class:"flex items-center"},kt=y("span",{class:"ml-8"},'"',-1),bt=["title"],wt=["title"],Mt=y("span",{class:"mr-8"},'"',-1),Et={key:2},St=z({setup(p){const s=oe(),{t:n}=X(),a=me(),g={1:n("mail.inOneDay"),2:n("mail.inThreeDays"),3:n("mail.inAWeek"),4:n("mail.inTwoWeeks"),5:n("mail.inAMonth")},M={inbox:n("common.inbox"),sent:n("mail.sent"),draft:n("common.draft"),spam:n("common.spam"),trash:n("common.trash")},m={0:n("common.unread"),1:n("common.read")},r=u=>{var _;return(_=M[u])!=null?_:u},e=()=>{var k,R,T,L,j,J,Y,K,f,P,Z,Q,l,o,E,w,V,B,S,ne,de,re,ie,ee,te,i,ae,le;if(!s.searchModel)return;let u="",_,$=(k=s.searchModel)==null?void 0:k.keyword;$&&(u=u+$),((R=s.searchModel)==null?void 0:R.dateType)===6?_=((T=s.searchModel)==null?void 0:T.startDate)!==((L=s.searchModel)==null?void 0:L.endDate)?((j=s.searchModel)==null?void 0:j.startDate)+"~"+((J=s.searchModel)==null?void 0:J.endDate):(Y=s.searchModel)==null?void 0:Y.startDate:((K=s.searchModel)==null?void 0:K.dateType)!==0&&(_=g[s.searchModel.dateType]),_&&((f=s.searchModel)!=null&&f.keyword&&(_=", "+_),u=u+_);let b=(P=s.searchModel)==null?void 0:P.from;b&&((((Z=s.searchModel)==null?void 0:Z.keyword)||((Q=s.searchModel)==null?void 0:Q.dateType)!==0)&&(b=", "+b),u=u+b);let A=(l=s.searchModel)==null?void 0:l.to;A&&((((o=s.searchModel)==null?void 0:o.keyword)||((E=s.searchModel)==null?void 0:E.dateType)||((w=s.searchModel)==null?void 0:w.from))&&(A=", "+A),u=u+A);let U=((V=s.searchModel)==null?void 0:V.searchFolder)!=="allEmails"?r(s.searchModel.searchFolder):"";U&&((((B=s.searchModel)==null?void 0:B.keyword)||((S=s.searchModel)==null?void 0:S.dateType)||((ne=s.searchModel)==null?void 0:ne.from)||((de=s.searchModel)==null?void 0:de.to))&&(U=", "+U),u=u+U);let D=((re=s.searchModel)==null?void 0:re.readOrUnread)!==-1?m[(ie=s.searchModel)==null?void 0:ie.readOrUnread]:"";return D&&((((ee=s.searchModel)==null?void 0:ee.keyword)||((te=s.searchModel)==null?void 0:te.dateType)||((i=s.searchModel)==null?void 0:i.from)||((ae=s.searchModel)==null?void 0:ae.to)||((le=s.searchModel)==null?void 0:le.searchFolder)!=="allEmails")&&(D=", "+D),u=u+D),u||n("common.allEmails")};return(u,_)=>(d(),v("div",_t,[y("div",xt,[y("span",null,x(t(n)("mail.contain")),1),kt,t(s).searchModel?(d(),v("span",{key:0,class:"max-w-500px ellipsis",title:e()},x(e()),9,bt)):(d(),v("div",{key:1,class:"max-w-500px ellipsis",title:t(a).query.keyword||""},x(t(a).query.keyword),9,wt)),Mt,y("span",null,x(t(n)("mail.relatedEmails"))+":",1),t(s).messageList.length?(d(),v("div",Et," \uFF08"+x(t(s).messageList.length>1?t(n)("common.totalEmailsLoaded",{total:t(s).messageList.length}):t(n)("common.totalEmailLoaded",{total:t(s).messageList.length}))+"\uFF09 ",1)):F("",!0)])]))}}),Nt={class:"mb-16 flex items-center justify-between dark:text-[#fffa] text-s"},Ct={key:1},Vt={class:"text-l"},$t={key:0},Ft=z({props:{title:null,type:null},emits:["refresh"],setup(p,{emit:s}){const n=p,{t:a}=X(),g=me(),M=oe(),m=ke(()=>{var e,u,_;if((e=g.query)!=null&&e.address){if(n.type==="inbox")return(u=M.addressList.filter($=>$.address===g.query.address)[0])==null?void 0:u.unRead;if(n.type==="sent")return(_=M.sentAddressList.filter($=>$.address===g.query.address)[0])==null?void 0:_.unRead}return r()}),r=()=>{var e,u;return n.type==="inbox"?M.inboxUnreadCount:n.type==="sent"?M.sentUnreadCount:n.type==="folder"?g.query.folderName?(u=(e=M.folderList)==null?void 0:e.filter(_=>_.name===g.query.folderName)[0])==null?void 0:u.unRead:M.folderUnreadCount:0};return(e,u)=>{const _=Ee,$=Ge,b=Se;return d(),v("div",Nt,[y("div",null,[t(g).name==="searchEmail"?(d(),C(St,{key:0})):(d(),v("div",Ct,[y("span",Vt,x(p.title),1),t(m)?(d(),v("span",$t," \uFF08 "+x(t(a)("common.unreadEmail",{unread:t(m)}))+" \uFF09 ",1)):F("",!0),t(g).name!=="searchEmail"?(d(),C(b,{key:1,effect:"dark",content:t(a)("common.refresh"),placement:"top"},{default:h(()=>[c($,{class:"!w-28px !h-28px ml-8",circle:"","data-cy":"refresh",onClick:u[0]||(u[0]=A=>s("refresh"))},{default:h(()=>[c(_,{class:"iconfont icon-Refresh text-blue"})]),_:1})]),_:1},8,["content"])):F("",!0)]))]),c(vt)])}}}),It={class:"mb-12"},Dt={class:"flex items-center"},Tt=["title"],Ut={key:0,class:"font-bold"},Lt=z({props:{modelValue:{type:Boolean},currentLog:null,viewSendState:null},emits:["update:modelValue"],setup(p,{emit:s}){const n=I(!0),{t:a}=X();return(g,M)=>{const m=et,r=Xe,e=tt,u=at,_=Me;return d(),C(_,{"model-value":n.value,title:t(a)("common.deliveryLogs"),width:"60%",onClosed:M[0]||(M[0]=$=>s("update:modelValue",!1))},{default:h(()=>{var $;return[y("div",It,[be(x(t(a)("common.deliveryStatus"))+":",1),y("span",{class:H(["ml-4",p.viewSendState(p.currentLog,"style")])},x(p.viewSendState(p.currentLog,"view")),3)]),c(t(Ze),{"max-height":400,data:(($=p.currentLog)==null?void 0:$.items)||[]},{default:h(()=>[c(m,{label:t(a)("mail.to")},{default:h(({row:b})=>[y("div",Dt,[y("span",{class:"break-normal ellipsis",title:b.to},x(b.to),9,Tt)])]),_:1},8,["label"]),c(m,{label:t(a)("common.deliveryStatus"),width:"240",align:"center"},{default:h(({row:b})=>[y("span",{class:H(["mr-4",{"text-green":b.isSuccess&&!b.isSending,"text-999":b.isSending,"text-orange":!b.isSuccess&&!b.isSending}])},x(b.isSending?t(a)("common.Delivering"):b.isSuccess&&!b.isSending?t(a)("common.deliverySuccessful"):t(a)("common.deliveryFailed")),3)]),_:1},8,["label"]),c(m,{label:t(a)("common.dateTime"),align:"center",width:"180"},{default:h(({row:b})=>[b.isSending?F("",!0):(d(),v("span",Ut,x(t(_e)(b.deliveryTime)),1))]),_:1},8,["label"]),c(m,{label:t(a)("common.log"),align:"center",width:"120"},{default:h(({row:b})=>[c(u,{placement:"left-start",trigger:"hover","popper-class":"!w-auto max-w-800px !p-0"},{reference:h(()=>[b.isSending?F("",!0):(d(),C(r,{key:0,icon:"icon-eyes",tip:t(a)("common.details"),"data-cy":"preview"},null,8,["tip"]))]),default:h(()=>[c(e,{"max-height":"50vh",class:"p-12 !break-normal"},{default:h(()=>[y("pre",null,x(b.log),1)]),_:2},1024)]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"])]}),_:1},8,["model-value","title"])}}});const qt={key:0,ref:"list",class:"shadow-s-10 rounded-normal overflow-hidden bg-fff px-32 dark:bg-[#333]"},Ot={class:"h-64px text-m flex items-center justify-between bg-fff dark:bg-[#333]"},At={class:"flex items-center space-x-12"},jt={class:"rounded-full bg-[#F3F5F5] flex items-center h-30px px-16 dark:bg-444"},Bt={class:"ml-8"},Rt={class:"ml-8"},Kt={class:"ml-8"},Ht=["tip"],Wt={class:"ml-8"},Yt={class:"ml-8"},zt={key:0,class:"dark:text-999 text-[13px] ml-10px"},Jt={key:1,ref:"emailList","infinite-scroll-immediate":!1,"infinite-scroll-distance":44,class:"max-h-[calc(100vh-228px)] mb-16 !overflow-auto list-none"},Pt=["id"],Qt={class:"flex items-center h-28px"},Gt={class:"mr-16 flex items-center"},Xt=["onClick"],Zt={class:"w-full flex overflow-hidden"},ea={class:"text-m w-168px ellipsis dark:text-[#fffa] mr-64 leading-7"},ta=["title"],aa={key:1},la=["title"],sa={key:0,src:Te,class:"mr-8 h-7 w-16 dark:text-999"},oa={key:1,class:"w-16px mr-8"},na={class:"flex-1 text-m ellipsis max-w-600px dark:text-[#fffa] leading-7","data-cy":"subject"},da={class:"space-x-8 flex text-s"},ra=["title","onClick"],ia=["src"],ca={class:"max-w-120px ellipsis h-6 leading-6"},ma=["onClick"],ua={class:"mr-24 text-14px h-28px leading-7 flex items-center space-x-24 dark:text-[#fffa]"},fa=["title","onClick"],pa={class:"w-150px","data-cy":"date"},ya={key:0,class:"mr-24 text-m h-28px flex items-center dark:text-[#fffa]"},ha={key:1,class:"w-14px"},ga=z({props:{type:null},setup(p){const s=p,n=xe(),a=me(),g=I(!1),M=I(),m=l=>{l&&(g.value=!0,M.value=l)};Le(()=>g.value,()=>{g.value||(M.value=null)});const{t:r}=X(),e=oe(),u=I(),_=I(!1),$=l=>{Re(l)},b=()=>q(this,null,function*(){yield e.loadMessage()}),A=()=>q(this,null,function*(){var l;yield e.refreshMessageList(),a.name==="folder"?yield e.loadFolders():yield e.loadAddress(e.folder),st.success(r("common.refreshSuccess")),e.messageList.length&&((l=document.getElementById(e.messageList[0].id.toString()))==null||l.scrollIntoView(),e.selectedMessage=[])}),U={inbox:r("common.inbox"),sent:r("mail.sent"),drafts:r("common.drafts"),trash:r("common.trash"),spam:r("common.spam"),folder:r("common.folders")},D=l=>{let E=Object.keys(U).slice(0,5).includes(l.folderName)?U[l.folderName]:l.folderName,w=l.addressName;return w?E+"/"+w:E},k=l=>{let o=l.folderName,E=l.addressName;e.notFolderOptions.includes(o)?n.push({name:o,query:o==="inbox"||o==="sent"?{address:E}:{}}):n.push({name:"folder",query:{folderName:o}})},R=ke(()=>a.query.folderName?a.query.folderName.toString().split("/")[a.query.folderName.toString().split("/").length-1]:U[s.type]),T=l=>{l?e.selectedMessage=e.messageList.map(o=>Object.assign({},{id:o.id,read:o.read,folderName:o.folderName})):e.selectedMessage=[]},L=l=>{l==="all"?e.selectedMessage=e.messageList.map(o=>Object.assign({},{id:o.id,read:o.read})):l==="read"?e.selectedMessage=e.messageList.filter(o=>o.read).map(o=>Object.assign({},{id:o.id,read:o.read})):l==="unread"&&(e.selectedMessage=e.messageList.filter(o=>!o.read).map(o=>Object.assign({},{id:o.id,read:o.read}))),u.value=l},j=l=>{var o,E,w;(o=e.selectedMessage)!=null&&o.find(V=>V.id===l.id)?e.selectedMessage=JSON.parse(JSON.stringify((E=e.selectedMessage)==null?void 0:E.filter(V=>V.id!==l.id))):(w=e.selectedMessage)==null||w.push({id:l.id,read:l.read,folderName:l.folderName})},J=(l,o)=>{K(l,o)},Y=l=>{K(e.selectedMessage,l),e.selectedMessage=[]},K=(l,o)=>q(this,null,function*(){yield e.markRead(l.map(S=>S.id),o);const E=["inbox","sent","drafts","spam","trash"],w=l.find(S=>S.folderName==="inbox"),V=l.find(S=>S.folderName==="sent"),B=l.find(S=>!E.includes(S.folderName));V&&e.loadAddress("sent"),w&&e.loadAddress("inbox"),B&&e.loadFolders()}),f=l=>q(this,null,function*(){!e.selectedMessage.length||(yield Ke(l),yield e.deleteEmails(e.selectedMessage,s.type),he(),yield e.reload(),ge(),yield e.updateUnreadCount(e.selectedMessage,s.type),e.selectedMessage=[])}),P=l=>q(this,null,function*(){yield e.move(e.selectedMessage,l),he(),yield e.reload(),ge(),yield e.updateUnreadCount(e.selectedMessage,l),e.selectedMessage=[]}),Z=l=>q(this,null,function*(){let o=e.folder;l.read||(yield K([l],!0)),l.id&&a.query.address?n.push(ue({name:"mail-content",query:ce(se({},n.currentRoute.value.query),{folder:o,address:a.query.address,messageId:l.id})})):l.id&&a.query.folderName?n.push(ue({name:"mail-content",query:ce(se({},n.currentRoute.value.query),{folder:o,folderName:a.query.folderName,messageId:l.id})})):n.push(ue({name:"mail-content",query:ce(se({},n.currentRoute.value.query),{folder:o,messageId:l.id,activeMenu:e.folder})})),e.selectedMessage=[]}),Q=(l,o)=>{let E=l==null?void 0:l.items.length,w=l==null?void 0:l.items.filter(S=>S.isSending===!0).length,V=l==null?void 0:l.items.filter(S=>S.isSuccess===!1).length,B=l==null?void 0:l.items.filter(S=>S.isSuccess===!0).length;switch(!0){case(!w&&V===E):switch(o){case"style":return"text-orange";case"view":return r("common.deliveryFailed");default:return"icon-fasongshibai text-orange"}case(!w&&B===E):switch(o){case"style":return"text-green";case"view":return r("common.deliverySuccessful");default:return"icon-fasongchenggong text-green"}case(!w&&V!==E):switch(o){case"style":return"text-[#d8bb4f]";case"view":return r("common.partialDeliverySuccessful");default:return"icon-bufenchenggong text-[#d8bb4f]"}default:switch(o){case"style":return"text-999";case"view":return r("common.Delivering");default:return"icon-fasongzhong text-999"}}};return qe(()=>q(this,null,function*(){var o;_.value=!0;const l=Oe("messageId");yield Ae(),l&&((o=document.getElementById(l.toString()))==null||o.scrollIntoView())})),je(()=>{_.value=!1}),(l,o)=>{var ee,te;const E=ot,w=Ee,V=nt,B=dt,S=rt,ne=it,de=ct,re=Se,ie=mt;return d(),v(O,null,[c(Ft,{title:t(R),type:p.type,onRefresh:A},null,8,["title","type"]),_.value?(d(),v("div",qt,[y("div",Ot,[y("div",At,[y("div",jt,[c(E,{"model-value":!!t(e).selectedMessage.length&&t(e).selectedMessage.length===((ee=t(e).messageList)==null?void 0:ee.length),indeterminate:!!t(e).selectedMessage.length&&t(e).selectedMessage.length!==((te=t(e).messageList)==null?void 0:te.length),"data-cy":"check-all",onChange:T},null,8,["model-value","indeterminate"]),c(S,{trigger:"click"},{dropdown:h(()=>[c(B,null,{default:h(()=>[c(V,{"data-cy":"all",onClick:o[0]||(o[0]=i=>L("all"))},{default:h(()=>[c(w,{class:"iconfont icon-classification"}),y("span",Bt,x(t(r)("common.all")),1)]),_:1}),c(V,{"data-cy":"read",onClick:o[1]||(o[1]=i=>L("read"))},{default:h(()=>[c(w,{class:"iconfont icon-a-Emileopen"}),y("span",Rt,x(t(r)("common.read")),1)]),_:1}),c(V,{"data-cy":"unread",onClick:o[2]||(o[2]=i=>L("unread"))},{default:h(()=>[c(w,{class:"iconfont icon-a-Emilenotopen"}),y("span",Kt,x(t(r)("common.unread")),1)]),_:1})]),_:1})]),default:h(()=>[y("span",null,[c(w,{class:"ml-12 iconfont icon-pull-down cursor-pointer text-black dark:text-[#ffffffaa]"})])]),_:1})]),y("span",{class:H(["rounded-full bg-[#F3F5F5] dark:bg-444 text-black dark:text-[#ffffffaa] flex items-center h-30px px-16 cursor-pointer mr-10px",t(e).selectedMessage.length?"":"cursor-not-allowed !text-999 !text-opacity-60 dark:text-opacity-20"]),tip:t(r)("common.delete"),"data-cy":"delete",onClick:o[3]||(o[3]=i=>f(t(e).selectedMessage.length))},x(t(r)("common.delete")),11,Ht),c(S,{trigger:"click",disabled:!t(e).selectedMessage.length},{dropdown:h(()=>[c(B,null,{default:h(()=>[c(V,{"data-cy":"mark-as-read",onClick:o[4]||(o[4]=i=>Y(!0))},{default:h(()=>[c(w,{class:"iconfont icon-a-Emileopen"}),y("span",Wt,x(t(r)("common.read")),1)]),_:1}),c(V,{"data-cy":"mark-as-unread",onClick:o[5]||(o[5]=i=>Y(!1))},{default:h(()=>[c(w,{class:"iconfont icon-a-Emilenotopen"}),y("span",Yt,x(t(r)("common.unread")),1)]),_:1})]),_:1})]),default:h(()=>[y("div",{class:H(["rounded-full bg-[#F3F5F5] flex items-center h-30px px-16 cursor-pointer dark:bg-444 text-black dark:text-[#ffffffaa]",t(e).selectedMessage.length?"":"cursor-not-allowed text-999 text-opacity-60 dark:text-opacity-20"]),"data-cy":"setting"},[y("span",null,x(t(r)("common.markAs")),1),c(w,{class:"ml-8 iconfont icon-pull-down"})],2)]),_:1},8,["disabled"]),p.type!=="drafts"?(d(),C(De,{key:0,selected:t(e).selectedMessage,onMoveSuccess:P},null,8,["selected"])):F("",!0)]),t(e).selectedMessage.length?(d(),v("span",zt,x(t(e).selectedMessage.length>1?t(r)("common.countEmailsSelected",{count:t(e).selectedMessage.length}):t(r)("common.countEmailSelected",{count:t(e).selectedMessage.length})),1)):F("",!0)]),y("div",null,[c(ne,{class:"my-0"})]),t(e).messageList.length?Be((d(),v("ul",Jt,[(d(!0),v(O,null,W(t(e).messageList,i=>{var ae,le;return d(),v("li",{id:i.id.toString(),key:i.id,class:H(["mail-item flex items-start mb-4 py-8 border-solid border-gray hover:bg-[#e8f4fd] dark:hover:bg-444 dark:bg-[#333]",i.read?"":"font-bold bg-[#f8f7f7] dark:bg-444"])},[y("div",Qt,[c(w,{class:H(["iconfont icon-youjiantou text-blue",t(a).query.messageId&&t(e).justViewMessageId===i.id?"":"opacity-0"])},null,8,["class"]),y("span",Gt,[c(E,{"model-value":t(e).selectedMessage.some(N=>N.id===i.id),"data-cy":"checkbox",onChange:N=>j(i)},null,8,["model-value","onChange"])]),c(re,{placement:"left",content:i.read?t(r)("common.markAsUnread"):t(r)("common.markAsRead")},{default:h(()=>[c(w,{class:H(["mr-8 iconfont font-normal cursor-pointer",i.read?"icon-a-Emileopen text-999/50":"icon-a-Emilenotopen text-blue"]),"data-cy":"mark-as-read-or-unread",onClick:N=>J([i],!i.read)},null,8,["class","onClick"])]),_:2},1032,["content"])]),y("div",{class:"ml-8 mr-32 flex-1 overflow-hidden cursor-pointer",onClick:N=>Z(i)},[y("div",Zt,[y("span",ea,[["sent","drafts"].includes(i.folderName)?!i.to.length&&!i.cc.length&&!i.bcc.length?(d(),v("span",aa,x(t(r)("common.noRecipient")),1)):(d(),v("span",{key:2,title:[...i.to,...i.cc,...i.bcc].map(N=>{var G;return(G=N.name)!=null?G:N.address}).join(", "),"data-cy":"to-or-from"},x([...i.to,...i.cc,...i.bcc].map(N=>{var G;return(G=N.name)!=null?G:N.address}).join(", ")),9,la)):(d(),v("span",{key:0,title:(ae=i.from.name)!=null?ae:i.from.address,"data-cy":"to-or-from"},x((le=i.from.name)!=null?le:i.from.address),9,ta))]),i.hasAttachment?(d(),v("img",sa)):(d(),v("div",oa)),y("div",na,[be(x(i.subject?i.subject:"("+t(r)("common.noSubject")+")"),1),y("div",da,[(d(!0),v(O,null,W(i.attachments.slice(0,3),N=>(d(),v("div",{key:N.fileName,class:"border-[#A9ABB8] border-1 rounded-full font-normal flex items-center px-8 h-6",title:N.fileName,onClick:ye(G=>$(N.downloadUrl),["stop"])},[y("img",{src:t(e).getAttachmentType(N.subType.toLowerCase()),class:"mr-4 h-7 w-16"},null,8,ia),y("span",ca,x(N.fileName),1)],8,ra))),128)),i.attachments.length>3?(d(),v("span",{key:0,class:"w-6 h-6 cursor-pointer ellipsis border-[#A9ABB8] border-1 rounded-full font-normal text-center leading-6 cursor-default",onClick:ye(N=>Z(i),["stop"])},x(i.attachments.length-3+"+"),9,ma)):F("",!0)])])])],8,Xt),y("div",ua,[t(a).name==="searchEmail"?(d(),v("span",{key:0,class:"w-160px ellipsis text-green cursor-pointer",title:D(i),onClick:N=>k(i)},x(D(i)),9,fa)):F("",!0),y("span",pa,x(t(_e)(i.date)),1)]),t(a).name!=="searchEmail"?(d(),v("div",ya,[i.deliveryLog!==null?(d(),C(w,{key:0,title:Q(i.deliveryLog,"view"),class:H(["iconfont cursor-pointer",Q(i.deliveryLog,"icon")]),onClick:N=>m(i.deliveryLog)},null,8,["title","class","onClick"])):(d(),v("div",ha))])):F("",!0)],10,Pt)}),128))])),[[ie,b]]):(d(),C(de,{key:0}))],512)):F("",!0),g.value?(d(),C(Lt,{key:1,modelValue:g.value,"onUpdate:modelValue":o[6]||(o[6]=i=>g.value=i),"current-log":M.value,"view-send-state":Q},null,8,["modelValue","current-log"])):F("",!0)],64)}}});var Ja=lt(ga,[["__scopeId","data-v-4d0073c9"]]);export{Ja as E};
