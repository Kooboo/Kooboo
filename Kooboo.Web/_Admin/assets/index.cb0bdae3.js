var V=(b,i,a)=>new Promise((o,s)=>{var d=e=>{try{c(a.next(e))}catch(m){s(m)}},l=e=>{try{c(a.throw(e))}catch(m){s(m)}},c=e=>e.done?o(e.value):Promise.resolve(e.value).then(d,l);c((a=a.apply(b,i)).next())});import{_ as A}from"./icon-button.0e134c9b.js";import{N as B,O as N,P as D,Q as I}from"./index.878e2bbf.js";import{g as x,w as U,o as F}from"./i18n.25caaace.js";import{r as S,a as k,e as T,Q as q,R as K}from"./validate.f3c0b03b.js";import{_ as L}from"./index.50326354.js";import{E as O}from"./index.f571dfc9.js";import{E as J,a as Q}from"./index.94998415.js";import{E as j}from"./index.a5d96e5a.js";import{d as R,g as C,c as H,o as E,j as $,w as p,b as r,u as t,i as M,a as P,f as y,aH as z,t as G,k as W,F as X}from"./url.8f5ec20c.js";import{b as Y}from"./confirm.629bcef4.js";import{_ as Z}from"./k-table.c13bd7f5.js";import{E as h}from"./windi.a815125a.js";import{E as oo}from"./index.e9f8834a.js";import{E as to}from"./index.5388dbc8.js";import"./index.158cdd11.js";import"./focus-trap.81e4fb05.js";import"./isNil.98bb3b88.js";import"./event.53b2ad83.js";import"./index.1e7e06b8.js";import"./index.0c2ced08.js";import"./index.f9c89813.js";import"./main.1c3b59e3.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";import"./replace-all.b35629e7.js";import"./index.adb17f32.js";import"./index.b065185c.js";import"./index.ab12ea9e.js";import"./index.b1b64a44.js";import"./style.1b77b3a2.js";import"./toNumber.6efebd6a.js";import"./_baseIsEqual.0a4e01e5.js";import"./event.776e7e11.js";import"./error.7e8331f1.js";import"./_baseClone.885c975f.js";import"./isEqual.2e410d13.js";import"./index.1d16d007.js";import"./scroll.0cf77af8.js";import"./refs.d2253dd4.js";import"./logo-transparent.1566007e.js";import"./index.60799c00.js";import"./aria.75ec5909.js";import"./validator.9b0d789f.js";import"./sortable.esm.a99254e8.js";import"./index.a9a077b4.js";import"./index.960b9732.js";import"./index.c6488b3c.js";import"./debounce.730e1961.js";import"./index.c93fe8e7.js";import"./index.2e51d36e.js";import"./index.5b499f72.js";const eo=R({props:{modelValue:{type:Boolean},currentContact:null,contactList:null},emits:["reload","update:modelValue"],setup(b,{emit:i}){const a=b,{t:o}=x(),s=C(!0),d=C();let l=C({});const c=H(()=>({name:[S(1,64),k(o("common.nameRequiredTips"))],address:[k(o("common.pleaseEnterAddress")),T,q(64),a.currentContact.id?"":K(a.contactList.map(_=>_.address),o("common.emailAddressExistsTips"))]})),e=()=>V(this,null,function*(){yield d.value.validate(),a.currentContact.id?yield B(l.value):yield N({name:l.value.name,address:l.value.address}),s.value=!1,i("reload")});return(()=>{l.value=a.currentContact})(),(_,n)=>{const v=O,w=J,u=Q,g=j;return E(),$(g,{modelValue:s.value,"onUpdate:modelValue":n[4]||(n[4]=f=>s.value=f),width:"400px",title:a.currentContact.id?t(o)("common.editContact"):t(o)("common.addContact"),"close-on-click-modal":!1,onClosed:n[5]||(n[5]=f=>i("update:modelValue",!1))},{footer:p(()=>[r(L,{"confirm-label":a.currentContact.id?t(o)("common.save"):t(o)("common.add"),onConfirm:e,onCancel:n[3]||(n[3]=f=>s.value=!1)},null,8,["confirm-label"])]),default:p(()=>[r(u,{ref_key:"form",ref:d,class:"el-form--label-normal",model:t(l),rules:t(c),"label-position":"top",onSubmit:n[2]||(n[2]=U(()=>{},["prevent"])),onKeydown:F(e,["enter"])},{default:p(()=>[r(w,{prop:"name",label:t(o)("common.name")},{default:p(()=>[r(v,{modelValue:t(l).name,"onUpdate:modelValue":n[0]||(n[0]=f=>t(l).name=f)},null,8,["modelValue"])]),_:1},8,["label"]),r(w,{prop:"address",label:t(o)("common.address")},{default:p(()=>[r(v,{modelValue:t(l).address,"onUpdate:modelValue":n[1]||(n[1]=f=>t(l).address=f)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules","onKeydown"])]),_:1},8,["modelValue","title"])}}}),ao={class:"p-24"},no={class:"flex items-center space-x-4"},nt=R({setup(b){const{t:i}=x(),a=C([]),o=C(!1),s=C({}),d=()=>V(this,null,function*(){a.value=yield D()});d();function l(e){return V(this,null,function*(){yield Y(e.length);const m=e.map(_=>_.id);yield I({ids:m}),d()})}const c=e=>{o.value=!0,s.value=JSON.parse(JSON.stringify(e))};return M(()=>o.value,()=>{o.value||(s.value={})}),(e,m)=>{const _=h,n=oo,v=to,w=A;return E(),P(X,null,[y("div",ao,[r(n,{round:"",class:"mb-24",onClick:m[0]||(m[0]=u=>o.value=!0)},{default:p(()=>[r(_,{class:"iconfont icon-a-addto"}),z(" "+G(t(i)("common.addContact")),1)]),_:1}),r(t(Z),{data:a.value,"show-check":"",sort:"name",order:"ascending",onDelete:l},{default:p(()=>[r(v,{label:t(i)("common.name"),prop:"name"},null,8,["label"]),r(v,{label:t(i)("common.address"),prop:"address"},null,8,["label"]),r(v,{align:"center",width:"60"},{default:p(({row:u})=>[y("div",no,[r(w,{icon:"icon-a-writein",tip:t(i)("common.edit"),onClick:g=>c(u)},null,8,["tip","onClick"])])]),_:1})]),_:1},8,["data"])]),o.value?(E(),$(eo,{key:0,modelValue:o.value,"onUpdate:modelValue":m[1]||(m[1]=u=>o.value=u),"current-contact":s.value,"contact-list":a.value,onReload:m[2]||(m[2]=u=>d())},null,8,["modelValue","current-contact","contact-list"])):W("",!0)],64)}}});export{nt as default};
