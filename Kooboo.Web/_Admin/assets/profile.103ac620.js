var me=Object.defineProperty;var Y=Object.getOwnPropertySymbols;var ue=Object.prototype.hasOwnProperty,de=Object.prototype.propertyIsEnumerable;var Z=(y,f,e)=>f in y?me(y,f,{enumerable:!0,configurable:!0,writable:!0,value:e}):y[f]=e,ee=(y,f)=>{for(var e in f||(f={}))ue.call(f,e)&&Z(y,e,f[e]);if(Y)for(var e of Y(f))de.call(f,e)&&Z(y,e,f[e]);return y};var U=(y,f,e)=>new Promise((n,s)=>{var _=w=>{try{a(e.next(w))}catch(r){s(r)}},t=w=>{try{a(e.throw(w))}catch(r){s(r)}},a=w=>w.done?n(w.value):Promise.resolve(w.value).then(_,t);a((e=e.apply(y,f)).next())});import{_ as ie}from"./avatar.d0cba173.js";import{g as T,w as z,o as D,d as ce,C as pe}from"./i18n.97105311.js";import{_ as le,a as fe}from"./verify-button.a565bd86.js";import{p as ve,a as B,G as _e,A as ae,e as we,I as ye,E as be,C as he,F as Ve}from"./validate.98ddbafd.js";import{_ as S}from"./index.9ffc2c80.js";import{s as ge,u as Ne,a as xe,b as Ce,g as ke,d as Pe,e as Ue,f as $e,h as Ae,j as Fe}from"./index.51a59403.js";import{E as K,a as q,S as Ee}from"./index.317a7f30.js";import{E as L}from"./index.4587e608.js";import{E as I}from"./index.4b289bae.js";import{d as M,g as v,c as J,B as O,o as b,j as C,w as d,b as u,u as l,f as m,E as Be,i as G,a as R,b6 as te,F as H,k as E,t as g,aH as Re,b2 as oe,aT as Te}from"./url.2e6a77c4.js";import{E as Me}from"./index.be52e7c3.js";import{E as se,a as ne}from"./index.afee24fe.js";import{V as Se,b as Ke}from"./main.52487121.js";import{V as qe}from"./vue-qr.a14aeae7.js";import"./country-and-region-codes.c36488d2.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./plugin-vue_export-helper.41ffa612.js";import"./windi.539ebeab.js";import"./index.6ebaed6b.js";import"./index.f997a738.js";import"./error.7e8331f1.js";import"./index.b09a9f00.js";import"./index.9e96921b.js";import"./index.99641a60.js";import"./index.77759eed.js";import"./replace-all.8fa5a83d.js";import"./index.b1fe55d8.js";import"./index.29d7c76d.js";import"./style.f835519e.js";import"./toNumber.574be4f1.js";import"./_baseIsEqual.abb55a3a.js";import"./_baseClone.f10ff33c.js";import"./isEqual.3700b7f1.js";import"./event.776e7e11.js";import"./isNil.98bb3b88.js";import"./index.07e210fb.js";import"./scroll.8babc10c.js";import"./index.bc93d068.js";import"./focus-trap.de18cf8f.js";import"./refs.4001ce17.js";import"./index.9589f7cf.js";import"./event.53b2ad83.js";import"./debounce.61c67278.js";import"./index.a46fa52c.js";import"./validator.1d438d08.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";const Ie={class:"flex items-center space-x-8"},Oe=M({props:{modelValue:{type:Boolean},phone:null},emits:["update:modelValue"],setup(y,{emit:f}){const e=y,{t:n}=T(),s=v(!0),_=v(),t=v({phone:"",code:"",regionCode:""}),a=J(()=>({phone:[ve,B(n("common.inputPhoneTips")),_e(t.value.regionCode,e.phone.tel)],code:[B(n("common.inputSecurityCodeTips")),ae]})),w=v(!0),r=(c,p)=>{c==="phone"&&(w.value=!p)},N=()=>U(this,null,function*(){yield ge(t.value.regionCode+t.value.phone)}),h=()=>{!e.phone||(t.value.regionCode="+86")},o=()=>U(this,null,function*(){yield _.value.validate(),yield Ne(t.value.regionCode+t.value.phone,Number(t.value.code)),x(),s.value=!1});h();const x=O("reloadUser");return(c,p)=>{const k=fe,i=K,V=L,A=q,P=I;return b(),C(P,{"model-value":s.value,title:e.phone.tel?l(n)("common.changePhone"):l(n)("common.bindPhone"),width:"400px","custom-class":"!overflow-visible",onClosed:p[5]||(p[5]=F=>f("update:modelValue",!1))},{footer:d(()=>[u(S,{"confirm-label":e.phone.tel?l(n)("common.change"):l(n)("common.bind"),onConfirm:o,onCancel:p[4]||(p[4]=F=>s.value=!1)},null,8,["confirm-label"])]),default:d(()=>[u(A,{ref_key:"form",ref:_,model:t.value,rules:l(a),"label-position":"top",onSubmit:p[3]||(p[3]=z(()=>{},["prevent"])),onKeypress:D(o,["enter"]),onValidate:r},{default:d(()=>[u(i,{prop:"phone",label:l(n)("common.phone")},{default:d(()=>[u(k,{modelValue:t.value.phone,"onUpdate:modelValue":p[0]||(p[0]=F=>t.value.phone=F),regionCode:t.value.regionCode,"onUpdate:regionCode":p[1]||(p[1]=F=>t.value.regionCode=F),"data-cy":"phone-number"},null,8,["modelValue","regionCode"])]),_:1},8,["label"]),u(i,{label:l(n)("common.securityCode"),prop:"code"},{default:d(()=>[m("div",Ie,[u(V,{modelValue:t.value.code,"onUpdate:modelValue":p[2]||(p[2]=F=>t.value.code=F),class:"phone_login__code_input",maxlength:"4","data-cy":"security-code"},null,8,["modelValue"]),u(le,{disabled:w.value,"data-cy":"send-security-code",onClick:N},null,8,["disabled"])])]),_:1},8,["label"])]),_:1},8,["model","rules","onKeypress"])]),_:1},8,["model-value","title"])}}}),je={class:"flex items-center space-x-8"},De=M({props:{modelValue:{type:Boolean},email:null},emits:["update:modelValue"],setup(y,{emit:f}){const e=y,{t:n}=T(),s=v(!0),_=v(),t=Be({email:"",code:""}),a=J(()=>({email:[we,B(n("common.inputEmailTips")),ye(e.email)],code:[B(n("common.inputSecurityCodeTips")),ae]})),w=v(!0),r=(x,c)=>{x==="email"&&(w.value=!c)},N=()=>U(this,null,function*(){yield Me(t.email)}),h=()=>U(this,null,function*(){try{_.value.validate(),yield xe(t.email,+t.code),o(),s.value=!1}catch(x){}}),o=O("reloadUser");return(x,c)=>{const p=L,k=K,i=q,V=I;return b(),C(V,{"close-on-click-modal":!1,"model-value":s.value,title:e.email?l(n)("common.changeEmail"):l(n)("common.bindEmail"),width:"400px","custom-class":"!overflow-visible",onClosed:c[4]||(c[4]=A=>f("update:modelValue",!1))},{footer:d(()=>[u(S,{"confirm-label":e.email?l(n)("common.change"):l(n)("common.bind"),onConfirm:h,onCancel:c[3]||(c[3]=A=>s.value=!1)},null,8,["confirm-label"])]),default:d(()=>[u(i,{ref_key:"form",ref:_,model:l(t),rules:l(a),"label-position":"top",onSubmit:c[2]||(c[2]=z(()=>{},["prevent"])),onKeypress:D(h,["enter"]),onValidate:r},{default:d(()=>[u(k,{label:l(n)("common.email"),prop:"email"},{default:d(()=>[u(p,{modelValue:l(t).email,"onUpdate:modelValue":c[0]||(c[0]=A=>l(t).email=A),"data-cy":"email"},null,8,["modelValue"])]),_:1},8,["label"]),u(k,{label:l(n)("common.securityCode"),prop:"code"},{default:d(()=>[m("div",je,[u(p,{modelValue:l(t).code,"onUpdate:modelValue":c[1]||(c[1]=A=>l(t).code=A),class:"phone_login__code_input",maxlength:"4","data-cy":"security-code"},null,8,["modelValue"]),u(le,{disabled:w.value,"data-cy":"send-security-code",onClick:N},null,8,["disabled"])])]),_:1},8,["label"])]),_:1},8,["model","rules","onKeypress"])]),_:1},8,["model-value","title"])}}}),Le=M({props:{modelValue:{type:Boolean},username:null},emits:["update:modelValue"],setup(y,{emit:f}){const e=y,n=v(),s=()=>U(this,null,function*(){a.value.confirmPassword.length>0&&(yield n.value.validateField("confirmPassword"))}),{t:_}=T(),t=v(!0),a=v({confirmPassword:"",password:"",oldPassword:""}),w={oldPassword:B(_("common.fieldRequiredTips"),!1),password:[B(_("common.fieldRequiredTips"),!1),be,he],confirmPassword:[B(_("common.fieldRequiredTips"),!1),Ve(a.value)]},r=new Ee(w);G(()=>a,h=>{h&&r.validate(a,o=>{o||n.value.clearValidate()})},{deep:!0});const N=()=>U(this,null,function*(){if(yield n.value.validate(),a.value.password===a.value.confirmPassword){const h={confirmPassword:a.value.confirmPassword,newPassword:a.value.password,oldPassword:a.value.oldPassword,username:e.username};try{yield Ce(ee({},h)),t.value=!1}catch(o){console.log(o)}}});return(h,o)=>{const x=L,c=K,p=q,k=I;return b(),C(k,{modelValue:t.value,"onUpdate:modelValue":o[5]||(o[5]=i=>t.value=i),width:"400px",title:l(_)("common.changePassword"),onClosed:o[6]||(o[6]=i=>f("update:modelValue",!1))},{footer:d(()=>[u(S,{"confirm-label":l(_)("profile.change"),onConfirm:o[3]||(o[3]=i=>N()),onCancel:o[4]||(o[4]=i=>t.value=!1)},null,8,["confirm-label"])]),default:d(()=>[u(p,{ref_key:"changePasswordForm",ref:n,rules:l(w),"label-position":"top",model:a.value,onKeydown:D(N,["enter"])},{default:d(()=>[u(c,{label:l(_)("common.oldPassword"),prop:"oldPassword"},{default:d(()=>[u(x,{modelValue:a.value.oldPassword,"onUpdate:modelValue":o[0]||(o[0]=i=>a.value.oldPassword=i),type:"password","data-cy":"old-password"},null,8,["modelValue"])]),_:1},8,["label"]),u(c,{label:l(_)("common.newPassword"),prop:"password"},{default:d(()=>[u(x,{modelValue:a.value.password,"onUpdate:modelValue":o[1]||(o[1]=i=>a.value.password=i),type:"password","data-cy":"new-password",onBlur:s},null,8,["modelValue"])]),_:1},8,["label"]),u(c,{label:l(_)("common.confirmPassword"),prop:"confirmPassword"},{default:d(()=>[u(x,{modelValue:a.value.confirmPassword,"onUpdate:modelValue":o[2]||(o[2]=i=>a.value.confirmPassword=i),type:"password","data-cy":"confirm-password"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["rules","model","onKeydown"])]),_:1},8,["modelValue","title"])}}}),ze=M({props:{modelValue:{type:Boolean},currency:null},emits:["update:modelValue"],setup(y,{emit:f}){const e=y,{t:n}=T(),s=v(!0),_=v(),t=v({currency:""}),a=v(),w=()=>U(this,null,function*(){a.value=yield ke(),t.value.currency=JSON.parse(JSON.stringify(e.currency))}),r=()=>U(this,null,function*(){a.value=yield Pe(t.value.currency),N(),s.value=!1});w();const N=O("reloadUser");return(h,o)=>{const x=se,c=ne,p=K,k=q,i=I;return b(),C(i,{"model-value":s.value,title:l(n)("common.changeCurrency"),width:"400px",onClosed:o[2]||(o[2]=V=>f("update:modelValue",!1))},{footer:d(()=>[u(S,{onConfirm:r,onCancel:o[1]||(o[1]=V=>s.value=!1)})]),default:d(()=>[u(k,{ref_key:"form",ref:_,"label-position":"top"},{default:d(()=>[u(p,{prop:"phone",label:l(n)("common.currency")},{default:d(()=>[u(c,{modelValue:t.value.currency,"onUpdate:modelValue":o[0]||(o[0]=V=>t.value.currency=V),class:"w-full","data-cy":"servers"},{default:d(()=>[(b(!0),R(H,null,te(a.value,V=>(b(),C(x,{key:V,label:V,value:V,"data-cy":"server-opt"},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},512)]),_:1},8,["model-value","title"])}}}),Je=M({props:{modelValue:{type:Boolean},name:null},emits:["update:modelValue"],setup(y,{emit:f}){const e=y,{t:n}=T(),s=v(!0),_=v(),t={firstName:B(n("common.fieldRequiredTips")),lastName:B(n("common.fieldRequiredTips"))},a=v({firstName:"",lastName:""}),w=()=>{a.value.firstName=e.name.firstName,a.value.lastName=e.name.lastName},r=()=>U(this,null,function*(){yield _.value.validate(),yield Ue(a.value.firstName,a.value.lastName),N(),s.value=!1});w();const N=O("reloadUser");return(h,o)=>{const x=L,c=K,p=q,k=I;return b(),C(k,{"model-value":s.value,title:l(n)("common.editName"),width:"400px",onClosed:o[6]||(o[6]=i=>f("update:modelValue",!1))},{footer:d(()=>[u(S,{onConfirm:r,onCancel:o[5]||(o[5]=i=>s.value=!1)})]),default:d(()=>[u(p,{ref_key:"form",ref:_,model:a.value,rules:l(t),"label-position":"top",onSubmit:o[4]||(o[4]=z(()=>{},["prevent"])),onKeypress:D(r,["enter"])},{default:d(()=>[u(c,{prop:"firstName",label:l(n)("common.firstName")},{default:d(()=>[u(x,{modelValue:a.value.firstName,"onUpdate:modelValue":o[0]||(o[0]=i=>a.value.firstName=i),onBlur:o[1]||(o[1]=i=>a.value.firstName=a.value.firstName.replace(/(^\s*)|(\s*$)/g,""))},null,8,["modelValue"])]),_:1},8,["label"]),u(c,{prop:"lastName",label:l(n)("common.lastName")},{default:d(()=>[u(x,{modelValue:a.value.lastName,"onUpdate:modelValue":o[2]||(o[2]=i=>a.value.lastName=i),onBlur:o[3]||(o[3]=i=>a.value.lastName=a.value.lastName.replace(/(^\s*)|(\s*$)/g,""))},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules","onKeypress"])]),_:1},8,["model-value","title"])}}}),j=ce.global.t,re=[{key:" ",value:j("common.none")},{key:"email",value:j("common.emailMessage")},{key:"tel",value:j("common.phoneMessage")},{key:"otp",value:j("common.authenticatorApp")}],Ge=M({props:{modelValue:{type:Boolean},method:null,tel:null,email:null},emits:["update:modelValue"],setup(y,{emit:f}){const e=y,{t:n}=T(),s=v(!0),_=v(),t=v(e.method||" "),a=v(),w=J(()=>{let h=[...re];return e.tel||(h=h.filter(o=>o.key!="tel")),e.email||(h=h.filter(o=>o.key!="email")),h}),r=()=>U(this,null,function*(){yield Ae(t.value),N(),s.value=!1});G(()=>t.value,()=>U(this,null,function*(){console.log(t.value),t.value=="otp"&&(a.value=yield $e())}));const N=O("reloadUser");return(h,o)=>{const x=se,c=ne,p=K,k=q,i=I;return b(),C(i,{"model-value":s.value,title:l(n)("common.2fa"),width:"400px","close-on-click-modal":!1,onClosed:o[2]||(o[2]=V=>f("update:modelValue",!1))},{footer:d(()=>[u(S,{onConfirm:r,onCancel:o[1]||(o[1]=V=>s.value=!1)})]),default:d(()=>[u(k,{ref_key:"form",ref:_,"label-position":"top"},{default:d(()=>[u(p,{prop:"method",label:l(n)("common.preferred2FAMethod")},{default:d(()=>[u(c,{modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=V=>t.value=V),class:"w-full","data-cy":"servers"},{default:d(()=>[(b(!0),R(H,null,te(l(w),V=>(b(),C(x,{key:V.key,label:V.value,value:V.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t.value=="otp"&&a.value?(b(),C(p,{key:0,label:l(n)("common.addOtpCodeTip")},{default:d(()=>[u(qe,{text:a.value,size:400,class:"transform"},null,8,["text"])]),_:1},8,["label"])):E("",!0)]),_:1},512)]),_:1},8,["model-value","title"])}}}),He={class:"p-24 bg-fff dark:bg-[#333] rounded-t-normal shadow-s-10 mb-1px","data-cy":"username-abbr"},Qe={class:"flex items-center"},We={class:"text-l text-black dark:text-fff/86 flex items-center","data-cy":"username"},Xe={class:"mr-8"},Ye={class:"p-24 bg-fff dark:bg-[#333] rounded-b-normal shadow-s-10 mb-24"},Ze={class:"dark:text-fff/80 text-m"},eo={class:"h-36px leading-9"},oo={class:"pr-32"},lo={class:"flex items-center"},ao=["title"],to={key:0,class:"h-36px leading-9"},so={class:"pr-32"},no=m("td",{class:"w-200px relative"},[m("span",{class:"absolute top-4"},"********")],-1),ro={class:"h-36px leading-9"},mo={class:"pr-32"},uo={class:"flex items-center"},io=["title"],co={key:1},po={class:"h-36px leading-9"},fo={class:"pr-32"},vo={class:"w-200px"},_o={class:""},wo={key:1,class:"h-36px leading-9"},yo={class:"pr-32"},bo={class:"w-200px"},ho={class:""},Vo={class:"pr-32"},go={class:"w-200px"},No={class:""},xo=M({props:{userName:null,emailAddress:null,tel:null,firstName:null,lastName:null,password:null,currency:null,fullName:null,twoFAMethod:null},emits:["reload"],setup(y,{emit:f}){const e=y,n=new pe,{t:s}=T(),_=n.get("jwt_token"),t=Se(_),a=Ke(),w=v({tel:""}),r=v({phone:!1,email:!1,password:!1,name:!1,currency:!1,towFA:!1}),N=v({firstName:"",lastName:""}),h=v(""),o=v(""),x=()=>{r.value.phone=!0,w.value.tel=e.tel},c=()=>{r.value.name=!0,N.value.firstName=e.firstName,N.value.lastName=e.lastName},p=()=>{r.value.password=!0,h.value=e.userName},k=()=>{r.value.email=!0,o.value=e.emailAddress,h.value=e.userName},i=()=>{r.value.currency=!0};function V(){return U(this,null,function*(){r.value.towFA=!0})}return G(()=>r.value,A=>{A.phone||(w.value.tel=""),A.name||(N.value.firstName="",N.value.lastName="")}),(A,P)=>{var F,Q,W,X;return b(),R(H,null,[m("div",He,[m("div",Qe,[u(ie,{username:e.userName,size:96,class:"mr-16"},null,8,["username"]),m("div",We,[m("div",Xe,g(l(s)("common.username"))+":",1),Re(" "+g(e.userName),1)])])]),m("div",Ye,[m("table",Ze,[m("tr",eo,[m("td",oo,g(l(s)("common.email"))+":",1),m("td",lo,[m("span",{class:"ellipsis w-200px",title:e.emailAddress||l(s)("common.notBound")},g(e.emailAddress||l(s)("common.notBound")),9,ao)]),m("td",null,[m("div",{class:"text-blue cursor-pointer ml-8","data-cy":"change-email",onClick:k},g(e.emailAddress?l(s)("common.change"):l(s)("common.bind")),1)])]),l(t)?(b(),R("tr",to,[m("td",so,g(l(s)("common.password"))+":",1),no,m("td",null,[m("div",{class:"text-blue cursor-pointer ml-8","data-cy":"change-password",onClick:p},g(l(s)("profile.change")),1)])])):E("",!0),m("tr",ro,[m("td",mo,g(l(s)("profile.name"))+":",1),m("td",uo,[((F=e.firstName)==null?void 0:F.length)+((Q=e.lastName)==null?void 0:Q.length)?(b(),R("span",{key:0,class:"w-200px ellipsis",title:e.fullName},g(e.fullName),9,io)):(b(),R("span",co,g(l(s)("common.none")),1))]),m("td",null,[m("div",{class:"text-blue cursor-pointer ml-8",onClick:c},g(l(s)("common.edit")),1)])]),m("tr",po,[m("td",fo,g(l(s)("profile.phone"))+":",1),m("td",vo,[m("div",_o,g(e.tel||l(s)("common.notBound")),1)]),m("td",null,[m("div",{class:"text-blue cursor-pointer ml-8",onClick:x},g(e.tel?l(s)("common.change"):l(s)("common.bind")),1)])]),(W=l(a).currentOrg)!=null&&W.isAdmin?(b(),R("tr",wo,[m("td",yo,g(l(s)("common.currency"))+":",1),m("td",bo,[m("div",ho,g(e.currency),1)]),m("td",null,[m("div",{class:"text-blue cursor-pointer ml-8",onClick:i},g(l(s)("common.changeCurrency")),1)])])):E("",!0),m("tr",null,[m("td",Vo,g(l(s)("common.2fa"))+":",1),m("td",go,[m("div",No,g(((X=l(re).find($=>$.key==e.twoFAMethod))==null?void 0:X.value)||e.twoFAMethod),1)]),m("td",null,[m("div",{class:"text-blue cursor-pointer ml-8",onClick:V},g(l(s)("common.change")),1)])])])]),r.value.phone?(b(),C(Oe,{key:0,modelValue:r.value.phone,"onUpdate:modelValue":P[0]||(P[0]=$=>r.value.phone=$),phone:w.value},null,8,["modelValue","phone"])):E("",!0),r.value.email?(b(),C(De,{key:1,modelValue:r.value.email,"onUpdate:modelValue":P[1]||(P[1]=$=>r.value.email=$),email:o.value},null,8,["modelValue","email"])):E("",!0),r.value.name?(b(),C(Je,{key:2,modelValue:r.value.name,"onUpdate:modelValue":P[2]||(P[2]=$=>r.value.name=$),name:N.value},null,8,["modelValue","name"])):E("",!0),r.value.password?(b(),C(Le,{key:3,modelValue:r.value.password,"onUpdate:modelValue":P[3]||(P[3]=$=>r.value.password=$),username:h.value},null,8,["modelValue","username"])):E("",!0),r.value.currency?(b(),C(ze,{key:4,modelValue:r.value.currency,"onUpdate:modelValue":P[4]||(P[4]=$=>r.value.currency=$),currency:e.currency},null,8,["modelValue","currency"])):E("",!0),r.value.towFA?(b(),C(Ge,{key:5,modelValue:r.value.towFA,"onUpdate:modelValue":P[5]||(P[5]=$=>r.value.towFA=$),method:e.twoFAMethod,tel:e.tel,email:e.emailAddress},null,8,["modelValue","method","tel","email"])):E("",!0)],64)}}}),Co={class:"w-535px mx-auto mt-32"},ko={class:"text-3l text-black dark:text-fff/86 font-medium mb-32"},Vl=M({setup(y){const{t:f}=T(),e=v({userName:"",emailAddress:"",tel:"",firstName:"",lastName:"",fullName:"",password:"",currency:"",twoFAMethod:"",id:""}),n=()=>U(this,null,function*(){e.value=yield Fe()});return n(),oe("user",e),oe("reloadUser",n),(s,_)=>(b(),R("div",Co,[m("div",ko,g(l(f)("common.profile")),1),u(xo,Te({userName:e.value.userName,emailAddress:e.value.emailAddress,tel:e.value.tel,firstName:e.value.firstName,lastName:e.value.lastName,fullName:e.value.fullName,password:e.value.password,currency:e.value.currency,twoFAMethod:e.value.twoFAMethod},{onReload:n}),null,16)]))}});export{Vl as default};
