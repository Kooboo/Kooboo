import{f as vt,a0 as mt}from"./i18n.bcd18f8a.js";var Zt={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(f,t){(function(o){f.exports=o()})(function(){return function o(i,d,v){function E(b,P){if(!d[b]){if(!i[b]){var T=typeof mt=="function"&&mt;if(!P&&T)return T(b,!0);if(O)return O(b,!0);var A=new Error("Cannot find module '"+b+"'");throw A.code="MODULE_NOT_FOUND",A}var F=d[b]={exports:{}};i[b][0].call(F.exports,function(h){var a=i[b][1][h];return E(a||h)},F,F.exports,o,i,d,v)}return d[b].exports}for(var O=typeof mt=="function"&&mt,I=0;I<v.length;I++)E(v[I]);return E}({1:[function(o,i,d){(function(v){var E=v.MutationObserver||v.WebKitMutationObserver,O;if(E){var I=0,b=new E(h),P=v.document.createTextNode("");b.observe(P,{characterData:!0}),O=function(){P.data=I=++I%2}}else if(!v.setImmediate&&typeof v.MessageChannel!="undefined"){var T=new v.MessageChannel;T.port1.onmessage=h,O=function(){T.port2.postMessage(0)}}else"document"in v&&"onreadystatechange"in v.document.createElement("script")?O=function(){var l=v.document.createElement("script");l.onreadystatechange=function(){h(),l.onreadystatechange=null,l.parentNode.removeChild(l),l=null},v.document.documentElement.appendChild(l)}:O=function(){setTimeout(h,0)};var A,F=[];function h(){A=!0;for(var l,g,S=F.length;S;){for(g=F,F=[],l=-1;++l<S;)g[l]();S=F.length}A=!1}i.exports=a;function a(l){F.push(l)===1&&!A&&O()}}).call(this,typeof vt!="undefined"?vt:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(o,i,d){var v=o(1);function E(){}var O={},I=["REJECTED"],b=["FULFILLED"],P=["PENDING"];i.exports=T;function T(p){if(typeof p!="function")throw new TypeError("resolver must be a function");this.state=P,this.queue=[],this.outcome=void 0,p!==E&&a(this,p)}T.prototype.catch=function(p){return this.then(null,p)},T.prototype.then=function(p,D){if(typeof p!="function"&&this.state===b||typeof D!="function"&&this.state===I)return this;var R=new this.constructor(E);if(this.state!==P){var B=this.state===b?p:D;F(R,B,this.outcome)}else this.queue.push(new A(R,p,D));return R};function A(p,D,R){this.promise=p,typeof D=="function"&&(this.onFulfilled=D,this.callFulfilled=this.otherCallFulfilled),typeof R=="function"&&(this.onRejected=R,this.callRejected=this.otherCallRejected)}A.prototype.callFulfilled=function(p){O.resolve(this.promise,p)},A.prototype.otherCallFulfilled=function(p){F(this.promise,this.onFulfilled,p)},A.prototype.callRejected=function(p){O.reject(this.promise,p)},A.prototype.otherCallRejected=function(p){F(this.promise,this.onRejected,p)};function F(p,D,R){v(function(){var B;try{B=D(R)}catch(U){return O.reject(p,U)}B===p?O.reject(p,new TypeError("Cannot resolve promise with itself")):O.resolve(p,B)})}O.resolve=function(p,D){var R=l(h,D);if(R.status==="error")return O.reject(p,R.value);var B=R.value;if(B)a(p,B);else{p.state=b,p.outcome=D;for(var U=-1,G=p.queue.length;++U<G;)p.queue[U].callFulfilled(D)}return p},O.reject=function(p,D){p.state=I,p.outcome=D;for(var R=-1,B=p.queue.length;++R<B;)p.queue[R].callRejected(D);return p};function h(p){var D=p&&p.then;if(p&&(typeof p=="object"||typeof p=="function")&&typeof D=="function")return function(){D.apply(p,arguments)}}function a(p,D){var R=!1;function B(k){R||(R=!0,O.reject(p,k))}function U(k){R||(R=!0,O.resolve(p,k))}function G(){D(U,B)}var Y=l(G);Y.status==="error"&&B(Y.value)}function l(p,D){var R={};try{R.value=p(D),R.status="success"}catch(B){R.status="error",R.value=B}return R}T.resolve=g;function g(p){return p instanceof this?p:O.resolve(new this(E),p)}T.reject=S;function S(p){var D=new this(E);return O.reject(D,p)}T.all=y;function y(p){var D=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var R=p.length,B=!1;if(!R)return this.resolve([]);for(var U=new Array(R),G=0,Y=-1,k=new this(E);++Y<R;)q(p[Y],Y);return k;function q(V,X){D.resolve(V).then(rt,function(ut){B||(B=!0,O.reject(k,ut))});function rt(ut){U[X]=ut,++G===R&&!B&&(B=!0,O.resolve(k,U))}}}T.race=m;function m(p){var D=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var R=p.length,B=!1;if(!R)return this.resolve([]);for(var U=-1,G=new this(E);++U<R;)Y(p[U]);return G;function Y(k){D.resolve(k).then(function(q){B||(B=!0,O.resolve(G,q))},function(q){B||(B=!0,O.reject(G,q))})}}},{"1":1}],3:[function(o,i,d){(function(v){typeof v.Promise!="function"&&(v.Promise=o(2))}).call(this,typeof vt!="undefined"?vt:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"2":2}],4:[function(o,i,d){var v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function E(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function O(){try{if(typeof indexedDB!="undefined")return indexedDB;if(typeof webkitIndexedDB!="undefined")return webkitIndexedDB;if(typeof mozIndexedDB!="undefined")return mozIndexedDB;if(typeof OIndexedDB!="undefined")return OIndexedDB;if(typeof msIndexedDB!="undefined")return msIndexedDB}catch(e){return}}var I=O();function b(){try{if(!I||!I.open)return!1;var e=typeof openDatabase!="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),n=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!e||n)&&typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch(r){return!1}}function P(e,n){e=e||[],n=n||{};try{return new Blob(e,n)}catch(s){if(s.name!=="TypeError")throw s;for(var r=typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder,u=new r,c=0;c<e.length;c+=1)u.append(e[c]);return u.getBlob(n.type)}}typeof Promise=="undefined"&&o(3);var T=Promise;function A(e,n){n&&e.then(function(r){n(null,r)},function(r){n(r)})}function F(e,n,r){typeof n=="function"&&e.then(n),typeof r=="function"&&e.catch(r)}function h(e){return typeof e!="string"&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function a(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var l="local-forage-detect-blob-support",g=void 0,S={},y=Object.prototype.toString,m="readonly",p="readwrite";function D(e){for(var n=e.length,r=new ArrayBuffer(n),u=new Uint8Array(r),c=0;c<n;c++)u[c]=e.charCodeAt(c);return r}function R(e){return new T(function(n){var r=e.transaction(l,p),u=P([""]);r.objectStore(l).put(u,"key"),r.onabort=function(c){c.preventDefault(),c.stopPropagation(),n(!1)},r.oncomplete=function(){var c=navigator.userAgent.match(/Chrome\/(\d+)/),s=navigator.userAgent.match(/Edge\//);n(s||!c||parseInt(c[1],10)>=43)}}).catch(function(){return!1})}function B(e){return typeof g=="boolean"?T.resolve(g):R(e).then(function(n){return g=n,g})}function U(e){var n=S[e.name],r={};r.promise=new T(function(u,c){r.resolve=u,r.reject=c}),n.deferredOperations.push(r),n.dbReady?n.dbReady=n.dbReady.then(function(){return r.promise}):n.dbReady=r.promise}function G(e){var n=S[e.name],r=n.deferredOperations.pop();if(r)return r.resolve(),r.promise}function Y(e,n){var r=S[e.name],u=r.deferredOperations.pop();if(u)return u.reject(n),u.promise}function k(e,n){return new T(function(r,u){if(S[e.name]=S[e.name]||At(),e.db)if(n)U(e),e.db.close();else return r(e.db);var c=[e.name];n&&c.push(e.version);var s=I.open.apply(I,c);n&&(s.onupgradeneeded=function(_){var C=s.result;try{C.createObjectStore(e.storeName),_.oldVersion<=1&&C.createObjectStore(l)}catch(w){if(w.name==="ConstraintError")console.warn('The database "'+e.name+'" has been upgraded from version '+_.oldVersion+" to version "+_.newVersion+', but the storage "'+e.storeName+'" already exists.');else throw w}}),s.onerror=function(_){_.preventDefault(),u(s.error)},s.onsuccess=function(){var _=s.result;_.onversionchange=function(C){C.target.close()},r(_),G(e)}})}function q(e){return k(e,!1)}function V(e){return k(e,!0)}function X(e,n){if(!e.db)return!0;var r=!e.db.objectStoreNames.contains(e.storeName),u=e.version<e.db.version,c=e.version>e.db.version;if(u&&(e.version!==n&&console.warn('The database "'+e.name+`" can't be downgraded from version `+e.db.version+" to version "+e.version+"."),e.version=e.db.version),c||r){if(r){var s=e.db.version+1;s>e.version&&(e.version=s)}return!0}return!1}function rt(e){return new T(function(n,r){var u=new FileReader;u.onerror=r,u.onloadend=function(c){var s=btoa(c.target.result||"");n({__local_forage_encoded_blob:!0,data:s,type:e.type})},u.readAsBinaryString(e)})}function ut(e){var n=D(atob(e.data));return P([n],{type:e.type})}function Dt(e){return e&&e.__local_forage_encoded_blob}function re(e){var n=this,r=n._initReady().then(function(){var u=S[n._dbInfo.name];if(u&&u.dbReady)return u.dbReady});return F(r,e,e),r}function ne(e){U(e);for(var n=S[e.name],r=n.forages,u=0;u<r.length;u++){var c=r[u];c._dbInfo.db&&(c._dbInfo.db.close(),c._dbInfo.db=null)}return e.db=null,q(e).then(function(s){return e.db=s,X(e)?V(e):s}).then(function(s){e.db=n.db=s;for(var _=0;_<r.length;_++)r[_]._dbInfo.db=s}).catch(function(s){throw Y(e,s),s})}function et(e,n,r,u){u===void 0&&(u=1);try{var c=e.db.transaction(e.storeName,n);r(null,c)}catch(s){if(u>0&&(!e.db||s.name==="InvalidStateError"||s.name==="NotFoundError"))return T.resolve().then(function(){if(!e.db||s.name==="NotFoundError"&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),V(e)}).then(function(){return ne(e).then(function(){et(e,n,r,u-1)})}).catch(r);r(s)}}function At(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function ie(e){var n=this,r={db:null};if(e)for(var u in e)r[u]=e[u];var c=S[r.name];c||(c=At(),S[r.name]=c),c.forages.push(n),n._initReady||(n._initReady=n.ready,n.ready=re);var s=[];function _(){return T.resolve()}for(var C=0;C<c.forages.length;C++){var w=c.forages[C];w!==n&&s.push(w._initReady().catch(_))}var x=c.forages.slice(0);return T.all(s).then(function(){return r.db=c.db,q(r)}).then(function(L){return r.db=L,X(r,n._defaultConfig.version)?V(r):L}).then(function(L){r.db=c.db=L,n._dbInfo=r;for(var N=0;N<x.length;N++){var j=x[N];j!==n&&(j._dbInfo.db=r.db,j._dbInfo.version=r.version)}})}function oe(e,n){var r=this;e=h(e);var u=new T(function(c,s){r.ready().then(function(){et(r._dbInfo,m,function(_,C){if(_)return s(_);try{var w=C.objectStore(r._dbInfo.storeName),x=w.get(e);x.onsuccess=function(){var L=x.result;L===void 0&&(L=null),Dt(L)&&(L=ut(L)),c(L)},x.onerror=function(){s(x.error)}}catch(L){s(L)}})}).catch(s)});return A(u,n),u}function ae(e,n){var r=this,u=new T(function(c,s){r.ready().then(function(){et(r._dbInfo,m,function(_,C){if(_)return s(_);try{var w=C.objectStore(r._dbInfo.storeName),x=w.openCursor(),L=1;x.onsuccess=function(){var N=x.result;if(N){var j=N.value;Dt(j)&&(j=ut(j));var z=e(j,N.key,L++);z!==void 0?c(z):N.continue()}else c()},x.onerror=function(){s(x.error)}}catch(N){s(N)}})}).catch(s)});return A(u,n),u}function se(e,n,r){var u=this;e=h(e);var c=new T(function(s,_){var C;u.ready().then(function(){return C=u._dbInfo,y.call(n)==="[object Blob]"?B(C.db).then(function(w){return w?n:rt(n)}):n}).then(function(w){et(u._dbInfo,p,function(x,L){if(x)return _(x);try{var N=L.objectStore(u._dbInfo.storeName);w===null&&(w=void 0);var j=N.put(w,e);L.oncomplete=function(){w===void 0&&(w=null),s(w)},L.onabort=L.onerror=function(){var z=j.error?j.error:j.transaction.error;_(z)}}catch(z){_(z)}})}).catch(_)});return A(c,r),c}function ue(e,n){var r=this;e=h(e);var u=new T(function(c,s){r.ready().then(function(){et(r._dbInfo,p,function(_,C){if(_)return s(_);try{var w=C.objectStore(r._dbInfo.storeName),x=w.delete(e);C.oncomplete=function(){c()},C.onerror=function(){s(x.error)},C.onabort=function(){var L=x.error?x.error:x.transaction.error;s(L)}}catch(L){s(L)}})}).catch(s)});return A(u,n),u}function ce(e){var n=this,r=new T(function(u,c){n.ready().then(function(){et(n._dbInfo,p,function(s,_){if(s)return c(s);try{var C=_.objectStore(n._dbInfo.storeName),w=C.clear();_.oncomplete=function(){u()},_.onabort=_.onerror=function(){var x=w.error?w.error:w.transaction.error;c(x)}}catch(x){c(x)}})}).catch(c)});return A(r,e),r}function fe(e){var n=this,r=new T(function(u,c){n.ready().then(function(){et(n._dbInfo,m,function(s,_){if(s)return c(s);try{var C=_.objectStore(n._dbInfo.storeName),w=C.count();w.onsuccess=function(){u(w.result)},w.onerror=function(){c(w.error)}}catch(x){c(x)}})}).catch(c)});return A(r,e),r}function le(e,n){var r=this,u=new T(function(c,s){if(e<0){c(null);return}r.ready().then(function(){et(r._dbInfo,m,function(_,C){if(_)return s(_);try{var w=C.objectStore(r._dbInfo.storeName),x=!1,L=w.openKeyCursor();L.onsuccess=function(){var N=L.result;if(!N){c(null);return}e===0||x?c(N.key):(x=!0,N.advance(e))},L.onerror=function(){s(L.error)}}catch(N){s(N)}})}).catch(s)});return A(u,n),u}function he(e){var n=this,r=new T(function(u,c){n.ready().then(function(){et(n._dbInfo,m,function(s,_){if(s)return c(s);try{var C=_.objectStore(n._dbInfo.storeName),w=C.openKeyCursor(),x=[];w.onsuccess=function(){var L=w.result;if(!L){u(x);return}x.push(L.key),L.continue()},w.onerror=function(){c(w.error)}}catch(L){c(L)}})}).catch(c)});return A(r,e),r}function pe(e,n){n=a.apply(this,arguments);var r=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var u=this,c;if(!e.name)c=T.reject("Invalid arguments");else{var s=e.name===r.name&&u._dbInfo.db,_=s?T.resolve(u._dbInfo.db):q(e).then(function(C){var w=S[e.name],x=w.forages;w.db=C;for(var L=0;L<x.length;L++)x[L]._dbInfo.db=C;return C});e.storeName?c=_.then(function(C){if(!!C.objectStoreNames.contains(e.storeName)){var w=C.version+1;U(e);var x=S[e.name],L=x.forages;C.close();for(var N=0;N<L.length;N++){var j=L[N];j._dbInfo.db=null,j._dbInfo.version=w}var z=new T(function(W,K){var $=I.open(e.name,w);$.onerror=function(Z){var lt=$.result;lt.close(),K(Z)},$.onupgradeneeded=function(){var Z=$.result;Z.deleteObjectStore(e.storeName)},$.onsuccess=function(){var Z=$.result;Z.close(),W(Z)}});return z.then(function(W){x.db=W;for(var K=0;K<L.length;K++){var $=L[K];$._dbInfo.db=W,G($._dbInfo)}}).catch(function(W){throw(Y(e,W)||T.resolve()).catch(function(){}),W})}}):c=_.then(function(C){U(e);var w=S[e.name],x=w.forages;C.close();for(var L=0;L<x.length;L++){var N=x[L];N._dbInfo.db=null}var j=new T(function(z,W){var K=I.deleteDatabase(e.name);K.onerror=function(){var $=K.result;$&&$.close(),W(K.error)},K.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},K.onsuccess=function(){var $=K.result;$&&$.close(),z($)}});return j.then(function(z){w.db=z;for(var W=0;W<x.length;W++){var K=x[W];G(K._dbInfo)}}).catch(function(z){throw(Y(e,z)||T.resolve()).catch(function(){}),z})})}return A(c,n),c}var de={_driver:"asyncStorage",_initStorage:ie,_support:b(),iterate:ae,getItem:oe,setItem:se,removeItem:ue,clear:ce,length:fe,key:le,keys:he,dropInstance:pe};function ve(){return typeof openDatabase=="function"}var nt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",me="~~local_forage_type~",Rt=/^~~local_forage_type~([^~]+)~/,pt="__lfsc__:",_t=pt.length,yt="arbf",gt="blob",Nt="si08",Pt="ui08",Bt="uic8",Mt="si16",Ft="si32",jt="ur16",kt="ui32",zt="fl32",Ut="fl64",Wt=_t+yt.length,Yt=Object.prototype.toString;function Vt(e){var n=e.length*.75,r=e.length,u,c=0,s,_,C,w;e[e.length-1]==="="&&(n--,e[e.length-2]==="="&&n--);var x=new ArrayBuffer(n),L=new Uint8Array(x);for(u=0;u<r;u+=4)s=nt.indexOf(e[u]),_=nt.indexOf(e[u+1]),C=nt.indexOf(e[u+2]),w=nt.indexOf(e[u+3]),L[c++]=s<<2|_>>4,L[c++]=(_&15)<<4|C>>2,L[c++]=(C&3)<<6|w&63;return x}function bt(e){var n=new Uint8Array(e),r="",u;for(u=0;u<n.length;u+=3)r+=nt[n[u]>>2],r+=nt[(n[u]&3)<<4|n[u+1]>>4],r+=nt[(n[u+1]&15)<<2|n[u+2]>>6],r+=nt[n[u+2]&63];return n.length%3===2?r=r.substring(0,r.length-1)+"=":n.length%3===1&&(r=r.substring(0,r.length-2)+"=="),r}function _e(e,n){var r="";if(e&&(r=Yt.call(e)),e&&(r==="[object ArrayBuffer]"||e.buffer&&Yt.call(e.buffer)==="[object ArrayBuffer]")){var u,c=pt;e instanceof ArrayBuffer?(u=e,c+=yt):(u=e.buffer,r==="[object Int8Array]"?c+=Nt:r==="[object Uint8Array]"?c+=Pt:r==="[object Uint8ClampedArray]"?c+=Bt:r==="[object Int16Array]"?c+=Mt:r==="[object Uint16Array]"?c+=jt:r==="[object Int32Array]"?c+=Ft:r==="[object Uint32Array]"?c+=kt:r==="[object Float32Array]"?c+=zt:r==="[object Float64Array]"?c+=Ut:n(new Error("Failed to get type for BinaryArray"))),n(c+bt(u))}else if(r==="[object Blob]"){var s=new FileReader;s.onload=function(){var _=me+e.type+"~"+bt(this.result);n(pt+gt+_)},s.readAsArrayBuffer(e)}else try{n(JSON.stringify(e))}catch(_){console.error("Couldn't convert value into a JSON string: ",e),n(null,_)}}function ye(e){if(e.substring(0,_t)!==pt)return JSON.parse(e);var n=e.substring(Wt),r=e.substring(_t,Wt),u;if(r===gt&&Rt.test(n)){var c=n.match(Rt);u=c[1],n=n.substring(c[0].length)}var s=Vt(n);switch(r){case yt:return s;case gt:return P([s],{type:u});case Nt:return new Int8Array(s);case Pt:return new Uint8Array(s);case Bt:return new Uint8ClampedArray(s);case Mt:return new Int16Array(s);case jt:return new Uint16Array(s);case Ft:return new Int32Array(s);case kt:return new Uint32Array(s);case zt:return new Float32Array(s);case Ut:return new Float64Array(s);default:throw new Error("Unkown type: "+r)}}var Ct={serialize:_e,deserialize:ye,stringToBuffer:Vt,bufferToString:bt};function qt(e,n,r,u){e.executeSql("CREATE TABLE IF NOT EXISTS "+n.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],r,u)}function ge(e){var n=this,r={db:null};if(e)for(var u in e)r[u]=typeof e[u]!="string"?e[u].toString():e[u];var c=new T(function(s,_){try{r.db=openDatabase(r.name,String(r.version),r.description,r.size)}catch(C){return _(C)}r.db.transaction(function(C){qt(C,r,function(){n._dbInfo=r,s()},function(w,x){_(x)})},_)});return r.serializer=Ct,c}function it(e,n,r,u,c,s){e.executeSql(r,u,c,function(_,C){C.code===C.SYNTAX_ERR?_.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[n.storeName],function(w,x){x.rows.length?s(w,C):qt(w,n,function(){w.executeSql(r,u,c,s)},s)},s):s(_,C)},s)}function be(e,n){var r=this;e=h(e);var u=new T(function(c,s){r.ready().then(function(){var _=r._dbInfo;_.db.transaction(function(C){it(C,_,"SELECT * FROM "+_.storeName+" WHERE key = ? LIMIT 1",[e],function(w,x){var L=x.rows.length?x.rows.item(0).value:null;L&&(L=_.serializer.deserialize(L)),c(L)},function(w,x){s(x)})})}).catch(s)});return A(u,n),u}function Ce(e,n){var r=this,u=new T(function(c,s){r.ready().then(function(){var _=r._dbInfo;_.db.transaction(function(C){it(C,_,"SELECT * FROM "+_.storeName,[],function(w,x){for(var L=x.rows,N=L.length,j=0;j<N;j++){var z=L.item(j),W=z.value;if(W&&(W=_.serializer.deserialize(W)),W=e(W,z.key,j+1),W!==void 0){c(W);return}}c()},function(w,x){s(x)})})}).catch(s)});return A(u,n),u}function $t(e,n,r,u){var c=this;e=h(e);var s=new T(function(_,C){c.ready().then(function(){n===void 0&&(n=null);var w=n,x=c._dbInfo;x.serializer.serialize(n,function(L,N){N?C(N):x.db.transaction(function(j){it(j,x,"INSERT OR REPLACE INTO "+x.storeName+" (key, value) VALUES (?, ?)",[e,L],function(){_(w)},function(z,W){C(W)})},function(j){if(j.code===j.QUOTA_ERR){if(u>0){_($t.apply(c,[e,w,r,u-1]));return}C(j)}})})}).catch(C)});return A(s,r),s}function Se(e,n,r){return $t.apply(this,[e,n,r,1])}function Te(e,n){var r=this;e=h(e);var u=new T(function(c,s){r.ready().then(function(){var _=r._dbInfo;_.db.transaction(function(C){it(C,_,"DELETE FROM "+_.storeName+" WHERE key = ?",[e],function(){c()},function(w,x){s(x)})})}).catch(s)});return A(u,n),u}function we(e){var n=this,r=new T(function(u,c){n.ready().then(function(){var s=n._dbInfo;s.db.transaction(function(_){it(_,s,"DELETE FROM "+s.storeName,[],function(){u()},function(C,w){c(w)})})}).catch(c)});return A(r,e),r}function xe(e){var n=this,r=new T(function(u,c){n.ready().then(function(){var s=n._dbInfo;s.db.transaction(function(_){it(_,s,"SELECT COUNT(key) as c FROM "+s.storeName,[],function(C,w){var x=w.rows.item(0).c;u(x)},function(C,w){c(w)})})}).catch(c)});return A(r,e),r}function Ee(e,n){var r=this,u=new T(function(c,s){r.ready().then(function(){var _=r._dbInfo;_.db.transaction(function(C){it(C,_,"SELECT key FROM "+_.storeName+" WHERE id = ? LIMIT 1",[e+1],function(w,x){var L=x.rows.length?x.rows.item(0).key:null;c(L)},function(w,x){s(x)})})}).catch(s)});return A(u,n),u}function Ie(e){var n=this,r=new T(function(u,c){n.ready().then(function(){var s=n._dbInfo;s.db.transaction(function(_){it(_,s,"SELECT key FROM "+s.storeName,[],function(C,w){for(var x=[],L=0;L<w.rows.length;L++)x.push(w.rows.item(L).key);u(x)},function(C,w){c(w)})})}).catch(c)});return A(r,e),r}function Oe(e){return new T(function(n,r){e.transaction(function(u){u.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(c,s){for(var _=[],C=0;C<s.rows.length;C++)_.push(s.rows.item(C).name);n({db:e,storeNames:_})},function(c,s){r(s)})},function(u){r(u)})})}function Le(e,n){n=a.apply(this,arguments);var r=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var u=this,c;return e.name?c=new T(function(s){var _;e.name===r.name?_=u._dbInfo.db:_=openDatabase(e.name,"","",0),e.storeName?s({db:_,storeNames:[e.storeName]}):s(Oe(_))}).then(function(s){return new T(function(_,C){s.db.transaction(function(w){function x(z){return new T(function(W,K){w.executeSql("DROP TABLE IF EXISTS "+z,[],function(){W()},function($,Z){K(Z)})})}for(var L=[],N=0,j=s.storeNames.length;N<j;N++)L.push(x(s.storeNames[N]));T.all(L).then(function(){_()}).catch(function(z){C(z)})},function(w){C(w)})})}):c=T.reject("Invalid arguments"),A(c,n),c}var De={_driver:"webSQLStorage",_initStorage:ge,_support:ve(),iterate:Ce,getItem:be,setItem:Se,removeItem:Te,clear:we,length:xe,key:Ee,keys:Ie,dropInstance:Le};function Ae(){try{return typeof localStorage!="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}function Kt(e,n){var r=e.name+"/";return e.storeName!==n.storeName&&(r+=e.storeName+"/"),r}function Re(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(n){return!0}}function Ne(){return!Re()||localStorage.length>0}function Pe(e){var n=this,r={};if(e)for(var u in e)r[u]=e[u];return r.keyPrefix=Kt(e,n._defaultConfig),Ne()?(n._dbInfo=r,r.serializer=Ct,T.resolve()):T.reject()}function Be(e){var n=this,r=n.ready().then(function(){for(var u=n._dbInfo.keyPrefix,c=localStorage.length-1;c>=0;c--){var s=localStorage.key(c);s.indexOf(u)===0&&localStorage.removeItem(s)}});return A(r,e),r}function Me(e,n){var r=this;e=h(e);var u=r.ready().then(function(){var c=r._dbInfo,s=localStorage.getItem(c.keyPrefix+e);return s&&(s=c.serializer.deserialize(s)),s});return A(u,n),u}function Fe(e,n){var r=this,u=r.ready().then(function(){for(var c=r._dbInfo,s=c.keyPrefix,_=s.length,C=localStorage.length,w=1,x=0;x<C;x++){var L=localStorage.key(x);if(L.indexOf(s)===0){var N=localStorage.getItem(L);if(N&&(N=c.serializer.deserialize(N)),N=e(N,L.substring(_),w++),N!==void 0)return N}}});return A(u,n),u}function je(e,n){var r=this,u=r.ready().then(function(){var c=r._dbInfo,s;try{s=localStorage.key(e)}catch(_){s=null}return s&&(s=s.substring(c.keyPrefix.length)),s});return A(u,n),u}function ke(e){var n=this,r=n.ready().then(function(){for(var u=n._dbInfo,c=localStorage.length,s=[],_=0;_<c;_++){var C=localStorage.key(_);C.indexOf(u.keyPrefix)===0&&s.push(C.substring(u.keyPrefix.length))}return s});return A(r,e),r}function ze(e){var n=this,r=n.keys().then(function(u){return u.length});return A(r,e),r}function Ue(e,n){var r=this;e=h(e);var u=r.ready().then(function(){var c=r._dbInfo;localStorage.removeItem(c.keyPrefix+e)});return A(u,n),u}function We(e,n,r){var u=this;e=h(e);var c=u.ready().then(function(){n===void 0&&(n=null);var s=n;return new T(function(_,C){var w=u._dbInfo;w.serializer.serialize(n,function(x,L){if(L)C(L);else try{localStorage.setItem(w.keyPrefix+e,x),_(s)}catch(N){(N.name==="QuotaExceededError"||N.name==="NS_ERROR_DOM_QUOTA_REACHED")&&C(N),C(N)}})})});return A(c,r),c}function Ye(e,n){if(n=a.apply(this,arguments),e=typeof e!="function"&&e||{},!e.name){var r=this.config();e.name=e.name||r.name,e.storeName=e.storeName||r.storeName}var u=this,c;return e.name?c=new T(function(s){e.storeName?s(Kt(e,u._defaultConfig)):s(e.name+"/")}).then(function(s){for(var _=localStorage.length-1;_>=0;_--){var C=localStorage.key(_);C.indexOf(s)===0&&localStorage.removeItem(C)}}):c=T.reject("Invalid arguments"),A(c,n),c}var Ve={_driver:"localStorageWrapper",_initStorage:Pe,_support:Ae(),iterate:Fe,getItem:Me,setItem:We,removeItem:Ue,clear:Be,length:ze,key:je,keys:ke,dropInstance:Ye},qe=function(n,r){return n===r||typeof n=="number"&&typeof r=="number"&&isNaN(n)&&isNaN(r)},$e=function(n,r){for(var u=n.length,c=0;c<u;){if(qe(n[c],r))return!0;c++}return!1},Gt=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},ft={},Ht={},ct={INDEXEDDB:de,WEBSQL:De,LOCALSTORAGE:Ve},Ke=[ct.INDEXEDDB._driver,ct.WEBSQL._driver,ct.LOCALSTORAGE._driver],dt=["dropInstance"],St=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(dt),Ge={description:"",driver:Ke.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function He(e,n){e[n]=function(){var r=arguments;return e.ready().then(function(){return e[n].apply(e,r)})}}function Tt(){for(var e=1;e<arguments.length;e++){var n=arguments[e];if(n)for(var r in n)n.hasOwnProperty(r)&&(Gt(n[r])?arguments[0][r]=n[r].slice():arguments[0][r]=n[r])}return arguments[0]}var Je=function(){function e(n){E(this,e);for(var r in ct)if(ct.hasOwnProperty(r)){var u=ct[r],c=u._driver;this[r]=c,ft[c]||this.defineDriver(u)}this._defaultConfig=Tt({},Ge),this._config=Tt({},this._defaultConfig,n),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return e.prototype.config=function(r){if((typeof r=="undefined"?"undefined":v(r))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var u in r){if(u==="storeName"&&(r[u]=r[u].replace(/\W/g,"_")),u==="version"&&typeof r[u]!="number")return new Error("Database version must be a number.");this._config[u]=r[u]}return"driver"in r&&r.driver?this.setDriver(this._config.driver):!0}else return typeof r=="string"?this._config[r]:this._config},e.prototype.defineDriver=function(r,u,c){var s=new T(function(_,C){try{var w=r._driver,x=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!r._driver){C(x);return}for(var L=St.concat("_initStorage"),N=0,j=L.length;N<j;N++){var z=L[N],W=!$e(dt,z);if((W||r[z])&&typeof r[z]!="function"){C(x);return}}var K=function(){for(var lt=function(Ze){return function(){var tr=new Error("Method "+Ze+" is not implemented by the current driver"),Jt=T.reject(tr);return A(Jt,arguments[arguments.length-1]),Jt}},wt=0,Xe=dt.length;wt<Xe;wt++){var xt=dt[wt];r[xt]||(r[xt]=lt(xt))}};K();var $=function(lt){ft[w]&&console.info("Redefining LocalForage driver: "+w),ft[w]=r,Ht[w]=lt,_()};"_support"in r?r._support&&typeof r._support=="function"?r._support().then($,C):$(!!r._support):$(!0)}catch(Z){C(Z)}});return F(s,u,c),s},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(r,u,c){var s=ft[r]?T.resolve(ft[r]):T.reject(new Error("Driver not found."));return F(s,u,c),s},e.prototype.getSerializer=function(r){var u=T.resolve(Ct);return F(u,r),u},e.prototype.ready=function(r){var u=this,c=u._driverSet.then(function(){return u._ready===null&&(u._ready=u._initDriver()),u._ready});return F(c,r,r),c},e.prototype.setDriver=function(r,u,c){var s=this;Gt(r)||(r=[r]);var _=this._getSupportedDrivers(r);function C(){s._config.driver=s.driver()}function w(N){return s._extend(N),C(),s._ready=s._initStorage(s._config),s._ready}function x(N){return function(){var j=0;function z(){for(;j<N.length;){var W=N[j];return j++,s._dbInfo=null,s._ready=null,s.getDriver(W).then(w).catch(z)}C();var K=new Error("No available storage method found.");return s._driverSet=T.reject(K),s._driverSet}return z()}}var L=this._driverSet!==null?this._driverSet.catch(function(){return T.resolve()}):T.resolve();return this._driverSet=L.then(function(){var N=_[0];return s._dbInfo=null,s._ready=null,s.getDriver(N).then(function(j){s._driver=j._driver,C(),s._wrapLibraryMethodsWithReady(),s._initDriver=x(_)})}).catch(function(){C();var N=new Error("No available storage method found.");return s._driverSet=T.reject(N),s._driverSet}),F(this._driverSet,u,c),this._driverSet},e.prototype.supports=function(r){return!!Ht[r]},e.prototype._extend=function(r){Tt(this,r)},e.prototype._getSupportedDrivers=function(r){for(var u=[],c=0,s=r.length;c<s;c++){var _=r[c];this.supports(_)&&u.push(_)}return u},e.prototype._wrapLibraryMethodsWithReady=function(){for(var r=0,u=St.length;r<u;r++)He(this,St[r])},e.prototype.createInstance=function(r){return new e(r)},e}(),Qe=new Je;i.exports=Qe},{"3":3}]},{},[4])(4)})})(Zt);var er=Zt.exports,st=function(){return st=Object.assign||function(t){for(var o,i=1,d=arguments.length;i<d;i++){o=arguments[i];for(var v in o)Object.prototype.hasOwnProperty.call(o,v)&&(t[v]=o[v])}return t},st.apply(this,arguments)};function Qt(f,t){var o={};for(var i in f)Object.prototype.hasOwnProperty.call(f,i)&&t.indexOf(i)<0&&(o[i]=f[i]);if(f!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,i=Object.getOwnPropertySymbols(f);d<i.length;d++)t.indexOf(i[d])<0&&Object.prototype.propertyIsEnumerable.call(f,i[d])&&(o[i[d]]=f[i[d]]);return o}function H(f,t,o,i){function d(v){return v instanceof o?v:new o(function(E){E(v)})}return new(o||(o=Promise))(function(v,E){function O(P){try{b(i.next(P))}catch(T){E(T)}}function I(P){try{b(i.throw(P))}catch(T){E(T)}}function b(P){P.done?v(P.value):d(P.value).then(O,I)}b((i=i.apply(f,t||[])).next())})}function J(f,t){var o={label:0,sent:function(){if(v[0]&1)throw v[1];return v[1]},trys:[],ops:[]},i,d,v,E;return E={next:O(0),throw:O(1),return:O(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function O(b){return function(P){return I([b,P])}}function I(b){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,d&&(v=b[0]&2?d.return:b[0]?d.throw||((v=d.return)&&v.call(d),0):d.next)&&!(v=v.call(d,b[1])).done)return v;switch(d=0,v&&(b=[b[0]&2,v.value]),b[0]){case 0:case 1:v=b;break;case 4:return o.label++,{value:b[1],done:!1};case 5:o.label++,d=b[1],b=[0];continue;case 7:b=o.ops.pop(),o.trys.pop();continue;default:if(v=o.trys,!(v=v.length>0&&v[v.length-1])&&(b[0]===6||b[0]===2)){o=0;continue}if(b[0]===3&&(!v||b[1]>v[0]&&b[1]<v[3])){o.label=b[1];break}if(b[0]===6&&o.label<v[1]){o.label=v[1],v=b;break}if(v&&o.label<v[2]){o.label=v[2],o.ops.push(b);break}v[2]&&o.ops.pop(),o.trys.pop();continue}b=t.call(f,o)}catch(P){b=[6,P],d=0}finally{i=v=0}if(b[0]&5)throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}}function Ot(f,t,o){if(o||arguments.length===2)for(var i=0,d=t.length,v;i<d;i++)(v||!(i in t))&&(v||(v=Array.prototype.slice.call(t,0,i)),v[i]=t[i]);return f.concat(v||Array.prototype.slice.call(t))}var rr=function(){function f(t,o,i){this.maxTotal=30,this.interval=5*1e3,this.dbName="MonacoEvent",this.storeName="Event",this.tempStore=[],this.timer=void 0,this.uploadList=[],this.id=t,this.callback=o,i!=null&&i.maxTotal&&(this.maxTotal=i.maxTotal),i!=null&&i.interval&&(this.interval=i.interval),i!=null&&i.storeName&&(this.storeName=i.storeName),this.db=er.createInstance({name:this.dbName,storeName:this.storeName}),this.currentKey="".concat(Date.now())}return f.prototype.updateKey=function(){var t=this.currentKey;this.currentKey="".concat(Date.now()),this.tempStore=[],this.upload(t),this.autoUpload()},f.prototype.upload=function(t){return H(this,void 0,void 0,function(){var o,i,d=this;return J(this,function(v){switch(v.label){case 0:return this.uploadList.includes(t)?[2]:[4,this.db.getItem(t)];case 1:if(o=v.sent(),!o)return[2];this.uploadList.push(t),v.label=2;case 2:return v.trys.push([2,5,,6]),[4,this.callback(o)];case 3:return v.sent(),[4,this.db.removeItem(t)];case 4:return v.sent(),this.uploadList=this.uploadList.filter(function(E){return E!==t}),[3,6];case 5:return i=v.sent(),console.log("\u4E0A\u4F20\u5931\u8D25",i),this.uploadList=this.uploadList.filter(function(E){return E!==t}),setTimeout(function(){d.upload(t)},3e3),[3,6];case 6:return[2]}})})},f.prototype.add=function(t){this.tempStore.push(st({record_id:this.id},t)),this.db.setItem(this.currentKey,this.tempStore),this.tempStore.length>=this.maxTotal&&this.updateKey()},f.prototype.uploadAll=function(){return H(this,void 0,void 0,function(){var t,o=this;return J(this,function(i){switch(i.label){case 0:return[4,this.db.keys()];case 1:return t=i.sent(),t.forEach(function(d){o.upload(d)}),[2]}})})},f.prototype.autoUpload=function(){var t=this;this.timer&&(clearTimeout(this.timer),this.timer=void 0),this.timer=setTimeout(function(){t.updateKey(),t.autoUpload()},this.interval)},f.prototype.dispose=function(){this.uploadAll(),clearTimeout(this.timer)},f}(),nr=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function ir(f){return f&&f.__esModule&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f}function or(f,t){return t={exports:{}},f(t,t.exports),t.exports}var te=or(function(f,t){(function(o,i){f.exports=i()})(nr,function(){return function(){var o={d:function(h,a){for(var l in a)o.o(a,l)&&!o.o(h,l)&&Object.defineProperty(h,l,{enumerable:!0,get:a[l]})},o:function(h,a){return Object.prototype.hasOwnProperty.call(h,a)},r:function(h){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(h,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(h,"__esModule",{value:!0})}},i={};o.r(i),o.d(i,{PlainTextOperation:function(){return F}});var d,v,E=(d=function(h,a){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,g){l.__proto__=g}||function(l,g){for(var S in g)Object.prototype.hasOwnProperty.call(g,S)&&(l[S]=g[S])},d(h,a)},function(h,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function l(){this.constructor=h}d(h,a),h.prototype=a===null?Object.create(a):(l.prototype=a.prototype,new l)}),O=function(h){function a(){var l=h!==null&&h.apply(this,arguments)||this;return l.name="Assertion Failed",l}return E(a,h),a}(Error),I=function(h){function a(){var l=h!==null&&h.apply(this,arguments)||this;return l.name="No-op Encountered",l.message="This method should not have been called!",l}return E(a,h),a}(Error);function b(h,a){if(h==null||h===!1)throw typeof a=="string"?new O(a):a}v=Error,E(function(){var h=v!==null&&v.apply(this,arguments)||this;return h.name="Invalid Operation Encountered",h.message="The Operation recieved was either Invalid or Corrupted, please retry!",h},v),function(h){E(function(){var a=h!==null&&h.apply(this,arguments)||this;return a.name="Transaction Failure",a.message="Failed to update in the Database",a},h)}(Error),function(h){E(function(){var a=h!==null&&h.apply(this,arguments)||this;return a.name="DOM Operation Failure",a.message="Failed to Query or Mutate some DOM Node",a},h)}(Error);var P=function(){function h(a){this._characterCount=a}return h.prototype.isInsert=function(){return!1},h.prototype.isDelete=function(){return!0},h.prototype.isRetain=function(){return!1},h.prototype.equals=function(a){return a.isDelete()&&a.characterCountEqual(this._characterCount)},h.prototype.attributesEqual=function(a){throw new I("Delete operation does not have any attributes.")},h.prototype.characterCountEqual=function(a){return this._characterCount===a},h.prototype.textContentEqual=function(a){return!1},h.prototype.addCharacterCount=function(a){this._characterCount+=a},h.prototype.addTextContent=function(a){throw new I("Can not add text to delete operation.")},h.prototype.setTextContent=function(a){throw new I("Can not add text to delete operation.")},h.prototype.characterCount=function(){return this._characterCount},h.prototype.textContent=function(){throw new I("Can get text from delete operation.")},h.prototype.hasEmptyAttributes=function(){return!0},h.prototype.getAttributes=function(){return null},h.prototype.toString=function(){return"DELETE ".concat(this._characterCount)},h.prototype.valueOf=function(){return-this._characterCount},h}(),T=function(){function h(a,l){l===void 0&&(l=null),this._attributes=l,this._text=a}return h.prototype.isInsert=function(){return!0},h.prototype.isDelete=function(){return!1},h.prototype.isRetain=function(){return!1},h.prototype.equals=function(a){return a.isInsert()&&a.attributesEqual(this._attributes)&&a.textContentEqual(this._text)},h.prototype.attributesEqual=function(a){if(a==null||this._attributes==null)return this._attributes==a;for(var l in this._attributes)if(this._attributes[l]!==a[l])return!1;for(var l in a)if(this._attributes[l]!==a[l])return!1;return!0},h.prototype.characterCountEqual=function(a){return!1},h.prototype.textContentEqual=function(a){return this._text===a},h.prototype.addCharacterCount=function(a){throw new I("Can not add character count to insert operation.")},h.prototype.addTextContent=function(a){this._text+=a},h.prototype.setTextContent=function(a){this._text=a},h.prototype.characterCount=function(){throw new I("Can get character count from insert operation.")},h.prototype.textContent=function(){return this._text},h.prototype.hasEmptyAttributes=function(){return this._attributes==null||Object.keys(this._attributes).length===0},h.prototype.getAttributes=function(){return Object.assign({},this._attributes)},h.prototype.toString=function(){return'INSERT "'.concat(this._text,'"')},h.prototype.valueOf=function(){return this._text},h}(),A=function(){function h(a,l){l===void 0&&(l=null),this._attributes=l,this._characterCount=a}return h.prototype.isInsert=function(){return!1},h.prototype.isDelete=function(){return!1},h.prototype.isRetain=function(){return!0},h.prototype.equals=function(a){return a.isRetain()&&a.attributesEqual(this._attributes)&&a.characterCountEqual(this._characterCount)},h.prototype.attributesEqual=function(a){if(a==null||this._attributes==null)return this._attributes==a;for(var l in this._attributes)if(this._attributes[l]!==a[l])return!1;for(var l in a)if(this._attributes[l]!==a[l])return!1;return!0},h.prototype.characterCountEqual=function(a){return this._characterCount===a},h.prototype.textContentEqual=function(a){return!1},h.prototype.addCharacterCount=function(a){this._characterCount+=a},h.prototype.addTextContent=function(a){throw new I("Can not add text to retain operation.")},h.prototype.setTextContent=function(a){throw new I("Can not add text to retain operation.")},h.prototype.characterCount=function(){return this._characterCount},h.prototype.textContent=function(){throw new I("Can get text from retain operation.")},h.prototype.hasEmptyAttributes=function(){return this._attributes==null||Object.keys(this._attributes).length===0},h.prototype.getAttributes=function(){return Object.assign({},this._attributes)},h.prototype.toString=function(){return"RETAIN ".concat(this._characterCount)},h.prototype.valueOf=function(){return this._characterCount},h}(),F=function(){function h(){this._ops=[],this._baseLength=0,this._targetLength=0}return h.prototype.equals=function(a){return this._baseLength===a._baseLength&&this._targetLength===a._targetLength&&this._ops.length===a._ops.length&&this._ops.every(function(l,g){return l.equals(a._ops[g])})},h.prototype._last=function(a){return a===void 0&&(a=0),this._ops.length>a?this._ops[this._ops.length-a-1]:null},h.prototype.retain=function(a,l){if(l===void 0&&(l=null),b(a>=0,"Retain expects a positive integer."),a===0)return this;this._baseLength+=a,this._targetLength+=a,l||(l={});var g=this._last();return g&&g.isRetain()&&g.attributesEqual(l)?g.addCharacterCount(a):this._ops.push(new A(a,l)),this},h.prototype.insert=function(a,l){if(l===void 0&&(l=null),b(typeof a=="string","Insert expects a string."),a==="")return this;this._targetLength+=a.length,l||(l={});var g=this._last(),S=this._last(1);return g&&g.isInsert()&&g.attributesEqual(l)?g.addTextContent(a):g&&g.isDelete()?S&&S.isInsert()&&S.attributesEqual(l)?S.addTextContent(a):(this._ops[this._ops.length-1]=new T(a,l),this._ops.push(g)):this._ops.push(new T(a,l)),this},h.prototype.delete=function(a){var l;if(b((l=typeof a=="string"?a.length:a)>=0,"Delete expects a positive integer or string."),l===0)return this;this._baseLength+=l;var g=this._last();return g&&g.isDelete()?g.addCharacterCount(l):this._ops.push(new P(l)),this},h.prototype.isNoop=function(){return this._ops.length===0||this._ops.every(function(a){return a.isRetain()&&a.hasEmptyAttributes()})},h.prototype.clone=function(){for(var a=this._ops,l=new h,g=0,S=a;g<S.length;g++){var y=S[g];y.isRetain()?l.retain(y.characterCount(),y.getAttributes()):y.isInsert()?l.insert(y.textContent(),y.getAttributes()):l.delete(y.characterCount())}return l},h.prototype.entries=function(){return this._ops.entries()},h.prototype.apply=function(a,l,g){l===void 0&&(l=[]),g===void 0&&(g=[]),b(a.length===this._baseLength,"The operation's base length must be equal to the string's length.");for(var S=[],y=0,m=0,p=this._ops;m<p.length;m++){var D=p[m];if(D.isRetain()){var R=D.characterCount(),B=y+R;b(B<=a.length,"Operation can't retain more characters than are left in the string."),S.push(a.slice(y,B));for(var U=0;U<R;U++){var G=l[y+U]||{},Y={};for(var k in G)Y[k]=G[k],b(Y[k]!=0,"Expected attribute value to be true");var q=D.getAttributes();for(var k in q)q[k]===!1?delete Y[k]:Y[k]=q[k],b(Y[k]!=0,"Expected attribute value to be true");g.push(Y)}y=B}else if(D.isInsert()){var V=D.textContent();for(S.push(V),U=0;U<V.length;U++){q=D.getAttributes();var X={};for(var k in q)X[k]=q[k],b(X[k]!=0,"Expected attribute value to be true");g.push(X)}}else y+=D.characterCount()}b(y===a.length,"The operation didn't operate on the whole string.");var rt=S.join("");return b(rt.length===g.length,"Attributes length did not match content length."),rt},h.prototype.invert=function(a){for(var l=this._ops,g=new h,S=0,y=0,m=l;y<m.length;y++){var p=m[y];if(p.isRetain()){var D=p.characterCount();g.retain(D,p.getAttributes()),S+=D}else if(p.isInsert()){var R=p.textContent();g.delete(R.length)}else{var B=p.characterCount();g.insert(a.slice(S,S+B),p.getAttributes()),S+=B}}return g},h.prototype._getSimpleOp=function(a){var l=a._ops;switch(l.length){case 1:return l[0];case 2:if(l[0].isRetain())return l[1];if(l[1].isRetain())return l[0];break;case 3:if(l[0].isRetain()&&l[2].isRetain())return l[1]}return null},h.prototype._getStartIndex=function(a){var l=a._ops;if(!l)return 0;var g=l[0];return g&&g.isRetain()?g.characterCount():0},h.prototype.shouldBeComposedWith=function(a){if(this.isNoop()||a.isNoop())return!0;var l=this._getStartIndex(this),g=this._getStartIndex(a),S=this._getSimpleOp(this),y=this._getSimpleOp(a);return S!=null&&y!=null&&(S.isInsert()&&y.isInsert()?l+S.textContent().length===g:!(!S.isDelete()||!y.isDelete()||g+y.characterCount()!==l&&l!==g))},h.prototype.shouldBeComposedWithInverted=function(a){if(this.isNoop()||a.isNoop())return!0;var l=this._getStartIndex(this),g=this._getStartIndex(a),S=this._getSimpleOp(this),y=this._getSimpleOp(a);return S!=null&&y!=null&&(S.isInsert()&&y.isInsert()?l+S.textContent().length===g||l===g:!(!S.isDelete()||!y.isDelete())&&g+y.characterCount()===l)},h.prototype._nextTextOp=function(a){var l=a.next().value;return l?l[1]:null},h.prototype._composeAttributes=function(a,l,g){var S={};for(var y in a)S[y]=a[y];for(var y in l)g&&l[y]===!1?delete S[y]:S[y]=l[y];return S},h.prototype.compose=function(a){b(this.canMergeWith(a),"The base length of the second operation has to be the target length of the first operation");for(var l=new h,g=this.entries(),S=a.entries(),y=this._nextTextOp(g),m=this._nextTextOp(S);y!=null||m!=null;)if(y&&y.isDelete())l.delete(y.characterCount()),y=this._nextTextOp(g);else if(m&&m.isInsert())l.insert(m.textContent(),m.getAttributes()),m=this._nextTextOp(S);else{if(b(y!=null,"Cannot compose operations: first operation is too short."),b(m!=null,"Cannot compose operations: first operation is too long."),y==null||m==null)break;if(y.isRetain()&&m.isRetain()){var p=this._composeAttributes(y.getAttributes(),m.getAttributes(),!1);y.characterCount()>m.characterCount()?(l.retain(m.characterCount(),p),y.addCharacterCount(-m.characterCount()),m=this._nextTextOp(S)):y.characterCount()===m.characterCount()?(l.retain(y.characterCount(),p),y=this._nextTextOp(g),m=this._nextTextOp(S)):(l.retain(y.characterCount(),p),m.addCharacterCount(-y.characterCount()),y=this._nextTextOp(g))}else y.isInsert()&&m.isDelete()?y.textContent().length>m.characterCount()?(y.setTextContent(y.textContent().slice(m.characterCount())),m=this._nextTextOp(S)):y.textContent().length===m.characterCount()?(y=this._nextTextOp(g),m=this._nextTextOp(S)):(m.addCharacterCount(-y.textContent().length),y=this._nextTextOp(g)):y.isInsert()&&m.isRetain()?(p=this._composeAttributes(y.getAttributes(),m.getAttributes(),!0),y.textContent().length>m.characterCount()?(l.insert(y.textContent().slice(0,m.characterCount()),p),y.setTextContent(y.textContent().slice(m.characterCount())),m=this._nextTextOp(S)):y.textContent().length===m.characterCount()?(l.insert(y.textContent(),p),y=this._nextTextOp(g),m=this._nextTextOp(S)):(l.insert(y.textContent(),p),m.addCharacterCount(-y.textContent().length),y=this._nextTextOp(g))):y.isRetain()&&m.isDelete()?y.characterCount()>m.characterCount()?(l.delete(m.characterCount()),y.addCharacterCount(-m.characterCount()),m=this._nextTextOp(S)):y.characterCount()===m.characterCount()?(l.delete(m.characterCount()),y=this._nextTextOp(g),m=this._nextTextOp(S)):(l.delete(y.characterCount()),m.addCharacterCount(-y.characterCount()),y=this._nextTextOp(g)):b(!1,`This should not happen:
op1: `.concat(y,`
op2: `).concat(m))}return l},h.prototype._transformAttributes=function(a,l){var g={},S={},y={};for(var m in a)y[m]=!0;for(var m in l)y[m]=!0;for(var m in y){var p=a[m],D=l[m];b(p!=null||D!=null,"Failed to transform attributes"),p==null?S[m]=D:D==null?g[m]=p:p===D||(g[m]=p)}return[g,S]},h.prototype.transform=function(a){b(a.isEqualBaseLength(this._baseLength),"Both operations have to have the same base length");for(var l=new h,g=new h,S=this.entries(),y=a.entries(),m=this._nextTextOp(S),p=this._nextTextOp(y);m!=null||p!=null;)if(m&&m.isInsert())l.insert(m.textContent(),m.getAttributes()),g.retain(m.textContent().length,m.getAttributes()),m=this._nextTextOp(S);else if(p&&p.isInsert())l.retain(p.textContent().length,p.getAttributes()),g.insert(p.textContent(),p.getAttributes()),p=this._nextTextOp(y);else{if(b(m!=null,"Cannot transform operations: first operation is too short."),b(p!=null,"Cannot transform operations: first operation is too long."),m==null||p==null)break;if(m.isRetain()&&p.isRetain()){var D=0,R=this._transformAttributes(m.getAttributes(),p.getAttributes());m.characterCount()>p.characterCount()?(D=p.characterCount(),m.addCharacterCount(-p.characterCount()),p=this._nextTextOp(y)):m.characterCount()===p.characterCount()?(D=p.characterCount(),m=this._nextTextOp(S),p=this._nextTextOp(y)):(D=m.characterCount(),p.addCharacterCount(-m.characterCount()),m=this._nextTextOp(S)),l.retain(D,R[0]),g.retain(D,R[1])}else m.isDelete()&&p.isDelete()?m.characterCount()>p.characterCount()?(m.addCharacterCount(-p.characterCount()),p=this._nextTextOp(y)):m.characterCount()===p.characterCount()?(m=this._nextTextOp(S),p=this._nextTextOp(y)):(p.addCharacterCount(-m.characterCount()),m=this._nextTextOp(S)):m.isDelete()&&p.isRetain()?(D=0,m.characterCount()>p.characterCount()?(D=p.characterCount(),m.addCharacterCount(-p.characterCount()),p=this._nextTextOp(y)):m.characterCount()===p.characterCount()?(D=p.characterCount(),m=this._nextTextOp(S),p=this._nextTextOp(y)):(D=m.characterCount(),p.addCharacterCount(-m.characterCount()),m=this._nextTextOp(S)),l.delete(D)):m.isRetain()&&p.isDelete()?(D=0,m.characterCount()>p.characterCount()?(D=p.characterCount(),m.addCharacterCount(-p.characterCount()),p=this._nextTextOp(y)):m.characterCount()===p.characterCount()?(D=m.characterCount(),m=this._nextTextOp(S),p=this._nextTextOp(y)):(D=m.characterCount(),p.addCharacterCount(-m.characterCount()),m=this._nextTextOp(S)),g.delete(D)):b(!1,`The two operations aren't compatible:
op1: `.concat(m,`
op2: `).concat(p))}return[l,g]},h.prototype.isEqualBaseLength=function(a){return this._baseLength===a},h.prototype.isEqualTargetLength=function(a){return this._targetLength===a},h.prototype.canMergeWith=function(a){return a.isEqualBaseLength(this._targetLength)},h.prototype.toString=function(){return this._ops.map(function(a){return a.toString()}).join(", ")},h.prototype.valueOf=function(){for(var a=[],l=0,g=this._ops;l<g.length;l++){var S=g[l];S.hasEmptyAttributes()||a.push(S.getAttributes()),a.push(S.valueOf())}return a},h.prototype.toJSON=function(){var a=this.valueOf();return a.length===0&&a.push(0),a},h.fromJSON=function(a){for(var l=new h,g={},S=0,y=a;S<y.length;S++){var m=y[S];typeof m!="object"?typeof m!="string"?(b(Number.isInteger(m),"invalid number found, can not assign to retain or delete operation."),m<0?(l.delete(-m),g={}):(l.retain(m,g),g={})):(l.insert(m,g),g={}):g=m}return l},h}();return i}()})});ir(te);var ht=te.PlainTextOperation,M;(function(f){f.Start="Start",f.End="End",f.Init="Init",f.Open="Open",f.Close="Close",f.Focus="Focus",f.Blur="Blur",f.Change="Change",f.Cursor="Cursor",f.SetText="SetText",f.ChangeFileList="ChangeFileList",f.Blank="Blank",f.Custom="Custom"})(M||(M={}));var Lt;(function(f){f.LF=`
`,f.CRLF=`\r
`})(Lt||(Lt={}));var ar=function(){function f(){var t=this;this.promise=new Promise(function(o,i){t.resolve=o,t.reject=i})}return f}(),sr=function(f,t){if(!(f&&t))return null;var o=f.map(function(E){return E.id}),i=t.map(function(E){return E.id}),d=[],v=[];return o.forEach(function(E){i.includes(E)||d.push(f.find(function(O){return O.id===E}))}),i.forEach(function(E){o.includes(E)||v.push(E)}),d.length===0&&v.length===0?null:(console.log(d,v),{add:d,del:v})},ee=0,Xt=function(){return ee=0},tt=function(){return ee++};function ur(f){var t=Math.floor(f%864e5/36e5),o=Math.floor(f%(1e3*60*60)/(1e3*60)),i=Math.floor(f%(1e3*60)/1e3);return t?"".concat(("00"+t).slice(-2),":").concat(("00"+o).slice(-2),":").concat(("00"+i).slice(-2)):"".concat(("00"+o).slice(-2),":").concat(("00"+i).slice(-2))}var cr=function(){function f(t,o,i){var d;this._toDispose=[],this._lastDocLines=[],this.storeCallback=function(){},this.id=t,this.lang=i,this.status=!1,this._monaco=o,this._monaco.getModel().setEOL(0),this._lastDocLines=(d=this._monaco)===null||d===void 0?void 0:d.getModel().getLinesContent()}return f.prototype._getModel=function(){if(!!this._monaco)return this._monaco.getModel()},f.prototype._onChange=function(t){var o=this._getModel(),i=this._getPreviousContentInRange(),d=i.length;if(!t.changes||t.changes.length===0){var v=new ht().retain(d);return{operation:v,inverse:v}}var E=this._operationFromMonacoChange(t.changes,d),O=E[0],I=E[1];return this._lastDocLines=o.getLinesContent(),{operation:O,inverse:I}},f.prototype._getPreviousContentInRange=function(t){var o=this._getModel(),i=o?o.getEOL():Lt.LF;if(!t)return this._lastDocLines.join(i);for(var d="",v=t.startLineNumber,E=t.startColumn,O=t.endLineNumber,I=t.endColumn,b=v;b<=O;b++){var P=this._lastDocLines[b-1];if(b===v){if(b===O)return P.slice(E-1,I-1);d+=P.slice(E-1)+i}else b===O?d+=P.slice(0,I-1):d+=P+i}return d},f.prototype._operationFromMonacoChange=function(t,o){var i=new ht,d=new ht;if(t.length>1){var v=t[0],E=t[t.length-1];v.rangeOffset>E.rangeOffset&&(t=Ot([],t,!0).reverse())}for(var O=0,I=0,b=t;I<b.length;I++){var P=b[I],T=P,A=T.range,F=T.text,h=T.rangeOffset,a=T.rangeLength,l=h-O;try{i=i.retain(l),d=d.retain(l)}catch(g){throw console.error(g),g}!F&&!A.isEmpty()?(i=i.delete(a),d=d.insert(this._getPreviousContentInRange(A))):F&&!A.isEmpty()?(i=i.delete(a).insert(F),d=d.insert(this._getPreviousContentInRange(A)).delete(F)):(i=i.insert(F),d=d.delete(F)),O=O+l+a}try{i=i.retain(o-O),d=d.retain(o-O)}catch(g){throw console.error(g),g}return[i,d]},f.prototype.addEvent=function(t){this.prevEvent&&this.prevEvent.type===M.Blur&&t.type===M.Focus&&t.time-this.prevEvent.time<3e3&&(t.time=this.prevEvent.time+50),this.storeCallback(t)},f.prototype.bindStoreCallback=function(t){this.storeCallback=t},f.prototype.trigger=function(t,o){return H(this,void 0,void 0,function(){return J(this,function(i){return this.addEvent(st(st({},o),{order:tt(),time:Date.now(),type:t,id:this.id})),[2]})})},f.prototype.open=function(){this.addEvent({order:tt(),time:Date.now(),type:M.Open,id:this.id,text:this._monaco.getValue(),lang:this.lang})},f.prototype.close=function(){this.addEvent({order:tt(),time:Date.now(),type:M.Close,id:this.id,text:this._monaco.getValue(),lang:this.lang})},f.prototype.on=function(){return H(this,void 0,void 0,function(){var t=this;return J(this,function(o){return typeof this.storeCallback=="function"&&this.id?this.status?[2]:(this.status=!0,this._toDispose=[this._monaco.onDidBlurEditorWidget(function(){t.addEvent({order:tt(),time:Date.now(),type:M.Blur,id:t.id})}),this._monaco.onDidFocusEditorWidget(function(){t.addEvent({order:tt(),time:Date.now(),type:M.Focus,id:t.id})}),this._monaco.onDidChangeModelContent(function(i){var d=t._onChange(i),v=d.operation,E=d.inverse;t.addEvent({order:tt(),id:t.id,time:Date.now(),type:M.Change,operation:v.toJSON(),inverse:E.toJSON()})}),this._monaco.onDidChangeCursorPosition(function(){var i=t._monaco.getSelection(),d=i.startLineNumber,v=i.startColumn,E=i.endLineNumber,O=i.endColumn;t.addEvent({order:tt(),id:t.id,time:Date.now(),type:M.Cursor,cursor:[d,v,E,O]})})],[2]):(console.error("\u672A\u4F20\u5165\u56DE\u8C03\u51FD\u6570\u6216\u6587\u4EF6id"),[2])})})},f.prototype.off=function(){return H(this,void 0,void 0,function(){return J(this,function(t){return this.status?(this.status=!1,this._toDispose.forEach(function(o){var i;return(i=o.dispose)===null||i===void 0?void 0:i.call(o)}),[2]):[2]})})},f.prototype.dispose=function(){this.off()},f}(),ot,Q={},Et=[];(function(){function f(){this._recordingStatus=!1,this._initializeStatus=!1,this._disposeStatus=!1,this._time=0,this._readyCompleter=new ar,this._eventStream=null}return f.getInstance=function(){return this.instance||(Xt(),this.instance=new f),this.instance},f.clearInstance=function(){Xt(),this.instance=void 0},f.start=function(t,o){var i=this.getInstance();i.initialize(t),o==null||o()},f.stop=function(t){this.instance&&(this.instance.dispose(),t==null||t())},f.open=function(t,o,i){this.instance||(this.instance=new f),this.instance.open(t,o,i)},f.close=function(t){this.instance&&this.instance.close(t)},f.focus=function(t){this.instance&&this.instance.focus(t)},Object.defineProperty(f.prototype,"recordId",{get:function(){return this._recordId},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"recordName",{get:function(){return this._recordName},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"recordingStatus",{get:function(){return this._recordingStatus},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"initializeStatus",{get:function(){return this._initializeStatus},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"disposeStatus",{get:function(){return this._disposeStatus},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"time",{get:function(){return this._time},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"readyCompleter",{get:function(){return this._readyCompleter},enumerable:!1,configurable:!0}),f.prototype.initialize=function(t){var o;return H(this,void 0,void 0,function(){var i=this;return J(this,function(d){return this._initializeStatus?[2]:(t.id&&t.pushEventApi?(Et=(o=t.initData)===null||o===void 0?void 0:o.fileList,this._eventStream=t.eventStream,ot=new rr(t.id,t.pushEventApi,t.memorizerConfig),this._recordId=t.id,this._recordName=t.name,this._readyCompleter.resolve(!0),this._recordingStatus=!0,this._initializeStatus=!0,ot.uploadAll(),ot.autoUpload(),this.eventAggregator({order:tt(),record_id:t.id,time:Date.now(),type:M.Init,initData:t.initData}),clearInterval(this._timer),this._timer=setInterval(function(){i._time+=1e3},1e3)):(console.error("\u7F3A\u5C11\u5FC5\u5907\u53C2\u6570 id or pushEventApi"),this._readyCompleter.reject(!1)),[2])})})},f.prototype.open=function(t,o,i){var d=this;!this._initializeStatus||this._disposeStatus||!t||Q[t]||(Q[t]=new cr(t,o,i),Q[t].bindStoreCallback(function(v){d.eventAggregator(v)}),Q[t].open(),Q[t].on())},f.prototype.close=function(t){!this._initializeStatus||this._disposeStatus||Q[t]&&(Q[t].close(),Q[t].dispose(),delete Q[t])},f.prototype.focus=function(t){!this._initializeStatus||this._disposeStatus||Q[t]&&Q[t].trigger(M.Focus)},f.prototype.changeFileList=function(t){if(!(!this._initializeStatus||this._disposeStatus)){var o=sr(t,Et);o!==null&&(this.eventAggregator({order:tt(),time:Date.now(),type:M.ChangeFileList,fileListChange:o}),Et=t)}},f.prototype.trigger=function(t,o,i){var d;!this._initializeStatus||this._disposeStatus||(d=Q[t])===null||d===void 0||d.trigger(o,i)},f.prototype.triggerCustom=function(t){!this._initializeStatus||this._disposeStatus||this.eventAggregator({order:tt(),time:Date.now(),type:M.Custom,customEvent:t})},f.prototype.triggerBlankEvent=function(t){var o=this;!this._initializeStatus||this._disposeStatus||(clearTimeout(this._blankEventTimer),this._blankEventTimer=setTimeout(function(){o.eventAggregator({order:tt(),time:Date.now(),type:M.Blank}),o.triggerBlankEvent(t)},t))},f.prototype.eventAggregator=function(t){!this._initializeStatus||this._disposeStatus||(this._eventStream&&this._eventStream(t),ot.add(t))},f.prototype.dispose=function(){var t,o;if(!(!this._initializeStatus||this._disposeStatus)){console.log("Dispose Recorder"),this._recordingStatus=!1,ot.uploadAll().finally(function(){var d,v;(v=(d=ot).dispose)===null||v===void 0||v.call(d),ot=void 0});for(var i in Q)(o=(t=Q[i])===null||t===void 0?void 0:t.dispose)===null||o===void 0||o.call(t);Q={},clearInterval(this._timer),clearTimeout(this._blankEventTimer),this._disposeStatus=!0,f.clearInstance()}},f})();var at,It=function(){function f(){this.monacoList={},this.fileListBin={}}return f}(),hr=function(){function f(t,o,i){if(this.playBeforeDelay=0,this.pollInterval=1e3,this.pollAutoPlay=!1,this.speed=1,this.isSkip=!1,this.skipTime=1e3*3,this.skipDelay=1e3,this.isLockCursor=!0,this.isLockView=!0,this.otherData=new It,this._loadStatus=!1,this._playStatus=!1,this._pollStatus=!1,this._events=[],this._frame=0,this._currentTime=0,this._id="",this._name="",this._fileList=[],this._tabList={},this.pollTimeoutTimer=void 0,this.playIntervalTimer=void 0,this.playTimeoutTimer=void 0,this.suggestTimeoutTimer=void 0,this.pullMoreCallback=null,!(t&&o))throw new Error("\u672A\u4F20\u5165monaco\u6216\u5B9E\u4F8B\u83B7\u53D6\u56DE\u8C03");at||(at=t),this.createEditorCallback=o,i&&(i.pollInterval!==void 0&&(this.pollInterval=i.pollInterval),i.isSkip!==void 0&&(this.isSkip=i.isSkip),i.skipTime!==void 0&&(this.skipTime=i.skipTime),i.skipDelay!==void 0&&(this.skipDelay=i.skipDelay),i.isLockView!==void 0&&(this.isLockView=i.isLockView),i.isLockCursor!==void 0&&(this.isLockCursor=i.isLockCursor))}return Object.defineProperty(f.prototype,"loadStatus",{get:function(){return this._loadStatus},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"playStatus",{get:function(){return this._playStatus},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"pollStatus",{get:function(){return this._pollStatus},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"events",{get:function(){return this._events},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"frame",{get:function(){return this._frame},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"prevEvent",{get:function(){return this._events[this._frame-1]},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"currentEvent",{get:function(){return this._events[this._frame]},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"nextEvent",{get:function(){return this._events[this._frame+1]},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"currentTime",{get:function(){return this._currentTime},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"firstTimestamp",{get:function(){return this._events.length?this._events[0].time:0},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"lastTimestamp",{get:function(){return this._events.length?this._events[this._events.length-1].time:0},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"totalTime",{get:function(){return this._events.length?this._events[this._events.length-1].time-this._events[0].time:0},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"lastEvent",{get:function(){return this._events.length?this._events[this._events.length-1]:null},enumerable:!1,configurable:!0}),f.prototype.getTime=function(t){return t-this.firstTimestamp},f.prototype.getProgress=function(t){return t/this.totalTime*100},f.prototype.formatTime=function(t){return ur(t)},Object.defineProperty(f.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"fileList",{get:function(){return this._fileList},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"other",{get:function(){return this._other},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"tabList",{get:function(){return this._tabList},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"activeId",{get:function(){return this._activeId},enumerable:!1,configurable:!0}),f.prototype.setOtherParam=function(t,o){this._other||(this._other={}),this._other[t]=o},f.prototype.setDom=function(t,o){this._tabList[t]&&(this._tabList[t].dom=o)},f.prototype.getDom=function(t){var o,i;return(i=(o=this._tabList)===null||o===void 0?void 0:o[t])===null||i===void 0?void 0:i.dom},f.prototype.getMonaco=function(t){return this.otherData.monacoList[t]},f.prototype.openEditor=function(t,o,i){return o===void 0&&(o=""),H(this,void 0,void 0,function(){var d;return J(this,function(v){switch(v.label){case 0:return this.otherData.monacoList[t]?[3,2]:(this.otherData.monacoList[t]=Promise.resolve(this.createEditorCallback(t,o,i)),[4,this.otherData.monacoList[t]]);case 1:d=v.sent(),d.updateOptions({readOnly:!0}),v.label=2;case 2:return[4,this.otherData.monacoList[t]];case 3:return v.sent().setValue(o),[4,this.otherData.monacoList[t]];case 4:return v.sent().getModel().setEOL(0),[2]}})})},f.prototype.bindExport=function(t){this.exportEvent=t},f.prototype.reset=function(){this._loadStatus=!1,this._playStatus=!1,this._pollStatus=!1,this._frame=0,this._fileList=[],this._tabList={},this._activeId=void 0,clearTimeout(this.pollTimeoutTimer),clearInterval(this.playIntervalTimer),clearTimeout(this.playTimeoutTimer),clearTimeout(this.suggestTimeoutTimer),this._events.length=0,this._currentTime=0,this.otherData=new It},f.prototype.getHighProgressBar=function(){var t=this;if(this.totalTime===0||this._events.length===0)return null;var o=this._events.map(function(I){return{time:t.getTime(I.time),type:I.type}}).sort(function(I,b){return I.time-b.time}),i=Math.ceil(o[o.length-1].time/200),d=new Array(200).fill(0),v=0;o.forEach(function(I){for(;I.time>i*(v+1);)v++;[M.Init,M.Start,M.Blur,M.Blank,M.End].includes(I.type)||d[v]++});var E=Math.max.apply(Math,d);E<3&&(E=3);var O=d.map(function(I){var b=I/E*100;return b<0?0:b>100?100:b});return this.highProgressBar=O,O},f.prototype.getDelayTime=function(t){return this.isSkip&&t>this.skipTime?(this._currentTime=this.getTime(this._events[this._frame].time)-this.skipDelay,this.skipDelay):t},f.prototype.getNextFrameTimeDiff=function(){if(this._frame>=this._events.length)return 0;var t=this._events[this._frame].time-this.firstTimestamp;return t-this._currentTime},f.prototype.getCurrentProgressData=function(){var t;return H(this,void 0,void 0,function(){var o,i,d,v,E,O,I,b,P,T,A;return J(this,function(F){switch(F.label){case 0:if(!this._loadStatus)return[2];o=this._playStatus,this._playStatus&&this.pause(),i=[],d=0,i.push({type:M.Init,initData:st(st({},this._other),{id:this._id,name:this._name,fileList:this._fileList}),order:d++,time:Date.now()}),v=[];for(E in this._tabList)v.push(E);O=0,F.label=1;case 1:return O<v.length?(I=v[O],b=this._tabList[I],T=(P=i).push,A={type:M.Open,order:d++,time:Date.now(),id:b.id},[4,this.otherData.monacoList[b.id]]):[3,4];case 2:T.apply(P,[(A.text=(t=F.sent())===null||t===void 0?void 0:t.getValue(),A.lang=b.lang,A)]),F.label=3;case 3:return O++,[3,1];case 4:return this._activeId&&i.push({type:M.Focus,order:d++,time:Date.now(),id:this._activeId}),o&&this.play(),[2,i]}})})},f.prototype.load=function(t){if(!!(t!=null&&t.length)){this.reset(),this._events=t,t.sort(function(v,E){return v.order-E.order});for(var o=[],i=t[0].order,d=0;d<t.length;d++)if(t[d].order===i)i++,o.push(t[d]);else if(t[d].order===i-1){console.error("\u987A\u5E8F\u6821\u9A8C\u9519\u8BEF, \u91CD\u590D\u5E27 \u8DF3\u8FC7");continue}else if([M.Start,M.End,M.Blank,M.Init].includes(t[d].type))console.error("\u987A\u5E8F\u6821\u9A8C\u9519\u8BEF, \u7279\u6B8A\u4E8B\u4EF6\u5FFD\u89C6\uFF1A",i+"\u4E0D\u7B49\u4E8E"+t[d].order,t[d]),i=t[d].order+1,o.push(t[d]);else{console.error("\u987A\u5E8F\u6821\u9A8C\u4E2D\u65AD\uFF1A",i+"\u4E0D\u7B49\u4E8E"+t[d].order);continue}this._events=o,this._loadStatus=!0,this._pollStatus||this.getHighProgressBar()}},f.prototype.push=function(t){var o;if(!!(t!=null&&t.length)){t.sort(function(E,O){return E.order-O.order});for(var i=[],d=this.lastEvent.order+1,v=0;v<t.length;v++)t[v].order===d&&(d++,i.push(t[v]));(o=this._events).push.apply(o,i),this._pollStatus&&this.pollAutoPlay&&(this.play(),this.pollAutoPlay=!1)}},f.prototype.operation=function(t,o){var i,d,v,E,O,I,b,P,T;return o===void 0&&(o=!1),H(this,void 0,void 0,function(){var A,F,h,a,l,g,S,y,m,p,D,R,B,U,G,Y,k,q=this;return J(this,function(V){switch(V.label){case 0:if(t.type!==M.Init)return[3,6];A=[];for(F in this._tabList)A.push(F);h=0,V.label=1;case 1:return h<A.length?(a=A[h],l=this._tabList[a],l?(g=this.otherData.monacoList[l.id],g?[4,g]:[3,3]):[2]):[3,5];case 2:(i=V.sent())===null||i===void 0||i.dispose(),delete this.otherData.monacoList[l.id],V.label=3;case 3:delete this._tabList[a],V.label=4;case 4:return h++,[3,1];case 5:return delete this.otherData,this.otherData=new It,this._fileList=[],this._tabList={},this._activeId=void 0,this._other=null,t.initData?(S=t.initData,y=S.id,m=S.name,p=S.fileList,D=Qt(S,["id","name","fileList"]),y&&(this._id=y),m&&(this._name=m),p!=null&&p.length&&(this._fileList=Ot([],p,!0)),this._other=D,[3,21]):[2];case 6:return t.type!==M.ChangeFileList?[3,7]:((d=t.fileListChange.add)===null||d===void 0||d.forEach(function(X){q._fileList.push(X)}),(v=t.fileListChange.del)===null||v===void 0||v.forEach(function(X){q.otherData.fileListBin[X]=q._fileList.splice(q._fileList.findIndex(function(rt){return rt.id===X}),1)}),[3,21]);case 7:return t.type!==M.Open?[3,9]:(this._tabList[t.id]={id:t.id,lang:t.lang},this._activeId=t.id,[4,this.openEditor(t.id,t.text,t.lang)]);case 8:return V.sent(),[3,21];case 9:return t.type!==M.Close?[3,11]:(this._activeId===t.id&&(this._activeId=void 0),[4,this.otherData.monacoList[t.id]]);case 10:return(E=V.sent())===null||E===void 0||E.dispose(),delete this.otherData.monacoList[t.id],delete this._tabList[t.id],[3,21];case 11:return t.type===M.SetText&&t.text?[4,this.otherData.monacoList[t.id]]:[3,13];case 12:return(O=V.sent())===null||O===void 0||O.setValue(t.text),[3,21];case 13:return t.type!==M.Change?[3,15]:[4,this.otherData.monacoList[t.id]];case 14:return R=V.sent(),R||console.error(t),this.applyOperation(R,ht.fromJSON(t.operation)),[3,21];case 15:return t.type!==M.Focus?[3,16]:(this._activeId=t.id,[3,21]);case 16:return o?[3,21]:t.type!==M.Cursor?[3,21]:(B=t.cursor,U=B[0],G=B[1],Y=B[2],k=B[3],[4,this.otherData.monacoList[t.id]]);case 17:return(I=V.sent())===null||I===void 0||I.setSelection(new at.Selection(U,G,Y,k)),this.isLockCursor?[4,this.otherData.monacoList[t.id]]:[3,19];case 18:(b=V.sent())===null||b===void 0||b.focus(),V.label=19;case 19:return this.isLockView?[4,this.otherData.monacoList[t.id]]:[3,21];case 20:(P=V.sent())===null||P===void 0||P.revealPositionInCenter({lineNumber:Y,column:k}),V.label=21;case 21:return(T=this.exportEvent)===null||T===void 0||T.call(this,t),[2]}})})},f.prototype.inverse=function(t,o){var i,d,v,E,O,I,b,P;return o===void 0&&(o=!1),H(this,void 0,void 0,function(){var T,A,F,h,a,l,g,S,y,m,p,D=this;return J(this,function(R){switch(R.label){case 0:return t.type===M.Init&&t.initData?(T=t.initData,A=T.id,F=T.name,h=T.fileList,a=Qt(T,["id","name","fileList"]),A&&(this._id=A),F&&(this._name=F),h!=null&&h.length&&(this._fileList=Ot([],h,!0)),this._other=a,[3,16]):[3,1];case 1:return t.type!==M.ChangeFileList?[3,2]:((i=t.fileListChange.add)===null||i===void 0||i.forEach(function(B){D._fileList=D._fileList.filter(function(U){return U.id!==B.id})}),(d=t.fileListChange.del)===null||d===void 0||d.forEach(function(B){D.otherData.fileListBin[B]&&(D._fileList.push(D.otherData.fileListBin[B]),delete D.otherData.fileListBin[B])}),[3,16]);case 2:return t.type!==M.Open?[3,4]:(this._activeId===t.id&&(this._activeId=void 0),delete this._tabList[t.id],[4,this.otherData.monacoList[t.id]]);case 3:return(v=R.sent())===null||v===void 0||v.dispose(),delete this.otherData.monacoList[t.id],[3,16];case 4:return t.type!==M.Close?[3,6]:(this._tabList[t.id]={id:t.id,lang:t.lang},this._activeId=t.id,[4,this.openEditor(t.id,t.text,t.lang)]);case 5:return R.sent(),[3,16];case 6:return t.type===M.SetText&&t.text?[4,this.otherData.monacoList[t.id]]:[3,8];case 7:return(E=R.sent())===null||E===void 0||E.setValue(t.text),[3,16];case 8:return t.type!==M.Change?[3,10]:[4,this.otherData.monacoList[t.id]];case 9:return l=R.sent(),this.applyOperation(l,ht.fromJSON(t.inverse)),[3,16];case 10:return t.type!==M.Blur?[3,11]:(this._activeId=t.id,[3,16]);case 11:return o?[3,16]:t.type!==M.Cursor?[3,16]:(g=t.cursor,S=g[0],y=g[1],m=g[2],p=g[3],[4,this.otherData.monacoList[t.id]]);case 12:return(O=R.sent())===null||O===void 0||O.setSelection(new at.Selection(S,y,m,p)),this.isLockCursor?[4,this.otherData.monacoList[t.id]]:[3,14];case 13:(I=R.sent())===null||I===void 0||I.focus(),R.label=14;case 14:return this.isLockView?[4,this.otherData.monacoList[t.id]]:[3,16];case 15:(b=R.sent())===null||b===void 0||b.revealPositionInCenter({lineNumber:m,column:p}),R.label=16;case 16:return(P=this.exportEvent)===null||P===void 0||P.call(this,t,!0),[2]}})})},f.prototype.prev=function(){var t,o;return H(this,void 0,void 0,function(){var i;return J(this,function(d){switch(d.label){case 0:return this._loadStatus?(this._pollStatus&&this.pollAutoPlay&&(this.pollAutoPlay=!1),this._frame<=0?(this._frame=0,[2]):(this._frame--,i=this._events[this._frame],this._currentTime=(((o=(t=this._events)===null||t===void 0?void 0:t[this._frame-1])===null||o===void 0?void 0:o.time)||this.firstTimestamp)-this.firstTimestamp,[4,this.inverse(i)])):[2];case 1:return d.sent(),[2]}})})},f.prototype.next=function(){var t;return H(this,void 0,void 0,function(){var o,i;return J(this,function(d){switch(d.label){case 0:return this._loadStatus?this._frame>this._events.length-1?(this._currentTime=this.totalTime,[2,-1]):(o=this._events[this._frame],this._currentTime=o.time-this.firstTimestamp,[4,this.operation(o)]):[2,-1];case 1:return d.sent(),i=(t=this._events)===null||t===void 0?void 0:t[this._frame+1],i?(this._frame++,[2,i.time-o.time]):(this._frame++,this._currentTime=this.totalTime,this._playStatus=!1,[2,-1])}})})},f.prototype.sleep=function(t){var o=this;return new Promise(function(i){t=t/o.speed;var d=50;clearInterval(o.playIntervalTimer),o.playIntervalTimer=setInterval(function(){if(o._currentTime+=d*o.speed,!o.pollStatus&&o._currentTime>=o.totalTime&&o.pause(),!o._playStatus)return clearTimeout(o.playTimeoutTimer),clearInterval(o.playIntervalTimer),i(!1)},d),clearTimeout(o.playTimeoutTimer),o.playTimeoutTimer=setTimeout(function(){clearInterval(o.playIntervalTimer),i(!0)},t)})},f.prototype.play=function(){var t=this;if(!(!this._loadStatus||this._playStatus)){this._playStatus=!0;var o=function(d){return H(t,void 0,void 0,function(){var v,E,O;return J(this,function(I){switch(I.label){case 0:return this._playStatus?[4,this.sleep(d)]:[2];case 1:return v=I.sent(),v?(O=this.getDelayTime,[4,this.next()]):[2];case 2:return E=O.apply(this,[I.sent()]),E===-1?(this._playStatus=!1,this._pollStatus&&(this.pollAutoPlay=!0),[2]):(o(E),[2])}})})},i=this.getDelayTime(this.getNextFrameTimeDiff());o(i)}},f.prototype.pause=function(){this._playStatus=!1,this._pollStatus&&(this.pollAutoPlay=!1)},f.prototype.toggle=function(){this._playStatus?this.pause():this.play()},f.prototype.jumpToFrame=function(t,o){return H(this,void 0,void 0,function(){var i,d,v,I,E,I,O,I,b;return J(this,function(P){switch(P.label){case 0:return this._loadStatus?t>=0&&t<=this._events.length?t!==0?[3,2]:[4,this.operation({type:M.Init,time:0,order:0})]:(console.warn("\u65E0\u6548\u7684\u5173\u952E\u5E27"),[2]):[2];case 1:return P.sent(),this._frame=0,this._currentTime=0,[2];case 2:if(t===this._frame)return o&&(this._currentTime=o),[2];for(i=this._playStatus,this.pause(),this._frame>t?(d=t,v=this._frame):(d=this._frame,v=t),I=d;I<v;I++)if(this._events[I].type===M.Init){for(this._frame=0,E=t-1;E<=0;E--){this._events[E].type===M.Init&&(this._frame=E);break}break}if(!(this._frame>t))return[3,7];I=this._frame-1,P.label=3;case 3:return I>=t?(O=this._events[I],[4,this.inverse(O,!0)]):[3,6];case 4:P.sent(),P.label=5;case 5:return I--,[3,3];case 6:return[3,11];case 7:I=this._frame,P.label=8;case 8:return I<t?(b=this._events[I],[4,this.operation(b,!0)]):[3,11];case 9:P.sent(),P.label=10;case 10:return I++,[3,8];case 11:return this._frame=t,o?this._currentTime=o:t===0?this._currentTime=0:t>=this._events.length?this._currentTime=this.totalTime:this._currentTime=this._events[t-1].time-this.firstTimestamp,i&&this.play(),[2]}})})},f.prototype.jumpToTime=function(t){return H(this,void 0,void 0,function(){var o,i=this;return J(this,function(d){switch(d.label){case 0:if(!this._loadStatus)return[2];if(t=Math.round(t),o=0,t<=0)t=0,o=0;else if(t>=this.totalTime)t=this.totalTime,o=this._events.length;else if(o=this._events.findIndex(function(v){return v.time-i.firstTimestamp>=t}),o===-1)return console.warn("\u6CA1\u6709\u627E\u5230\u63A5\u8FD1\u7684\u5173\u952E\u5E27"),[2];return[4,this.jumpToFrame(o,t)];case 1:return d.sent(),[2]}})})},f.prototype.jumpToStart=function(){return H(this,void 0,void 0,function(){return J(this,function(t){switch(t.label){case 0:return[4,this.jumpToFrame(0)];case 1:return t.sent(),[2]}})})},f.prototype.jumpToEnd=function(){return H(this,void 0,void 0,function(){return J(this,function(t){switch(t.label){case 0:return[4,this.jumpToFrame(this._events.length)];case 1:return t.sent(),[2]}})})},f.prototype.createPoll=function(t){this._pollStatus||typeof t=="function"&&(this._pollStatus=!0,this.pullMoreCallback=t,this.pollTask())},f.prototype.closePoll=function(){this._pollStatus=!1,this.pollAutoPlay=!1,this.pullMoreCallback=null,clearTimeout(this.pollTimeoutTimer)},f.prototype.pullMore=function(){var t;return H(this,void 0,void 0,function(){var o,i;return J(this,function(d){switch(d.label){case 0:return this._pollStatus?(o=(t=this.lastEvent)===null||t===void 0?void 0:t.order,Number.isInteger(o)?[4,this.pullMoreCallback(o)]:[2,Promise.reject("\u6700\u540E\u7684\u4E8B\u4EF6order\u4E0D\u662F\u4E00\u4E2A\u6570\u503C")]):[2,Promise.reject("\u975E\u8F6E\u8BE2\u6A21\u5F0F")];case 1:return i=d.sent(),(i==null?void 0:i.length)>0&&this.push(i),[2]}})})},f.prototype.pollTask=function(){var t=this;clearTimeout(this.pollTimeoutTimer),this.pollTimeoutTimer=setTimeout(function(){return H(t,void 0,void 0,function(){return J(this,function(o){switch(o.label){case 0:return[4,this.pullMore()];case 1:return o.sent(),this._pollStatus&&this.pollTask(),[2]}})})},this.pollInterval)},f.prototype.dispose=function(){this.reset()},f.prototype.applyOperation=function(t,o){if(!o.isNoop()){var i=t==null?void 0:t.getModel();if(!i){console.error("editor null");return}var d=this._transformOpsIntoMonacoChanges(o.entries(),i);d.length&&this._applyChangesToMonaco(t,d)}},f.prototype._applyChangesToMonaco=function(t,o){if(!!t){var i=t.getOption(at.editor.EditorOption.readOnly);i&&t.updateOptions({readOnly:!1}),this._applyEdits(t,o),i&&t.updateOptions({readOnly:i})}},f.prototype._applyEdits=function(t,o){var i=t==null?void 0:t.getModel();!i||i.applyEdits(o)},f.prototype._transformOpsIntoMonacoChanges=function(t,o){o.setEOL(0);for(var i=0,d=[],v;!(v=t.next()).done;){var E=v.value,O=E[1];switch(!0){case O.isRetain():i+=O.characterCount();break;case O.isInsert():{var I=o.getPositionAt(i);d.push({range:new at.Range(I.lineNumber,I.column,I.lineNumber,I.column),text:O.textContent(),forceMoveMarkers:!0});break}case O.isDelete():{var b=o.getPositionAt(i),P=o.getPositionAt(i+O.characterCount());d.push({range:new at.Range(b.lineNumber,b.column,P.lineNumber,P.column),text:"",forceMoveMarkers:!0}),i+=O.characterCount()}}}return d},f}();export{cr as M,hr as P};
