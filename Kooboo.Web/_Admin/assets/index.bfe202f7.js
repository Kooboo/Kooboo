var x=(C,u,i)=>new Promise((p,k)=>{var _=m=>{try{b(i.next(m))}catch(d){k(d)}},v=m=>{try{b(i.throw(m))}catch(d){k(d)}},b=m=>m.done?p(m.value):Promise.resolve(m.value).then(_,v);b((i=i.apply(C,u)).next())});import{_ as Z}from"./tooltip.66155ff7.js";import{_ as ee}from"./k-table.b1a54b80.js";import{g as j,o as L,w as oe}from"./i18n.a87944a4.js";import{a as te}from"./index.d2657986.js";import{b as ae,u as q}from"./main.9fdfea92.js";import{b as le,r as ne,d as se,a as ie,c as re,g as me,h as ue,j as de,v as pe,k as ce}from"./validate.bb56f9e3.js";import{_ as fe}from"./index.f0d5f031.js";import{u as O}from"./binding.1cf04949.js";import{_ as _e}from"./plugin-vue_export-helper.21dcd24c.js";import{E as ve}from"./index.6f16842c.js";import{E as be,a as ge}from"./index.f15f695e.js";import{E as ye,a as ke}from"./index.9fd79879.js";import{E as De}from"./index.178b9e08.js";import{E as Se,a as we,c as Ee}from"./index.7c862087.js";import{E as z}from"./windi.6360286d.js";import{E as G}from"./index.d96452a6.js";import{E as Ve}from"./index.c003dfa1.js";import{d as M,g as S,i as F,o as r,j as f,w as n,b as s,f as g,u as t,a as w,b7 as U,aI as P,t as V,F as h,k as y,n as he,b8 as xe,e as Be}from"./url.4cb47a7a.js";import{B as Ne}from"./breadcrumb.f4d80c95.js";import{b as Ue}from"./confirm.b60b5d2f.js";import{E as Ce}from"./index.361e2245.js";import{E as Te}from"./index.b38edc72.js";import{E as $e}from"./index.6918f0a5.js";import"./sortable.esm.a99254e8.js";import"./icon-button.74ccc970.js";import"./index.4f90a917.js";import"./index.4d568055.js";import"./index.c6da2706.js";import"./isEqual.4cab74e3.js";import"./_baseIsEqual.dc9e64c4.js";import"./error.7e8331f1.js";import"./index.42922617.js";import"./index.7b8c5aef.js";import"./event.776e7e11.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";import"./replace-all.56d2c1f7.js";import"./index.d24a40b9.js";import"./index.f23f1e38.js";import"./index.a24f458a.js";import"./index.1fd72ea8.js";import"./index.abe211fa.js";import"./style.c350d462.js";import"./toNumber.47eea968.js";import"./isNil.98bb3b88.js";import"./index.e3f90979.js";import"./event.53b2ad83.js";import"./_baseClone.b8903935.js";import"./index.fd96ea36.js";import"./scroll.16983984.js";import"./debounce.4e0c106e.js";import"./index.66319a92.js";import"./validator.b5df2420.js";import"./focus-trap.50a00b7f.js";import"./index.c10802d9.js";import"./refs.3132cbdb.js";/* empty css                                                               */import"./plugin-vue_export-helper.41ffa612.js";import"./logo-transparent.1566007e.js";import"./index.f2c1b903.js";import"./aria.75ec5909.js";const Re={class:"p-24 pl-32"},Ie={class:"flex items-center space-x-8"},Ae=M({props:{modelValue:{type:Boolean}},emits:["update:modelValue","reload"],setup(C,{emit:u}){const{t:i}=j(),p=[{key:"domain",value:i("common.domain")},{key:"Port",value:i("common.port")}],k=ae(),_=S(!0),v=S(p[0].key),b=S(),m=S(),d=q(),T=O(),D=S(!1);te().then(c=>{var o;b.value=c,l.value.rootDomain=(o=c[0])==null?void 0:o.domainName});const l=S({subDomain:"",rootDomain:"",port:81,defaultBinding:!1,redirect:"",culture:"",sudDomainUseDash:!1}),$={subDomain:[le,ne(1,63),se(l.value)],rootDomain:ie(i("common.rootDomainRequiredTips")),port:[re(),me()]},B=()=>x(this,null,function*(){yield m.value.validate(),yield ue(l.value),_.value=!1,d.loadSite(),u("reload")});F(()=>v.value,c=>{l.value.defaultBinding=c===p[1].key}),F(()=>l.value.rootDomain,()=>{var c,o,a;l.value.sudDomainUseDash=(a=(o=(c=b.value)==null?void 0:c.find(N=>N.domainName==l.value.rootDomain))==null?void 0:o.sudDomainUseDash)!=null?a:!1});const R=c=>{c.target.blur()};return(c,o)=>{const a=be,N=ge,E=ye,H=De,I=Se,A=we,J=ve,Q=z,W=G,X=ke,Y=Ve;return r(),f(Y,{"model-value":_.value,"custom-class":"el-dialog--zero-padding",width:"724px","close-on-click-modal":!1,title:t(i)("common.newBinding"),onClosed:o[9]||(o[9]=e=>u("update:modelValue",!1))},{footer:n(()=>[s(fe,{onConfirm:B,onCancel:o[8]||(o[8]=e=>_.value=!1)})]),default:n(()=>[g("div",Re,[t(k).header?(r(),f(X,{key:0,ref_key:"form",ref:m,model:l.value,rules:t($),onKeydown:L(B,["enter"]),onSubmit:o[7]||(o[7]=oe(()=>{},["prevent"]))},{default:n(()=>[t(k).header.isOnlineServer?y("",!0):(r(),f(E,{key:0,label:t(i)("common.bindingTo"),"label-width":"100px"},{default:n(()=>[s(N,{modelValue:v.value,"onUpdate:modelValue":o[0]||(o[0]=e=>v.value=e),class:"el-radio-group--rounded"},{default:n(()=>[(r(),w(h,null,U(p,e=>s(a,{key:e.key,label:e.key,"data-cy":e.key},{default:n(()=>[P(V(e.value),1)]),_:2},1032,["label","data-cy"])),64))]),_:1},8,["modelValue"])]),_:1},8,["label"])),g("div",Ie,[v.value===p[0].key?(r(),f(E,{key:0,prop:"subDomain",label:t(i)("common.domain"),"label-width":"100px"},{default:n(()=>[s(H,{modelValue:l.value.subDomain,"onUpdate:modelValue":o[1]||(o[1]=e=>l.value.subDomain=e),"data-cy":"subdomain"},null,8,["modelValue"])]),_:1},8,["label"])):y("",!0),v.value===p[0].key?(r(),f(E,{key:1,prop:"rootDomain"},{default:n(()=>[s(A,{modelValue:l.value.rootDomain,"onUpdate:modelValue":o[2]||(o[2]=e=>l.value.rootDomain=e),class:"w-300px"},{default:n(()=>[(r(!0),w(h,null,U(b.value,e=>(r(),f(I,{key:e.domainName,label:(e.sudDomainUseDash?"-":".")+e.domainName,value:e.domainName,"data-cy":"root-domain-opt"},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):y("",!0)]),v.value===p[1].key?(r(),f(E,{key:1,prop:"port",label:t(i)("common.port"),"label-width":"100px"},{default:n(()=>[s(J,{modelValue:l.value.port,"onUpdate:modelValue":o[3]||(o[3]=e=>l.value.port=e),onKeydown:L(R,["enter"])},null,8,["modelValue","onKeydown"])]),_:1},8,["label"])):y("",!0),s(W,{placement:"top",content:D.value?t(i)("common.hideAdvanceSettings"):t(i)("common.showAdvanceSettings")},{default:n(()=>[g("div",{class:"flex items-center justify-center h-40px cursor-pointer bg-card dark:bg-444 hover:bg-[#eff6ff] dark:hover:bg-444","data-cy":"show-advance-settings",onClick:o[4]||(o[4]=e=>D.value=!D.value)},[s(Q,{class:he(["iconfont icon-pull-down text-s leading-none cursor-pointer transform origin-center transition duration-200 dark:text-fff/86",D.value?"rotate-180":"rotate-0"])},null,8,["class"])])]),_:1},8,["content"]),D.value?(r(),w(h,{key:2},[s(E,{class:"mt-16",label:t(i)("common.redirectTo"),"label-width":"100px"},{default:n(()=>[s(A,{modelValue:l.value.redirect,"onUpdate:modelValue":o[5]||(o[5]=e=>l.value.redirect=e),class:"w-full",clearable:""},{default:n(()=>[(r(!0),w(h,null,U(t(T).bindings,e=>(r(),f(I,{key:e.id,value:e.fullName,label:e.fullName},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),s(E,{label:t(i)("common.culture"),"label-width":"100px"},{default:n(()=>[s(A,{modelValue:l.value.culture,"onUpdate:modelValue":o[6]||(o[6]=e=>l.value.culture=e),class:"w-full",clearable:""},{default:n(()=>[(r(!0),w(h,null,U(t(d).site.culture,(e,K)=>(r(),f(I,{key:K,value:K,label:e},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])],64)):y("",!0)]),_:1},8,["model","rules","onKeydown"])):y("",!0)])]),_:1},8,["model-value","title"])}}});var Pe=_e(Ae,[["__scopeId","data-v-1cac8c62"]]);const Ke={class:"p-24"},Le={class:"flex items-center py-24 space-x-16"},Fe={class:"flex items-center"},je={"data-cy":"domain"},qe={key:0},Yo=M({setup(C){const{t:u}=j(),i=S(!1),p=q(),k=O(),_=()=>x(this,null,function*(){k.loadBindings()}),v=m=>x(this,null,function*(){yield Ue(m.length),yield de(m.map(d=>d.id)),p.loadSite(),_()}),b=m=>x(this,null,function*(){try{yield pe({rootDomain:m.fullName}),yield ce({rootDomain:m.fullName})}catch(d){}_()});return _(),(m,d)=>{const T=z,D=Ce,l=Te,$=$e,B=G,R=Z,c=Ee,o=xe("hasPermission");return r(),w(h,null,[g("div",Ke,[s(Ne,{name:t(u)("common.domains")},null,8,["name"]),g("div",Le,[Be((r(),f(D,{round:"","data-cy":"new-binding",onClick:d[0]||(d[0]=a=>i.value=!0)},{default:n(()=>[g("div",Fe,[s(T,{class:"mr-16 iconfont icon-a-addto"}),P(" "+V(t(u)("common.newBinding")),1)])]),_:1})),[[o,{feature:"domain",action:"edit"}]])]),s(t(ee),{data:t(k).bindings,"show-check":"",permission:{feature:"domain",action:"delete"},onDelete:v},{default:n(()=>[s(l,{label:t(u)("common.domainOrPort")},{default:n(({row:a})=>[g("span",je,V(a.defaultPortBinding?a.port:a.fullName),1)]),_:1},8,["label"]),s(l,{label:t(u)("common.redirectTo")},{default:n(({row:a})=>[g("span",null,V(a.redirect),1)]),_:1},8,["label"]),s(l,{label:t(u)("common.culture")},{default:n(({row:a})=>[g("span",null,V(a.culture),1)]),_:1},8,["label"]),s(l,{label:t(u)("common.SSLEnabled")},{default:n(({row:a})=>[a.defaultPortBinding?y("",!0):(r(),w("div",qe,[s(B,{class:"box-item",effect:"dark",content:a.enableSsl?"":t(u)("common.enableSSL"),disabled:a.enableSsl,placement:"top"},{default:n(()=>[s($,{"model-value":a.enableSsl,disabled:a.enableSsl||!t(p).hasAccess("domain","edit"),title:t(p).hasAccess("domain","edit")?"":t(u)("common.noPermission"),"data-cy":"ssl-enabled","onUpdate:modelValue":N=>b(a)},null,8,["model-value","disabled","title","onUpdate:modelValue"])]),_:2},1032,["content","disabled"]),a.sslError?(r(),f(c,{key:0,round:"",type:"danger",class:"ml-4"},{default:n(()=>[P(V(t(u)("common.failed"))+" ",1),s(R,{tip:a.sslError,"custom-class":"ml-4"},null,8,["tip"])]),_:2},1024)):y("",!0)]))]),_:1},8,["label"])]),_:1},8,["data"])]),i.value?(r(),f(Pe,{key:0,modelValue:i.value,"onUpdate:modelValue":d[1]||(d[1]=a=>i.value=a),onReload:_},null,8,["modelValue"])):y("",!0)],64)}}});export{Yo as default};
