var Q=(e,V,o)=>new Promise((d,f)=>{var s=u=>{try{k(o.next(u))}catch(m){f(m)}},l=u=>{try{k(o.throw(u))}catch(m){f(m)}},k=u=>u.done?d(u.value):Promise.resolve(u.value).then(s,l);k((o=o.apply(e,V)).next())});import{_ as ve}from"./icon-button.74ccc970.js";import{_ as ye}from"./tooltip.66155ff7.js";import{g as ae,u as ne}from"./main.9fdfea92.js";import{t as Z}from"./commerce.f69dd9fe.js";import{v as Ve,g as X}from"./i18n.a87944a4.js";import{E as ue}from"./index.178b9e08.js";import{E as Y,a as ge}from"./index.9fd79879.js";import{d as _,u as r,o as t,a as w,b7 as B,e as be,j as c,w as b,r as ee,F as h,g as U,i as ke,f as S,t as D,b as x,k as F,c as de,h as ie,aI as W,H as $e,n as we,m as xe,aA as Ce,A as Ee}from"./url.4cb47a7a.js";import{a as he,b as Ue,c as Se}from"./index.562b5616.js";import{_ as Ie}from"./index.f0ea490f.js";import{_ as Ne}from"./index.0e5d639d.js";import{S as Fe}from"./search-input.2a27ef56.js";import{_ as Me}from"./k-table.b1a54b80.js";import{_ as se}from"./index.f0d5f031.js";import{u as Te}from"./use-date.f1258183.js";import{u as Be}from"./content-effect.8201478b.js";import{E as De}from"./edit-content.0655e1f8.js";import{E as me}from"./index.c003dfa1.js";import{_ as Re}from"./index.85105f22.js";import{e as P}from"./guid.c1a40312.js";import{E as re}from"./windi.6360286d.js";import{E as Le}from"./index.361e2245.js";import{E as ce,a as fe}from"./index.7c862087.js";import{E as _e}from"./index.b38edc72.js";import{b as Ae}from"./textContent.09908244.js";import{d as Oe}from"./image-cover.b0b3d25c.js";import{g as Pe}from"./string.955a924b.js";import{E as ze}from"./index.fd96ea36.js";import{_ as je}from"./key-value-editor.7ab17885.js";import{_ as Ge}from"./list-editor.97a4c003.js";import{E as Je}from"./index.f43a3c1f.js";import{E as qe,a as He}from"./index.42922617.js";import{b as Ke,a as Qe}from"./index.f15f695e.js";import{E as We}from"./index.6918f0a5.js";import{E as Xe}from"./index.6f16842c.js";import{f as le,g as oe}from"./custom-field.e7199f85.js";const Ye=_({props:{defaultModel:null,multilingualModel:null,label:null,rules:null,defaultProp:null,multilingualProp:null},emits:["update:default-model"],setup(e,{emit:V}){const o=e,d=ae();V("update:default-model",k());function f(u){V("update:default-model",u),o.multilingualModel[d.default]=u}function s(u,m){var p=u==d.default;p&&V("update:default-model",m),o.multilingualModel[u]=m}function l(u){var C;var m=o.multilingualModel,p=u==d.default;return(C=m[u])!=null?C:p?o.defaultModel:void 0}function k(){if(o.defaultModel!=null)return o.defaultModel;var u=o.multilingualModel;return u[d.default]}return(u,m)=>{const p=Y;return r(d).visible?(t(!0),w(h,{key:0},B(r(d).cultures,(C,$)=>be((t(),c(p,{key:$,label:r(d).appendLangText(e.label,$),prop:`${e.multilingualProp}.${$}`,rules:e.rules},{default:b(()=>[ee(u.$slots,"default",{value:l($),onchange:E=>s($,E)})]),_:2},1032,["label","prop","rules"])),[[Ve,r(d).selected.includes($)]])),128)):(t(),c(p,{key:1,label:e.label,prop:e.defaultProp,rules:e.rules},{default:b(()=>[ee(u.$slots,"default",{value:k(),onchange:f})]),_:3},8,["label","prop","rules"]))}}}),Ze={class:"inline-flex items-center space-x-4"},el={class:"flex items-center space-x-8 w-full"},ll={class:"text-s text-999"},ol={class:"border-999"},tl={class:"text-orange"},Xl=_({props:{title:null,seoName:null,path:null,label:null},emits:["update:seoName"],setup(e,{emit:V}){const o=e,d=U(o.seoName!=Z(o.title));ne();const{t:f}=X();return ke([()=>o.title,()=>d.value],()=>{d.value||V("update:seoName",Z(o.title))}),(s,l)=>{const k=ye,u=ue,m=ve,p=Y;return t(),c(p,null,{label:b(()=>[S("div",Ze,[S("div",null,D(e.label||r(f)("common.seoName")),1),x(k,{tip:r(f)("common.seoNameTip"),"custom-class":"ml-4"},null,8,["tip"])])]),default:b(()=>[S("div",el,[x(u,{"model-value":o.seoName,"onUpdate:modelValue":l[0]||(l[0]=C=>V("update:seoName",C)),onInput:l[1]||(l[1]=()=>d.value=!0)},null,8,["model-value"]),d.value?(t(),c(m,{key:0,circle:"",class:"text-blue",icon:"icon-Refresh",tip:"Sync from title",onClick:l[2]||(l[2]=()=>d.value=!1)})):F("",!0)]),S("div",ll,[S("span",ol,"https://www.example.com/"+D(o.path)+"/",1),S("span",tl,D(o.seoName),1)])]),_:1})}}}),al={class:"px-32 py-24"},pe=_({props:{folder:null,id:null},emits:["reload","update:model-value"],setup(e,{emit:V}){const{t:o}=X(),d=U(),f=U(!0),s=U();setTimeout(()=>{document.querySelectorAll(".tox-tinymce-aux").forEach(u=>{var m;(m=s.value)==null||m.appendChild(u)})},500);const l=()=>Q(this,null,function*(){const{id:k}=yield d.value.save();f.value=!1,V("reload",k)});return(k,u)=>{const m=me;return t(),w("div",null,[x(m,{modelValue:f.value,"onUpdate:modelValue":u[1]||(u[1]=p=>f.value=p),width:"800px","close-on-click-modal":!1,title:r(o)("common.textContent"),"custom-class":"el-dialog--zero-padding",onClosed:u[2]||(u[2]=p=>V("update:model-value",!1))},{footer:b(()=>[x(se,{onConfirm:l,onCancel:u[0]||(u[0]=p=>f.value=!1)})]),default:b(()=>[S("div",al,[x(De,{id:e.id,ref_key:"form",ref:d,"folder-id":e.folder},null,8,["id","folder-id"])]),S("div",{ref_key:"tinymceAuxNewContainer",ref:s},null,512)]),_:1},8,["modelValue","title"])])}}}),nl={class:"space-x-16 flex items-center pb-24"},ul=S("div",{class:"flex-1"},null,-1),dl=_({props:{modelValue:{type:Boolean},folderId:null,multiple:{type:Boolean},exclude:null},emits:["update:model-value","success"],setup(e,{emit:V}){const o=e,{t:d}=X(),f=U(!0),s=U(),l=U(!1),k=U(),{list:u,columns:m,keywords:p,columnLoaded:C,pagination:$,fetchList:E,searchCategories:M,categoryOptions:v,rawList:R}=Be(o.folderId,!0,o.exclude),T=de(()=>m.value.map(i=>({name:i.name,displayName:i.displayName,controlType:i.controlType,multipleValue:i.multipleValue,attrs:{sortable:"custom","min-width":180}})));ie(()=>Q(this,null,function*(){E(1,10)}));function n(){const i=[];for(const a of s.value.selected){const y=R.value.find(I=>I.id==a.id);y&&i.push(y)}V("success",i),f.value=!1}return(i,a)=>{var j,G,N,L;const y=re,I=Le,A=ce,O=fe,q=Fe,z=_e,H=me;return t(),w(h,null,[x(H,{modelValue:f.value,"onUpdate:modelValue":a[5]||(a[5]=g=>f.value=g),width:"900px","close-on-click-modal":!1,title:r(d)("common.content"),onClosed:a[6]||(a[6]=g=>V("update:model-value",!1))},{footer:b(()=>[x(se,{onConfirm:n,onCancel:a[4]||(a[4]=g=>f.value=!1)})]),default:b(()=>[S("div",nl,[x(I,{round:"",type:"primary",onClick:a[0]||(a[0]=g=>{k.value={id:r(P),folderId:e.folderId},l.value=!0})},{default:b(()=>[x(y,{class:"iconfont icon-a-addto"}),W(" "+D(r(d)("common.add")),1)]),_:1}),ul,(t(!0),w(h,null,B(r(v),g=>{var K;return t(),c(O,{key:g.id,modelValue:r(M)[g.id],"onUpdate:modelValue":J=>r(M)[g.id]=J,clearable:"",multiple:"",placeholder:(K=g.display)!=null?K:g.alias,onChange:a[1]||(a[1]=()=>r(E)(1,10))},{default:b(()=>[(t(!0),w(h,null,B(g.options,J=>(t(),c(A,{key:J.key,label:J.value,value:J.key},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])}),128)),x(q,{modelValue:r(p),"onUpdate:modelValue":a[2]||(a[2]=g=>$e(p)?p.value=g:null),placeholder:r(d)("common.searchContents"),class:"w-238px",clearable:"","data-cy":"search"},null,8,["modelValue","placeholder"])]),r(C)?(t(),c(r(Me),{key:0,ref_key:"table",ref:s,data:r(u),"show-check":"","hide-header":"","is-radio":!e.multiple,pagination:r($),"hide-delete":"",onChange:a[3]||(a[3]=g=>r(E)(g,10))},{default:b(()=>[x(Re,{columns:r(T)},null,8,["columns"]),x(z,{prop:"online",sortable:"custom",label:r(d)("content.online"),width:"120",align:"center"},{default:b(({row:g})=>[S("span",{class:we(g.online?"text-green":"text-999"),"data-cy":"online"},D(g.online?r(d)("common.yes"):r(d)("common.no")),3)]),_:1},8,["label"]),x(z,{label:r(d)("common.lastModified"),width:"180",align:"center",prop:"lastModified",sortable:"custom"},{default:b(({row:g})=>[W(D(r(Te)(g.lastModified)),1)]),_:1},8,["label"])]),_:1},8,["data","is-radio","pagination"])):F("",!0)]),_:1},8,["modelValue","title"]),l.value?(t(),c(pe,{key:0,id:(G=(j=k.value)==null?void 0:j.id)!=null?G:r(P),modelValue:l.value,"onUpdate:modelValue":a[7]||(a[7]=g=>l.value=g),folder:(L=(N=k.value)==null?void 0:N.folderId)!=null?L:r(P),onReload:r(E)},null,8,["id","modelValue","folder","onReload"])):F("",!0)],64)}}}),il={key:0,class:"w-504px"},sl={class:"flex space-x-4"},ml={key:1},rl=["onClick"],cl=_({props:{modelValue:null,contentFolder:null,multiple:{type:Boolean},allowRepetition:{type:Boolean},embedded:{type:Boolean}},emits:["update:model-value"],setup(e,{emit:V}){const o=e,d=U(!1),f=U(!1),s=U(),l=U({columns:[],list:[]});function k(){o.embedded?(s.value={id:P,folderId:o.contentFolder},f.value=!0):d.value=!0}function u(){return Q(this,null,function*(){var a;const i=yield Ae(o.modelValue||[],(a=o.contentFolder)!=null?a:"");l.value=i,V("update:model-value",l.value.list.map(y=>y.id))})}u();const m=de(()=>{const i=[];if(!l.value)return i;for(const a of l.value.columns)a.controlType=="MediaFile"?i.unshift(a):i.push(a);return i});function p(i){let a=[...o.modelValue];if(o.multiple)for(const y of i)l.value.list.find(I=>I.id==y.id)||l.value.list.push(y),a.push(y.id);else a=i.map(y=>y.id),l.value.list=i;V("update:model-value",a)}function C(i){const a=o.modelValue.findIndex(y=>y==i);a>-1&&o.modelValue.splice(a,1),V("update:model-value",o.modelValue)}function $(i){const a=o.modelValue.splice(i.oldIndex,1)[0];o.modelValue.splice(i.newIndex,0,a),V("update:model-value",o.modelValue)}function E(i,a){var I,A;const y=(A=(I=l.value)==null?void 0:I.list)==null?void 0:A.find(O=>O.id==i);return y?Pe(y.textValues,a):""}const M=ne();function v(i){return`url("${i?Ee(M.site.prUrl,i):Oe}")`}function R(i,a){if(a.controlType!=="MediaFile")return[];const y=E(i,a.name);if(!y)return[];if(!a.multipleValue)return[y];try{return JSON.parse(y)}catch(I){return console.warn(["JSON parse error",I,y]),[]}}function T(i){s.value=l.value.list.find(a=>a.id==i),s.value&&(f.value=!0)}function n(i){o.modelValue.findIndex(y=>y==i)==-1&&o.modelValue.push(i),V("update:model-value",o.modelValue),u()}return(i,a)=>{var O,q,z,H,j,G;const y=ze,I=re,A=Ne;return t(),w(h,null,[(q=(O=l.value)==null?void 0:O.columns)!=null&&q.length?(t(),w("div",il,[x(A,{"wrapper-class":"space-y-4 w-full",list:e.modelValue,onAdd:k,onDelete:C,onSort:$},{default:b(({item:N})=>[x(y,null,{default:b(()=>[S("div",sl,[(t(!0),w(h,null,B(r(m),L=>(t(),w(h,{key:L.name},[L.controlType=="MediaFile"?(t(!0),w(h,{key:0},B(R(N,L),(g,K)=>(t(),w("div",{key:K,class:"w-32 h-32 bg-contain bg-center bg-no-repeat rounded-4px overflow-hidden inline-block relative group bg-gray",style:xe({backgroundImage:v(g)})},null,4))),128)):(t(),w("div",ml,D(E(N,L.name)),1))],64))),128))])]),_:2},1024)]),right:b(({item:N})=>[S("a",{class:"cursor-pointer px-4 hover:text-blue","data-cy":"edit",onClick:L=>T(N)},[x(I,{class:"iconfont icon-a-writein"})],8,rl)]),_:1},8,["list"]),(t(),c(Ce,{to:"body"},[d.value?(t(),c(dl,{key:0,modelValue:d.value,"onUpdate:modelValue":a[0]||(a[0]=N=>d.value=N),"folder-id":e.contentFolder,multiple:e.multiple,exclude:e.allowRepetition?[]:e.modelValue,onSuccess:p},null,8,["modelValue","folder-id","multiple","exclude"])):F("",!0)]))])):F("",!0),f.value?(t(),c(pe,{key:1,id:(H=(z=s.value)==null?void 0:z.id)!=null?H:r(P),modelValue:f.value,"onUpdate:modelValue":a[1]||(a[1]=N=>f.value=N),folder:(G=(j=s.value)==null?void 0:j.folderId)!=null?G:r(P),onReload:n},null,8,["id","modelValue","folder"])):F("",!0)],64)}}});const te=_({props:{field:null,modelValue:null},emits:["update:model-value"],setup(e,{emit:V}){const o=e,d=U(!1);if(o.field.multiple&&!Array.isArray(o.modelValue)){var f=[];o.modelValue!==void 0&&f.push(o.modelValue),V("update:model-value",f)}return ie(()=>{d.value=!0}),(s,l)=>{const k=ue,u=ce,m=fe,p=qe,C=He,$=Ke,E=Qe,M=We,v=Se,R=Je,T=Xe;return d.value?(t(),w(h,{key:0},[e.field.type==="TextBox"?(t(),c(k,{key:0,style:{width:"100%"},"model-value":e.modelValue,"onUpdate:modelValue":l[0]||(l[0]=n=>s.$emit("update:model-value",n))},null,8,["model-value"])):e.field.type==="TextArea"?(t(),c(k,{key:1,"model-value":e.modelValue,class:"break-normal",type:"textarea",autosize:{minRows:8,maxRows:15},style:{width:"100%"},"onUpdate:modelValue":l[1]||(l[1]=n=>s.$emit("update:model-value",n))},null,8,["model-value"])):e.field.type==="RichEditor"?(t(),c(Ie,{key:2,"model-value":e.modelValue,min_height:385,"onUpdate:modelValue":l[2]||(l[2]=n=>s.$emit("update:model-value",n))},null,8,["model-value"])):e.field.type==="Selection"?(t(),c(m,{key:3,"model-value":e.modelValue,clearable:"","onUpdate:modelValue":l[3]||(l[3]=n=>s.$emit("update:model-value",n))},{default:b(()=>[(t(!0),w(h,null,B(e.field.selectionOptions,n=>(t(),c(u,{key:n.value,value:n.value,label:n.key},null,8,["value","label"]))),128))]),_:1},8,["model-value"])):e.field.type==="CheckBox"?(t(),c(C,{key:4,"model-value":e.modelValue,"onUpdate:modelValue":l[4]||(l[4]=n=>s.$emit("update:model-value",n))},{default:b(()=>[(t(!0),w(h,null,B(e.field.selectionOptions,n=>(t(),c(p,{key:n.value,size:"large",label:n.value},{default:b(()=>[W(D(n.key),1)]),_:2},1032,["label"]))),128))]),_:1},8,["model-value"])):e.field.type==="RadioBox"?(t(),c(E,{key:5,"model-value":e.modelValue,"onUpdate:modelValue":l[5]||(l[5]=n=>s.$emit("update:model-value",n))},{default:b(()=>[(t(!0),w(h,null,B(e.field.selectionOptions,n=>(t(),c($,{key:n.value,size:"large",label:n.value},{default:b(()=>[W(D(n.key),1)]),_:2},1032,["label"]))),128))]),_:1},8,["model-value"])):e.field.type==="Switch"?(t(),c(M,{key:6,"model-value":e.modelValue,"onUpdate:modelValue":l[6]||(l[6]=n=>s.$emit("update:model-value",n))},null,8,["model-value"])):e.field.type==="DateTime"?(t(),c(v,{key:7,"model-value":e.modelValue,type:"datetime",class:"!w-504px","popper-class":"filed-control-el-date-picker","onUpdate:modelValue":l[7]||(l[7]=n=>s.$emit("update:model-value",n))},null,8,["model-value"])):e.field.type==="ColorPicker"?(t(),c(R,{key:8,"model-value":e.modelValue,"popper-class":"filed-control-el-color-picker","show-alpha":"","onUpdate:modelValue":l[8]||(l[8]=n=>s.$emit("update:model-value",n))},null,8,["model-value"])):e.field.type==="Number"?(t(),c(T,{key:9,"model-value":e.modelValue,"controls-position":"right","onUpdate:modelValue":l[9]||(l[9]=n=>s.$emit("update:model-value",n))},null,8,["model-value"])):e.field.type==="MediaFile"?(t(),c(he,{key:10,"model-value":e.modelValue,multiple:e.field.multiple,validations:e.field.validations,"onUpdate:modelValue":l[10]||(l[10]=n=>s.$emit("update:model-value",n))},null,8,["model-value","multiple","validations"])):e.field.type==="File"?(t(),c(Ue,{key:11,"model-value":e.modelValue,multiple:e.field.multiple,"onUpdate:modelValue":l[11]||(l[11]=n=>s.$emit("update:model-value",n))},null,8,["model-value","multiple"])):e.field.type==="Content"?(t(),c(cl,{key:12,"model-value":e.modelValue||[],"content-folder":e.field.contentFolder,multiple:e.field.multiple,embedded:e.field.embedded,"allow-repetition":e.field.allowRepetition,"onUpdate:modelValue":l[12]||(l[12]=n=>s.$emit("update:model-value",n))},null,8,["model-value","content-folder","multiple","embedded","allow-repetition"])):e.field.type==="KeyValues"?(t(),c(je,{key:13,"model-value":e.modelValue||[],"onUpdate:modelValue":l[13]||(l[13]=n=>s.$emit("update:model-value",n))},null,8,["model-value"])):e.field.type==="ValueList"?(t(),c(Ge,{key:14,"model-value":e.modelValue||[],"onUpdate:modelValue":l[14]||(l[14]=n=>s.$emit("update:model-value",n))},null,8,["model-value"])):F("",!0)],64)):F("",!0)}}}),fl={key:0,class:"bg-fff dark:bg-[#252526] px-24 py-16 rounded-normal"},Yl=_({props:{data:null,customFields:null},setup(e,{expose:V}){const o=e,d=ae(),f=U();function s(m){return m=Object.keys(o.data).find(p=>p.toLowerCase()==m.toLowerCase())||m,o.data[m]||(o.data[m]={}),o.data[m]}function l(m,p){return s(m)[p]}function k(m,p,C){const $=s(m);$[p]=C}function u(m){var E;if((E=le[m.type])==null?void 0:E.multilingual)return d.default;const C=s(m.name),$=Object.keys(C);return!$.length||$.includes(d.default)?d.default:$[0]}return V({form:f}),(m,p)=>{var M;const C=Ye,$=Y,E=ge;return(M=e.customFields)!=null&&M.length?(t(),w("div",fl,[x(E,{ref_key:"form",ref:f,"label-position":"top",model:e.data},{default:b(()=>[(t(!0),w(h,null,B(e.customFields,v=>{var R;return t(),w(h,{key:v.name},[v.editable?(t(),w(h,{key:0},[((R=r(le)[v.type])==null?void 0:R.multilingual)&&v.multilingual?(t(),c(C,{key:0,label:v.displayName||v.name,"multilingual-model":s(v.name),rules:r(oe)(v.validations,v.type),"multilingual-prop":v.name},{default:b(({value:T,onchange:n})=>[x(te,{"model-value":T,field:v,"onUpdate:modelValue":i=>n(i)},null,8,["model-value","field","onUpdate:modelValue"])]),_:2},1032,["label","multilingual-model","rules","multilingual-prop"])):(t(),c($,{key:1,label:v.displayName||v.name,rules:r(oe)(v.validations,v.type),prop:`${v.name}.${u(v)}`},{default:b(()=>[x(te,{"model-value":l(v.name,u(v)),field:v,"onUpdate:modelValue":T=>k(v.name,u(v),T)},null,8,["model-value","field","onUpdate:modelValue"])]),_:2},1032,["label","rules","prop"]))],64)):F("",!0)],64)}),128))]),_:1},8,["model"])])):F("",!0)}}});export{Yl as _,Xl as a,Ye as b};
