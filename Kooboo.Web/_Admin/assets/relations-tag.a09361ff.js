var F=Object.defineProperty,G=Object.defineProperties;var M=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var B=(a,e,t)=>e in a?F(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,E=(a,e)=>{for(var t in e||(e={}))P.call(e,t)&&B(a,t,e[t]);if(N)for(var t of N(e))z.call(e,t)&&B(a,t,e[t]);return a},I=(a,e)=>G(a,M(e));import{_ as A}from"./icon-button.3313e42d.js";import{a as L,u as $}from"./replace-all.7cf5f327.js";import{d as H,u as O}from"./main.ea42d807.js";import{d as j,cd as J,g as b,c as R,o as f,j as k,w as m,b as y,u,f as w,t as x,aF as K,cg as S,a as D,F as T,b6 as Q,aH as W,k as X,az as Y}from"./url.2e6a77c4.js";import{g as U}from"./i18n.48bd28ac.js";import{u as Z,g as ee}from"./page.831d1a45.js";import{E as te,a as ae}from"./index.b494e80e.js";import{E as oe}from"./index.a439b087.js";import{E as ne}from"./index.c4e9b529.js";import{c as le}from"./index.0d2684bf.js";const se=(a,e,t)=>H.get(L("Relation/ShowBy"),{id:a,by:e,type:t},{hiddenLoading:!0}),re=["onClick"],ie=["onClick"],ue=j({props:{modelValue:{type:Boolean},id:null,by:null,type:null,displayName:null},emits:["update:modelValue"],setup(a){const e=a,{onPreview:t}=Z(),{t:s}=U(),g=O(),c=J(),h=b([]),_=b(!0),d=R(()=>e.displayName?e.displayName:e.by);se(e.id,e.by,e.type).then(o=>{h.value=o});const r=o=>{var n,p;let l=d.value+"-edit";if(e.by==="textContent"&&g.hasAccess("content","view")){let v=c.resolve($({name:"content",query:{id:o.objectId,folder:(n=o.extensions)==null?void 0:n.folderId}}));S(v.href)}else if(g.hasAccess(d.value==="page"?"pages":d.value,"view")){if(((p=o.extensions)==null?void 0:p.type)==="Designer"){const C=ee(o.objectId,o.extensions.layout);S(c.resolve(C).href);return}const v=c.resolve($({name:l,query:{id:o.objectId}}));S(v.href)}};return(o,l)=>{const n=te,p=A,v=ae,C=oe,q=ne;return f(),k(q,{modelValue:_.value,"onUpdate:modelValue":l[0]||(l[0]=i=>_.value=i),width:"600px","close-on-click-modal":!1,title:u(s)("common.relation"),onClosed:l[1]||(l[1]=i=>o.$emit("update:modelValue",!1))},{default:m(()=>[y(C,{"max-height":"400px"},{default:m(()=>[y(v,{data:h.value,class:"el-table--gray"},{default:m(()=>[y(n,{label:u(s)("common.name")},{default:m(({row:i})=>[w("a",{class:"cursor-pointer underline","data-cy":"name",onClick:V=>u(t)(i.url)},x(i.name),9,re)]),_:1},8,["label"]),y(n,{label:u(s)("common.remark")},{default:m(({row:i})=>[w("a",{class:"cursor-pointer","data-cy":"remark",onClick:V=>u(t)(i.url)},x(i.remark),9,ie)]),_:1},8,["label"]),y(n,{label:u(s)("common.edit"),width:"80px",align:"right"},K({_:2},[a.by!=="dataMethodSetting"&&a.by!=="resourceGroup"&&a.by!=="route"?{name:"default",fn:m(({row:i})=>[y(p,{permission:{feature:u(d)==="page"?"pages":u(d),action:"view"},icon:"icon-a-writein",class:"hover:text-blue",tip:u(s)("common.edit"),"data-cy":"edit",onClick:V=>r(i)},null,8,["permission","tip","onClick"])])}:{name:"default",fn:m(()=>[w("div",null,"-")])}]),1032,["label"])]),_:1},8,["data"])]),_:1})]),_:1},8,["modelValue","title"])}}}),ce={class:"flex flex-wrap"},we=j({props:{relations:null,id:null,type:null},setup(a){const e=a,{t}=U(),s=b(!1),g=b("menu"),c=b(),h=[{name:"menu",display:t("common.menu"),type:"warning"},{name:"view",display:t("common.view"),type:"success"},{name:"layout",display:t("common.layout"),type:""},{name:"page",display:t("common.page"),type:"success"},{name:"htmlBlock",display:t("common.htmlBlock"),type:"danger"},{name:"dataMethodSetting",display:t("common.dataMethodSetting"),type:""},{name:"resourceGroup",display:t("common.resourceGroup"),type:"warning"},{name:"route",display:t("common.route"),type:"warning"}],_=R(()=>{const r=[];if(!!e.relations){for(const o of Object.keys(e.relations)){const l=e.relations[o],n=h.find(p=>p.name===o);n?r.push(I(E({},n),{value:l})):r.push({name:o,display:o,type:"",value:l})}return r}}),d=r=>{c.value="",r==="textContent"?c.value="content":r==="cmsCssRule"&&(c.value="style"),g.value=r,s.value=!0};return(r,o)=>{const l=le;return f(),D(T,null,[w("div",ce,[(f(!0),D(T,null,Q(u(_),n=>(f(),k(l,{key:n.name,size:"small",class:"rounded-full cursor-pointer my-4 mr-4",type:n.type,"data-cy":"relation-tag",onClick:p=>d(n.name)},{default:m(()=>[W(x(n.value)+" "+x(n.display),1)]),_:2},1032,["type","onClick"]))),128))]),(f(),k(Y,{to:"body"},[s.value?(f(),k(ue,{key:0,id:a.id,modelValue:s.value,"onUpdate:modelValue":o[0]||(o[0]=n=>s.value=n),by:g.value,"display-name":c.value,type:a.type},null,8,["id","modelValue","by","display-name","type"])):X("",!0)]))],64)}}});export{we as _};
