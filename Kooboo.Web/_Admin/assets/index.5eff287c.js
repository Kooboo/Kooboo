var j=(E,v,u)=>new Promise((a,n)=>{var f=r=>{try{S(u.next(r))}catch(l){n(l)}},m=r=>{try{S(u.throw(r))}catch(l){n(l)}},S=r=>r.done?a(r.value):Promise.resolve(r.value).then(f,m);S((u=u.apply(E,v)).next())});import{g as R,w as P}from"./i18n.2d8b30eb.js";import{_ as ce}from"./index.026f772c.js";import{B as ve}from"./breadcrumb.79da4f07.js";import{c as fe,r as _e}from"./index.8143a7f0.js";import{l as be,n as ye,o as ge,u as Ve,p as ke,q as xe,s as we}from"./commerce.0424f5f4.js";import{u as Se}from"./email.2058242d.js";import{_ as ae}from"./index.47274d5a.js";import{_ as Z}from"./index.ed88cf90.js";import{a as O,u as Ee,b as $e,w as Ce}from"./validate.348f94d6.js";import{_ as Te,aa as he}from"./dev-mode.e5eea554.js";import{_ as Ue}from"./index.fb11220d.js";import{E as ee,a as oe,c as ne}from"./index.ab4ed870.js";import{E as H,a as G}from"./index.a141884f.js";import{E as Ne}from"./index.4c9af567.js";import{E as se,a as ue}from"./index.0a83bb10.js";import{E as De}from"./index.b3663d55.js";import{E as le}from"./index.bb5499e2.js";import{E as W}from"./index.a4ff385c.js";import{d as A,g,i as K,K as Be,o as d,j as C,w as o,b as e,u as p,a as U,b6 as L,F as B,f as _,aH as q,t as h,k as D}from"./url.8f5ec20c.js";import{E as z}from"./windi.bf752d69.js";import{E as te}from"./index.96970839.js";import{E as qe}from"./index.21d7e739.js";import{E as me}from"./index.745dc8e0.js";import{_ as re}from"./k-table.f75c31cc.js";import{u as ie}from"./use-date.28e9a8a3.js";import{E as de}from"./index.bc06171b.js";import{E as pe}from"./index.ec785feb.js";import{E as je,a as Ae}from"./index.22cf2ea3.js";import{E as Ie}from"./index.c1ec4d8d.js";import"./replace-all.dd6016f2.js";import"./main.d8c6ef59.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";/* empty css                                                               */import"./plugin-vue_export-helper.21dcd24c.js";import"./plugin-vue_export-helper.41ffa612.js";import"./index.593106e3.js";import"./error.7e8331f1.js";import"./classCompletion.a22e38a6.js";import"./userWorker.b3a6730b.js";import"./editor.main.d2800f63.js";import"./guid.c1a40312.js";import"./vuedraggable.umd.8a5464a3.js";import"./cloneDeep.b77ba92c.js";import"./_baseClone.29a8cd97.js";import"./_baseIsEqual.2f38f7c3.js";import"./index.37979027.js";import"./index.3d9a337f.js";import"./index.3dc39d21.js";import"./index.832f2769.js";import"./index.b3e4ff8e.js";import"./index.5af167df.js";import"./style.ad574a57.js";import"./toNumber.6efebd6a.js";import"./config.589cc0cd.js";import"./dark.7c26a0d3.js";import"./page.c26fc024.js";import"./index.80a4dc1a.js";import"./index.bf8ed8c6.js";import"./scroll.54c27fbd.js";import"./aria.75ec5909.js";import"./event.53b2ad83.js";import"./focus-trap.3f074800.js";import"./isNil.98bb3b88.js";import"./validator.1bcd6e6a.js";import"./index.0535d5fe.js";import"./index.a595fe6d.js";import"./index.35ae15db.js";import"./dropdown.d7a15792.js";import"./refs.d2253dd4.js";import"./use-copy-text.67d6617b.js";import"./index.68d24a68.js";import"./toggleComment.5b29ca87.js";import"./use-save-tip.ee41ca28.js";import"./confirm.617d359f.js";import"./logo-transparent.1566007e.js";import"./icon-button.e30c79ea.js";import"./index.e87fdc52.js";import"./index.b3d1cf25.js";import"./index.3be79fd5.js";import"./index.5f2a659f.js";import"./index.06224119.js";import"./index.14aabd47.js";import"./alert.8fe5500a.js";import"./index.b4ac73b5.js";import"./media-list.vue_vue_type_style_index_0_scoped_true_lang.a31db113.js";/* empty css                                                          */import"./file.52d8e05a.js";/* empty css                                                          *//* empty css                                                                 */import"./use-file-upload.1cd07d1f.js";/* empty css                                                         */import"./image-editor.vue_vue_type_style_index_0_scoped_true_lang.7c6ede25.js";import"./image-editor.404a4df5.js";import"./main.esm.f3ac04a5.js";import"./index.a330b59f.js";import"./_baseUniq.2c27addc.js";import"./_baseIndexOf.4d7985be.js";import"./event.776e7e11.js";import"./isEqual.c3e9e9f4.js";import"./debounce.730e1961.js";import"./index.b68af8a1.js";import"./index.e3f90979.js";import"./sortable.esm.a99254e8.js";import"./index.14993118.js";import"./dayjs.min.35b12e7a.js";const Le={class:"flex items-center space-x-8 w-full"},Oe={key:0,class:"border border-line rounded-normal p-8"},Re=A({props:{modelValue:{type:Boolean},events:null,model:null},emits:["update:model-value","success"],setup(E,{emit:v}){var b;const u=E,a=g(),{t:n}=R(),f=g(!0),m=g("preview"),S=g(),r=[{key:"preview",value:n("common.preview")},{key:"code",value:n("common.code")}],l=g(JSON.parse(JSON.stringify((b=u.model)!=null?b:{event:"",subjectTemplate:"",bodyTemplate:"",sendToCustomer:!0,sendToAddresses:[]}))),$={event:[O(n("common.eventRequiredTips"))]};function s(){return j(this,null,function*(){yield a.value.validate(),v("success",l.value),f.value=!1})}return K([()=>m.value,()=>l.value.event],()=>j(this,null,function*(){m.value!="preview"||!l.value.event||(yield Be(),S.value=yield be(l.value))}),{immediate:!0}),K(()=>l.value.event,()=>{const t=u.events.find(i=>i.name==l.value.event);t&&(l.value.subjectTemplate=t.mailSubjectTemplate,l.value.bodyTemplate=t.mailBodyTemplate)}),(t,i)=>{const V=ee,w=oe,k=H,c=Ne,T=se,I=ue,N=De,M=ae,X=le,Q=G,Y=W;return d(),C(Y,{modelValue:f.value,"onUpdate:modelValue":i[7]||(i[7]=y=>f.value=y),width:"800px","close-on-click-modal":!1,title:p(n)("common.emailNotifications"),onClosed:i[8]||(i[8]=y=>v("update:model-value",!1))},{footer:o(()=>[e(Z,{onConfirm:s,onCancel:i[6]||(i[6]=y=>f.value=!1)})]),default:o(()=>[e(Q,{ref_key:"form",ref:a,model:l.value,"label-position":"top",rules:$,class:"space-y-12"},{default:o(()=>{var y,F,J;return[e(k,{label:p(n)("common.event"),prop:"event"},{default:o(()=>[e(w,{modelValue:l.value.event,"onUpdate:modelValue":i[0]||(i[0]=x=>l.value.event=x),placeholder:p(n)("common.pleaseSelect"),class:"w-full"},{default:o(()=>[(d(!0),U(B,null,L(E.events,x=>(d(),C(V,{key:x.name,value:x.name,label:x.display},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e(k,{label:p(n)("common.sendTo")},{default:o(()=>[_("div",Le,[e(Ue,{modelValue:l.value.sendToAddresses,"onUpdate:modelValue":i[1]||(i[1]=x=>l.value.sendToAddresses=x),class:"flex-1 w-full","disable-query":"","input-value":l.value.sendToAddresses,"data-cy":"bcc"},null,8,["modelValue","input-value"]),e(c,{modelValue:l.value.sendToCustomer,"onUpdate:modelValue":i[2]||(i[2]=x=>l.value.sendToCustomer=x),class:"flex-shrink-0",label:p(n)("common.customer")},null,8,["modelValue","label"])])]),_:1},8,["label"]),l.value.event?(d(),U(B,{key:0},[e(I,{modelValue:m.value,"onUpdate:modelValue":i[3]||(i[3]=x=>m.value=x),class:"el-radio-group--rounded"},{default:o(()=>[(d(),U(B,null,L(r,x=>e(T,{key:x.key,label:x.key},{default:o(()=>[q(h(x.value),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"]),m.value=="preview"?(d(),U("div",Oe,[_("h1",null,"Subject: "+h((y=S.value)==null?void 0:y.subjectTemplate),1),e(N,{class:"my-12"}),e(M,{class:"h-300px",content:(J=(F=S.value)==null?void 0:F.bodyTemplate)!=null?J:""},null,8,["content"])])):(d(),U(B,{key:1},[e(k,{label:p(n)("common.subject"),prop:"subjectTemplate"},{default:o(()=>[e(X,{modelValue:l.value.subjectTemplate,"onUpdate:modelValue":i[4]||(i[4]=x=>l.value.subjectTemplate=x)},null,8,["modelValue"])]),_:1},8,["label"]),e(k,{label:p(n)("common.content"),prop:"bodyTemplate"},{default:o(()=>[e(Te,{modelValue:l.value.bodyTemplate,"onUpdate:modelValue":i[5]||(i[5]=x=>l.value.bodyTemplate=x),class:"border border-999",language:"html","k-script":""},null,8,["modelValue"])]),_:1},8,["label"])],64))],64)):D("",!0)]}),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),Me={class:"space-y-4 w-full"},Fe={class:"text-666 dark:text-fff/67 flex items-center pl-16 pr-8 w-full border-line dark:border-666 rounded-normal border border-solid ellipsis bg-fff dark:bg-[#333]","data-cy":"added-item"},Je={class:"overflow-hidden leading-40px flex-1 mr-8 ellipsis","data-cy":"text"},Pe={class:"p-4"},We={class:"p-4"},ze=A({props:{items:null,events:null},setup(E){const v=E,u=g(!1),a=g();function n(){a.value=void 0,u.value=!0}function f(r){if(a.value){const l=v.items.indexOf(a.value);v.items.splice(l,1,r)}else v.items.push(r)}function m(r){a.value=r,u.value=!0}function S(r){v.items.splice(r,1)}return(r,l)=>{const $=ne,s=z,b=te;return d(),U("div",Me,[(d(!0),U(B,null,L(E.items,(t,i)=>{var V;return d(),U("div",{key:i},[_("div",Fe,[_("div",Je,h((V=E.events.find(w=>w.name==t.event))==null?void 0:V.description),1),_("div",null,[e($,{round:""},{default:o(()=>{var w;return[q(h((w=E.events.find(k=>k.name==t.event))==null?void 0:w.display),1)]}),_:2},1024)]),_("div",Pe,[e(s,{class:"iconfont icon-a-setup cursor-pointer","data-cy":"edit",onClick:P(w=>m(t),["stop"])},null,8,["onClick"])]),_("div",We,[e(s,{class:"text-orange iconfont icon-delete cursor-pointer",color:"#fab6b6","data-cy":"remove",onClick:P(w=>S(i),["stop"])},null,8,["onClick"])])])])}),128)),e(b,{circle:"","data-cy":"add",onClick:n},{default:o(()=>[e(s,{class:"text-blue iconfont icon-a-addto"})]),_:1}),_("div",null,[u.value?(d(),C(Re,{key:0,modelValue:u.value,"onUpdate:modelValue":l[0]||(l[0]=t=>u.value=t),events:E.events,model:a.value,onSuccess:f},null,8,["modelValue","events","model"])):D("",!0)])])}}}),Ke=A({props:{modelValue:{type:Boolean},model:null},emits:["update:model-value","success"],setup(E,{emit:v}){var l;const u=E,a=g(),{t:n}=R(),f=g(!0),m=g(JSON.parse(JSON.stringify((l=u.model)!=null?l:{server:"",port:"",ssl:!1,userName:"",password:""}))),S={server:[Ee(n("common.urlInvalid")),O(n("common.serverUrlRequiredTips"))],port:[$e()],userName:[O(n("common.inputUsernameTips"))],password:[O(n("common.inputPasswordTips"))]};function r(){return j(this,null,function*(){yield a.value.validate(),v("success",m.value),f.value=!1})}return($,s)=>{const b=le,t=H,i=qe,V=me,w=G,k=W;return d(),C(k,{modelValue:f.value,"onUpdate:modelValue":s[6]||(s[6]=c=>f.value=c),width:"600px","close-on-click-modal":!1,title:`smtp ${p(n)("common.setting")}`,onClosed:s[7]||(s[7]=c=>v("update:model-value",!1))},{footer:o(()=>[e(Z,{onConfirm:r,onCancel:s[5]||(s[5]=c=>f.value=!1)})]),default:o(()=>[e(w,{ref_key:"form",ref:a,model:m.value,"label-position":"top",rules:S,class:"space-y-12"},{default:o(()=>[e(t,{label:p(n)("common.server"),prop:"server"},{default:o(()=>[e(b,{modelValue:m.value.server,"onUpdate:modelValue":s[0]||(s[0]=c=>m.value.server=c),placeholder:"smtp.qq.com"},null,8,["modelValue"])]),_:1},8,["label"]),e(t,{label:p(n)("common.port")},{default:o(()=>[e(i,{modelValue:m.value.port,"onUpdate:modelValue":s[1]||(s[1]=c=>m.value.port=c),modelModifiers:{number:!0},placeholder:"587"},null,8,["modelValue"])]),_:1},8,["label"]),e(t,{label:"ssl"},{default:o(()=>[e(V,{modelValue:m.value.ssl,"onUpdate:modelValue":s[2]||(s[2]=c=>m.value.ssl=c)},null,8,["modelValue"])]),_:1}),e(t,{label:p(n)("common.account"),prop:"userName"},{default:o(()=>[e(b,{modelValue:m.value.userName,"onUpdate:modelValue":s[3]||(s[3]=c=>m.value.userName=c),placeholder:"xxx@qq.com"},null,8,["modelValue"])]),_:1},8,["label"]),e(t,{label:p(n)("common.password"),prop:"password"},{default:o(()=>[e(b,{modelValue:m.value.password,"onUpdate:modelValue":s[4]||(s[4]=c=>m.value.password=c),type:"password"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),He=A({props:{modelValue:{type:Boolean},events:null,model:null},emits:["update:model-value","success"],setup(E,{emit:v}){var l;const u=E,a=g(),{t:n}=R(),f=g(!0),m=g(JSON.parse(JSON.stringify((l=u.model)!=null?l:{event:"",url:""}))),S={url:[Ce(n("common.urlInvalid")),O(n("common.urlRequiredTips"))],event:[O(n("common.eventRequiredTips"))]};function r(){return j(this,null,function*(){yield a.value.validate(),v("success",m.value),f.value=!1})}return($,s)=>{const b=ee,t=oe,i=H,V=le,w=G,k=W;return d(),C(k,{modelValue:f.value,"onUpdate:modelValue":s[3]||(s[3]=c=>f.value=c),width:"600px","close-on-click-modal":!1,title:"Webhook",onClosed:s[4]||(s[4]=c=>v("update:model-value",!1))},{footer:o(()=>[e(Z,{onConfirm:r,onCancel:s[2]||(s[2]=c=>f.value=!1)})]),default:o(()=>[e(w,{ref_key:"form",ref:a,model:m.value,"label-position":"top",rules:S,class:"space-y-12"},{default:o(()=>[e(i,{label:p(n)("common.event"),prop:"event"},{default:o(()=>[e(t,{modelValue:m.value.event,"onUpdate:modelValue":s[0]||(s[0]=c=>m.value.event=c),placeholder:p(n)("common.pleaseSelect"),class:"w-full"},{default:o(()=>[(d(!0),U(B,null,L(E.events,c=>(d(),C(b,{key:c.name,value:c.name,label:c.display},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e(i,{label:"URL",prop:"url"},{default:o(()=>[e(V,{modelValue:m.value.url,"onUpdate:modelValue":s[1]||(s[1]=c=>m.value.url=c)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}}),Ge={class:"space-y-4 w-full"},Xe={class:"text-666 dark:text-fff/67 flex items-center pl-16 pr-8 w-full border-line dark:border-666 rounded-normal border border-solid ellipsis bg-fff dark:bg-[#333]","data-cy":"added-item"},Qe={class:"overflow-hidden leading-40px flex-1 mr-8 ellipsis","data-cy":"text"},Ye={class:"p-4"},Ze={class:"p-4"},eo=A({props:{items:null,events:null},setup(E){const v=E,u=g(!1),a=g();function n(){a.value=void 0,u.value=!0}function f(r){if(a.value){const l=v.items.indexOf(a.value);v.items.splice(l,1,r)}else v.items.push(r)}function m(r){a.value=r,u.value=!0}function S(r){v.items.splice(r,1)}return(r,l)=>{const $=ne,s=z,b=te;return d(),U("div",Ge,[(d(!0),U(B,null,L(E.items,(t,i)=>{var V;return d(),U("div",{key:i},[_("div",Xe,[_("div",Qe,h((V=E.events.find(w=>w.name==t.event))==null?void 0:V.description),1),_("div",null,[e($,{round:""},{default:o(()=>{var w;return[q(h((w=E.events.find(k=>k.name==t.event))==null?void 0:w.display),1)]}),_:2},1024)]),_("div",Ye,[e(s,{class:"iconfont icon-a-setup cursor-pointer","data-cy":"edit",onClick:P(w=>m(t),["stop"])},null,8,["onClick"])]),_("div",Ze,[e(s,{class:"text-orange iconfont icon-delete cursor-pointer",color:"#fab6b6","data-cy":"remove",onClick:P(w=>S(i),["stop"])},null,8,["onClick"])])])])}),128)),e(b,{circle:"","data-cy":"add",onClick:n},{default:o(()=>[e(s,{class:"text-blue iconfont icon-a-addto"})]),_:1}),_("div",null,[u.value?(d(),C(He,{key:0,modelValue:u.value,"onUpdate:modelValue":l[0]||(l[0]=t=>u.value=t),events:E.events,model:a.value,onSuccess:f},null,8,["modelValue","events","model"])):D("",!0)])])}}}),oo=["onClick"],lo=A({props:{modelValue:{type:Boolean}},emits:["update:model-value"],setup(E,{emit:v}){const{t:u}=R(),a=g(!0),n=g(),f=g(!1),m=g(),S=r=>j(this,null,function*(){n.value=yield ye({pagenr:r})});return S(),(r,l)=>{var w;const $=de,s=z,b=pe,t=re,i=W,V=ae;return d(),U(B,null,[e(i,{modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=k=>a.value=k),width:"1000px","close-on-click-modal":!1,title:p(u)("common.log"),onClosed:l[1]||(l[1]=k=>v("update:model-value",!1))},{default:o(()=>{var k,c,T,I;return[n.value?(d(),C(t,{key:0,data:(k=n.value)==null?void 0:k.dataList,pagination:{currentPage:(c=n.value)==null?void 0:c.pageNr,pageCount:(T=n.value)==null?void 0:T.totalPages,pageSize:(I=n.value)==null?void 0:I.pageSize},onChange:S},{default:o(()=>[e($,{label:p(u)("common.email")},{default:o(({row:N})=>[_("span",null,h(N.address),1)]),_:1},8,["label"]),e($,{label:p(u)("common.event"),width:"180"},{default:o(({row:N})=>[_("span",null,h(N.event),1)]),_:1},8,["label"]),e($,{label:p(u)("common.content")},{default:o(({row:N})=>[_("span",{class:"text-blue cursor-pointer",onClick:M=>{m.value=N,f.value=!0}},h(N.subject),9,oo)]),_:1},8,["label"]),e($,{label:p(u)("common.dateTime"),width:"180"},{default:o(({row:N})=>[_("span",null,h(p(ie)(new Date(N.timestamp))),1)]),_:1},8,["label"]),e($,{label:p(u)("common.status"),width:"80",align:"center"},{default:o(({row:N})=>[!N.sent&&N.errorCount?(d(),C(b,{key:0,placement:"top-start",content:N.error},{default:o(()=>[e(s,{class:"iconfont icon-fasongshibai text-orange"})]),_:2},1032,["content"])):D("",!0),N.sent?(d(),C(b,{key:1,placement:"top-start",content:p(u)("common.deliverySuccessful")},{default:o(()=>[e(s,{class:"iconfont icon-fasongchenggong text-green"})]),_:1},8,["content"])):D("",!0)]),_:1},8,["label"])]),_:1},8,["data","pagination"])):D("",!0)]}),_:1},8,["modelValue","title"]),m.value?(d(),C(i,{key:0,modelValue:f.value,"onUpdate:modelValue":l[2]||(l[2]=k=>f.value=k),title:(w=m.value)==null?void 0:w.subject,width:"1200px"},{default:o(()=>{var k;return[e(V,{class:"h-600px",content:(k=m.value)==null?void 0:k.content},null,8,["content"])]}),_:1},8,["modelValue","title"])):D("",!0)],64)}}}),to=["onClick"],ao={class:"max-h-600px overflow-auto"},no=A({props:{modelValue:{type:Boolean}},emits:["update:model-value"],setup(E,{emit:v}){const{t:u}=R(),a=g(!0),n=g(),f=g(!1),m=g(),S=r=>j(this,null,function*(){n.value=yield ge({pagenr:r})});return S(),(r,l)=>{const $=de,s=z,b=pe,t=re,i=W;return d(),U(B,null,[e(i,{modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=V=>a.value=V),width:"1000px","close-on-click-modal":!1,title:p(u)("common.log"),onClosed:l[1]||(l[1]=V=>v("update:model-value",!1))},{default:o(()=>{var V,w,k,c;return[n.value?(d(),C(t,{key:0,data:(V=n.value)==null?void 0:V.dataList,pagination:{currentPage:(w=n.value)==null?void 0:w.pageNr,pageCount:(k=n.value)==null?void 0:k.totalPages,pageSize:(c=n.value)==null?void 0:c.pageSize},onChange:S},{default:o(()=>[e($,{label:"URL"},{default:o(({row:T})=>[_("span",null,h(T.address),1)]),_:1}),e($,{label:p(u)("common.event"),width:"180"},{default:o(({row:T})=>[_("span",null,h(T.event),1)]),_:1},8,["label"]),e($,{label:p(u)("common.content")},{default:o(({row:T})=>[_("span",{class:"text-blue cursor-pointer truncate",onClick:I=>{m.value=T,f.value=!0}},h(T.content),9,to)]),_:1},8,["label"]),e($,{label:p(u)("common.dateTime"),width:"180"},{default:o(({row:T})=>[_("span",null,h(p(ie)(new Date(T.timestamp))),1)]),_:1},8,["label"]),e($,{label:p(u)("common.status"),width:"80",align:"center"},{default:o(({row:T})=>[!T.sent&&T.errorCount?(d(),C(b,{key:0,placement:"top-start",content:T.error},{default:o(()=>[e(s,{class:"iconfont icon-fasongshibai text-orange"})]),_:2},1032,["content"])):D("",!0),T.sent?(d(),C(b,{key:1,placement:"top-start",content:p(u)("common.success")},{default:o(()=>[e(s,{class:"iconfont icon-fasongchenggong text-green"})]),_:1},8,["content"])):D("",!0)]),_:1},8,["label"])]),_:1},8,["data","pagination"])):D("",!0)]}),_:1},8,["modelValue","title"]),m.value?(d(),C(i,{key:0,modelValue:f.value,"onUpdate:modelValue":l[2]||(l[2]=V=>f.value=V),title:p(u)("common.content"),width:"1200px"},{default:o(()=>[_("div",ao,[e(he,{data:JSON.parse(m.value.content)},null,8,["data"])])]),_:1},8,["modelValue","title"])):D("",!0)],64)}}}),so={class:"p-24 pb-150px"},uo={class:"rounded-normal bg-fff dark:bg-[#252526] mt-16 mb-24 py-24 px-56px relative"},mo={class:"max-w-504px"},ro={key:0,class:"flex items-center space-x-8"},io={class:"text-s text-999"},po={class:"text-s text-999"},co={class:"text-s text-999"},vo=q("Sending Log"),fo={key:0,class:"rounded-normal bg-fff dark:bg-[#252526] mt-16 mb-24 py-24 px-56px relative"},_o={class:"max-w-504px"},bo={class:"flex items-center"},yo=_("span",null,"Webhooks",-1),go=q('SHA256Hash(request.body+secret)== request.header["X-Kooboo-Hmac-SHA256"]'),Vo=q("Sending Log"),Vt=A({setup(E){const{t:v}=R(),u=Ve(),a=g(),n=g([]),f=g([]),m=Se(),S=g(!1),r=g(!1),l=g(!1);ke().then(b=>n.value=b),xe().then(b=>f.value=b);const $=[{key:"kooboo",value:"Kooboo"},{key:"custom",value:v("common.custom")}],s=()=>j(this,null,function*(){yield we(a.value),u.loadSettings(),_e()});return K(()=>u.settings,()=>{a.value=JSON.parse(JSON.stringify(u.settings))},{immediate:!0}),K(()=>{var b;return(b=a.value)==null?void 0:b.mailServerType},()=>{var b;((b=a.value)==null?void 0:b.mailServerType)=="kooboo"&&m.loadAddress("addresses")},{immediate:!0}),fe("save",s),(b,t)=>{const i=me,V=H,w=se,k=ue,c=te,T=ee,I=oe,N=z,M=je,X=Ae,Q=Ie,Y=G;return d(),U("div",so,[e(ve,{name:p(v)("commerce.notificationSettings")},null,8,["name"]),a.value?(d(),C(Y,{key:0,"label-position":"top"},{default:o(()=>[_("div",uo,[_("div",mo,[e(V,{label:p(v)("common.enableEmailNotification")},{default:o(()=>[e(i,{modelValue:a.value.enableEmailNotification,"onUpdate:modelValue":t[0]||(t[0]=y=>a.value.enableEmailNotification=y)},null,8,["modelValue"])]),_:1},8,["label"]),e(V,{label:p(v)("common.mailServer")},{default:o(()=>[e(k,{modelValue:a.value.mailServerType,"onUpdate:modelValue":t[1]||(t[1]=y=>a.value.mailServerType=y),class:"el-radio-group--rounded"},{default:o(()=>[(d(),U(B,null,L($,y=>e(w,{key:y.key,label:y.key},{default:o(()=>[q(h(y.value),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1},8,["label"]),e(V,null,{default:o(()=>{var y,F,J;return[a.value.mailServerType=="custom"?(d(),U("div",ro,[e(c,{type:"primary",size:"small",round:"",onClick:t[2]||(t[2]=x=>S.value=!0)},{default:o(()=>[q(h(p(v)("common.setServerInfo")),1)]),_:1}),_("span",io,h((y=a.value.customMailServer)==null?void 0:y.server),1),_("span",po,h((F=a.value.customMailServer)==null?void 0:F.port),1),_("span",co,h((J=a.value.customMailServer)==null?void 0:J.userName),1)])):(d(),C(I,{key:1,modelValue:a.value.koobooEmailAddress,"onUpdate:modelValue":t[3]||(t[3]=x=>a.value.koobooEmailAddress=x),placeholder:p(v)("common.pleaseSelect"),class:"w-250px"},{default:o(()=>[(d(!0),U(B,null,L(p(m).addressList.filter(x=>x.addressType!=="Wildcard"),x=>(d(),C(T,{key:x.id,value:x.address,label:x.address},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"]))]}),_:1}),e(V,{label:p(v)("common.event")},{default:o(()=>[e(ze,{items:a.value.emailNotifications,events:n.value},null,8,["items","events"])]),_:1},8,["label"])]),e(c,{round:"",size:"small",type:"primary",class:"absolute top-24 right-32",plain:"",onClick:t[4]||(t[4]=y=>r.value=!0)},{default:o(()=>[vo]),_:1}),S.value?(d(),C(Ke,{key:0,modelValue:S.value,"onUpdate:modelValue":t[5]||(t[5]=y=>S.value=y),model:a.value.customMailServer,onSuccess:t[6]||(t[6]=y=>a.value.customMailServer=y)},null,8,["modelValue","model"])):D("",!0)]),a.value?(d(),U("div",fo,[_("div",_o,[e(V,{label:p(v)("common.enableWebhook")},{default:o(()=>[e(i,{modelValue:a.value.enableWebhook,"onUpdate:modelValue":t[7]||(t[7]=y=>a.value.enableWebhook=y)},null,8,["modelValue"])]),_:1},8,["label"]),e(V,null,{label:o(()=>[_("div",bo,[yo,e(Q,{placement:"top-start",width:"600"},{reference:o(()=>[e(N,{class:"ml-4 iconfont icon-problem",onClick:t[8]||(t[8]=P(()=>{},["prevent"]))})]),default:o(()=>[e(X,{title:p(v)("common.webhookDescription"),column:1,border:""},{default:o(()=>[e(M,{label:"secret"},{default:o(()=>[q(h(a.value.webhookSecret),1)]),_:1}),e(M,{label:"Verification"},{default:o(()=>[go]),_:1})]),_:1},8,["title"])]),_:1})])]),default:o(()=>[e(eo,{events:f.value,items:a.value.webhooks},null,8,["events","items"])]),_:1})]),e(c,{round:"",size:"small",type:"primary",class:"absolute top-24 right-32",plain:"",onClick:t[9]||(t[9]=y=>l.value=!0)},{default:o(()=>[Vo]),_:1})])):D("",!0)]),_:1})):D("",!0),r.value?(d(),C(lo,{key:1,modelValue:r.value,"onUpdate:modelValue":t[10]||(t[10]=y=>r.value=y)},null,8,["modelValue"])):D("",!0),l.value?(d(),C(no,{key:2,modelValue:l.value,"onUpdate:modelValue":t[11]||(t[11]=y=>l.value=y)},null,8,["modelValue"])):D("",!0),e(ce,{"hidden-cancel":"",onSave:s})])}}});export{Vt as default};
