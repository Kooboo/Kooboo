var x=(a,d,f)=>new Promise((c,y)=>{var r=o=>{try{i(f.next(o))}catch(U){y(U)}},w=o=>{try{i(f.throw(o))}catch(U){y(U)}},i=o=>o.done?c(o.value):Promise.resolve(o.value).then(r,w);i((f=f.apply(a,d)).next())});import{_ as N}from"./k-table.e9121736.js";import{d as D}from"./main.52487121.js";import{G as W}from"./index.232e741a.js";import{g as G,o as X}from"./i18n.97105311.js";import{g as H}from"./confirm.46f27373.js";import{_ as Y}from"./index.9ffc2c80.js";import{f as Z}from"./index.934159ee.js";import{E as M,a as J,c as ee}from"./index.afee24fe.js";import{E as oe,a as te}from"./index.317a7f30.js";import{E as O}from"./index.4b289bae.js";import{d as F,g as v,c as Q,o as g,j as E,w as t,b as e,u as l,a as B,b6 as P,F as K,f as $,t as S,aH as C,k as I}from"./url.2e6a77c4.js";import{u as q}from"./use-date.88693eba.js";import{E as le}from"./windi.539ebeab.js";import{E as z}from"./index.b09a9f00.js";import{E as ae,a as ne,b as se}from"./index.3fcd2f53.js";import{E as j}from"./index.f3d28a97.js";import{E as re}from"./index.01dc3ec0.js";import"./sortable.esm.a99254e8.js";import"./icon-button.e1f3bfd2.js";import"./index.9589f7cf.js";import"./focus-trap.de18cf8f.js";import"./isNil.98bb3b88.js";import"./event.53b2ad83.js";import"./index.9e96921b.js";import"./index.975a8825.js";import"./index.bc93d068.js";import"./index.7a88a6b5.js";import"./isEqual.3700b7f1.js";import"./_baseIsEqual.abb55a3a.js";import"./index.4587e608.js";import"./event.776e7e11.js";import"./error.7e8331f1.js";import"./index.c1764395.js";import"./index.6302b2c1.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";import"./replace-all.8fa5a83d.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./logo-transparent.1566007e.js";import"./index.d267cbe6.js";import"./index.07e210fb.js";import"./scroll.8babc10c.js";import"./aria.75ec5909.js";import"./validator.1d438d08.js";import"./index.f997a738.js";import"./debounce.61c67278.js";import"./toNumber.574be4f1.js";import"./index.a46fa52c.js";import"./_baseClone.f10ff33c.js";import"./refs.4001ce17.js";import"./dayjs.min.378b3d72.js";import"./dropdown.87a7678e.js";import"./index.e3f90979.js";const ie=()=>D.get("SearchConsole/GetAuthUrl",{callbackUrl:location.href}),me=()=>D.get("SearchConsole/GetSiteList",void 0,{hiddenError:!0}),ue=a=>D.post("SearchConsole/DeleteSite",{siteUrl:a}),ce=a=>D.post("SearchConsole/AddSite",{siteUrl:a}),pe=(a,d)=>D.post("SearchConsole/ValidSite",{siteUrl:a,onGoogle:d}),de=a=>D.get("SearchConsole/GetSitemapList",{siteUrl:a}),fe=(a,d)=>D.post("SearchConsole/DeleteSitemap",{siteUrl:a,feedPath:d}),_e=(a,d)=>D.post("SearchConsole/SubmitSitemap",{siteUrl:a,feedPath:d}),ve=a=>D.post("sitemap/Feeds",{domain:a}),ye=a=>D.post("SearchConsole/GetSearchAnalytics",a),be=F({props:{modelValue:{type:Boolean},excludes:null},emits:["update:modelValue","reload"],setup(a,{emit:d}){const f=a,c=v([]),{t:y}=G(),r=v(!0),w=v(),i=v({url:""});Z().then(h=>c.value=h);const o=()=>x(this,null,function*(){!i.value.url||(yield ce(i.value.url),d("reload"),r.value=!1)}),U=Q(()=>{var h=[];for(const k of c.value){var s=`sc-domain:${k.domainName}`;f.excludes.find(b=>b==s)||h.push(s)}return h});return(h,s)=>{const k=M,b=J,L=oe,T=te,p=O;return g(),E(p,{"model-value":r.value,width:"600px","close-on-click-modal":!1,title:l(y)("common.addSite"),onClosed:s[2]||(s[2]=n=>d("update:modelValue",!1))},{footer:t(()=>[e(Y,{disabled:!i.value.url,onConfirm:o,onCancel:s[1]||(s[1]=n=>r.value=!1)},null,8,["disabled"])]),default:t(()=>[e(T,{ref_key:"form",ref:w,"label-position":"top",model:i.value,onKeydown:X(o,["enter"])},{default:t(()=>[e(L,{label:l(y)("common.site"),prop:"name"},{default:t(()=>[e(b,{modelValue:i.value.url,"onUpdate:modelValue":s[0]||(s[0]=n=>i.value.url=n),class:"w-full"},{default:t(()=>[(g(!0),B(K,null,P(l(U),n=>(g(),E(k,{key:n,label:n,value:n},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","onKeydown"])]),_:1},8,["model-value","title"])}}}),ge={class:"flex items-center pb-24 space-x-16"},we=F({props:{modelValue:{type:Boolean},siteUrl:null},emits:["update:modelValue","reload"],setup(a,{emit:d}){const f=a,c=v([]),y=v([]),{t:r}=G(),w=v(!0);ve(f.siteUrl).then(s=>{y.value=s});function i(){return x(this,null,function*(){c.value=yield de(f.siteUrl)})}i();function o(s){return x(this,null,function*(){yield H();for(const k of s)yield fe(f.siteUrl,k.path);yield i()})}function U(s){return x(this,null,function*(){yield _e(f.siteUrl,s),yield i()})}const h=Q(()=>{const s=[];for(const k of y.value)c.value.find(b=>b.path==k)||s.push(k);return s});return(s,k)=>{const b=le,L=z,T=ae,p=ne,n=se,_=j,V=N,A=O;return g(),E(A,{"model-value":w.value,width:"1000px","close-on-click-modal":!1,title:l(r)("common.sitemap"),onClosed:k[0]||(k[0]=m=>d("update:modelValue",!1))},{default:t(()=>[$("div",null,[$("div",ge,[e(n,{trigger:"click",class:"ml-10px",disabled:!l(h).length,onCommand:U},{dropdown:t(()=>[e(p,null,{default:t(()=>[(g(!0),B(K,null,P(l(h),m=>(g(),E(T,{key:m,command:m},{default:t(()=>[$("span",null,S(m),1)]),_:2},1032,["command"]))),128))]),_:1})]),default:t(()=>[e(L,{round:"","data-cy":"new-page"},{default:t(()=>[e(b,{class:"iconfont icon-a-addto"}),C(" "+S(l(r)("common.submit")),1)]),_:1})]),_:1},8,["disabled"])]),e(V,{data:c.value,"show-check":"",onDelete:o},{default:t(()=>[e(_,{label:l(r)("common.path"),prop:"path"},null,8,["label"]),e(_,{label:l(r)("common.lastSubmitted"),prop:"errors"},{default:t(({row:m})=>[C(S(l(q)(m.lastSubmitted)),1)]),_:1},8,["label"]),e(_,{label:l(r)("common.lastDownloaded"),prop:"errors"},{default:t(({row:m})=>[C(S(m.lastDownloaded?l(q)(m.lastDownloaded):""),1)]),_:1},8,["label"]),e(_,{label:l(r)("common.error"),prop:"errors",width:"80"},null,8,["label"]),e(_,{label:l(r)("common.warning"),prop:"warnings",width:"80"},null,8,["label"])]),_:1},8,["data"])])]),_:1},8,["model-value","title"])}}}),ke={class:"flex items-center pb-24 space-x-16 flex"},he=F({props:{modelValue:{type:Boolean},siteUrl:null},emits:["update:modelValue","reload"],setup(a,{emit:d}){const f=a,c=new Date,y=new Date,r=v("auto");y.setTime(y.getTime()-3600*1e3*24*30);const w=v([y,c]),i=v([]),{t:o}=G(),U=v(!0);function h(){return x(this,null,function*(){i.value=(yield ye({siteUrl:f.siteUrl,startDate:w.value[0],endDate:w.value[1],aggregationType:r.value})).rows})}h();const s=[{key:"auto",value:o("common.auto")},{key:"byPage",value:o("console.byPage")},{key:"byProperty",value:o("common.byProperty")}];return(k,b)=>{const L=M,T=J,p=re,n=z,_=j,V=N,A=O;return g(),E(A,{"model-value":U.value,width:"1000px","close-on-click-modal":!1,title:l(o)("common.analytics"),onClosed:b[2]||(b[2]=m=>d("update:modelValue",!1))},{default:t(()=>[$("div",null,[$("div",ke,[e(T,{modelValue:r.value,"onUpdate:modelValue":b[0]||(b[0]=m=>r.value=m)},{default:t(()=>[(g(),B(K,null,P(s,m=>e(L,{key:m.key,value:m.key,label:m.value},null,8,["value","label"])),64))]),_:1},8,["modelValue"]),e(p,{modelValue:w.value,"onUpdate:modelValue":b[1]||(b[1]=m=>w.value=m),type:"daterange","unlink-panels":"","range-separator":l(o)("common.to"),"start-placeholder":l(o)("common.startDate"),"end-placeholder":l(o)("common.endDate")},null,8,["modelValue","range-separator","start-placeholder","end-placeholder"]),e(n,{type:"primary",round:"",onClick:h},{default:t(()=>[C(S(l(o)("common.search")),1)]),_:1})]),e(V,{data:i.value},{default:t(()=>[e(_,{label:l(o)("common.clicks"),prop:"clicks"},null,8,["label"]),e(_,{label:l(o)("common.ctr"),prop:"ctr"},null,8,["label"]),e(_,{label:l(o)("common.impressions"),prop:"impressions"},null,8,["label"]),e(_,{label:l(o)("console.keys"),prop:"keys"},{default:t(({row:m})=>{var u;return[C(S((u=m.keys)==null?void 0:u.join(" ")),1)]}),_:1},8,["label"])]),_:1},8,["data"])])]),_:1},8,["model-value","title"])}}}),Se={key:1,class:"px-24"},Ue=$("div",{class:"flex items-center py-24 space-x-16"},null,-1),Eo=F({setup(a){const d=v(),f=v([]),{t:c}=G(),y=v(!1),r=v(!1),w=v(!1),i=v();function o(){return x(this,null,function*(){try{f.value=(yield me()).sort((p,n)=>p.siteUrl>n.siteUrl?1:-1)}catch(p){d.value=yield ie()}})}o();function U(){location.href=d.value}function h(p,n){return x(this,null,function*(){yield pe(p,n);for(let V=0;V<3;V++){yield o();var _=f.value.find(A=>A.siteUrl);if(!_||_.permissionLevel!="siteUnverifiedUser")break}})}function s(p){return x(this,null,function*(){yield H();for(const n of p)yield ue(n.siteUrl);o()})}function k(p){return p.permissionLevel!="siteUnverifiedUser"}function b(p){i.value=p,r.value=!0}function L(p){i.value=p,w.value=!0}const T={siteOwner:c("common.siteOwner"),siteUnverifiedUser:c("common.siteUnverifiedUser")};return(p,n)=>{const _=z,V=j,A=ee,m=N;return g(),B("div",null,[d.value?(g(),E(W,{key:0},{button:t(()=>[e(_,{type:"primary",onClick:U},{default:t(()=>[C(S(l(c)("common.login")),1)]),_:1})]),default:t(()=>[$("p",null,S(l(c)("common.searchConsoleLoginTip")),1)]),_:1})):(g(),B("div",Se,[Ue,e(m,{data:f.value,onDelete:s},{default:t(()=>[e(V,{label:l(c)("common.site"),prop:"siteUrl"},{default:t(({row:u})=>[$("span",null,S(u.siteUrl),1)]),_:1},8,["label"]),e(V,{label:l(c)("common.permission"),align:"center"},{default:t(({row:u})=>[e(A,{class:"rounded-full"},{default:t(()=>[C(S(T[u.permissionLevel]||u.permissionLevel),1)]),_:2},1024)]),_:1},8,["label"]),e(V,{align:"right"},{default:t(({row:u})=>[k(u)?(g(),B(K,{key:1},[e(_,{type:"primary",round:"",plain:"",size:"small",onClick:R=>L(u)},{default:t(()=>[C(S(l(c)("common.analytics")),1)]),_:2},1032,["onClick"]),e(_,{type:"primary",round:"",plain:"",size:"small",onClick:R=>b(u)},{default:t(()=>[C(S(l(c)("common.sitemap")),1)]),_:2},1032,["onClick"])],64)):(g(),E(_,{key:0,type:"danger",round:"",size:"small",onClick:R=>h(u.siteUrl,u.onGoogle)},{default:t(()=>[C(S(l(c)("common.validation")),1)]),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data"])])),y.value?(g(),E(be,{key:2,modelValue:y.value,"onUpdate:modelValue":n[0]||(n[0]=u=>y.value=u),excludes:f.value.map(u=>u.siteUrl),onReload:o},null,8,["modelValue","excludes"])):I("",!0),r.value?(g(),E(we,{key:3,modelValue:r.value,"onUpdate:modelValue":n[1]||(n[1]=u=>r.value=u),"site-url":i.value.siteUrl},null,8,["modelValue","site-url"])):I("",!0),w.value?(g(),E(he,{key:4,modelValue:w.value,"onUpdate:modelValue":n[2]||(n[2]=u=>w.value=u),"site-url":i.value.siteUrl},null,8,["modelValue","site-url"])):I("",!0)])}}});export{Eo as default};
