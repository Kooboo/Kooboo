var P=Object.defineProperty;var $=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var S=(d,i,n)=>i in d?P(d,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):d[i]=n,C=(d,i)=>{for(var n in i||(i={}))Q.call(i,n)&&S(d,n,i[n]);if($)for(var n of $(i))W.call(i,n)&&S(d,n,i[n]);return d};var x=(d,i,n)=>new Promise((t,f)=>{var v=u=>{try{_(n.next(u))}catch(k){f(k)}},E=u=>{try{_(n.throw(u))}catch(k){f(k)}},_=u=>u.done?t(u.value):Promise.resolve(u.value).then(v,E);_((n=n.apply(d,i)).next())});import{u as X,a as Y}from"./product.9d71c7fc.js";import{g as Z}from"./i18n.a87944a4.js";import{k as h}from"./main.9fdfea92.js";import{n as I}from"./guid.c1a40312.js";import{E as ee}from"./index.99e769ef.js";import{E as le}from"./windi.6360286d.js";import{E as oe}from"./index.361e2245.js";import{E as te,a as ae,b as ne}from"./index.c86a187b.js";import{E as me,a as ue}from"./index.b38edc72.js";import{c as se}from"./index.7c862087.js";import{E as ie}from"./index.d96452a6.js";import{E as de}from"./index.178b9e08.js";import{E as re,a as pe}from"./index.9fd79879.js";import{E as ce}from"./index.c003dfa1.js";import{d as fe,g as y,o as q,a as R,f as g,b as e,w as l,aI as c,t as r,u as m,r as ve,F as _e}from"./url.4cb47a7a.js";const ke={class:"space-y-8"},ye={class:"flex items-center"},Ee=g("div",{class:"flex-1"},null,-1),be=["title"],xe=["title"],Ae=fe({props:{items:null,id:null,deleteRemoteFile:{type:Boolean}},emits:["update:items"],setup(d,{emit:i}){const n=d,{t}=Z(),f=y(!1),v=y(!1),E=y(),_=y(),u=y(),k=y();function z(o){return x(this,arguments,function*({raw:s}){const p=new FormData;p.append("file",s),p.append("variantId",n.id),yield X(p),i("update:items",[...n.items,{id:I(),type:"file",name:s.name,size:s.size,contentType:s.type,value:n.id}])})}function N(s){return x(this,null,function*(){s.type=="file"&&n.deleteRemoteFile&&Y(s.value,s.name),i("update:items",n.items.filter(o=>o!=s))})}function L(s){switch(s){case"file":return t("common.file");case"text":return t("common.text");case"link":return t("common.link");default:return s}}function A(s){switch(s){case"file":k.value.click();break;case"text":u.value={id:I(),type:"text",name:"",value:""},f.value=!0;break;case"link":u.value={id:I(),type:"link",name:"",value:""},v.value=!0;break}}function G(s){return x(this,null,function*(){var o,p;yield(o=_.value)==null?void 0:o.validate(),i("update:items",[...n.items,C({},s)]),f.value=!1,(p=_.value)==null||p.resetFields()})}function M(s){return x(this,null,function*(){var o,p;yield(o=E.value)==null?void 0:o.validate(),i("update:items",[...n.items,C({},s)]),v.value=!1,(p=E.value)==null||p.resetFields()})}return(s,o)=>{const p=ee,T=le,b=oe,w=te,j=ae,H=ne,V=me,J=se,K=ie,O=ue,F=de,D=re,U=pe,B=ce;return q(),R("div",null,[g("div",ke,[g("div",ye,[e(p,{class:"hidden",action:"","auto-upload":!1,"on-change":z,"show-file-list":!1},{default:l(()=>[g("div",{ref_key:"uploadRef",ref:k},null,512)]),_:1}),e(H,{trigger:"click",onCommand:A},{dropdown:l(()=>[e(j,null,{default:l(()=>[e(w,{command:"file"},{default:l(()=>[c(r(m(t)("common.file")),1)]),_:1}),e(w,{command:"link"},{default:l(()=>[c(r(m(t)("common.link")),1)]),_:1}),e(w,{command:"text"},{default:l(()=>[c(r(m(t)("common.text")),1)]),_:1})]),_:1})]),default:l(()=>[e(b,{type:"primary",round:""},{default:l(()=>[e(T,{class:"iconfont icon-a-addto"}),c(r(m(t)("common.add"))+" ",1),e(T,{class:"iconfont icon-pull-down text-12px ml-8 !mr-0"})]),_:1})]),_:1}),Ee,ve(s.$slots,"bar")]),e(O,{data:d.items},{default:l(()=>[e(V,{prop:"name",label:m(t)("common.name")},{default:l(({row:a})=>[g("div",{title:a.name,class:"truncate"},r(a.name),9,be)]),_:1},8,["label"]),e(V,{label:m(t)("common.type")},{default:l(({row:a})=>[e(J,{round:"",type:"success"},{default:l(()=>[c(r(L(a.type)),1)]),_:2},1024)]),_:1},8,["label"]),e(V,{label:m(t)("common.detail")},{default:l(({row:a})=>[a.type=="file"?(q(),R(_e,{key:0},[c(r(m(h)(a.size)),1)],64)):(q(),R("div",{key:1,title:a.value,class:"truncate"},r(a.value),9,xe))]),_:1},8,["label"]),e(V,{width:"40"},{default:l(({row:a})=>[e(K,{placement:"top",content:m(t)("common.delete")},{default:l(()=>[e(T,{class:"iconfont icon-delete hover:text-orange text-l",onClick:ge=>N(a)},null,8,["onClick"])]),_:2},1032,["content"])]),_:1})]),_:1},8,["data"])]),e(B,{modelValue:f.value,"onUpdate:modelValue":o[4]||(o[4]=a=>f.value=a),title:m(t)("common.text")},{footer:l(()=>[e(b,{onClick:o[2]||(o[2]=a=>f.value=!1)},{default:l(()=>[c(r(m(t)("common.cancel")),1)]),_:1}),e(b,{type:"primary",onClick:o[3]||(o[3]=a=>G(u.value))},{default:l(()=>[c(r(m(t)("common.ok")),1)]),_:1})]),default:l(()=>[e(U,{ref_key:"textForm",ref:_,model:u.value},{default:l(()=>[e(D,{label:m(t)("common.name"),prop:"name",rules:[{required:!0,message:m(t)("common.nameRequiredTips")}]},{default:l(()=>[e(F,{modelValue:u.value.name,"onUpdate:modelValue":o[0]||(o[0]=a=>u.value.name=a)},null,8,["modelValue"])]),_:1},8,["label","rules"]),e(D,{label:m(t)("common.text"),prop:"value",rules:[{required:!0,message:m(t)("common.valueRequiredTips")}]},{default:l(()=>[e(F,{modelValue:u.value.value,"onUpdate:modelValue":o[1]||(o[1]=a=>u.value.value=a),type:"textarea"},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),e(B,{modelValue:v.value,"onUpdate:modelValue":o[9]||(o[9]=a=>v.value=a),title:m(t)("common.link")},{footer:l(()=>[e(b,{onClick:o[7]||(o[7]=a=>v.value=!1)},{default:l(()=>[c(r(m(t)("common.cancel")),1)]),_:1}),e(b,{type:"primary",onClick:o[8]||(o[8]=a=>M(u.value))},{default:l(()=>[c(r(m(t)("common.ok")),1)]),_:1})]),default:l(()=>[e(U,{ref_key:"linkForm",ref:E,model:u.value},{default:l(()=>[e(D,{label:m(t)("common.name"),prop:"name",rules:[{required:!0,message:m(t)("common.nameRequiredTips")}]},{default:l(()=>[e(F,{modelValue:u.value.name,"onUpdate:modelValue":o[5]||(o[5]=a=>u.value.name=a)},null,8,["modelValue"])]),_:1},8,["label","rules"]),e(D,{label:m(t)("common.link"),prop:"value",rules:[{required:!0,message:m(t)("common.urlRequiredTips")}]},{default:l(()=>[e(F,{modelValue:u.value.value,"onUpdate:modelValue":o[6]||(o[6]=a=>u.value.value=a),type:"textarea"},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}});export{Ae as _};
