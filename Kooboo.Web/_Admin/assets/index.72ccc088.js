var C=(e,i,s)=>new Promise((r,c)=>{var l=d=>{try{y(s.next(d))}catch(t){c(t)}},h=d=>{try{y(s.throw(d))}catch(t){c(t)}},y=d=>d.done?r(d.value):Promise.resolve(d.value).then(l,h);y((s=s.apply(e,i)).next())});import{a as O,r as U}from"./classCompletion.a22e38a6.js";import{a as k}from"./replace-all.d441bf14.js";import{d as b}from"./main.582f9de6.js";import{C as q,w as B}from"./i18n.bcd18f8a.js";import{x as M,h as z,aW as Q,d as W,o as m,a as g,t as S,k as w,b as u,u as j,w as x,r as I,n as D,I as J,f as p}from"./url.8f5ec20c.js";import{n as X}from"./guid.c1a40312.js";import{V as Y}from"./vuedraggable.umd.7929a3b6.js";import{E as Z}from"./windi.19264205.js";import{E as _}from"./index.ec6ad7db.js";import{E as ee}from"./index.aec72f69.js";import{c as te}from"./cloneDeep.060340c1.js";const oe=()=>b.get(k("KScript/GetDefine")),se=()=>b.get(k("KScript/GetKViewSuggestions")),ie=()=>b.get(k("KScript/GetClassSuggestions")),Se=(e,i,s)=>b.get(k("KScript/getcolumns"),{database:e,table:i,moduleId:s},{hiddenLoading:!0,hiddenError:!0}),xe=(e,i)=>b.get(k("KScript/gettables"),{database:e,moduleId:i},{hiddenLoading:!0,hiddenError:!0}),H=new q;let L,A,E,G,v=new Date().getTime();function Ie(){v=new Date().getTime()}function ne(){return se()}function Pe(){return C(this,null,function*(){const e=M("siteId"),i=H.get("_site_version_");return E&&e+i+v==L||(E=(()=>C(this,null,function*(){const s=yield ne();return yield O(s),yield oe()}))(),L=e+i+v),E})}function Fe(){return C(this,null,function*(){const e=M("siteId"),i=H.get("_site_version_");e+i+v!=A&&(G=ie(),A=e+i+v),U(yield G)})}const ae=[{type:"format",key:"f",shiftKey:!0,altKey:!0},{type:"format",key:"F",shiftKey:!0,altKey:!0},{type:"save",key:"s",metaKey:!0},{type:"save",key:"s",ctrlKey:!0},{type:"StartDebug",key:"F8"},{type:"DebugContinue",key:"F5"},{type:"DebugInto",key:"F11"},{type:"DebugOver",key:"F10"},{type:"DebugOut",key:"F11",shiftKey:!0},{type:"DebugStop",key:"F5",shiftKey:!0},{type:"matchCase",key:"c",altKey:!0},{type:"matchCase",key:"\xE7",metaKey:!0,altKey:!0},{type:"useRegularExpression",key:"r",altKey:!0},{type:"useRegularExpression",key:"\xAE",metaKey:!0,altKey:!0}];function Te(e,i){const s=r=>{const c=ae.find(l=>!!l.altKey==!!r.altKey&&!!l.ctrlKey==!!r.ctrlKey&&!!l.metaKey==!!r.metaKey&&!!l.shiftKey==!!r.shiftKey&&l.key===r.key);c&&e===c.type&&(i(),r.preventDefault())};z(()=>{addEventListener("keydown",s)}),Q(()=>{removeEventListener("keydown",s)})}const re={key:0,class:"font-bold"},le={key:0,class:"pr-8 w-32"},de={class:"overflow-hidden leading-40px flex-1 mr-8 ellipsis","data-cy":"text"},ce=["title"],ue={key:1,class:"p-4"},ye={class:"p-4"},fe={key:2,class:"p-4"},Ve=W({props:{list:null,idProp:{default:void 0},displayProp:{default:void 0},group:{default:X()},title:{default:void 0},wrapperClass:{default:void 0},editable:{type:Boolean},deleteTip:null,disableActions:{default:void 0}},emits:["delete","sort","add","edit","change"],setup(e,{emit:i}){const s=e;function r(t,o){const n=te(J(o));t.moved?(n.splice(t.moved.oldIndex,1),n.splice(t.moved.newIndex,0,t.moved.element)):t.added?n.splice(t.added.newIndex,0,t.added.element):t.removed&&n.splice(t.removed.oldIndex,1),i("change",n)}function c(t){var n;const o=(n=s.disableActions)==null?void 0:n.edit;return h(t,o)}function l(t){var n;const o=(n=s.disableActions)==null?void 0:n.delete;return h(t,o)}function h(t,o){if(!!o)return typeof o=="function"?o(t):o||void 0}function y(t,o){c(t)||i("edit",s.idProp?t[s.idProp]:t,t,{index:o,list:s.list})}function d(t,o){l(t)||i("delete",s.idProp?t[s.idProp]:t,t,{index:o,list:s.list})}return(t,o)=>{var P,F;const n=Z,N=_,R=ee;return m(),g("div",{class:D((P=e.wrapperClass)!=null?P:"space-y-4 px-24 py-16")},[e.title?(m(),g("h3",re,S(e.title),1)):w("",!0),u(j(Y),{"model-value":e.list,group:e.group,disabled:e.list.length<2,"item-key":(F=e.idProp)!=null?F:"",class:"space-y-4",onSort:o[0]||(o[0]=a=>i("sort",a)),onChange:o[1]||(o[1]=a=>r(a,e.list))},{item:x(({element:a,index:f})=>{var T,V;return[p("div",{class:D(["text-666 dark:text-fff/67 flex items-center pl-16 pr-8 w-full border-line dark:border-666 rounded-normal border border-solid ellipsis bg-fff dark:bg-[#333]",{"cursor-move":e.list.length>1}]),"data-cy":"added-item"},[e.list.length>1?(m(),g("div",le,"# "+S(f+1),1)):w("",!0),p("div",de,[I(t.$slots,"default",{item:a,index:f},()=>{var K,$;return[p("span",{title:(K=a[e.displayProp||""])==null?void 0:K.trim(),"data-cy":"name"},S(($=a[e.displayProp||""])==null?void 0:$.trim()),9,ce)]})]),p("div",null,[I(t.$slots,"right",{item:a,index:f})]),e.editable?(m(),g("div",ue,[u(n,{class:D(["iconfont icon-a-setup",[c(a)?"cursor-not-allowed text-opacity-50":"cursor-pointer"]]),"data-cy":"edit",onClick:B(K=>y(a,f),["stop"])},null,8,["class","onClick"])])):w("",!0),p("div",ye,[u(N,{placement:"top-start",content:(T=e.deleteTip)==null?void 0:T.call(e,a),disabled:!((V=e.deleteTip)!=null&&V.call(e,a))},{default:x(()=>[u(n,{class:D(["text-orange iconfont icon-delete",[l(a)?"cursor-not-allowed text-opacity-50":"cursor-pointer"]]),color:"#fab6b6","data-cy":"remove",onClick:B(K=>d(a,f),["stop"])},null,8,["class","onClick"])]),_:2},1032,["content","disabled"])]),e.list.length>1?(m(),g("div",fe,[u(n,{class:"iconfont icon-move","data-cy":"move"})])):w("",!0)],2)]}),_:3},8,["model-value","group","disabled","item-key"]),I(t.$slots,"bottom",{},()=>[u(R,{circle:"","data-cy":"add",onClick:o[2]||(o[2]=a=>t.$emit("add"))},{default:x(()=>[u(n,{class:"text-blue iconfont icon-a-addto"})]),_:1})])],2)}}});export{Ve as _,Se as a,Fe as b,Te as c,xe as g,Ie as r,Pe as u};
