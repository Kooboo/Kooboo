var Q=Object.defineProperty,U=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var F=(n,s,a)=>s in n?Q(n,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[s]=a,$=(n,s)=>{for(var a in s||(s={}))X.call(s,a)&&F(n,a,s[a]);if(E)for(var a of E(s))Y.call(s,a)&&F(n,a,s[a]);return n},b=(n,s)=>U(n,W(s));var O=(n,s,a)=>new Promise((w,m)=>{var S=u=>{try{g(a.next(u))}catch(p){m(p)}},y=u=>{try{g(a.throw(u))}catch(p){m(p)}},g=u=>u.done?w(u.value):Promise.resolve(u.value).then(S,y);g((a=a.apply(n,s)).next())});import{e as Z,S as z,g as ee}from"./textContent.09908244.js";import{g as f,cd as te,N as oe,G as ae,i as re,ch as se}from"./url.4cb47a7a.js";import{d as j}from"./dayjs.min.ccc40d4f.js";import{u as ne}from"./use-date.f1258183.js";import{o as I}from"./omitBy.be6984cf.js";import{c as x}from"./index.85105f22.js";import{i as K}from"./isEmpty.8a500dd9.js";function ye(n,s,a){const w=f([]),m=f([]),S=f(!1),y=f([]),g=te(),u=oe(),p=ae({currentPage:1,pageCount:0,pageSize:30}),h=f(""),C=f(""),k=f({}),B=f([]),i=f({prop:"",order:"ascending"});function D(){return O(this,null,function*(){h.value=C.value.trim(),yield N(1,p.pageSize)})}const M=se(D,1e3);re(()=>C.value,()=>{M()});function R(){Z({folderId:n,keyword:h.value,categories:I(k.value,o=>K(o)),exclude:a})}function _(o,t,e){const l=I(k.value,r=>K(r));if(h.value){const r={folderId:n,pageNr:o,pageSize:t!=null?t:30,keyword:h.value,categories:l,exclude:e};return i.value.prop&&(r.sortField=i.value.prop,r.ascending=i.value.order==="ascending"),z(r)}else{const r={folderId:n,pageNr:o,pageSize:t!=null?t:30,categories:l,exclude:e};return i.value.prop&&(r.sortField=i.value.prop,r.ascending=i.value.order==="ascending"),ee(r)}}function N(o,t){return O(this,null,function*(){var l,r,c,v;o||(o=+((l=u.query.pageNr)!=null?l:1));const e=yield _(o,(r=t!=null?t:p.pageSize)!=null?r:30,a);B.value=(c=e.categories)!=null?c:[],y.value=((v=e.columns)!=null?v:[]).map(d=>(d.rawName=d.name,d.name=x(d.name),d)),m.value=e.list,G(e.list,y.value),p.currentPage=e.pageNr,p.pageCount=e.totalPages,p.pageSize=e.pageSize,s||g.replace({query:b($({},u.query),{pageNr:o})})})}function G(o,t){w.value=o.map(e=>{const l={id:e.id,online:e.online,lastModified:e.lastModified,usedBy:e.usedBy,order:e.order};for(const r in e.textValues){let c=e.textValues[r];const v=t.find(d=>d.name==x(r));if(v!=null&&v.selectionOptions)try{const d=JSON.parse(v.selectionOptions);let L=[c];v.controlType=="CheckBox"&&(L=JSON.parse(c));const q=[];for(const T of L){const V=d.find(H=>H.value==T);V?q.push(V.key):q.push(T)}c=q.join(",")}catch(d){}l[x(r)]=c,c&&j(c).isValid()&&c===j(c).toISOString()&&(l[x(r)]=ne(c))}return l}),S.value=!0}function P(){const{SiteId:o,folder:t}=u.query;return`${o}_TextContent_${t}`}function A(o){return O(this,null,function*(){var e;const t=y.value.find(l=>l.name==o.prop);i.value.prop=(e=t==null?void 0:t.rawName)!=null?e:"",i.value.order=o.order,localStorage.setItem(P(),JSON.stringify(i.value)),yield D()})}function J(){const o=localStorage.getItem(P());if(o){const{prop:t,order:e}=JSON.parse(o);i.value.prop=t,i.value.order=e}}return J(),{keywords:C,currentKeyword:h,pagination:p,list:w,rawList:m,columns:y,fetchList:N,columnLoaded:S,sortSetting:i,searchCategories:k,categoryOptions:B,onSortChanged:A,initSortSetting:J,exportData:R}}export{ye as u};
