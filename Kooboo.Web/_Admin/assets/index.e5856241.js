var x=(V,g,v)=>new Promise((h,e)=>{var m=c=>{try{f(v.next(c))}catch(a){e(a)}},t=c=>{try{f(v.throw(c))}catch(a){e(a)}},f=c=>c.done?h(c.value):Promise.resolve(c.value).then(m,t);f((v=v.apply(V,g)).next())});import{_ as ie}from"./icon-button.315b6443.js";import{_ as se}from"./k-table.7d05e82e.js";import{B as Y,C as me,D as Z,I as re,E as ue,F as de,G as ce}from"./dev-mode.1f379952.js";import{B as pe}from"./breadcrumb.edaec300.js";import{g as A,d as fe,C as _e}from"./i18n.bcd18f8a.js";import{_ as ee}from"./index.7a75fca3.js";import{E as F}from"./index.d4a6b2d5.js";import{d as j,g as _,o as i,j as p,w as d,b as s,u as n,ce as ve,f as w,a as z,F as W,b6 as Q,aH as I,t as $,k as S,c as ge,N as ke,b7 as ye,e as R,cg as X}from"./url.8f5ec20c.js";import{m as Ve}from"./marked.esm.30e9f73c.js";import{_ as he}from"./index.47274d5a.js";import{a as oe,u as we}from"./replace-all.d441bf14.js";import{d as te,u as be}from"./main.582f9de6.js";import{E as xe}from"./index.0a8d3d17.js";import{E as le}from"./index.373c837a.js";import{E as Ce,a as Se}from"./index.6d22f937.js";import{E as $e}from"./index.5cbbc5d7.js";import{E as Ee,a as De}from"./index.6d63eb53.js";import{b as Ue,s as Me}from"./confirm.eadb49f1.js";import{_ as Be}from"./package-search.6e7aee13.js";import{E as Ie}from"./windi.19264205.js";import{E as Ne}from"./index.aec72f69.js";import{E as Te}from"./index.b83a1079.js";import"./index.ec6ad7db.js";import"./focus-trap.eafcfd1f.js";import"./isNil.98bb3b88.js";import"./event.53b2ad83.js";import"./index.05e21f33.js";import"./index.3a977dfb.js";import"./index.c80f5028.js";import"./sortable.esm.a99254e8.js";import"./index.564bc658.js";import"./isEqual.11d86bcc.js";import"./_baseIsEqual.547729d3.js";import"./error.7e8331f1.js";import"./index.daafc4da.js";import"./event.776e7e11.js";import"./index.59b1471f.js";import"./guid.c1a40312.js";import"./index.72ccc088.js";import"./classCompletion.a22e38a6.js";import"./userWorker.b3a6730b.js";import"./editor.main.d2800f63.js";import"./preload-helper.13a99eb0.js";import"./vuedraggable.umd.7929a3b6.js";import"./cloneDeep.060340c1.js";import"./_baseClone.eeff2792.js";import"./index.79f78425.js";import"./config.812575d1.js";import"./dark.166fd971.js";import"./page.e927203a.js";import"./validate.238a9986.js";import"./index.2341329b.js";import"./index.bda83f28.js";import"./index.bff48780.js";import"./index.649f6c77.js";import"./index.a32fb6e5.js";import"./style.9c8f6403.js";import"./toNumber.6efebd6a.js";import"./index.10f642b2.js";import"./index.a3d8335f.js";import"./scroll.4888a9e9.js";import"./aria.75ec5909.js";import"./validator.b73911a9.js";import"./index.8bc4b1d6.js";import"./dropdown.f6378640.js";import"./refs.d2253dd4.js";import"./use-copy-text.c117d066.js";import"./index.73c941f5.js";import"./toggleComment.5b29ca87.js";import"./use-save-tip.8f44d6c0.js";import"./index.4dc50d47.js";import"./index.3be79fd5.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./index.79dc05e0.js";import"./index.ff00fbd6.js";import"./index.57a23e6d.js";import"./alert.8fe5500a.js";import"./index.d84e2378.js";/* empty css                                                               */import"./media-list.vue_vue_type_style_index_0_scoped_true_lang.c0b84b74.js";/* empty css                                                          */import"./file.734aeed6.js";import"./use-date.a1321c18.js";import"./dayjs.min.59f10137.js";/* empty css                                                          *//* empty css                                                                 */import"./use-file-upload.c73251ef.js";/* empty css                                                         */import"./image-editor.vue_vue_type_style_index_0_scoped_true_lang.53a9e945.js";import"./image-editor.f97cfa84.js";import"./main.esm.6441082b.js";import"./index.7633560d.js";import"./plugin-vue_export-helper.41ffa612.js";import"./index.50c16ae5.js";import"./index.e3f90979.js";import"./debounce.730e1961.js";import"./index.9a83ee01.js";import"./logo-transparent.1566007e.js";import"./layout.29f65550.js";import"./search-input.5b2e8d23.js";import"./index.4972d853.js";import"./position.f6e7bc86.js";import"./throttle.3f3ee457.js";import"./index.7a30c6dd.js";const Oe=j({props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(V,{emit:g}){const{t:v}=A(),h=Y(),e=_(!0),m=_(),t=_({name:""}),f=()=>x(this,null,function*(){yield m.value.validate(),yield h.createModule(t.value.name),e.value=!1});return(c,a)=>{const k=F;return i(),p(k,{"model-value":e.value,width:"600px","close-on-click-modal":!1,title:n(v)("common.newModule"),onClosed:a[1]||(a[1]=b=>g("update:modelValue",!1))},{footer:d(()=>[s(ee,{onConfirm:f,onCancel:a[0]||(a[0]=b=>e.value=!1)})]),default:d(()=>[s(me,{ref_key:"form",ref:m,model:t.value,onSave:f},null,8,["model"])]),_:1},8,["model-value","title"])}}}),Re={class:"px-12"},ze=j({props:{modelValue:{type:Boolean},id:null},emits:["update:modelValue"],setup(V,{emit:g}){const v=V,{t:h}=A(),e=_(!0),m=_("");Z("root",v.id,"Readme.md").then(f=>{m.value=Ve.parse(f)});const t=ve(()=>`<div style="padding:10px;">${m.value}<div>`);return(f,c)=>{const a=F;return i(),p(a,{"custom-class":"el-dialog--zero-padding","model-value":e.value,width:"1000px","close-on-click-modal":!1,title:n(h)("common.description"),onClosed:c[0]||(c[0]=k=>g("update:modelValue",!1))},{default:d(()=>[w("div",Re,[s(he,{class:"h-400px",content:n(t)},null,8,["content"])])]),_:1},8,["model-value","title"])}}}),Ae=fe.global.t,Fe=V=>te.get(oe("ModuleSetting/GetSetting"),{id:V}),je=(V,g)=>te.post(oe("ModuleSetting/UpdateSetting"),{id:V,json:g},void 0,{successMessage:Ae("common.saveSuccess")}),Pe={key:0},Je={class:"text-m font-bold ellipsis"},qe=["title"],Ge=j({props:{modelValue:{type:Boolean},id:null},emits:["update:modelValue"],setup(V,{emit:g}){const v=V,{t:h}=A(),e=_(!0),m=_(),t=_({});x(this,null,function*(){var c=yield Z("root",v.id,"module.config");m.value=JSON.parse(c);const a=yield Fe(v.id);if(a)t.value=JSON.parse(a);else if(m.value.settingDefines)for(const k of m.value.settingDefines)t.value[k.name]=k.defaultValue});const f=()=>x(this,null,function*(){m.value.setting=t.value,yield je(v.id,JSON.stringify(t.value,null,2)),e.value=!1});return(c,a)=>{const k=le,b=xe,E=Ce,M=Se,P=$e,J=Ee,q=De,G=F;return i(),p(G,{"model-value":e.value,width:"600px","close-on-click-modal":!1,title:n(h)("common.setting"),onClosed:a[1]||(a[1]=D=>g("update:modelValue",!1))},{footer:d(()=>[s(ee,{permission:{feature:"module",action:"edit"},onConfirm:f,onCancel:a[0]||(a[0]=D=>e.value=!1)})]),default:d(()=>[s(q,{"label-position":"top"},{default:d(()=>{var D;return[(D=m.value)!=null&&D.settingDefines?(i(),z("div",Pe,[(i(!0),z(W,null,Q(m.value.settingDefines,r=>(i(),p(J,{key:r.name},{label:d(()=>[w("p",Je,[I($(r.display||r.name),1),w("span",{class:"font-normal text-s px-4",title:r.description},$(r.description),9,qe)])]),default:d(()=>[r.type==="switch"?(i(),p(k,{key:0,modelValue:t.value[r.name],"onUpdate:modelValue":y=>t.value[r.name]=y},null,8,["modelValue","onUpdate:modelValue"])):r.type==="number"?(i(),p(b,{key:1,modelValue:t.value[r.name],"onUpdate:modelValue":y=>t.value[r.name]=y,modelModifiers:{number:!0}},null,8,["modelValue","onUpdate:modelValue"])):r.type==="select"?(i(),p(M,{key:2,modelValue:t.value[r.name],"onUpdate:modelValue":y=>t.value[r.name]=y,modelModifiers:{number:!0},class:"w-full"},{default:d(()=>[(i(!0),z(W,null,Q(r.options,(y,K)=>(i(),p(E,{key:K,label:y,value:y},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):(i(),p(P,{key:3,modelValue:t.value[r.name],"onUpdate:modelValue":y=>t.value[r.name]=y,modelModifiers:{number:!0},type:r.type=="textarea"?"textarea":""},null,8,["modelValue","onUpdate:modelValue","type"]))]),_:2},1024))),128))])):S("",!0)]}),_:1})]),_:1},8,["model-value","title"])}}}),Ke={class:"p-24"},Le={class:"flex items-center py-24 space-x-16"},He={class:"flex items-center"},We={class:"flex items-center"},Qe={class:"flex items-center"},Xe={class:"text-blue cursor-pointer"},Ye=["src"],Xt=j({setup(V){const g=_();function v(){var l;(l=g.value)==null||l.show()}const h=new _e,{t:e}=A(),m=Y(),t=be(),f=_(!1),c=_(!1),a=_(!1),k=_(!1),b=_(!1),E=_(),M=_(),P=l=>x(this,null,function*(){yield Ue(l.length),yield m.deleteModules(l.map(u=>u.id))}),J=l=>x(this,null,function*(){!t.hasAccess("module","edit")||(yield Me(e("common.shareModuleConfirm")),yield ue(l))}),q=l=>{E.value=l,a.value=!0},G=l=>{E.value=l,k.value=!0},D=l=>x(this,null,function*(){!t.hasAccess("module","edit")||(yield de(l.id,!l.online),m.load())}),r=l=>{!t.hasAccess("module","edit")||ce(l)},y=ge(()=>{if(!M.value)return;const l=h.get("jwt_token")||localStorage.getItem("TOKEN");return M.value+"?access_token="+l}),K=l=>{const u=h.get("jwt_token")||localStorage.getItem("TOKEN"),C=new URL(l),U=t.site.siteType=="p",L=location.protocol=="https:"&&C.protocol=="http:";U?L?X(l):(M.value=l,b.value=!0):(l=`${C.origin}/_Admin/login?permission=${t.site.siteType}&returnurl=${C.pathname}&&access_token=${u}`,X(l))},H=()=>x(this,null,function*(){yield m.load()});return H(),(l,u)=>{const C=Ie,U=Ne,L=ke("router-link"),N=Te,ae=le,T=ie,ne=F,O=ye("hasPermission");return i(),z("div",Ke,[s(pe,{name:n(e)("common.modules")},null,8,["name"]),w("div",Le,[R((i(),p(U,{round:"","data-cy":"create-module",onClick:u[0]||(u[0]=o=>f.value=!0)},{default:d(()=>[w("div",He,[s(C,{class:"mr-16 iconfont icon-a-addto"}),I(" "+$(n(e)("common.create")),1)])]),_:1})),[[O,{feature:"module",action:"edit"}]]),R((i(),p(U,{round:"","data-cy":"import",onClick:u[1]||(u[1]=o=>c.value=!0)},{default:d(()=>[w("div",We,[s(C,{class:"mr-16 iconfont icon-a-Pullin"}),I(" "+$(n(e)("common.import")),1)])]),_:1})),[[O,{feature:"module",action:"edit"}]]),R((i(),p(U,{round:"","data-cy":"search",onClick:v},{default:d(()=>[w("div",Qe,[s(C,{class:"mr-16 iconfont icon-search"}),I(" "+$(n(e)("common.search")),1)])]),_:1})),[[O,{feature:"module",action:"edit"}]])]),n(m).list?(i(),p(n(se),{key:0,data:n(m).list,"show-check":"",sort:"creationDate",permission:{feature:"module",action:"delete"},onDelete:P},{default:d(()=>[s(N,{label:n(e)("common.name")},{default:d(({row:o})=>[s(L,{to:n(we)({name:"dev-mode",query:{activity:"modules",moduleId:o.id}}),"data-cy":"name"},{default:d(()=>[w("span",Xe,$(o.name),1)]),_:2},1032,["to"])]),_:1},8,["label"]),s(N,{label:n(e)("common.online"),width:"150"},{default:d(({row:o})=>[R(s(ae,{"model-value":o.online,"data-cy":"online",onClick:B=>D(o)},null,8,["model-value","onClick"]),[[O,{feature:"module",action:"edit"}]])]),_:1},8,["label"]),s(N,{width:"100",label:n(e)("common.backend")},{default:d(({row:o})=>[o.backendViewUrl?(i(),p(U,{key:0,size:"small",type:"primary",round:"","data-cy":"",class:"leading-6",onClick:B=>K(o.backendViewUrl)},{default:d(()=>[I($(n(e)("common.manage")),1)]),_:2},1032,["onClick"])):S("",!0)]),_:1},8,["label"]),s(N,{align:"right",width:"180px",prop:"creationDate"},{default:d(({row:o})=>[s(T,{icon:"icon-a-setup",tip:n(e)("common.settings"),"data-cy":"setting",onClick:B=>G(o.id)},null,8,["tip","onClick"]),s(T,{icon:"icon-page",tip:n(e)("common.description"),"data-cy":"description",onClick:B=>q(o.id)},null,8,["tip","onClick"]),s(T,{permission:{feature:"module",action:"edit"},icon:"icon-xiazai-wenjianxiazai-05",tip:n(e)("common.export"),"data-cy":"export",onClick:B=>r(o.name)},null,8,["tip","onClick"]),s(T,{permission:{feature:"module",action:"edit"},icon:"icon-link !bg-transparent",tip:n(e)("common.share"),"data-cy":"share",onClick:B=>J(o.id)},null,8,["tip","onClick"])]),_:1})]),_:1},8,["data"])):S("",!0),f.value?(i(),p(Oe,{key:1,modelValue:f.value,"onUpdate:modelValue":u[2]||(u[2]=o=>f.value=o)},null,8,["modelValue"])):S("",!0),c.value?(i(),p(re,{key:2,modelValue:c.value,"onUpdate:modelValue":u[3]||(u[3]=o=>c.value=o)},null,8,["modelValue"])):S("",!0),a.value?(i(),p(ze,{key:3,id:E.value,modelValue:a.value,"onUpdate:modelValue":u[4]||(u[4]=o=>a.value=o)},null,8,["id","modelValue"])):S("",!0),k.value?(i(),p(Ge,{key:4,id:E.value,modelValue:k.value,"onUpdate:modelValue":u[5]||(u[5]=o=>k.value=o)},null,8,["id","modelValue"])):S("",!0),s(ne,{modelValue:b.value,"onUpdate:modelValue":u[6]||(u[6]=o=>b.value=o),width:"1000px","close-on-click-modal":!1,"custom-class":"el-dialog--zero-padding",title:n(e)("common.manage"),onClosed:u[7]||(u[7]=o=>b.value=!1)},{default:d(()=>[w("iframe",{src:n(y),class:"w-full h-500px"},null,8,Ye)]),_:1},8,["modelValue","title"]),s(Be,{ref_key:"searchDialog",ref:g,module:"module",onReload:H},null,512)])}}});export{Xt as default};
