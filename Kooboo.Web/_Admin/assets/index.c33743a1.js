var ce=Object.defineProperty,de=Object.defineProperties;var fe=Object.getOwnPropertyDescriptors;var H=Object.getOwnPropertySymbols;var me=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable;var Z=(u,r,s)=>r in u?ce(u,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):u[r]=s,O=(u,r)=>{for(var s in r||(r={}))me.call(r,s)&&Z(u,s,r[s]);if(H)for(var s of H(r))ve.call(r,s)&&Z(u,s,r[s]);return u},D=(u,r)=>de(u,fe(r));import{i as K,w as pe,v as ge,T as be,u as L}from"./i18n.a87944a4.js";import{b as we,d as ke,m as _e,a2 as he,a3 as Ie,u as xe,f as Ce,E as k,B as ye,O as Ee,P as Ne,a4 as ze,a5 as Oe,a6 as Le,a7 as Te,_ as Ae,c as I,a8 as De,w as Me}from"./windi.6360286d.js";import{i as Ve}from"./browser.aedb6977.js";import{u as $e}from"./index.4d568055.js";import{d as Re,E as j,g as y,D as Se,ar as Be,c as x,i as W,L as Xe,h as Ye,o as E,j as G,b as l,w as b,f as m,n as f,u as a,k as N,a as M,F as q,l as Fe,b7 as Pe,e as He,m as J,r as Ze,aA as je}from"./url.4cb47a7a.js";import{t as V}from"./throttle.1f6a079c.js";const We=we({urlList:{type:ke(Array),default:()=>_e([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0}}),Ge={close:()=>!0,switch:u=>K(u)},qe=["src"],Je={name:"ElImageViewer"},Ke=Re(D(O({},Je),{props:We,emits:Ge,setup(u,{emit:r}){const s=u,C={CONTAIN:{name:"contain",icon:j(he)},ORIGINAL:{name:"original",icon:j(Ie)}},Q=Ve()?"DOMMouseScroll":"mousewheel",{t:U}=$e(),o=xe("image-viewer"),{nextZIndex:ee}=Ce(),T=y(),$=y([]),R=Se(),_=y(!0),v=y(s.initialIndex),z=Be(C.CONTAIN),i=y({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),ae=x(()=>{const{urlList:e}=s;return e.length<=1}),S=x(()=>v.value===0),B=x(()=>v.value===s.urlList.length-1),te=x(()=>s.urlList[v.value]),se=x(()=>{const{scale:e,deg:t,offsetX:n,offsetY:c,enableTransition:p}=i.value;let d=n/e,g=c/e;switch(t%360){case 90:case-270:[d,g]=[g,-d];break;case 180:case-180:[d,g]=[-d,-g];break;case 270:case-90:[d,g]=[-g,d];break}const h={transform:`scale(${e}) rotate(${t}deg) translate(${d}px, ${g}px)`,transition:p?"transform .3s":""};return z.value.name===C.CONTAIN.name&&(h.maxWidth=h.maxHeight="100%"),h}),ne=x(()=>K(s.zIndex)?s.zIndex:ee());function A(){le(),r("close")}function oe(){const e=V(n=>{switch(n.code){case I.esc:s.closeOnPressEscape&&A();break;case I.space:Y();break;case I.left:F();break;case I.up:w("zoomIn");break;case I.right:P();break;case I.down:w("zoomOut");break}}),t=V(n=>{(n.wheelDelta?n.wheelDelta:-n.detail)>0?w("zoomIn",{zoomRate:1.2,enableTransition:!1}):w("zoomOut",{zoomRate:1.2,enableTransition:!1})});R.run(()=>{L(document,"keydown",e),L(document,Q,t)})}function le(){R.stop()}function re(){_.value=!1}function ie(e){_.value=!1,e.target.alt=U("el.image.error")}function ue(e){if(_.value||e.button!==0||!T.value)return;i.value.enableTransition=!1;const{offsetX:t,offsetY:n}=i.value,c=e.pageX,p=e.pageY,d=V(h=>{i.value=D(O({},i.value),{offsetX:t+h.pageX-c,offsetY:n+h.pageY-p})}),g=L(document,"mousemove",d);L(document,"mouseup",()=>{g()}),e.preventDefault()}function X(){i.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function Y(){if(_.value)return;const e=De(C),t=Object.values(C),n=z.value.name,p=(t.findIndex(d=>d.name===n)+1)%e.length;z.value=C[e[p]],X()}function F(){if(S.value&&!s.infinite)return;const e=s.urlList.length;v.value=(v.value-1+e)%e}function P(){if(B.value&&!s.infinite)return;const e=s.urlList.length;v.value=(v.value+1)%e}function w(e,t={}){if(_.value)return;const{zoomRate:n,rotateDeg:c,enableTransition:p}=O({zoomRate:1.4,rotateDeg:90,enableTransition:!0},t);switch(e){case"zoomOut":i.value.scale>.2&&(i.value.scale=Number.parseFloat((i.value.scale/n).toFixed(3)));break;case"zoomIn":i.value.scale<7&&(i.value.scale=Number.parseFloat((i.value.scale*n).toFixed(3)));break;case"clockwise":i.value.deg+=c;break;case"anticlockwise":i.value.deg-=c;break}i.value.enableTransition=p}return W(te,()=>{Xe(()=>{const e=$.value[0];e!=null&&e.complete||(_.value=!0)})}),W(v,e=>{X(),r("switch",e)}),Ye(()=>{var e,t;oe(),(t=(e=T.value)==null?void 0:e.focus)==null||t.call(e)}),(e,t)=>(E(),G(je,{to:"body",disabled:!e.teleported},[l(be,{name:"viewer-fade",appear:""},{default:b(()=>[m("div",{ref_key:"wrapper",ref:T,tabindex:-1,class:f(a(o).e("wrapper")),style:J({zIndex:a(ne)})},[m("div",{class:f(a(o).e("mask")),onClick:t[0]||(t[0]=pe(n=>e.hideOnClickModal&&A(),["self"]))},null,2),N(" CLOSE "),m("span",{class:f([a(o).e("btn"),a(o).e("close")]),onClick:A},[l(a(k),null,{default:b(()=>[l(a(ye))]),_:1})],2),N(" ARROW "),a(ae)?N("v-if",!0):(E(),M(q,{key:0},[m("span",{class:f([a(o).e("btn"),a(o).e("prev"),a(o).is("disabled",!e.infinite&&a(S))]),onClick:F},[l(a(k),null,{default:b(()=>[l(a(Ee))]),_:1})],2),m("span",{class:f([a(o).e("btn"),a(o).e("next"),a(o).is("disabled",!e.infinite&&a(B))]),onClick:P},[l(a(k),null,{default:b(()=>[l(a(Ne))]),_:1})],2)],64)),N(" ACTIONS "),m("div",{class:f([a(o).e("btn"),a(o).e("actions")])},[m("div",{class:f(a(o).e("actions__inner"))},[l(a(k),{onClick:t[1]||(t[1]=n=>w("zoomOut"))},{default:b(()=>[l(a(ze))]),_:1}),l(a(k),{onClick:t[2]||(t[2]=n=>w("zoomIn"))},{default:b(()=>[l(a(Oe))]),_:1}),m("i",{class:f(a(o).e("actions__divider"))},null,2),l(a(k),{onClick:Y},{default:b(()=>[(E(),G(Fe(a(z).icon)))]),_:1}),m("i",{class:f(a(o).e("actions__divider"))},null,2),l(a(k),{onClick:t[3]||(t[3]=n=>w("anticlockwise"))},{default:b(()=>[l(a(Le))]),_:1}),l(a(k),{onClick:t[4]||(t[4]=n=>w("clockwise"))},{default:b(()=>[l(a(Te))]),_:1})],2)],2),N(" CANVAS "),m("div",{class:f(a(o).e("canvas"))},[(E(!0),M(q,null,Pe(e.urlList,(n,c)=>He((E(),M("img",{ref_for:!0,ref:p=>$.value[c]=p,key:n,src:n,style:J(a(se)),class:f(a(o).e("img")),onLoad:re,onError:ie,onMousedown:ue},null,46,qe)),[[ge,c===v.value]])),128))],2),Ze(e.$slots,"default")],6)]),_:3})],8,["disabled"]))}}));var Qe=Ae(Ke,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const la=Me(Qe);export{la as E};
