var N=(e,m,t)=>new Promise((u,p)=>{var a=l=>{try{r(t.next(l))}catch(f){p(f)}},g=l=>{try{r(t.throw(l))}catch(f){p(f)}},r=l=>l.done?u(l.value):Promise.resolve(l.value).then(a,g);r((t=t.apply(e,m)).next())});import{g as w}from"./i18n.a87944a4.js";import{I as Q}from"./commerce.ded2851e.js";import{S as W}from"./search-input.2a27ef56.js";import{s as X}from"./commerce.f69dd9fe.js";import{E as U}from"./index.361e2245.js";import{E as I}from"./index.6f16842c.js";import{E as F,a as z}from"./index.7c862087.js";import{E as Y}from"./index.c6da2706.js";import{E as L}from"./index.7df1cda1.js";import{d as B,g as _,c as Z,o as x,j as V,w as b,f as i,b as o,u as n,aI as j,t as y,a as h,b7 as D,F as J,k as P}from"./url.4cb47a7a.js";import{_ as q}from"./icon-button.74ccc970.js";import{a as ee}from"./tax.a38e7edd.js";import{_ as R}from"./condition.17b45051.js";import{E as G,a as te}from"./index.9fd79879.js";const ne={class:"flex justify-between"},oe={class:"divide-y divide-line divide-solid"},ae={class:"w-180px"},se={class:"flex items-center gap-4"},le=i("span",{class:"dark:text-[#cfd3dc]"},"%",-1),de=B({props:{regions:null,list:null,baseTax:null},setup(e){const m=e,{t}=w(),u=_(1),p=_(6),a=_(""),g=Z(()=>{var k,$;let s=[];const d=($=(k=a.value)==null?void 0:k.toLowerCase())==null?void 0:$.trim();for(const T of m.regions)d&&!JSON.stringify(T).toLowerCase().includes(d)||s.push(T);const c=(u.value-1)*p.value;return{list:s.slice(c,c+p.value),count:s.length}});function r(){a.value="",m.list.splice(0,m.list.length)}function l(s){return m.list.find(d=>d.region==s)}function f(s,d){let c=l(s);c?c.tax=d:(c={region:s,tax:d,type:"Added"},m.list.push(c))}function E(s,d){let c=l(s);c?c.type=d:(c={region:s,tax:0,type:d},m.list.push(c))}return(s,d)=>{const c=W,k=U,$=I,T=F,H=z,K=Y,M=L;return x(),V(M,{shadow:!1,class:"w-full max-w-800px"},{header:b(()=>[i("div",ne,[o(c,{modelValue:a.value,"onUpdate:modelValue":d[0]||(d[0]=v=>a.value=v),class:"w-208px",placeholder:n(t)("common.keyword")},null,8,["modelValue","placeholder"]),o(k,{round:"",onClick:r},{default:b(()=>[j(y(n(t)("common.reset")),1)]),_:1})])]),default:b(()=>[i("div",oe,[(x(!0),h(J,null,D(n(g).list,v=>{var C,A,S;return x(),h("div",{key:v.name,class:"flex items-center gap-12 py-8"},[i("div",ae,y(n(X)((C=e.regions.find(O=>O.name==v.name))==null?void 0:C.nameTranslations,v.name)),1),i("div",se,[o($,{"model-value":((A=l(v.name))==null?void 0:A.tax)||0,step:.1,min:0,"onUpdate:modelValue":O=>f(v.name,O)},null,8,["model-value","step","onUpdate:modelValue"]),le]),o(H,{"model-value":((S=l(v.name))==null?void 0:S.type)||"Added",class:"flex-1","onUpdate:modelValue":O=>E(v.name,O)},{default:b(()=>[o(T,{value:"Added",label:n(t)("common.addedToBaseTax",{tax:e.baseTax})},null,8,["label"]),o(T,{value:"Instead",label:n(t)("common.insteadOfBaseTax",{tax:e.baseTax})},null,8,["label"]),o(T,{value:"Compounded",label:n(t)("common.compoundedOnTopOfBaseTax",{tax:e.baseTax})},null,8,["label"])]),_:2},1032,["model-value","onUpdate:modelValue"])])}),128)),o(K,{class:"pt-12",layout:"prev, pager, next","page-size":p.value,total:n(g).count,onCurrentChange:d[1]||(d[1]=v=>u.value=v)},null,8,["page-size","total"])])]),_:1})}}}),ce={key:0,class:"space-y-8"},ie={class:"flex items-start"},me={class:"flex gap-12 flex-1"},re={class:"flex items-center gap-4"},ue=i("span",{class:"dark:text-[#cfd3dc]"},"%",-1),pe={class:"flex items-end"},xe={class:"flex items-center space-x-4"},fe={key:0,class:"dark:text-[#cfd3dc]"},ve={key:1,class:"dark:text-[#cfd3dc]"},be={key:2,class:"dark:text-[#cfd3dc]"},ge=B({props:{item:null,schemas:null,baseTax:null},emits:["remove"],setup(e){const m=e,{t}=w(),u=_(!!m.item.editing);return(p,a)=>{const g=I,r=F,l=z,f=q,E=U;return u.value?(x(),h("div",ce,[i("div",ie,[i("div",me,[i("div",re,[o(g,{modelValue:e.item.tax,"onUpdate:modelValue":a[0]||(a[0]=s=>e.item.tax=s),step:.1,min:0},null,8,["modelValue","step"]),ue]),o(l,{modelValue:e.item.type,"onUpdate:modelValue":a[1]||(a[1]=s=>e.item.type=s),class:"w-300px"},{default:b(()=>[o(r,{value:"Added",label:n(t)("common.addedToBaseTaxAndRegionOverrides",{tax:e.baseTax})},null,8,["label"]),o(r,{value:"Instead",label:n(t)("common.insteadOfBaseTaxAndRegionOverrides",{tax:e.baseTax})},null,8,["label"]),o(r,{value:"Compounded",label:n(t)("common.compoundedOnTopOfBaseTaxAndRegionOverrides",{tax:e.baseTax})},null,8,["label"])]),_:1},8,["modelValue"])]),o(f,{circle:"",class:"hover:text-orange text-orange",icon:"icon-delete ",tip:n(t)("common.delete"),onClick:a[2]||(a[2]=s=>p.$emit("remove"))},null,8,["tip"])]),i("div",pe,[e.schemas.length?(x(),V(R,{key:0,condition:e.item.condition,schemas:e.schemas,title:n(t)("commerce.product"),class:"flex-1"},null,8,["condition","schemas","title"])):P("",!0),o(E,{round:"",type:"primary",onClick:a[3]||(a[3]=s=>u.value=!1)},{default:b(()=>[j(y(n(t)("common.done")),1)]),_:1})])])):(x(),h("div",{key:1,class:"cursor-pointer",onClick:a[4]||(a[4]=s=>u.value=!0)},[o(R,{condition:e.item.condition,schemas:e.schemas,title:n(t)("commerce.product"),readonly:""},null,8,["condition","schemas","title"]),i("div",xe,[i("span",null,y(n(t)("common.using")),1),i("span",null,y(e.item.tax)+"%",1),e.item.type=="Added"?(x(),h("span",fe,y(n(t)("common.addedToBaseTaxAndRegionOverrides",{tax:e.baseTax})),1)):e.item.type=="Instead"?(x(),h("span",ve,y(n(t)("common.insteadOfBaseTaxAndRegionOverrides",{tax:e.baseTax})),1)):(x(),h("span",be,y(n(t)("common.compoundedOnTopOfBaseTaxAndRegionOverrides",{tax:e.baseTax})),1))])]))}}}),he={class:"space-y-8 w-full"},ye=B({props:{list:null,baseTax:null},setup(e){const m=e,t=_([]);function u(){return N(this,null,function*(){t.value=yield ee()})}u();const{t:p}=w();function a(){m.list.push({tax:0,type:"Added",condition:{isAny:!1,items:[]},editing:!0})}function g(r){m.list.splice(r,1)}return(r,l)=>{const f=L,E=q,s=G;return x(),V(s,{label:n(p)("common.productOverrides")},{default:b(()=>[i("div",he,[(x(!0),h(J,null,D(e.list,(d,c)=>(x(),V(f,{key:c,class:"relative mb-8 w-820px",shadow:!1},{default:b(()=>[o(ge,{"base-tax":e.baseTax,item:d,schemas:t.value,onRemove:k=>g(c)},null,8,["base-tax","item","schemas","onRemove"])]),_:2},1024))),128)),o(E,{circle:"",class:"text-blue",icon:"icon-a-addto",tip:n(p)("common.add"),onClick:a},null,8,["tip"])])]),_:1},8,["label"])}}}),Te={class:"px-24 pt-0 pb-84px space-y-12"},_e={class:"bg-fff dark:bg-[#252526] px-24 py-16 rounded-normal"},Ee={class:"flex items-center gap-4"},ke=i("span",{class:"dark:text-[#cfd3dc]"},"%",-1),je=B({props:{model:null},setup(e){const m=e,{t}=w(),u=_([]);return Q(m.model.country).then(p=>u.value=p),(p,a)=>{const g=I,r=G,l=te;return x(),h("div",Te,[i("div",_e,[o(l,{"label-position":"top"},{default:b(()=>[o(r,{label:n(t)("common.baseTax")},{default:b(()=>[i("div",Ee,[o(g,{modelValue:e.model.baseTax,"onUpdate:modelValue":a[0]||(a[0]=f=>e.model.baseTax=f),step:.1,min:0},null,8,["modelValue","step"]),ke])]),_:1},8,["label"]),u.value.length?(x(),V(r,{key:0,label:n(t)("common.regionOverrides")},{default:b(()=>[o(de,{regions:u.value,list:e.model.regionOverrides,"base-tax":e.model.baseTax},null,8,["regions","list","base-tax"])]),_:1},8,["label"])):P("",!0),o(ye,{list:e.model.productOverrides,"base-tax":e.model.baseTax},null,8,["list","base-tax"])]),_:1})])])}}});export{je as _};
