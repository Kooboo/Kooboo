var V=(w,t,s)=>new Promise((D,d)=>{var _=m=>{try{p(s.next(m))}catch(n){d(n)}},e=m=>{try{p(s.throw(m))}catch(n){d(n)}},p=m=>m.done?D(m.value):Promise.resolve(m.value).then(_,e);p((s=s.apply(w,t)).next())});import{g as S,o as h}from"./i18n.a87944a4.js";import{a as F}from"./index.d2657986.js";import{x as B,L as T,H as C}from"./main.9fdfea92.js";import{a as N,r as g,b as K,d as L,i as $,s as j}from"./validate.bb56f9e3.js";import{d as A,g as v,cd as H,i as y,o as x,a as R,f as b,t as E,u as l,b as i,w as u,F as M,b7 as O,j as Q,aI as z,x as G}from"./url.4cb47a7a.js";import{E as J}from"./index.178b9e08.js";import{E as P,a as W}from"./index.9fd79879.js";import{E as X,a as Y}from"./index.7c862087.js";import{E as Z}from"./index.361e2245.js";import"./index.50c16ae5.js";import"./windi.6360286d.js";import"./preload-helper.13a99eb0.js";import"./replace-all.56d2c1f7.js";import"./index.d24a40b9.js";import"./index.f23f1e38.js";import"./index.a24f458a.js";import"./index.1fd72ea8.js";import"./index.abe211fa.js";import"./style.c350d462.js";import"./toNumber.47eea968.js";import"./_baseIsEqual.dc9e64c4.js";import"./event.776e7e11.js";import"./index.7b8c5aef.js";import"./error.7e8331f1.js";import"./isNil.98bb3b88.js";import"./_baseClone.b8903935.js";import"./isEqual.4cab74e3.js";import"./index.d96452a6.js";import"./focus-trap.50a00b7f.js";import"./event.53b2ad83.js";import"./index.fd96ea36.js";import"./index.4d568055.js";import"./scroll.16983984.js";import"./debounce.4e0c106e.js";import"./index.66319a92.js";import"./validator.b5df2420.js";const ee={class:"text-444 dark:text-fff/86"},oe={class:"text-3l mb-8"},ae={class:"text-s"},te={class:"border-t border-b border-line dark:border-[#555] border-solid my-24 py-24"},se={class:"flex items-center space-x-8"},He=A({setup(w){const{t}=S(),s=v(),D=H(),d=v(!1),_=v(!1),e=v({subDomain:"",rootDomain:"",siteName:"",sudDomainUseDash:!1}),p={subDomain:[N(t("common.subDomainRequiredTips")),g(1,63),K,L(e.value)],rootDomain:N(t("common.rootDomainRequiredTips")),siteName:[g(1,50),N(t("common.nameRequiredTips")),$(B,t("common.siteNameExistsTips")),j()]},m=v();F().then(r=>{s.value=r,s.value.length&&(e.value.rootDomain=s.value[0].domainName)});const n=()=>V(this,null,function*(){yield m.value.validate();const r=yield T(e.value),o=G("currentFolder");o&&(yield C({siteIds:[r.id],folderName:o})),D.push({name:"home",query:{currentFolder:o}})});return y(()=>e.value.subDomain,()=>{d.value||(e.value.siteName=e.value.subDomain)}),y(()=>e.value.rootDomain,()=>{var r,o,c;e.value.sudDomainUseDash=(c=(o=(r=s.value)==null?void 0:r.find(f=>f.domainName==e.value.rootDomain))==null?void 0:o.sudDomainUseDash)!=null?c:!1}),y(()=>e.value.siteName,()=>{_.value||(e.value.subDomain=e.value.siteName)}),(r,o)=>{const c=J,f=P,U=X,k=Y,q=W,I=Z;return x(),R("div",ee,[b("p",oe,E(l(t)("common.createSite")),1),b("p",ae,E(l(t)("common.createTips")),1),b("div",te,[i(q,{ref_key:"form",ref:m,"label-position":"top",model:e.value,rules:l(p),onKeydown:h(n,["enter"])},{default:u(()=>[i(f,{label:l(t)("common.siteName"),prop:"siteName"},{default:u(()=>[i(c,{modelValue:e.value.siteName,"onUpdate:modelValue":o[0]||(o[0]=a=>e.value.siteName=a),modelModifiers:{trim:!0},class:"w-304px","data-cy":"siteName",onInput:o[1]||(o[1]=a=>d.value=!0)},null,8,["modelValue"])]),_:1},8,["label"]),b("div",se,[i(f,{label:l(t)("common.domain"),prop:"subDomain"},{default:u(()=>[i(c,{modelValue:e.value.subDomain,"onUpdate:modelValue":o[2]||(o[2]=a=>e.value.subDomain=a),class:"w-304px","data-cy":"subdomain",onInput:o[3]||(o[3]=a=>_.value=!0)},null,8,["modelValue"])]),_:1},8,["label"]),i(f,{prop:"rootDomain",class:"mt-30px"},{default:u(()=>[i(k,{modelValue:e.value.rootDomain,"onUpdate:modelValue":o[4]||(o[4]=a=>e.value.rootDomain=a),"data-cy":"root-domain",class:"!w-300px"},{default:u(()=>[(x(!0),R(M,null,O(s.value,a=>(x(),Q(U,{key:a.domainName,value:a.domainName,label:(a.sudDomainUseDash?"-":".")+a.domainName,"data-cy":"root-domain-opt"},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),_:1},8,["model","rules","onKeydown"])]),i(I,{round:"",type:"primary","data-cy":"start-create",onClick:n},{default:u(()=>[z(E(l(t)("common.startCreate")),1)]),_:1})])}}});export{He as default};
