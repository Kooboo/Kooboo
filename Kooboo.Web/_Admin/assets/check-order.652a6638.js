var w=(R,a,_)=>new Promise((f,c)=>{var b=i=>{try{u(_.next(i))}catch(g){c(g)}},h=i=>{try{u(_.throw(i))}catch(g){c(g)}},u=i=>i.done?f(i.value):Promise.resolve(i.value).then(b,h);u((_=_.apply(R,a)).next())});import{g as ae,w as le}from"./i18n.97105311.js";import{d as oe,cd as se,g as v,x as ne,i as J,J as re,o as m,a as p,b as s,u as n,f as t,t as r,w as x,F as E,b6 as N,n as me,k as C,j,aH as ie}from"./url.2e6a77c4.js";import{a as V,r as ce,X as ue}from"./validate.98ddbafd.js";import{d as de}from"./main.52487121.js";import{I as pe,A as fe,B as ve,C as xe,D as _e}from"./index.934159ee.js";import{V as be}from"./vue-qr.a14aeae7.js";import{E as he}from"./windi.539ebeab.js";import{E as ye}from"./index.6ebaed6b.js";import{E as ge,a as ke}from"./index.13bfae9f.js";import{E as we}from"./index.4587e608.js";import{E as Ce,a as Ve}from"./index.317a7f30.js";import{E as Ie,a as Ee}from"./index.afee24fe.js";import{E as Ne}from"./index.b09a9f00.js";import"./index.99641a60.js";import"./index.77759eed.js";import"./replace-all.8fa5a83d.js";import"./index.b1fe55d8.js";import"./index.51a59403.js";import"./index.29d7c76d.js";import"./style.f835519e.js";import"./toNumber.574be4f1.js";import"./_baseIsEqual.abb55a3a.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./error.7e8331f1.js";import"./event.776e7e11.js";import"./index.9e96921b.js";import"./isNil.98bb3b88.js";import"./_baseClone.f10ff33c.js";import"./isEqual.3700b7f1.js";import"./index.9589f7cf.js";import"./focus-trap.de18cf8f.js";import"./event.53b2ad83.js";import"./index.f997a738.js";import"./index.bc93d068.js";import"./scroll.8babc10c.js";import"./debounce.61c67278.js";import"./index.a46fa52c.js";import"./validator.1d438d08.js";const Te={class:"p-24 dark:text-[#fffa] overflow-x-hidden"},je={class:"text-000 dark:text-[#fffa] text-52px font-medium mt-4 mb-24px h-73px leading-73px"},Re={class:"jumbotron flex"},Pe={class:"px-6 pt-5 pb-32 bg-fff dark:bg-[#333] w-620px mr-40px rounded-normal shadow-s-10 flex-shrink-0"},Se={class:"flex justify-between items-center h-28px leading-28px"},qe={class:"text-20px font-medium text-000 dark:text-[#fffa]"},Oe={class:"space-y-8 text-000 dark:text-[#fffa] text-opacity-65 text-m"},Ue={class:"ellipsis"},$e=["innerHTML"],De={class:"text-20px font-medium text-000 dark:text-[#fffa] mb-4"},Be={key:0},Fe={class:"space-x-24 flex mb-28px"},He=["onClick"],Le={class:"flex items-center"},Me={class:"flex items-center justify-between space-x-16"},ze={class:"flex items-center justify-between mt-6px"},Ae={key:1,class:"w-180px h-220px mx-auto"},We={key:0,class:"flex flex-col"},Je=t("div",{class:"flex items-center justify-center h-auto"},[t("img",{class:"transform scale-80 -m-12",src:"https://td.cdn-go.cn/enterprise_payment/v0.0.9/logo.png"})],-1),Qe={class:"px-6 pt-5 pb-44px bg-fff dark:bg-[#333] text-m w-500px rounded-normal shadow-s-10 text-000 dark:text-[#fffa]",style:{height:"fit-content"}},Xe={class:"text-20px font-medium"},Ye={class:"text-000 dark:text-[#fffa]"},Ge={class:"space-y-8 mb-8"},Ke={class:"flex justify-between items-center h-5 leading-5"},Ze={class:"flex justify-between items-center h-5 leading-5"},et={class:"flex justify-between items-center font-medium h-60px text-20px mt-28px mb-37px border-t-1 border-b-1 border-[#dcdfe6] dark:border-[#4c4d4f]"},tt={class:"flex items-center justify-center"},At=oe({setup(R){const{t:a}=ae(),_=se(),f=v("CreditCard"),c=v(!1);let b;const h=v(),u=v(),i=v({id:"",type:"",isDefault:!1,display:""}),g=d=>{i.value=JSON.parse(JSON.stringify(d)),c.value=!1},l=v({cardNumber:"",year:"",month:"",name:"",cvc:""}),Q={name:[V(a("common.fieldRequiredTips")),ce(1,50)],cardNumber:[V(a("common.fieldRequiredTips"))],year:[V(a("common.fieldRequiredTips"))],month:[V(a("common.fieldRequiredTips"))],cvc:[V(a("common.fieldRequiredTips")),ue()]},P=v(),X=v([1,2,3,4,5,6,7,8,9,10,11,12]),Y=v([2023,2024,2025,2026,2027,2028,2029,2030,2031,2032,2033,2034,2035,2036,2037,2038,2039,2040,2041,2042,2043,2044,2045,2046,2047,2048,2049,2050,2051,2052,2053,2054,2055,2056,2057,2058,2059,2060,2061,2062,2063,2064,2065,2066,2067,2068,2069,2070,2071,2072,2073]),I=v(),y=ne("orderId"),G=()=>w(this,null,function*(){let d;c.value?(yield P.value.validate(),d=yield fe({name:l.value.name,cardNumber:l.value.cardNumber.replaceAll("-",""),year:l.value.year,month:l.value.month,cvc:l.value.cvc,orderId:y})):d=yield ve(i.value.id,y),d.success?_.push({name:"consoleOrder"}):window.location.href=d.redirectUrl});J(()=>c.value,()=>{c.value||(l.value.cardNumber="",l.value.year="",l.value.month="",l.value.name="",l.value.cvc="")}),(()=>w(this,null,function*(){y&&(u.value=yield xe(y)),h.value=yield _e(),h.value.length&&(i.value=h.value.filter(d=>d.isDefault)[0])}))();function K(){return w(this,null,function*(){var d=`marketOrder/CheckStatus?id=${I.value.requestId}`,o=yield de.get(d,void 0,{hiddenLoading:!0});o.paid&&(clearInterval(b),_.push({name:"consoleOrder"}))})}return J(()=>f.value,()=>w(this,null,function*(){f.value==="WechatPay"&&y?(I.value=yield pe(y),b=setInterval(K,1e3)):clearInterval(b)})),re(()=>{clearInterval(b)}),(d,o)=>{var D,B,F,H,L,M,z,A;const S=he,q=ye,O=ge,Z=ke,T=we,k=Ce,U=Ie,$=Ee,ee=Ve,te=Ne;return m(),p("div",Te,[s(S,{class:"iconfont icon-fanhui1 cursor-pointer hover:text-blue",title:n(a)("common.back"),onClick:o[0]||(o[0]=e=>d.$router.back())},null,8,["title"]),t("h1",je,r(n(a)("order.checkout")),1),t("div",Re,[t("div",Pe,[t("div",Se,[t("h1",qe,r((D=u.value)==null?void 0:D.title),1)]),t("ul",Oe,[t("li",Ue,[t("div",{innerHTML:(B=u.value)==null?void 0:B.summary},null,8,$e)])]),s(q,{class:"mt-28px mb-20px"}),t("h1",De,r(n(a)("common.paymentMethod")),1),s(Z,{modelValue:f.value,"onUpdate:modelValue":o[1]||(o[1]=e=>f.value=e),class:"el-tabs--hide-content partnerTab mb-28px"},{default:x(()=>[s(O,{label:n(a)("common.creditCard"),name:"CreditCard"},null,8,["label"]),s(O,{label:n(a)("common.wechatPay"),name:"WechatPay"},null,8,["label"])]),_:1},8,["modelValue"]),f.value==="CreditCard"?(m(),p("div",Be,[t("div",Fe,[(m(!0),p(E,null,N(h.value,e=>{var W;return m(),p("div",{key:e.display,class:me(["w-94px h-36px rounded-full flex items-center justify-center cursor-pointer",e.id===((W=i.value)==null?void 0:W.id)&&!c.value?"bg-blue text-fff":"bg-[#192845] bg-opacity-5 dark:bg-666"]),onClick:lt=>g(e)}," *"+r(e.display),11,He)}),128)),c.value?C("",!0):(m(),p("div",{key:0,class:"w-36px h-36px rounded-full bg-blue flex items-center justify-center cursor-pointer",onClick:o[2]||(o[2]=e=>c.value=!0)},[s(S,{class:"iconfont icon-a-addto text-fff font-medium"})]))]),c.value?(m(),j(ee,{key:0,ref_key:"form",ref:P,model:l.value,rules:Q,"label-position":"top",onSubmit:o[10]||(o[10]=le(()=>{},["prevent"]))},{default:x(()=>[t("div",Le,[s(k,{prop:"cardNumber",label:n(a)("common.cardNumber"),class:"!mr-32"},{default:x(()=>[s(T,{modelValue:l.value.cardNumber,"onUpdate:modelValue":o[3]||(o[3]=e=>l.value.cardNumber=e),class:"w-260px",maxlength:"19",placeholder:"0000-0000-0000-0000",onInput:o[4]||(o[4]=e=>l.value.cardNumber=l.value.cardNumber.replace(/\s/g,"").replace(/[^\d]/g,"").replace(/(\d{4})(?=\d)/g,"$1-"))},null,8,["modelValue"])]),_:1},8,["label"]),t("div",Me,[s(k,{prop:"month",label:n(a)("common.expirationDate"),class:"flex-1"},{default:x(()=>[s($,{modelValue:l.value.month,"onUpdate:modelValue":o[5]||(o[5]=e=>l.value.month=e),class:"",placeholder:n(a)("common.month"),size:"large"},{default:x(()=>[(m(!0),p(E,null,N(X.value,e=>(m(),j(U,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),s(k,{prop:"year",class:"flex-1 yearFormItem",label:" "},{default:x(()=>[s($,{modelValue:l.value.year,"onUpdate:modelValue":o[6]||(o[6]=e=>l.value.year=e),class:"",placeholder:n(a)("common.year"),size:"large"},{default:x(()=>[(m(!0),p(E,null,N(Y.value,e=>(m(),j(U,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1})])]),t("div",ze,[s(k,{prop:"name",label:n(a)("common.nameOnCard"),class:"mr-32"},{default:x(()=>[s(T,{modelValue:l.value.name,"onUpdate:modelValue":o[7]||(o[7]=e=>l.value.name=e),class:"w-260px",placeholder:n(a)("common.enterYourNameHere")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(k,{prop:"cvc",label:n(a)("common.cvc"),class:"flex-1"},{default:x(()=>[s(T,{modelValue:l.value.cvc,"onUpdate:modelValue":o[8]||(o[8]=e=>l.value.cvc=e),class:"w-full",maxlength:"3",placeholder:n(a)("common.enterCVCHere"),onInput:o[9]||(o[9]=e=>l.value.cvc=l.value.cvc.replace(/\s/g,"").replace(/[^\d]/g,""))},null,8,["modelValue","placeholder"])]),_:1},8,["label"])])]),_:1},8,["model"])):C("",!0)])):C("",!0),f.value==="WechatPay"?(m(),p("div",Ae,[I.value?(m(),p("div",We,[s(be,{text:I.value.nextAction.responseData,size:2e3,class:"transform scale-75"},null,8,["text"]),Je])):C("",!0)])):C("",!0)]),t("div",Qe,[t("h1",Xe,r(n(a)("common.orderSummary")),1),(m(!0),p(E,null,N((F=u.value)==null?void 0:F.items,e=>(m(),p("div",{key:e.name,class:"flex justify-between items-center h-6 leading-6 text-m my-8"},[t("span",null,r(e.name),1),t("span",Ye,r(e.price),1)]))),128)),s(q,{class:"mb-28px mt-5"}),t("ul",Ge,[t("li",Ke,[t("span",null,r(n(a)("common.subtotal")),1),t("span",null,r((H=u.value)==null?void 0:H.subTotal),1)]),t("li",Ze,[t("span",null,r(n(a)("common.vat")),1),t("span",null,r((L=u.value)==null?void 0:L.tax),1)])]),t("div",et,[t("span",null,r(n(a)("common.total"))+" ("+r((M=u.value)==null?void 0:M.currency)+")",1),t("span",null,r((z=u.value)==null?void 0:z.total),1)]),t("span",tt,[s(te,{type:"primary",round:"",class:"w-300px",disabled:f.value==="WechatPay"||!c.value&&((A=i.value)==null?void 0:A.id)==="",onClick:G},{default:x(()=>[ie(r(f.value==="CreditCard"?n(a)("common.submitPayment"):n(a)("common.scanToPay")),1)]),_:1},8,["disabled"])])])])])}}});export{At as default};
