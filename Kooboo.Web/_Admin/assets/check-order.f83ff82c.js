var Fe=Object.defineProperty;var le=Object.getOwnPropertySymbols;var Ne=Object.prototype.hasOwnProperty,Re=Object.prototype.propertyIsEnumerable;var ue=Math.pow,ce=(i,t,e)=>t in i?Fe(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Mt=(i,t)=>{for(var e in t||(t={}))Ne.call(t,e)&&ce(i,e,t[e]);if(le)for(var e of le(t))Re.call(t,e)&&ce(i,e,t[e]);return i};var ct=(i,t,e)=>new Promise((r,o)=>{var n=l=>{try{s(e.next(l))}catch(u){o(u)}},a=l=>{try{s(e.throw(l))}catch(u){o(u)}},s=l=>l.done?r(l.value):Promise.resolve(l.value).then(n,a);s((e=e.apply(i,t)).next())});import{g as Oe,w as $e}from"./i18n.25caaace.js";import{o as Q,a as it,k as At,d as je,cd as Ue,g as ft,x as ze,i as fe,J as Ge,b as K,u as X,f as F,t as Y,w as dt,F as Ft,b6 as Nt,n as He,j as Xt,aH as Ve}from"./url.8f5ec20c.js";import{a as Et,r as Ke,X as Xe}from"./validate.f3c0b03b.js";import{d as Ze}from"./main.1c3b59e3.js";import{I as Je,A as We,B as qe,C as Ye,D as Qe}from"./index.7247b296.js";import{_ as tr}from"./plugin-vue_export-helper.21dcd24c.js";import{E as er}from"./windi.a815125a.js";import{E as rr}from"./index.e281bb71.js";import{E as or,a as nr}from"./index.4a9f2d0a.js";import{E as ir}from"./index.f571dfc9.js";import{E as ar,a as sr}from"./index.94998415.js";import{E as lr,a as cr}from"./index.960b9732.js";import{E as ur}from"./index.e9f8834a.js";import"./index.878e2bbf.js";import"./index.adb17f32.js";import"./replace-all.b35629e7.js";import"./index.b065185c.js";import"./index.ab12ea9e.js";import"./index.b1b64a44.js";import"./style.1b77b3a2.js";import"./toNumber.6efebd6a.js";import"./_baseIsEqual.0a4e01e5.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";import"./error.7e8331f1.js";import"./event.776e7e11.js";import"./index.1e7e06b8.js";import"./isNil.98bb3b88.js";import"./_baseClone.885c975f.js";import"./isEqual.2e410d13.js";import"./index.158cdd11.js";import"./focus-trap.81e4fb05.js";import"./event.53b2ad83.js";import"./index.c6488b3c.js";import"./index.f9c89813.js";import"./scroll.0cf77af8.js";import"./debounce.730e1961.js";import"./index.c93fe8e7.js";import"./validator.9b0d789f.js";function Zt(i){return i===""?i:i==="true"||i=="1"}function fr(i,t){return new Promise((e,r)=>{var o=new XMLHttpRequest;o.responseType="blob",o.onload=function(){var n=new FileReader;n.onloadend=function(){e(n.result)},n.readAsArrayBuffer(o.response)},o.open("GET",i),o.send()})}function ht(i){if(typeof i!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(i))}function de(i,t){for(var e="",r=0,o=-1,n=0,a,s=0;s<=i.length;++s){if(s<i.length)a=i.charCodeAt(s);else{if(a===47)break;a=47}if(a===47){if(!(o===s-1||n===1))if(o!==s-1&&n===2){if(e.length<2||r!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){var l=e.lastIndexOf("/");if(l!==e.length-1){l===-1?(e="",r=0):(e=e.slice(0,l),r=e.length-1-e.lastIndexOf("/")),o=s,n=0;continue}}else if(e.length===2||e.length===1){e="",r=0,o=s,n=0;continue}}t&&(e.length>0?e+="/..":e="..",r=2)}else e.length>0?e+="/"+i.slice(o+1,s):e=i.slice(o+1,s),r=s-o-1;o=s,n=0}else a===46&&n!==-1?++n:n=-1}return e}function dr(i,t){var e=t.dir||t.root,r=t.base||(t.name||"")+(t.ext||"");return e?e===t.root?e+r:e+i+r:r}var Ct={resolve:function(){for(var t="",e=!1,r,o=arguments.length-1;o>=-1&&!e;o--){var n;o>=0?n=arguments[o]:(r===void 0&&(r=process.cwd()),n=r),ht(n),n.length!==0&&(t=n+"/"+t,e=n.charCodeAt(0)===47)}return t=de(t,!e),e?t.length>0?"/"+t:"/":t.length>0?t:"."},normalize:function(t){if(ht(t),t.length===0)return".";var e=t.charCodeAt(0)===47,r=t.charCodeAt(t.length-1)===47;return t=de(t,!e),t.length===0&&!e&&(t="."),t.length>0&&r&&(t+="/"),e?"/"+t:t},isAbsolute:function(t){return ht(t),t.length>0&&t.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var t,e=0;e<arguments.length;++e){var r=arguments[e];ht(r),r.length>0&&(t===void 0?t=r:t+="/"+r)}return t===void 0?".":Ct.normalize(t)},relative:function(t,e){if(ht(t),ht(e),t===e||(t=Ct.resolve(t),e=Ct.resolve(e),t===e))return"";for(var r=1;r<t.length&&t.charCodeAt(r)===47;++r);for(var o=t.length,n=o-r,a=1;a<e.length&&e.charCodeAt(a)===47;++a);for(var s=e.length,l=s-a,u=n<l?n:l,c=-1,h=0;h<=u;++h){if(h===u){if(l>u){if(e.charCodeAt(a+h)===47)return e.slice(a+h+1);if(h===0)return e.slice(a+h)}else n>u&&(t.charCodeAt(r+h)===47?c=h:h===0&&(c=0));break}var y=t.charCodeAt(r+h),C=e.charCodeAt(a+h);if(y!==C)break;y===47&&(c=h)}var A="";for(h=r+c+1;h<=o;++h)(h===o||t.charCodeAt(h)===47)&&(A.length===0?A+="..":A+="/..");return A.length>0?A+e.slice(a+c):(a+=c,e.charCodeAt(a)===47&&++a,e.slice(a))},_makeLong:function(t){return t},dirname:function(t){if(ht(t),t.length===0)return".";for(var e=t.charCodeAt(0),r=e===47,o=-1,n=!0,a=t.length-1;a>=1;--a)if(e=t.charCodeAt(a),e===47){if(!n){o=a;break}}else n=!1;return o===-1?r?"/":".":r&&o===1?"//":t.slice(0,o)},basename:function(t,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');ht(t);var r=0,o=-1,n=!0,a;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";var s=e.length-1,l=-1;for(a=t.length-1;a>=0;--a){var u=t.charCodeAt(a);if(u===47){if(!n){r=a+1;break}}else l===-1&&(n=!1,l=a+1),s>=0&&(u===e.charCodeAt(s)?--s===-1&&(o=a):(s=-1,o=l))}return r===o?o=l:o===-1&&(o=t.length),t.slice(r,o)}else{for(a=t.length-1;a>=0;--a)if(t.charCodeAt(a)===47){if(!n){r=a+1;break}}else o===-1&&(n=!1,o=a+1);return o===-1?"":t.slice(r,o)}},extname:function(t){ht(t);for(var e=-1,r=0,o=-1,n=!0,a=0,s=t.length-1;s>=0;--s){var l=t.charCodeAt(s);if(l===47){if(!n){r=s+1;break}continue}o===-1&&(n=!1,o=s+1),l===46?e===-1?e=s:a!==1&&(a=1):e!==-1&&(a=-1)}return e===-1||o===-1||a===0||a===1&&e===o-1&&e===r+1?"":t.slice(e,o)},format:function(t){if(t===null||typeof t!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof t);return dr("/",t)},parse:function(t){ht(t);var e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;var r=t.charCodeAt(0),o=r===47,n;o?(e.root="/",n=1):n=0;for(var a=-1,s=0,l=-1,u=!0,c=t.length-1,h=0;c>=n;--c){if(r=t.charCodeAt(c),r===47){if(!u){s=c+1;break}continue}l===-1&&(u=!1,l=c+1),r===46?a===-1?a=c:h!==1&&(h=1):a!==-1&&(h=-1)}return a===-1||l===-1||h===0||h===1&&a===l-1&&a===s+1?l!==-1&&(s===0&&o?e.base=e.name=t.slice(1,l):e.base=e.name=t.slice(s,l)):(s===0&&o?(e.name=t.slice(1,a),e.base=t.slice(1,l)):(e.name=t.slice(s,a),e.base=t.slice(s,l)),e.ext=t.slice(a,l)),s>0?e.dir=t.slice(0,s-1):o&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};Ct.posix=Ct;const hr=Ct.extname,Ce=Ct.basename;class gr{constructor(){let t=(()=>typeof global=="undefined")(),e="image/png",r="image/jpeg",o="image/jpeg",n="image/webp",a="application/pdf",s="image/svg+xml";Object.assign(this,{toMime:this.toMime.bind(this),fromMime:this.fromMime.bind(this),expected:t?'"png", "jpg", or "webp"':'"png", "jpg", "pdf", or "svg"',formats:t?{png:e,jpg:r,jpeg:o,webp:n}:{png:e,jpg:r,jpeg:o,pdf:a,svg:s},mimes:t?{[e]:"png",[r]:"jpg",[n]:"webp"}:{[e]:"png",[r]:"jpg",[a]:"pdf",[s]:"svg"}})}toMime(t){return this.formats[(t||"").replace(/^\./,"").toLowerCase()]}fromMime(t){return this.mimes[t]}}function pr(i,{filename:t="",extension:e="",format:T,page:o,quality:n,matte:a,density:s,outline:l,archive:C}={}){var{fromMime:c,toMime:h,expected:y}=new gr,C=C||"canvas",A=T||e.replace(/@\d+x$/i,"")||hr(t),T=c(h(A)||A),R=h(T),p=i.length;if(!A)throw new Error("Cannot determine image format (use a filename extension or 'format' argument)");if(!T)throw new Error(`Unsupported file format "${A}" (expected ${y})`);if(!p)throw new RangeError("Canvas has no associated contexts (try calling getContext or newPage first)");let m,k,d=t.replace(/{(\d*)}/g,(v,w)=>(k=!0,w=parseInt(w,10),m=isFinite(w)?w:isFinite(m)?m:-1,"{}")),g=o>0?o-1:o<0?p+o:void 0;if(isFinite(g)&&g<0||g>=p)throw new RangeError(p==1?`Canvas only has a \u2018page 1\u2019 (${g} is out of bounds)`:`Canvas has pages 1\u2013${p} (${g} is out of bounds)`);if(i=isFinite(g)?[i[g]]:k||T=="pdf"?i:i.slice(-1),n===void 0)n=.92;else if(typeof n!="number"||!isFinite(n)||n<0||n>1)throw new TypeError("The quality option must be an number in the 0.0\u20131.0 range");if(s===void 0){let v=(e||Ce(t,A)).match(/@(\d+)x$/i);s=v?parseInt(v[1],10):1}else if(typeof s!="number"||!Number.isInteger(s)||s<1)throw new TypeError("The density option must be a non-negative integer");return l===void 0?l=!0:T=="svg"&&(l=!!l),{filename:t,pattern:d,format:T,mime:R,pages:i,padding:m,quality:n,matte:a,density:s,outline:l,archive:C}}class Ut{static for(t){return new Ut().append(t).get()}constructor(){this.crc=-1}get(){return~this.crc}append(t){for(var e=this.crc|0,r=this.table,o=0,n=t.length|0;o<n;o++)e=e>>>8^r[(e^t[o])&255];return this.crc=e,this}}Ut.prototype.table=(()=>{var i,t,e,r=[];for(i=0;i<256;i++){for(e=i,t=0;t<8;t++)e=e&1?e>>>1^3988292384:e>>>1;r[i]=e}return r})();function Jt(i){let t=new Uint8Array(i),e=new DataView(t.buffer),r={array:t,view:e,size:i,set8(o,n){return e.setUint8(o,n),r},set16(o,n){return e.setUint16(o,n,!0),r},set32(o,n){return e.setUint32(o,n,!0),r},bytes(o,n){return t.set(n,o),r}};return r}class zt{constructor(t){let e=new Date;Object.assign(this,{directory:t,offset:0,files:[],time:(e.getHours()<<6|e.getMinutes())<<5|e.getSeconds()/2,date:(e.getFullYear()-1980<<4|e.getMonth()+1)<<5|e.getDate()}),this.add(t)}add(t,e){return ct(this,null,function*(){let r=!e,o=zt.encoder.encode(`${this.directory}/${r?"":t}`),n=new Uint8Array(r?0:yield e.arrayBuffer()),a=30+o.length,s=a+n.length,l=16,{offset:u}=this,c=Jt(26).set32(0,134742036).set16(6,this.time).set16(8,this.date).set32(10,Ut.for(n)).set32(14,n.length).set32(18,n.length).set16(22,o.length);u+=a;let h=Jt(a+n.length+l).set32(0,67324752).bytes(4,c.array).bytes(30,o).bytes(a,n);u+=n.length,h.set32(s,134695760).bytes(s+4,c.array.slice(10,22)),u+=l,this.files.push({offset:u,folder:r,name:o,header:c,payload:h}),this.offset=u})}toBuffer(){let t=this.files.reduce((h,{name:y})=>46+y.length+h,0),e=Jt(t+22),r=0;for(var{offset:o,name:n,header:a,folder:s}of this.files)e.set32(r,33639248).set16(r+4,20).bytes(r+6,a.array).set8(r+38,s?16:0).set32(r+42,o).bytes(r+46,n),r+=46+n.length;e.set32(r,101010256).set16(r+8,this.files.length).set16(r+10,this.files.length).set32(r+12,t).set32(r+16,this.offset);let l=new Uint8Array(this.offset+e.size),u=0;for(var{payload:c}of this.files)l.set(c.array,u),u+=c.size;return l.set(e.array,u),l}get blob(){return new Blob([this.toBuffer()],{type:"application/zip"})}}zt.encoder=new TextEncoder;const ee=(i,t,e,r)=>{if(r){let{width:o,height:n}=i,a=Object.assign(document.createElement("canvas"),{width:o,height:n}),s=a.getContext("2d");s.fillStyle=r,s.fillRect(0,0,o,n),s.drawImage(i,0,0),i=a}return new Promise((o,n)=>i.toBlob(o,t,e))},mr=(...i)=>ee(...i).then(t=>t.arrayBuffer()),vr=(i,t,e,r,o)=>ct(void 0,null,function*(){_e(o,yield ee(i,t,e,r))}),br=(i,t,e,r,o,n,a)=>ct(void 0,null,function*(){let s=c=>n.replace("{}",String(c+1).padStart(a,"0")),l=Ce(o,".zip")||"archive",u=new zt(l);yield Promise.all(i.map((c,h)=>ct(void 0,null,function*(){let y=s(h);yield u.add(y,yield ee(c,t,e,r))}))),_e(`${l}.zip`,u.blob)}),_e=(i,t)=>{const e=window.URL.createObjectURL(t),r=document.createElement("a");r.style.display="none",r.href=e,r.setAttribute("download",i),typeof r.download=="undefined"&&r.setAttribute("target","_blank"),document.body.appendChild(r),r.click(),document.body.removeChild(r),setTimeout(()=>window.URL.revokeObjectURL(e),100)},yr=(i,t,e)=>i.map(r=>{if(t==1&&!e)return r.canvas;let o=document.createElement("canvas"),n=o.getContext("2d"),a=r.canvas?r.canvas:r;return o.width=a.width*t,o.height=a.height*t,e&&(n.fillStyle=e,n.fillRect(0,0,o.width,o.height)),n.scale(t,t),n.drawImage(a,0,0),o}),wr={asBuffer:mr,asDownload:vr,asZipDownload:br,atScale:yr,options:pr},{asBuffer:Wt,asDownload:xr,asZipDownload:Cr,atScale:qt,options:Yt}=wr,he=Symbol.for("toDataURL"),_r=i=>new Promise((t,e)=>Object.assign(new ke,{crossOrigin:"Anonymous",onload:t,onerror:e,src:i}));class kr{constructor(t,e){let r=document.createElement("canvas"),o=[];Object.defineProperty(r,"async",{value:!0,writable:!1,enumerable:!0});for(var[n,a]of Object.entries({png:()=>Wt(r,"image/png"),jpg:()=>Wt(r,"image/jpeg"),pages:()=>o.concat(r).map(s=>s.getContext("2d"))}))Object.defineProperty(r,n,{get:a});return Object.assign(r,{width:t,height:e,newPage(...s){var{width:u,height:c}=r,l=Object.assign(document.createElement("canvas"),{width:u,height:c});l.getContext("2d").drawImage(r,0,0),o.push(l);var[u,c]=s.length?s:[u,c];return Object.assign(r,{width:u,height:c}).getContext("2d")},saveAs(s,l){l=typeof l=="number"?{quality:l}:l;let u=Yt(this.pages,Mt({filename:s},l)),{pattern:c,padding:h,mime:y,quality:C,matte:A,density:T,archive:R}=u,p=qt(u.pages,T);return h==null?xr(p[0],y,C,A,s):Cr(p,y,C,A,R,c,h)},toBuffer(s="png",l={}){l=typeof l=="number"?{quality:l}:l;let u=Yt(this.pages,Mt({extension:s},l)),{mime:c,quality:h,matte:y,pages:C,density:A}=u,T=qt(C,A,y)[0];return Wt(T,c,h,y)},[he]:r.toDataURL.bind(r),toDataURL(s="png",l={}){l=typeof l=="number"?{quality:l}:l;let u=Yt(this.pages,Mt({extension:s},l)),{mime:c,quality:h,matte:y,pages:C,density:A}=u,T=qt(C,A,y)[0],R=T[T===r?he:"toDataURL"](c,h);return Promise.resolve(R)}})}}const{CanvasRenderingContext2D:Pr,CanvasGradient:Ar,CanvasPattern:Tr,Image:ke,ImageData:Br,Path2D:Dr,DOMMatrix:Er,DOMRect:Sr,DOMPoint:Ir}=window,Lr={Canvas:kr,loadImage:_r,CanvasRenderingContext2D:Pr,CanvasGradient:Ar,CanvasPattern:Tr,Image:ke,ImageData:Br,Path2D:Dr,DOMMatrix:Er,DOMRect:Sr,DOMPoint:Ir},It=(i,t,e={},r=e)=>{if(Array.isArray(t))t.forEach(o=>It(i,o,e,r));else if(typeof t=="function")t(i,e,r,It);else{const o=Object.keys(t)[0];Array.isArray(t[o])?(r[o]={},It(i,t[o],e,r[o])):r[o]=t[o](i,e,r,It)}return e},_t=(i,t)=>(e,r,o,n)=>{t(e,r,o)&&n(e,i,r,o)},Mr=(i,t)=>(e,r,o,n)=>{const a=[];let s=e.pos;for(;t(e,r,o);){const l={};if(n(e,i,r,l),e.pos===s)break;s=e.pos,a.push(l)}return a},Fr=i=>({data:i,pos:0}),at=()=>i=>i.data[i.pos++],Pe=(i=0)=>t=>t.data[t.pos+i],pt=i=>t=>t.data.subarray(t.pos,t.pos+=i),Gt=i=>t=>t.data.subarray(t.pos,t.pos+i),Qt=i=>t=>Array.from(pt(i)(t)).map(e=>String.fromCharCode(e)).join(""),xt=i=>t=>{const e=pt(2)(t);return i?(e[1]<<8)+e[0]:(e[0]<<8)+e[1]},Ae=(i,t)=>(e,r,o)=>{const n=typeof t=="function"?t(e,r,o):t,a=pt(i),s=new Array(n);for(var l=0;l<n;l++)s[l]=a(e);return s},Nr=(i,t,e)=>{for(var r=0,o=0;o<e;o++)r+=i[t+o]&&ue(2,e-o-1);return r},re=i=>t=>{const e=at()(t),r=new Array(8);for(var o=0;o<8;o++)r[7-o]=!!(e&1<<o);return Object.keys(i).reduce((n,a)=>{const s=i[a];return s.length?n[a]=Nr(r,s.index,s.length):n[a]=r[s.index],n},{})};var Ht={blocks:i=>{const e=[],r=i.data.length;for(var o=0,n=at()(i);n!==0&&n;n=at()(i)){if(i.pos+n>=r){const u=r-i.pos;e.push(pt(u)(i)),o+=u;break}e.push(pt(n)(i)),o+=n}const a=new Uint8Array(o);for(var s=0,l=0;l<e.length;l++)a.set(e[l],s),s+=e[l].length;return a}};const Rr=_t({gce:[{codes:pt(2)},{byteSize:at()},{extras:re({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:xt(!0)},{transparentColorIndex:at()},{terminator:at()}]},i=>{var t=Gt(2)(i);return t[0]===33&&t[1]===249}),Or=_t({image:[{code:at()},{descriptor:[{left:xt(!0)},{top:xt(!0)},{width:xt(!0)},{height:xt(!0)},{lct:re({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},_t({lct:Ae(3,(i,t,e)=>Math.pow(2,e.descriptor.lct.size+1))},(i,t,e)=>e.descriptor.lct.exists),{data:[{minCodeSize:at()},Ht]}]},i=>Pe()(i)===44),$r=_t({text:[{codes:pt(2)},{blockSize:at()},{preData:(i,t,e)=>pt(e.text.blockSize)(i)},Ht]},i=>{var t=Gt(2)(i);return t[0]===33&&t[1]===1}),jr=_t({application:[{codes:pt(2)},{blockSize:at()},{id:(i,t,e)=>Qt(e.blockSize)(i)},Ht]},i=>{var t=Gt(2)(i);return t[0]===33&&t[1]===255}),Ur=_t({comment:[{codes:pt(2)},Ht]},i=>{var t=Gt(2)(i);return t[0]===33&&t[1]===254}),zr=[{header:[{signature:Qt(3)},{version:Qt(3)}]},{lsd:[{width:xt(!0)},{height:xt(!0)},{gct:re({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:at()},{pixelAspectRatio:at()}]},_t({gct:Ae(3,(i,t)=>Math.pow(2,t.lsd.gct.size+1))},(i,t)=>t.lsd.gct.exists),{frames:Mr([Rr,jr,Ur,Or,$r],i=>{var t=Pe()(i);return t===33||t===44})}],Gr=(i,t)=>{const e=new Array(i.length),r=i.length/t,o=function(c,h){const y=i.slice(h*t,(h+1)*t);e.splice.apply(e,[c*t,t].concat(y))},n=[0,4,2,1],a=[8,8,4,2];for(var s=0,l=0;l<4;l++)for(var u=n[l];u<r;u+=a[l])o(u,s),s++;return e},Hr=(i,t,e)=>{const n=e;var a,s,l,u,c,h,y,g,C,A,d,T,v,w,D,_;const R=new Array(e),p=new Array(4096),m=new Array(4096),k=new Array(4096+1);for(T=i,s=1<<T,c=s+1,a=s+2,y=-1,u=T+1,l=(1<<u)-1,C=0;C<s;C++)p[C]=0,m[C]=C;var d,g,v,w,_,D;for(d=g=v=w=_=D=0,A=0;A<n;){if(w===0){if(g<u){d+=t[D]<<g,g+=8,D++;continue}if(C=d&l,d>>=u,g-=u,C>a||C==c)break;if(C==s){u=T+1,l=(1<<u)-1,a=s+2,y=-1;continue}if(y==-1){k[w++]=m[C],y=C,v=C;continue}for(h=C,C==a&&(k[w++]=v,C=y);C>s;)k[w++]=m[C],C=p[C];v=m[C]&255,k[w++]=v,a<4096&&(p[a]=y,m[a]=v,a++,(a&l)===0&&a<4096&&(u++,l+=a)),y=h}w--,R[_++]=k[w],A++}for(A=_;A<n;A++)R[A]=0;return R},Vr=i=>{const t=new Uint8Array(i);return It(Fr(t),zr)},Kr=i=>{const t=i.pixels.length,e=new Uint8ClampedArray(t*4);for(var r=0;r<t;r++){const o=r*4,n=i.pixels[r],a=i.colorTable[n];e[o]=a[0],e[o+1]=a[1],e[o+2]=a[2],e[o+3]=n!==i.transparentIndex?255:0}return e},Xr=(i,t,e)=>{if(!i.image){console.warn("gif frame does not have associated image.");return}const{image:r}=i,o=r.descriptor.width*r.descriptor.height;var n=Hr(r.data.minCodeSize,r.data.blocks,o);r.descriptor.lct.interlaced&&(n=Gr(n,r.descriptor.width));const a={pixels:n,dims:{top:i.image.descriptor.top,left:i.image.descriptor.left,width:i.image.descriptor.width,height:i.image.descriptor.height}};return r.descriptor.lct&&r.descriptor.lct.exists?a.colorTable=r.lct:a.colorTable=t,i.gce&&(a.delay=(i.gce.delay||10)*10,a.disposalType=i.gce.extras.disposal,i.gce.extras.transparentColorGiven&&(a.transparentIndex=i.gce.transparentColorIndex)),e&&(a.patch=Kr(a)),a},Zr=(i,t)=>i.frames.filter(e=>e.image).map(e=>Xr(e,i.gct,t));function Jr(i,t,e){const r=Te(t),o=i-1;let n=0;switch(e){case tt.L:n=gt[o][0];break;case tt.M:n=gt[o][1];break;case tt.Q:n=gt[o][2];break;case tt.H:n=gt[o][3];break}return r<=n}function Wr(i,t){for(var e=1,r=Te(i),o=0,n=gt.length;o<n;o++){var a=0;switch(t){case tt.L:a=gt[o][0];break;case tt.M:a=gt[o][1];break;case tt.Q:a=gt[o][2];break;case tt.H:a=gt[o][3];break}if(r<=a)break;e++}if(e>gt.length)throw new Error("Too long data");return e}function Te(i){var t=encodeURI(i).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return t.length+(t.length!=Number(i)?3:0)}class qr{constructor(t){this.mode=nt.MODE_8BIT_BYTE,this.parsedData=[],this.data=t;const e=[];for(let r=0,o=this.data.length;r<o;r++){const n=[],a=this.data.charCodeAt(r);a>65536?(n[0]=240|(a&1835008)>>>18,n[1]=128|(a&258048)>>>12,n[2]=128|(a&4032)>>>6,n[3]=128|a&63):a>2048?(n[0]=224|(a&61440)>>>12,n[1]=128|(a&4032)>>>6,n[2]=128|a&63):a>128?(n[0]=192|(a&1984)>>>6,n[1]=128|a&63):n[0]=a,e.push(n)}this.parsedData=Array.prototype.concat.apply([],e),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}getLength(){return this.parsedData.length}write(t){for(let e=0,r=this.parsedData.length;e<r;e++)t.put(this.parsedData[e],8)}}class wt{constructor(t=-1,e=tt.L){this.moduleCount=0,this.dataList=[],this.typeNumber=t,this.errorCorrectLevel=e,this.moduleCount=0,this.dataList=[]}addData(t){if(this.typeNumber<=0)this.typeNumber=Wr(t,this.errorCorrectLevel);else{if(this.typeNumber>40)throw new Error(`Invalid QR version: ${this.typeNumber}`);if(!Jr(this.typeNumber,t,this.errorCorrectLevel))throw new Error(`Data is too long for QR version: ${this.typeNumber}`)}const e=new qr(t);this.dataList.push(e),this.dataCache=void 0}isDark(t,e){if(t<0||this.moduleCount<=t||e<0||this.moduleCount<=e)throw new Error(`${t},${e}`);return this.modules[t][e]}getModuleCount(){return this.moduleCount}make(){this.makeImpl(!1,this.getBestMaskPattern())}makeImpl(t,e){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(let r=0;r<this.moduleCount;r++){this.modules[r]=new Array(this.moduleCount);for(let o=0;o<this.moduleCount;o++)this.modules[r][o]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,e),this.typeNumber>=7&&this.setupTypeNumber(t),this.dataCache==null&&(this.dataCache=wt.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,e)}setupPositionProbePattern(t,e){for(let r=-1;r<=7;r++)if(!(t+r<=-1||this.moduleCount<=t+r))for(let o=-1;o<=7;o++)e+o<=-1||this.moduleCount<=e+o||(0<=r&&r<=6&&(o==0||o==6)||0<=o&&o<=6&&(r==0||r==6)||2<=r&&r<=4&&2<=o&&o<=4?this.modules[t+r][e+o]=!0:this.modules[t+r][e+o]=!1)}getBestMaskPattern(){if(Number.isInteger(this.maskPattern)&&Object.values(vt).includes(this.maskPattern))return this.maskPattern;let t=0,e=0;for(let r=0;r<8;r++){this.makeImpl(!0,r);const o=$.getLostPoint(this);(r==0||t>o)&&(t=o,e=r)}return e}setupTimingPattern(){for(let t=8;t<this.moduleCount-8;t++)this.modules[t][6]==null&&(this.modules[t][6]=t%2==0);for(let t=8;t<this.moduleCount-8;t++)this.modules[6][t]==null&&(this.modules[6][t]=t%2==0)}setupPositionAdjustPattern(){const t=$.getPatternPosition(this.typeNumber);for(let e=0;e<t.length;e++)for(let r=0;r<t.length;r++){const o=t[e],n=t[r];if(this.modules[o][n]==null)for(let a=-2;a<=2;a++)for(let s=-2;s<=2;s++)a==-2||a==2||s==-2||s==2||a==0&&s==0?this.modules[o+a][n+s]=!0:this.modules[o+a][n+s]=!1}}setupTypeNumber(t){const e=$.getBCHTypeNumber(this.typeNumber);for(var r=0;r<18;r++){var o=!t&&(e>>r&1)==1;this.modules[Math.floor(r/3)][r%3+this.moduleCount-8-3]=o}for(var r=0;r<18;r++){var o=!t&&(e>>r&1)==1;this.modules[r%3+this.moduleCount-8-3][Math.floor(r/3)]=o}}setupTypeInfo(t,e){const r=this.errorCorrectLevel<<3|e,o=$.getBCHTypeInfo(r);for(var n=0;n<15;n++){var a=!t&&(o>>n&1)==1;n<6?this.modules[n][8]=a:n<8?this.modules[n+1][8]=a:this.modules[this.moduleCount-15+n][8]=a}for(var n=0;n<15;n++){var a=!t&&(o>>n&1)==1;n<8?this.modules[8][this.moduleCount-n-1]=a:n<9?this.modules[8][15-n-1+1]=a:this.modules[8][15-n-1]=a}this.modules[this.moduleCount-8][8]=!t}mapData(t,e){let r=-1,o=this.moduleCount-1,n=7,a=0;for(let s=this.moduleCount-1;s>0;s-=2)for(s==6&&s--;;){for(let l=0;l<2;l++)if(this.modules[o][s-l]==null){let u=!1;a<t.length&&(u=(t[a]>>>n&1)==1),$.getMask(e,o,s-l)&&(u=!u),this.modules[o][s-l]=u,n--,n==-1&&(a++,n=7)}if(o+=r,o<0||this.moduleCount<=o){o-=r,r=-r;break}}}static createData(t,e,r){const o=bt.getRSBlocks(t,e),n=new Yr;for(var a=0;a<r.length;a++){const l=r[a];n.put(l.mode,4),n.put(l.getLength(),$.getLengthInBits(l.mode,t)),l.write(n)}let s=0;for(var a=0;a<o.length;a++)s+=o[a].dataCount;if(n.getLengthInBits()>s*8)throw new Error(`code length overflow. (${n.getLengthInBits()}>${s*8})`);for(n.getLengthInBits()+4<=s*8&&n.put(0,4);n.getLengthInBits()%8!=0;)n.putBit(!1);for(;!(n.getLengthInBits()>=s*8||(n.put(wt.PAD0,8),n.getLengthInBits()>=s*8));)n.put(wt.PAD1,8);return wt.createBytes(n,o)}static createBytes(t,e){let r=0,o=0,n=0;const a=new Array(e.length),s=new Array(e.length);for(var l=0;l<e.length;l++){const C=e[l].dataCount,A=e[l].totalCount-C;o=Math.max(o,C),n=Math.max(n,A),a[l]=new Array(C);for(var u=0;u<a[l].length;u++)a[l][u]=255&t.buffer[u+r];r+=C;const T=$.getErrorCorrectPolynomial(A),p=new Tt(a[l],T.getLength()-1).mod(T);s[l]=new Array(T.getLength()-1);for(var u=0;u<s[l].length;u++){const k=u+p.getLength()-s[l].length;s[l][u]=k>=0?p.get(k):0}}let c=0;for(var u=0;u<e.length;u++)c+=e[u].totalCount;const h=new Array(c);let y=0;for(var u=0;u<o;u++)for(var l=0;l<e.length;l++)u<a[l].length&&(h[y++]=a[l][u]);for(var u=0;u<n;u++)for(var l=0;l<e.length;l++)u<s[l].length&&(h[y++]=s[l][u]);return h}}wt.PAD0=236;wt.PAD1=17;const tt={L:1,M:0,Q:3,H:2},nt={MODE_NUMBER:1<<0,MODE_ALPHA_NUM:1<<1,MODE_8BIT_BYTE:1<<2,MODE_KANJI:1<<3},vt={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};class ${static getBCHTypeInfo(t){let e=t<<10;for(;$.getBCHDigit(e)-$.getBCHDigit($.G15)>=0;)e^=$.G15<<$.getBCHDigit(e)-$.getBCHDigit($.G15);return(t<<10|e)^$.G15_MASK}static getBCHTypeNumber(t){let e=t<<12;for(;$.getBCHDigit(e)-$.getBCHDigit($.G18)>=0;)e^=$.G18<<$.getBCHDigit(e)-$.getBCHDigit($.G18);return t<<12|e}static getBCHDigit(t){let e=0;for(;t!=0;)e++,t>>>=1;return e}static getPatternPosition(t){return $.PATTERN_POSITION_TABLE[t-1]}static getMask(t,e,r){switch(t){case vt.PATTERN000:return(e+r)%2==0;case vt.PATTERN001:return e%2==0;case vt.PATTERN010:return r%3==0;case vt.PATTERN011:return(e+r)%3==0;case vt.PATTERN100:return(Math.floor(e/2)+Math.floor(r/3))%2==0;case vt.PATTERN101:return e*r%2+e*r%3==0;case vt.PATTERN110:return(e*r%2+e*r%3)%2==0;case vt.PATTERN111:return(e*r%3+(e+r)%2)%2==0;default:throw new Error(`bad maskPattern:${t}`)}}static getErrorCorrectPolynomial(t){let e=new Tt([1],0);for(let r=0;r<t;r++)e=e.multiply(new Tt([1,V.gexp(r)],0));return e}static getLengthInBits(t,e){if(1<=e&&e<10)switch(t){case nt.MODE_NUMBER:return 10;case nt.MODE_ALPHA_NUM:return 9;case nt.MODE_8BIT_BYTE:return 8;case nt.MODE_KANJI:return 8;default:throw new Error(`mode:${t}`)}else if(e<27)switch(t){case nt.MODE_NUMBER:return 12;case nt.MODE_ALPHA_NUM:return 11;case nt.MODE_8BIT_BYTE:return 16;case nt.MODE_KANJI:return 10;default:throw new Error(`mode:${t}`)}else if(e<41)switch(t){case nt.MODE_NUMBER:return 14;case nt.MODE_ALPHA_NUM:return 13;case nt.MODE_8BIT_BYTE:return 16;case nt.MODE_KANJI:return 12;default:throw new Error(`mode:${t}`)}else throw new Error(`type:${e}`)}static getLostPoint(t){const e=t.getModuleCount();let r=0;for(var o=0;o<e;o++)for(var n=0;n<e;n++){let l=0;const u=t.isDark(o,n);for(let c=-1;c<=1;c++)if(!(o+c<0||e<=o+c))for(let h=-1;h<=1;h++)n+h<0||e<=n+h||c==0&&h==0||u==t.isDark(o+c,n+h)&&l++;l>5&&(r+=3+l-5)}for(var o=0;o<e-1;o++)for(var n=0;n<e-1;n++){let c=0;t.isDark(o,n)&&c++,t.isDark(o+1,n)&&c++,t.isDark(o,n+1)&&c++,t.isDark(o+1,n+1)&&c++,(c==0||c==4)&&(r+=3)}for(var o=0;o<e;o++)for(var n=0;n<e-6;n++)t.isDark(o,n)&&!t.isDark(o,n+1)&&t.isDark(o,n+2)&&t.isDark(o,n+3)&&t.isDark(o,n+4)&&!t.isDark(o,n+5)&&t.isDark(o,n+6)&&(r+=40);for(var n=0;n<e;n++)for(var o=0;o<e-6;o++)t.isDark(o,n)&&!t.isDark(o+1,n)&&t.isDark(o+2,n)&&t.isDark(o+3,n)&&t.isDark(o+4,n)&&!t.isDark(o+5,n)&&t.isDark(o+6,n)&&(r+=40);let a=0;for(var n=0;n<e;n++)for(var o=0;o<e;o++)t.isDark(o,n)&&a++;return r+=Math.abs(100*a/e/e-50)/5*10,r}}$.PATTERN_POSITION_TABLE=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]];$.G15=1<<10|1<<8|1<<5|1<<4|1<<2|1<<1|1<<0;$.G18=1<<12|1<<11|1<<10|1<<9|1<<8|1<<5|1<<2|1<<0;$.G15_MASK=1<<14|1<<12|1<<10|1<<4|1<<1;class V{static glog(t){if(t<1)throw new Error(`glog(${t})`);return V.LOG_TABLE[t]}static gexp(t){for(;t<0;)t+=255;for(;t>=256;)t-=255;return V.EXP_TABLE[t]}}V.EXP_TABLE=new Array(256);V.LOG_TABLE=new Array(256);V._constructor=function(){for(var i=0;i<8;i++)V.EXP_TABLE[i]=1<<i;for(var i=8;i<256;i++)V.EXP_TABLE[i]=V.EXP_TABLE[i-4]^V.EXP_TABLE[i-5]^V.EXP_TABLE[i-6]^V.EXP_TABLE[i-8];for(var i=0;i<255;i++)V.LOG_TABLE[V.EXP_TABLE[i]]=i}();class Tt{constructor(t,e){if(t.length==null)throw new Error(`${t.length}/${e}`);let r=0;for(;r<t.length&&t[r]==0;)r++;this.num=new Array(t.length-r+e);for(let o=0;o<t.length-r;o++)this.num[o]=t[o+r]}get(t){return this.num[t]}getLength(){return this.num.length}multiply(t){const e=new Array(this.getLength()+t.getLength()-1);for(let r=0;r<this.getLength();r++)for(let o=0;o<t.getLength();o++)e[r+o]^=V.gexp(V.glog(this.get(r))+V.glog(t.get(o)));return new Tt(e,0)}mod(t){if(this.getLength()-t.getLength()<0)return this;const e=V.glog(this.get(0))-V.glog(t.get(0)),r=new Array(this.getLength());for(var o=0;o<this.getLength();o++)r[o]=this.get(o);for(var o=0;o<t.getLength();o++)r[o]^=V.gexp(V.glog(t.get(o))+e);return new Tt(r,0).mod(t)}}class bt{constructor(t,e){this.totalCount=t,this.dataCount=e}static getRSBlocks(t,e){const r=bt.getRsBlockTable(t,e);if(r==null)throw new Error(`bad rs block @ typeNumber:${t}/errorCorrectLevel:${e}`);const o=r.length/3,n=[];for(let a=0;a<o;a++){const s=r[a*3+0],l=r[a*3+1],u=r[a*3+2];for(let c=0;c<s;c++)n.push(new bt(l,u))}return n}static getRsBlockTable(t,e){switch(e){case tt.L:return bt.RS_BLOCK_TABLE[(t-1)*4+0];case tt.M:return bt.RS_BLOCK_TABLE[(t-1)*4+1];case tt.Q:return bt.RS_BLOCK_TABLE[(t-1)*4+2];case tt.H:return bt.RS_BLOCK_TABLE[(t-1)*4+3];default:return}}}bt.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];class Yr{constructor(){this.buffer=[],this.length=0}get(t){const e=Math.floor(t/8);return(this.buffer[e]>>>7-t%8&1)==1}put(t,e){for(let r=0;r<e;r++)this.putBit((t>>>e-r-1&1)==1)}getLengthInBits(){return this.length}putBit(t){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}}const gt=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]];var Qr=100,J=256,ge=J-1,yt=4,Be=16,oe=1<<Be,De=10,ne=10,to=oe>>ne,eo=oe<<De-ne,ro=J>>3,te=6,oo=1<<te,no=ro*oo,io=30,Ee=10,Rt=1<<Ee,Se=8,pe=1<<Se,ao=Ee+Se,Pt=1<<ao,me=499,ve=491,be=487,Ie=503,so=3*Ie;function lo(i,t){var e,r,o,n,a;function s(){e=[],r=new Int32Array(256),o=new Int32Array(J),n=new Int32Array(J),a=new Int32Array(J>>3);var p,m;for(p=0;p<J;p++)m=(p<<yt+8)/J,e[p]=new Float64Array([m,m,m,0]),n[p]=oe/J,o[p]=0}function l(){for(var p=0;p<J;p++)e[p][0]>>=yt,e[p][1]>>=yt,e[p][2]>>=yt,e[p][3]=p}function u(p,m,k,d,g){e[m][0]-=p*(e[m][0]-k)/Rt,e[m][1]-=p*(e[m][1]-d)/Rt,e[m][2]-=p*(e[m][2]-g)/Rt}function c(p,m,k,d,g){for(var v=Math.abs(m-p),w=Math.min(m+p,J),_=m+1,D=m-1,L=1,f,M;_<w||D>v;)M=a[L++],_<w&&(f=e[_++],f[0]-=M*(f[0]-k)/Pt,f[1]-=M*(f[1]-d)/Pt,f[2]-=M*(f[2]-g)/Pt),D>v&&(f=e[D--],f[0]-=M*(f[0]-k)/Pt,f[1]-=M*(f[1]-d)/Pt,f[2]-=M*(f[2]-g)/Pt)}function h(p,m,k){var d=2147483647,g=d,v=-1,w=v,_,D,L,f,M;for(_=0;_<J;_++)D=e[_],L=Math.abs(D[0]-p)+Math.abs(D[1]-m)+Math.abs(D[2]-k),L<d&&(d=L,v=_),f=L-(o[_]>>Be-yt),f<g&&(g=f,w=_),M=n[_]>>ne,n[_]-=M,o[_]+=M<<De;return n[v]+=to,o[v]-=eo,w}function y(){var p,m,k,d,g,v,w=0,_=0;for(p=0;p<J;p++){for(k=e[p],g=p,v=k[1],m=p+1;m<J;m++)d=e[m],d[1]<v&&(g=m,v=d[1]);if(d=e[g],p!=g&&(m=d[0],d[0]=k[0],k[0]=m,m=d[1],d[1]=k[1],k[1]=m,m=d[2],d[2]=k[2],k[2]=m,m=d[3],d[3]=k[3],k[3]=m),v!=w){for(r[w]=_+p>>1,m=w+1;m<v;m++)r[m]=p;w=v,_=p}}for(r[w]=_+ge>>1,m=w+1;m<256;m++)r[m]=ge}function C(p,m,k){for(var d,g,v,w=1e3,_=-1,D=r[m],L=D-1;D<J||L>=0;)D<J&&(g=e[D],v=g[1]-m,v>=w?D=J:(D++,v<0&&(v=-v),d=g[0]-p,d<0&&(d=-d),v+=d,v<w&&(d=g[2]-k,d<0&&(d=-d),v+=d,v<w&&(w=v,_=g[3])))),L>=0&&(g=e[L],v=m-g[1],v>=w?L=-1:(L--,v<0&&(v=-v),d=g[0]-p,d<0&&(d=-d),v+=d,v<w&&(d=g[2]-k,d<0&&(d=-d),v+=d,v<w&&(w=v,_=g[3]))));return _}function A(){var p,m=i.length,k=30+(t-1)/3,d=m/(3*t),g=~~(d/Qr),v=Rt,w=no,_=w>>te;for(_<=1&&(_=0),p=0;p<_;p++)a[p]=v*((_*_-p*p)*pe/(_*_));var D;m<so?(t=1,D=3):m%me!==0?D=3*me:m%ve!==0?D=3*ve:m%be!==0?D=3*be:D=3*Ie;var L,f,M,x,O=0;for(p=0;p<d;)if(L=(i[O]&255)<<yt,f=(i[O+1]&255)<<yt,M=(i[O+2]&255)<<yt,x=h(L,f,M),u(v,x,L,f,M),_!==0&&c(_,x,L,f,M),O+=D,O>=m&&(O-=m),p++,g===0&&(g=1),p%g===0)for(v-=v/k,w-=w/io,_=w>>te,_<=1&&(_=0),x=0;x<_;x++)a[x]=v*((_*_-x*x)*pe/(_*_))}function T(){s(),A(),l(),y()}this.buildColormap=T;function R(){for(var p=[],m=[],k=0;k<J;k++)m[e[k][3]]=k;for(var d=0,g=0;g<J;g++){var v=m[g];p[d++]=e[v][0],p[d++]=e[v][1],p[d++]=e[v][2]}return p}this.getColormap=R,this.lookupRGB=C}var ye=-1,Ot=12,St=5003,co=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];function uo(i,t,e,r){var o=Math.max(2,r),n=new Uint8Array(256),a=new Int32Array(St),s=new Int32Array(St),l,u=0,c,h=0,y,C=!1,A,T,R,p,m,k;function d(x,O){n[c++]=x,c>=254&&D(O)}function g(x){v(St),h=T+2,C=!0,M(T,x)}function v(x){for(var O=0;O<x;++O)a[O]=-1}function w(x,O){var b,ut,U,et,st,z,rt;for(A=x,C=!1,k=A,y=L(k),T=1<<x-1,R=T+1,h=T+2,c=0,et=f(),rt=0,b=St;b<65536;b*=2)++rt;rt=8-rt,z=St,v(z),M(T,O);t:for(;(ut=f())!=ye;){if(b=(ut<<Ot)+et,U=ut<<rt^et,a[U]===b){et=s[U];continue}else if(a[U]>=0){st=z-U,U===0&&(st=1);do if((U-=st)<0&&(U+=z),a[U]===b){et=s[U];continue t}while(a[U]>=0)}M(et,O),et=ut,h<1<<Ot?(s[U]=h++,a[U]=b):g(O)}M(et,O),M(R,O)}function _(x){x.writeByte(o),p=i*t,m=0,w(o+1,x),x.writeByte(0)}function D(x){c>0&&(x.writeByte(c),x.writeBytes(n,0,c),c=0)}function L(x){return(1<<x)-1}function f(){if(p===0)return ye;--p;var x=e[m++];return x&255}function M(x,O){for(l&=co[u],u>0?l|=x<<u:l=x,u+=k;u>=8;)d(l&255,O),l>>=8,u-=8;if((h>y||C)&&(C?(y=L(k=A),C=!1):(++k,k==Ot?y=1<<Ot:y=L(k))),x==R){for(;u>0;)d(l&255,O),l>>=8,u-=8;D(O)}}this.encode=_}function ot(){this.page=-1,this.pages=[],this.newPage()}ot.pageSize=4096;ot.charMap={};for(var $t=0;$t<256;$t++)ot.charMap[$t]=String.fromCharCode($t);ot.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(ot.pageSize),this.cursor=0};ot.prototype.getData=function(){for(var i="",t=0;t<this.pages.length;t++)for(var e=0;e<ot.pageSize;e++)i+=ot.charMap[this.pages[t][e]];return i};ot.prototype.toFlattenUint8Array=function(){const i=[];for(var t=0;t<this.pages.length;t++)if(t===this.pages.length-1){const r=Uint8Array.from(this.pages[t].slice(0,this.cursor));i.push(r)}else i.push(this.pages[t]);const e=new Uint8Array(i.reduce((r,o)=>r+o.length,0));return i.reduce((r,o)=>(e.set(o,r),r+o.length),0),e};ot.prototype.writeByte=function(i){this.cursor>=ot.pageSize&&this.newPage(),this.pages[this.page][this.cursor++]=i};ot.prototype.writeUTFBytes=function(i){for(var t=i.length,e=0;e<t;e++)this.writeByte(i.charCodeAt(e))};ot.prototype.writeBytes=function(i,t,e){for(var r=e||i.length,o=t||0;o<r;o++)this.writeByte(i[o])};function j(i,t){this.width=~~i,this.height=~~t,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.neuQuant=null,this.usedEntry=new Array,this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.dither=!1,this.globalPalette=!1,this.out=new ot}j.prototype.setDelay=function(i){this.delay=Math.round(i/10)};j.prototype.setFrameRate=function(i){this.delay=Math.round(100/i)};j.prototype.setDispose=function(i){i>=0&&(this.dispose=i)};j.prototype.setRepeat=function(i){this.repeat=i};j.prototype.setTransparent=function(i){this.transparent=i};j.prototype.addFrame=function(i){this.image=i,this.colorTab=this.globalPalette&&this.globalPalette.slice?this.globalPalette:null,this.getImagePixels(),this.analyzePixels(),this.globalPalette===!0&&(this.globalPalette=this.colorTab),this.firstFrame&&(this.writeHeader(),this.writeLSD(),this.writePalette(),this.repeat>=0&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),!this.firstFrame&&!this.globalPalette&&this.writePalette(),this.writePixels(),this.firstFrame=!1};j.prototype.finish=function(){this.out.writeByte(59)};j.prototype.setQuality=function(i){i<1&&(i=1),this.sample=i};j.prototype.setDither=function(i){i===!0&&(i="FloydSteinberg"),this.dither=i};j.prototype.setGlobalPalette=function(i){this.globalPalette=i};j.prototype.getGlobalPalette=function(){return this.globalPalette&&this.globalPalette.slice&&this.globalPalette.slice(0)||this.globalPalette};j.prototype.writeHeader=function(){this.out.writeUTFBytes("GIF89a")};j.prototype.analyzePixels=function(){this.colorTab||(this.neuQuant=new lo(this.pixels,this.sample),this.neuQuant.buildColormap(),this.colorTab=this.neuQuant.getColormap()),this.dither?this.ditherPixels(this.dither.replace("-serpentine",""),this.dither.match(/-serpentine/)!==null):this.indexPixels(),this.pixels=null,this.colorDepth=8,this.palSize=7,this.transparent!==null&&(this.transIndex=this.findClosest(this.transparent,!0))};j.prototype.indexPixels=function(i){var t=this.pixels.length/3;this.indexedPixels=new Uint8Array(t);for(var e=0,r=0;r<t;r++){var o=this.findClosestRGB(this.pixels[e++]&255,this.pixels[e++]&255,this.pixels[e++]&255);this.usedEntry[o]=!0,this.indexedPixels[r]=o}};j.prototype.ditherPixels=function(i,t){var e={FalseFloydSteinberg:[[.375,1,0],[.375,0,1],[.25,1,1]],FloydSteinberg:[[.4375,1,0],[.1875,-1,1],[.3125,0,1],[.0625,1,1]],Stucki:[[.19047619047619047,1,0],[.09523809523809523,2,0],[.047619047619047616,-2,1],[.09523809523809523,-1,1],[.19047619047619047,0,1],[.09523809523809523,1,1],[.047619047619047616,2,1],[.023809523809523808,-2,2],[.047619047619047616,-1,2],[.09523809523809523,0,2],[.047619047619047616,1,2],[.023809523809523808,2,2]],Atkinson:[[.125,1,0],[.125,2,0],[.125,-1,1],[.125,0,1],[.125,1,1],[.125,0,2]]};if(!i||!e[i])throw"Unknown dithering kernel: "+i;var r=e[i],o=0,n=this.height,a=this.width,s=this.pixels,l=t?-1:1;this.indexedPixels=new Uint8Array(this.pixels.length/3);for(var u=0;u<n;u++){t&&(l=l*-1);for(var c=l==1?0:a-1,h=l==1?a:0;c!==h;c+=l){o=u*a+c;var y=o*3,C=s[y],A=s[y+1],T=s[y+2];y=this.findClosestRGB(C,A,T),this.usedEntry[y]=!0,this.indexedPixels[o]=y,y*=3;for(var R=this.colorTab[y],p=this.colorTab[y+1],m=this.colorTab[y+2],k=C-R,d=A-p,g=T-m,v=l==1?0:r.length-1,w=l==1?r.length:0;v!==w;v+=l){var _=r[v][1],D=r[v][2];if(_+c>=0&&_+c<a&&D+u>=0&&D+u<n){var L=r[v][0];y=o+_+D*a,y*=3,s[y]=Math.max(0,Math.min(255,s[y]+k*L)),s[y+1]=Math.max(0,Math.min(255,s[y+1]+d*L)),s[y+2]=Math.max(0,Math.min(255,s[y+2]+g*L))}}}}};j.prototype.findClosest=function(i,t){return this.findClosestRGB((i&16711680)>>16,(i&65280)>>8,i&255,t)};j.prototype.findClosestRGB=function(i,t,e,r){if(this.colorTab===null)return-1;if(this.neuQuant&&!r)return this.neuQuant.lookupRGB(i,t,e);for(var o=0,n=256*256*256,a=this.colorTab.length,s=0,l=0;s<a;l++){var u=i-(this.colorTab[s++]&255),c=t-(this.colorTab[s++]&255),h=e-(this.colorTab[s++]&255),y=u*u+c*c+h*h;(!r||this.usedEntry[l])&&y<n&&(n=y,o=l)}return o};j.prototype.getImagePixels=function(){var i=this.width,t=this.height;this.pixels=new Uint8Array(i*t*3);for(var e=this.image,r=0,o=0,n=0;n<t;n++)for(var a=0;a<i;a++)this.pixels[o++]=e[r++],this.pixels[o++]=e[r++],this.pixels[o++]=e[r++],r++};j.prototype.writeGraphicCtrlExt=function(){this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4);var i,t;this.transparent===null?(i=0,t=0):(i=1,t=2),this.dispose>=0&&(t=this.dispose&7),t<<=2,this.out.writeByte(0|t|0|i),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)};j.prototype.writeImageDesc=function(){this.out.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame||this.globalPalette?this.out.writeByte(0):this.out.writeByte(128|this.palSize)};j.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(240|this.palSize),this.out.writeByte(0),this.out.writeByte(0)};j.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes("NETSCAPE2.0"),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)};j.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);for(var i=3*256-this.colorTab.length,t=0;t<i;t++)this.out.writeByte(0)};j.prototype.writeShort=function(i){this.out.writeByte(i&255),this.out.writeByte(i>>8&255)};j.prototype.writePixels=function(){var i=new uo(this.width,this.height,this.indexedPixels,this.colorDepth);i.encode(this.out)};j.prototype.stream=function(){return this.out};var fo=globalThis&&globalThis.__awaiter||function(i,t,e,r){function o(n){return n instanceof e?n:new e(function(a){a(n)})}return new(e||(e=Promise))(function(n,a){function s(c){try{u(r.next(c))}catch(h){a(h)}}function l(c){try{u(r.throw(c))}catch(h){a(h)}}function u(c){c.done?n(c.value):o(c.value).then(s,l)}u((r=r.apply(i,t||[])).next())})};const{Canvas:mt}=Lr,jt=.4;function we(i){if(!i)return;function t(e){e.onload=null,e.onerror=null}return new Promise(function(e,r){if(i.slice(0,4)=="data"){let n=new Image;n.onload=function(){e(n),t(n)},n.onerror=function(){r("Image load error"),t(n)},n.src=i;return}let o=new Image;o.setAttribute("crossOrigin","Anonymous"),o.onload=function(){e(o)},o.onerror=function(){r("Image load error")},o.src=i})}class N{constructor(t){const e=Object.assign({},t);if(Object.keys(N.defaultOptions).forEach(r=>{r in e||Object.defineProperty(e,r,{value:N.defaultOptions[r],enumerable:!0,writable:!0})}),e.components?typeof e.components=="object"&&Object.keys(N.defaultComponentOptions).forEach(r=>{r in e.components?Object.defineProperty(e.components,r,{value:Object.assign(Object.assign({},N.defaultComponentOptions[r]),e.components[r]),enumerable:!0,writable:!0}):Object.defineProperty(e.components,r,{value:N.defaultComponentOptions[r],enumerable:!0,writable:!0})}):e.components=N.defaultComponentOptions,e.dotScale!==null&&e.dotScale!==void 0){if(e.dotScale<=0||e.dotScale>1)throw new Error("dotScale should be in range (0, 1].");e.components.data.scale=e.dotScale,e.components.timing.scale=e.dotScale,e.components.alignment.scale=e.dotScale}this.options=e,this.canvas=new mt(t.size,t.size),this.canvasContext=this.canvas.getContext("2d"),this.qrCode=new wt(-1,this.options.correctLevel),Number.isInteger(this.options.maskPattern)&&(this.qrCode.maskPattern=this.options.maskPattern),Number.isInteger(this.options.version)&&(this.qrCode.typeNumber=this.options.version),this.qrCode.addData(this.options.text),this.qrCode.make()}draw(){return new Promise(t=>this._draw().then(t))}_clear(){this.canvasContext.clearRect(0,0,this.canvas.width,this.canvas.height)}static _prepareRoundedCornerClip(t,e,r,o,n,a){t.beginPath(),t.moveTo(e,r),t.arcTo(e+o,r,e+o,r+n,a),t.arcTo(e+o,r+n,e,r+n,a),t.arcTo(e,r+n,e,r,a),t.arcTo(e,r,e+o,r,a),t.closePath()}static _getAverageRGB(t){const r={r:0,g:0,b:0};let o,n,a=-4;const s={r:0,g:0,b:0};let l=0;n=t.naturalHeight||t.height,o=t.naturalWidth||t.width;const c=new mt(o,n).getContext("2d");if(!c)return r;c.drawImage(t,0,0);let h;try{h=c.getImageData(0,0,o,n)}catch(y){return r}for(;(a+=5*4)<h.data.length;)h.data[a]>200||h.data[a+1]>200||h.data[a+2]>200||(++l,s.r+=h.data[a],s.g+=h.data[a+1],s.b+=h.data[a+2]);return s.r=~~(s.r/l),s.g=~~(s.g/l),s.b=~~(s.b/l),s}static _drawDot(t,e,r,o,n=0,a=1){t.fillRect((e+n)*o,(r+n)*o,a*o,a*o)}static _drawAlignProtector(t,e,r,o){t.clearRect((e-2)*o,(r-2)*o,5*o,5*o),t.fillRect((e-2)*o,(r-2)*o,5*o,5*o)}static _drawAlign(t,e,r,o,n=0,a=1,s,l){const u=t.fillStyle;t.fillStyle=s,new Array(4).fill(0).map((c,h)=>{N._drawDot(t,e-2+h,r-2,o,n,a),N._drawDot(t,e+2,r-2+h,o,n,a),N._drawDot(t,e+2-h,r+2,o,n,a),N._drawDot(t,e-2,r+2-h,o,n,a)}),N._drawDot(t,e,r,o,n,a),l||(t.fillStyle="rgba(255, 255, 255, 0.6)",new Array(2).fill(0).map((c,h)=>{N._drawDot(t,e-1+h,r-1,o,n,a),N._drawDot(t,e+1,r-1+h,o,n,a),N._drawDot(t,e+1-h,r+1,o,n,a),N._drawDot(t,e-1,r+1-h,o,n,a)})),t.fillStyle=u}_draw(){var t,e,r,o,n,a,s,l,u,c,h,y,C,A,T,R,p,m,k;return fo(this,void 0,void 0,function*(){const d=(t=this.qrCode)===null||t===void 0?void 0:t.moduleCount,g=this.options.size;let v=this.options.margin;(v<0||v*2>=g)&&(v=0);const w=Math.ceil(v),_=g-2*v,D=this.options.whiteMargin,L=this.options.backgroundDimming,f=Math.ceil(_/d),M=f*d,x=M+2*w,O=new mt(x,x),b=O.getContext("2d");this._clear(),b.save(),b.translate(w,w);const ut=new mt(x,x),U=ut.getContext("2d");let et=null,st=[];if(this.options.gifBackground){const P=Vr(this.options.gifBackground);if(et=P,st=Zr(P,!0),this.options.autoColor){let B=0,E=0,I=0,Z=0;for(let G=0;G<st[0].colorTable.length;G++){const H=st[0].colorTable[G];H[0]>200||H[1]>200||H[2]>200||H[0]===0&&H[1]===0&&H[2]===0||(Z++,B+=H[0],E+=H[1],I+=H[2])}B=~~(B/Z),E=~~(E/Z),I=~~(I/Z),this.options.colorDark=`rgb(${B},${E},${I})`}}else if(this.options.backgroundImage){const P=yield we(this.options.backgroundImage);if(this.options.autoColor){const B=N._getAverageRGB(P);this.options.colorDark=`rgb(${B.r},${B.g},${B.b})`}U.drawImage(P,0,0,P.width,P.height,0,0,x,x),U.rect(0,0,x,x),U.fillStyle=L,U.fill()}else U.rect(0,0,x,x),U.fillStyle=this.options.colorLight,U.fill();const z=$.getPatternPosition(this.qrCode.typeNumber),rt=((r=(e=this.options.components)===null||e===void 0?void 0:e.data)===null||r===void 0?void 0:r.scale)||jt,Bt=(1-rt)*.5;for(let P=0;P<d;P++)for(let B=0;B<d;B++){const E=this.qrCode.isDark(P,B),I=B<8&&(P<8||P>=d-8)||B>=d-8&&P<8,Z=P==6&&B>=8&&B<=d-8||B==6&&P>=8&&P<=d-8;let G=I||Z;for(let q=1;q<z.length-1;q++)G=G||P>=z[q]-2&&P<=z[q]+2&&B>=z[q]-2&&B<=z[q]+2;const H=B*f+(G?0:Bt*f),lt=P*f+(G?0:Bt*f);if(b.strokeStyle=E?this.options.colorDark:this.options.colorLight,b.lineWidth=.5,b.fillStyle=E?this.options.colorDark:this.options.colorLight,z.length===0)G||b.fillRect(H,lt,(G?1:rt)*f,(G?1:rt)*f);else{const q=B<d-4&&B>=d-4-5&&P<d-4&&P>=d-4-5;!G&&!q&&b.fillRect(H,lt,(G?1:rt)*f,(G?1:rt)*f)}}const W=z[z.length-1],S=this.options.colorLight;if(b.fillStyle=S,b.fillRect(0,0,8*f,8*f),b.fillRect(0,(d-8)*f,8*f,8*f),b.fillRect((d-8)*f,0,8*f,8*f),!((n=(o=this.options.components)===null||o===void 0?void 0:o.timing)===null||n===void 0)&&n.protectors&&(b.fillRect(8*f,6*f,(d-8-8)*f,f),b.fillRect(6*f,8*f,f,(d-8-8)*f)),!((s=(a=this.options.components)===null||a===void 0?void 0:a.cornerAlignment)===null||s===void 0)&&s.protectors&&N._drawAlignProtector(b,W,W,f),!((u=(l=this.options.components)===null||l===void 0?void 0:l.alignment)===null||u===void 0)&&u.protectors)for(let P=0;P<z.length;P++)for(let B=0;B<z.length;B++){const E=z[B],I=z[P];if(!(E===6&&(I===6||I===W))){if(I===6&&(E===6||E===W))continue;if(E===W&&I===W)continue;N._drawAlignProtector(b,E,I,f)}}b.fillStyle=this.options.colorDark,b.fillRect(0,0,7*f,f),b.fillRect((d-7)*f,0,7*f,f),b.fillRect(0,6*f,7*f,f),b.fillRect((d-7)*f,6*f,7*f,f),b.fillRect(0,(d-7)*f,7*f,f),b.fillRect(0,(d-7+6)*f,7*f,f),b.fillRect(0,0,f,7*f),b.fillRect(6*f,0,f,7*f),b.fillRect((d-7)*f,0,f,7*f),b.fillRect((d-7+6)*f,0,f,7*f),b.fillRect(0,(d-7)*f,f,7*f),b.fillRect(6*f,(d-7)*f,f,7*f),b.fillRect(2*f,2*f,3*f,3*f),b.fillRect((d-7+2)*f,2*f,3*f,3*f),b.fillRect(2*f,(d-7+2)*f,3*f,3*f);const kt=((h=(c=this.options.components)===null||c===void 0?void 0:c.timing)===null||h===void 0?void 0:h.scale)||jt,Vt=(1-kt)*.5;for(let P=0;P<d-8;P+=2)N._drawDot(b,8+P,6,f,Vt,kt),N._drawDot(b,6,8+P,f,Vt,kt);const ie=((C=(y=this.options.components)===null||y===void 0?void 0:y.cornerAlignment)===null||C===void 0?void 0:C.scale)||jt,Le=(1-ie)*.5;N._drawAlign(b,W,W,f,Le,ie,this.options.colorDark,((T=(A=this.options.components)===null||A===void 0?void 0:A.cornerAlignment)===null||T===void 0?void 0:T.protectors)||!1);const ae=((p=(R=this.options.components)===null||R===void 0?void 0:R.alignment)===null||p===void 0?void 0:p.scale)||jt,Me=(1-ae)*.5;for(let P=0;P<z.length;P++)for(let B=0;B<z.length;B++){const E=z[B],I=z[P];if(!(E===6&&(I===6||I===W))){if(I===6&&(E===6||E===W))continue;if(E===W&&I===W)continue;N._drawAlign(b,E,I,f,Me,ae,this.options.colorDark,((k=(m=this.options.components)===null||m===void 0?void 0:m.alignment)===null||k===void 0?void 0:k.protectors)||!1)}}if(D&&(b.fillStyle=this.options.backgroundColor,b.fillRect(-w,-w,x,w),b.fillRect(-w,M,x,w),b.fillRect(M,-w,w,x),b.fillRect(-w,-w,w,x)),this.options.logoImage){const P=yield we(this.options.logoImage);let B=this.options.logoScale,E=this.options.logoMargin,I=this.options.logoCornerRadius;(B<=0||B>=1)&&(B=.2),E<0&&(E=0),I<0&&(I=0);const Z=M*B,G=.5*(x-Z),H=G;b.restore(),b.fillStyle=this.options.logoBackgroundColor,b.save(),N._prepareRoundedCornerClip(b,G-E,H-E,Z+2*E,Z+2*E,I+E),b.clip();const lt=b.globalCompositeOperation;b.globalCompositeOperation="destination-out",b.fill(),b.globalCompositeOperation=lt,b.restore(),b.save(),N._prepareRoundedCornerClip(b,G,H,Z,Z,I),b.clip(),b.drawImage(P,G,H,Z,Z),b.restore(),b.save(),b.translate(w,w)}if(et){let P,B,E,I,Z,G;if(st.forEach(function(H){P||(P=new j(g,g),P.setDelay(H.delay),P.setRepeat(0));const{width:lt,height:q}=H.dims;B||(B=new mt(lt,q),E=B.getContext("2d"),E.rect(0,0,B.width,B.height),E.fillStyle="#ffffff",E.fill()),(!I||!G||lt!==I.width||q!==I.height)&&(I=new mt(lt,q),Z=I.getContext("2d"),G=Z.createImageData(lt,q)),G.data.set(H.patch),Z.putImageData(G,0,0),E.drawImage(I.getContext("2d").canvas,H.dims.left,H.dims.top);const Lt=new mt(x,x),Dt=Lt.getContext("2d");Dt.drawImage(B.getContext("2d").canvas,0,0,x,x),Dt.rect(0,0,x,x),Dt.fillStyle=L,Dt.fill(),Dt.drawImage(O.getContext("2d").canvas,0,0,x,x);const Kt=new mt(g,g),se=Kt.getContext("2d");se.drawImage(Lt.getContext("2d").canvas,0,0,g,g),P.addFrame(se.getImageData(0,0,Kt.width,Kt.height).data)}),!P)throw new Error("No frames.");if(P.finish(),xe(this.canvas)){const lt=P.stream().toFlattenUint8Array().reduce((q,Lt)=>q+String.fromCharCode(Lt),"");return Promise.resolve(`data:image/gif;base64,${window.btoa(lt)}`)}return Promise.resolve(Buffer.from(P.stream().toFlattenUint8Array()))}else{U.drawImage(O.getContext("2d").canvas,0,0,x,x),b.drawImage(ut.getContext("2d").canvas,-w,-w,x,x);const P=new mt(g,g);P.getContext("2d").drawImage(O.getContext("2d").canvas,0,0,g,g),this.canvas=P;const E=this.options.gifBackground?"gif":"png";return xe(this.canvas)?Promise.resolve(this.canvas.toDataURL(E)):Promise.resolve(this.canvas.toBuffer(E))}})}}N.CorrectLevel=tt;N.defaultComponentOptions={data:{scale:.4},timing:{scale:.5,protectors:!1},alignment:{scale:.5,protectors:!1},cornerAlignment:{scale:.5,protectors:!0}};N.defaultOptions={text:"",size:400,margin:20,colorDark:"#000000",colorLight:"rgba(255, 255, 255, 0.6)",correctLevel:tt.M,backgroundImage:void 0,backgroundDimming:"rgba(0,0,0,0)",logoImage:void 0,logoScale:.2,logoMargin:4,logoCornerRadius:8,whiteMargin:!0,components:N.defaultComponentOptions,autoColor:!0,logoBackgroundColor:"#ffffff",backgroundColor:"#ffffff"};function xe(i){try{return i instanceof HTMLElement}catch(t){return typeof i=="object"&&i.nodeType===1&&typeof i.style=="object"&&typeof i.ownerDocument=="object"}}const ho={props:{text:{type:String,required:!0},qid:{type:String},correctLevel:{type:Number,default:1},size:{type:Number,default:200},margin:{type:Number,default:20},colorDark:{type:String,default:"#000000"},colorLight:{type:String,default:"#FFFFFF"},bgSrc:{type:String,default:void 0},background:{type:String,default:"rgba(0,0,0,0)"},backgroundDimming:{type:String,default:"rgba(0,0,0,0)"},logoSrc:{type:String,default:void 0},logoBackgroundColor:{type:String,default:"rgba(255,255,255,1)"},gifBgSrc:{type:String,default:void 0},logoScale:{type:Number,default:.2},logoMargin:{type:Number,default:0},logoCornerRadius:{type:Number,default:8},whiteMargin:{type:[Boolean,String],default:!0},dotScale:{type:Number,default:1},autoColor:{type:[Boolean,String],default:!0},binarize:{type:[Boolean,String],default:!1},binarizeThreshold:{type:Number,default:128},callback:{type:Function,default:function(){}},bindElement:{type:Boolean,default:!0},backgroundColor:{type:String,default:"#FFFFFF"},components:{default:function(){return{data:{scale:1},timing:{scale:1,protectors:!1},alignment:{scale:1,protectors:!1},cornerAlignment:{scale:1,protectors:!0}}}}},name:"vue-qr",data(){return{imgUrl:""}},watch:{$props:{deep:!0,handler(){this.main()}}},mounted(){this.main()},methods:{main(){return ct(this,null,function*(){if(this.gifBgSrc){const e=yield fr(this.gifBgSrc),r=this.logoSrc;this.render(void 0,r,e);return}const i=this.bgSrc,t=this.logoSrc;this.render(i,t)})},render(i,t,e){return ct(this,null,function*(){const r=this;new N({gifBackground:e,text:r.text,size:r.size,margin:r.margin,colorDark:r.colorDark,colorLight:r.colorLight,backgroundColor:r.backgroundColor,backgroundImage:i,backgroundDimming:r.backgroundDimming,logoImage:t,logoScale:r.logoScale,logoBackgroundColor:r.logoBackgroundColor,correctLevel:r.correctLevel,logoMargin:r.logoMargin,logoCornerRadius:r.logoCornerRadius,whiteMargin:Zt(r.whiteMargin),dotScale:r.dotScale,autoColor:Zt(r.autoColor),binarize:Zt(r.binarize),binarizeThreshold:r.binarizeThreshold,components:r.components}).draw().then(o=>{this.imgUrl=o,r.callback&&r.callback(o,r.qid)})})}}},go=["src"];function po(i,t,e,r,o,n){return e.bindElement?(Q(),it("img",{key:0,style:{display:"inline-block"},src:o.imgUrl},null,8,go)):At("",!0)}var mo=tr(ho,[["render",po]]);const vo={class:"p-24 dark:text-[#fffa] overflow-x-hidden"},bo={class:"text-000 dark:text-[#fffa] text-52px font-medium mt-4 mb-24px h-73px leading-73px"},yo={class:"jumbotron flex"},wo={class:"px-6 pt-5 pb-32 bg-fff dark:bg-[#333] w-620px mr-40px rounded-normal shadow-s-10 flex-shrink-0"},xo={class:"flex justify-between items-center h-28px leading-28px"},Co={class:"text-20px font-medium text-000 dark:text-[#fffa]"},_o={class:"space-y-8 text-000 dark:text-[#fffa] text-opacity-65 text-m"},ko={class:"ellipsis"},Po=["innerHTML"],Ao={class:"text-20px font-medium text-000 dark:text-[#fffa] mb-4"},To={key:0},Bo={class:"space-x-24 flex mb-28px"},Do=["onClick"],Eo={class:"flex items-center"},So={class:"flex items-center justify-between space-x-16"},Io={class:"flex items-center justify-between mt-6px"},Lo={key:1,class:"w-180px h-220px mx-auto"},Mo={key:0,class:"flex flex-col"},Fo=F("div",{class:"flex items-center justify-center h-auto"},[F("img",{class:"transform scale-80 -m-12",src:"https://td.cdn-go.cn/enterprise_payment/v0.0.9/logo.png"})],-1),No={class:"px-6 pt-5 pb-44px bg-fff dark:bg-[#333] text-m w-500px rounded-normal shadow-s-10 text-000 dark:text-[#fffa]",style:{height:"fit-content"}},Ro={class:"text-20px font-medium"},Oo={class:"text-000 dark:text-[#fffa]"},$o={class:"space-y-8 mb-8"},jo={class:"flex justify-between items-center h-5 leading-5"},Uo={class:"flex justify-between items-center h-5 leading-5"},zo={class:"flex justify-between items-center font-medium h-60px text-20px mt-28px mb-37px border-t-1 border-b-1 border-[#dcdfe6] dark:border-[#4c4d4f]"},Go={class:"flex items-center justify-center"},Sn=je({setup(i){const{t}=Oe(),e=Ue(),r=ft("CreditCard"),o=ft(!1);let n;const a=ft(),s=ft(),l=ft({id:"",type:"",isDefault:!1,display:""}),u=d=>{l.value=JSON.parse(JSON.stringify(d)),o.value=!1},c=ft({cardNumber:"",year:"",month:"",name:"",cvc:""}),h={name:[Et(t("common.fieldRequiredTips")),Ke(1,50)],cardNumber:[Et(t("common.fieldRequiredTips"))],year:[Et(t("common.fieldRequiredTips"))],month:[Et(t("common.fieldRequiredTips"))],cvc:[Et(t("common.fieldRequiredTips")),Xe()]},y=ft(),C=ft([1,2,3,4,5,6,7,8,9,10,11,12]),A=ft([2023,2024,2025,2026,2027,2028,2029,2030,2031,2032,2033,2034,2035,2036,2037,2038,2039,2040,2041,2042,2043,2044,2045,2046,2047,2048,2049,2050,2051,2052,2053,2054,2055,2056,2057,2058,2059,2060,2061,2062,2063,2064,2065,2066,2067,2068,2069,2070,2071,2072,2073]),T=ft(),R=ze("orderId"),p=()=>ct(this,null,function*(){let d;o.value?(yield y.value.validate(),d=yield We({name:c.value.name,cardNumber:c.value.cardNumber.replaceAll("-",""),year:c.value.year,month:c.value.month,cvc:c.value.cvc,orderId:R})):d=yield qe(l.value.id,R),d.success?e.push({name:"consoleOrder"}):window.location.href=d.redirectUrl});fe(()=>o.value,()=>{o.value||(c.value.cardNumber="",c.value.year="",c.value.month="",c.value.name="",c.value.cvc="")}),(()=>ct(this,null,function*(){R&&(s.value=yield Ye(R)),a.value=yield Qe(),a.value.length&&(l.value=a.value.filter(d=>d.isDefault)[0])}))();function k(){return ct(this,null,function*(){var d=`marketOrder/CheckStatus?id=${T.value.requestId}`,g=yield Ze.get(d,void 0,{hiddenLoading:!0});g.paid&&(clearInterval(n),e.push({name:"consoleOrder"}))})}return fe(()=>r.value,()=>ct(this,null,function*(){r.value==="WechatPay"&&R?(T.value=yield Je(R),n=setInterval(k,1e3)):clearInterval(n)})),Ge(()=>{clearInterval(n)}),(d,g)=>{var ut,U,et,st,z,rt,Bt,W;const v=er,w=rr,_=or,D=nr,L=ir,f=ar,M=lr,x=cr,O=sr,b=ur;return Q(),it("div",vo,[K(v,{class:"iconfont icon-fanhui1 cursor-pointer hover:text-blue",title:X(t)("common.back"),onClick:g[0]||(g[0]=S=>d.$router.back())},null,8,["title"]),F("h1",bo,Y(X(t)("order.checkout")),1),F("div",yo,[F("div",wo,[F("div",xo,[F("h1",Co,Y((ut=s.value)==null?void 0:ut.title),1)]),F("ul",_o,[F("li",ko,[F("div",{innerHTML:(U=s.value)==null?void 0:U.summary},null,8,Po)])]),K(w,{class:"mt-28px mb-20px"}),F("h1",Ao,Y(X(t)("common.paymentMethod")),1),K(D,{modelValue:r.value,"onUpdate:modelValue":g[1]||(g[1]=S=>r.value=S),class:"el-tabs--hide-content partnerTab mb-28px"},{default:dt(()=>[K(_,{label:X(t)("common.creditCard"),name:"CreditCard"},null,8,["label"]),K(_,{label:X(t)("common.wechatPay"),name:"WechatPay"},null,8,["label"])]),_:1},8,["modelValue"]),r.value==="CreditCard"?(Q(),it("div",To,[F("div",Bo,[(Q(!0),it(Ft,null,Nt(a.value,S=>{var kt;return Q(),it("div",{key:S.display,class:He(["w-94px h-36px rounded-full flex items-center justify-center cursor-pointer",S.id===((kt=l.value)==null?void 0:kt.id)&&!o.value?"bg-blue text-fff":"bg-[#192845] bg-opacity-5 dark:bg-666"]),onClick:Vt=>u(S)}," *"+Y(S.display),11,Do)}),128)),o.value?At("",!0):(Q(),it("div",{key:0,class:"w-36px h-36px rounded-full bg-blue flex items-center justify-center cursor-pointer",onClick:g[2]||(g[2]=S=>o.value=!0)},[K(v,{class:"iconfont icon-a-addto text-fff font-medium"})]))]),o.value?(Q(),Xt(O,{key:0,ref_key:"form",ref:y,model:c.value,rules:h,"label-position":"top",onSubmit:g[10]||(g[10]=$e(()=>{},["prevent"]))},{default:dt(()=>[F("div",Eo,[K(f,{prop:"cardNumber",label:X(t)("common.cardNumber"),class:"!mr-32"},{default:dt(()=>[K(L,{modelValue:c.value.cardNumber,"onUpdate:modelValue":g[3]||(g[3]=S=>c.value.cardNumber=S),class:"w-260px",maxlength:"19",placeholder:"0000-0000-0000-0000",onInput:g[4]||(g[4]=S=>c.value.cardNumber=c.value.cardNumber.replace(/\s/g,"").replace(/[^\d]/g,"").replace(/(\d{4})(?=\d)/g,"$1-"))},null,8,["modelValue"])]),_:1},8,["label"]),F("div",So,[K(f,{prop:"month",label:X(t)("common.expirationDate"),class:"flex-1"},{default:dt(()=>[K(x,{modelValue:c.value.month,"onUpdate:modelValue":g[5]||(g[5]=S=>c.value.month=S),class:"",placeholder:X(t)("common.month"),size:"large"},{default:dt(()=>[(Q(!0),it(Ft,null,Nt(C.value,S=>(Q(),Xt(M,{key:S,label:S,value:S},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),K(f,{prop:"year",class:"flex-1 yearFormItem",label:" "},{default:dt(()=>[K(x,{modelValue:c.value.year,"onUpdate:modelValue":g[6]||(g[6]=S=>c.value.year=S),class:"",placeholder:X(t)("common.year"),size:"large"},{default:dt(()=>[(Q(!0),it(Ft,null,Nt(A.value,S=>(Q(),Xt(M,{key:S,label:S,value:S},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1})])]),F("div",Io,[K(f,{prop:"name",label:X(t)("common.nameOnCard"),class:"mr-32"},{default:dt(()=>[K(L,{modelValue:c.value.name,"onUpdate:modelValue":g[7]||(g[7]=S=>c.value.name=S),class:"w-260px",placeholder:X(t)("common.enterYourNameHere")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),K(f,{prop:"cvc",label:X(t)("common.cvc"),class:"flex-1"},{default:dt(()=>[K(L,{modelValue:c.value.cvc,"onUpdate:modelValue":g[8]||(g[8]=S=>c.value.cvc=S),class:"w-full",maxlength:"3",placeholder:X(t)("common.enterCVCHere"),onInput:g[9]||(g[9]=S=>c.value.cvc=c.value.cvc.replace(/\s/g,"").replace(/[^\d]/g,""))},null,8,["modelValue","placeholder"])]),_:1},8,["label"])])]),_:1},8,["model"])):At("",!0)])):At("",!0),r.value==="WechatPay"?(Q(),it("div",Lo,[T.value?(Q(),it("div",Mo,[K(mo,{text:T.value.nextAction.responseData,size:2e3,class:"transform scale-75"},null,8,["text"]),Fo])):At("",!0)])):At("",!0)]),F("div",No,[F("h1",Ro,Y(X(t)("common.orderSummary")),1),(Q(!0),it(Ft,null,Nt((et=s.value)==null?void 0:et.items,S=>(Q(),it("div",{key:S.name,class:"flex justify-between items-center h-6 leading-6 text-m my-8"},[F("span",null,Y(S.name),1),F("span",Oo,Y(S.price),1)]))),128)),K(w,{class:"mb-28px mt-5"}),F("ul",$o,[F("li",jo,[F("span",null,Y(X(t)("common.subtotal")),1),F("span",null,Y((st=s.value)==null?void 0:st.subTotal),1)]),F("li",Uo,[F("span",null,Y(X(t)("common.vat")),1),F("span",null,Y((z=s.value)==null?void 0:z.tax),1)])]),F("div",zo,[F("span",null,Y(X(t)("common.total"))+" ("+Y((rt=s.value)==null?void 0:rt.currency)+")",1),F("span",null,Y((Bt=s.value)==null?void 0:Bt.total),1)]),F("span",Go,[K(b,{type:"primary",round:"",class:"w-300px",disabled:r.value==="WechatPay"||!o.value&&((W=l.value)==null?void 0:W.id)==="",onClick:p},{default:dt(()=>[Ve(Y(r.value==="CreditCard"?X(t)("common.submitPayment"):X(t)("common.scanToPay")),1)]),_:1},8,["disabled"])])])])])}}});export{Sn as default};
