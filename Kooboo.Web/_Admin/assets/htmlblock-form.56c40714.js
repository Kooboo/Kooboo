var v=(g,h,n)=>new Promise((l,o)=>{var p=e=>{try{r(n.next(e))}catch(c){o(c)}},u=e=>{try{r(n.throw(e))}catch(c){o(c)}},r=e=>e.done?l(e.value):Promise.resolve(e.value).then(p,u);r((n=n.apply(g,h)).next())});import{g as j,v as q,w as I}from"./i18n.a87944a4.js";import{_ as F}from"./index.f154d010.js";import{a as S,r as $,s as x,i as A}from"./validate.bb56f9e3.js";import{i as C,a as K,u as L}from"./html-block.ea040376.js";import{_ as D}from"./index.f0ea490f.js";import{g as G,u as H}from"./main.9fdfea92.js";import{e as O}from"./guid.c1a40312.js";import{d as z,g as J,G as P,c as k,h as Q,i as T,K as W,cj as X,o as f,a as B,f as Y,b as _,w as b,u as s,j as V,aI as Z,t as ee,F as ae,b7 as te,e as se}from"./url.4cb47a7a.js";import{u as oe}from"./use-save-tip.e3dc783a.js";import{E as ne,a as le}from"./index.9fd79879.js";import{E as ie}from"./index.178b9e08.js";const re={class:"flex justify-end mb-8"},Ve=z({props:{id:null},setup(g,{expose:h}){const n=g,{t:l}=j(),o=G(),p=J(),u=H(),r=oe(),e=P({id:O,name:"",values:{}}),c={name:[S(l("common.fieldRequiredTips")),$(1,50),x(),A(C,l("common.valueHasBeenTakenTips"))],contentTypeId:[S(l("common.fieldRequiredTips"))]},E=k(()=>!n.id);k(()=>o.visible&&Object.keys(o.cultures).length>1),Q(()=>v(this,null,function*(){if(n.id){const a=yield K({id:n.id,name:n.id});e.name=a.name,e.id=a.id;for(const t in e.values)e.values[t]=a.values[t]||""}r.init(e)})),T(()=>o.cultures,a=>{if(a){const t=o.default;Object.keys(a).sort((i,w)=>i===t?-1:w===t?1:0).forEach(i=>e.values[i]=e.values[i]||"")}},{immediate:!0});function M(a){let t=l("common.content");return a===o.default?o.selected.length>1?t+` - ${a} (`+l("common.default")+")":t:t+` - ${a}`}function N(a){return o.selected.includes(a)}function R(){return v(this,null,function*(){var a;yield(a=p.value)==null?void 0:a.validate(),yield L(e),r.init(e)})}return h({save:R,model:e}),W(()=>{u.firstActiveMenu=""}),X((a,t,m)=>v(this,null,function*(){var i;a.name==="login"?m():(u.firstActiveMenu=(i=a.meta.activeMenu)!=null?i:a.name,yield r.check(e).then(()=>{m()}).catch(()=>{u.firstActiveMenu="htmlblocks",m(!1)}))})),T(()=>e,()=>{r.changed(e)},{deep:!0}),(a,t)=>{const m=ne,i=ie,w=le;return f(),B("div",null,[Y("div",re,[_(F)]),_(w,{ref_key:"form",ref:p,model:s(e),rules:s(c),"label-width":"auto",onSubmit:t[1]||(t[1]=I(()=>{},["prevent"]))},{default:b(()=>[s(E)?(f(),V(m,{key:1,prop:"name",label:s(l)("common.name")},{default:b(()=>[_(i,{modelValue:s(e).name,"onUpdate:modelValue":t[0]||(t[0]=y=>s(e).name=y)},null,8,["modelValue"])]),_:1},8,["label"])):(f(),V(m,{key:0,label:s(l)("common.name")},{default:b(()=>[Z(ee(s(e).name),1)]),_:1},8,["label"])),(f(!0),B(ae,null,te(s(e).values,(y,d)=>se((f(),V(m,{key:d,label:M(d),class:"label-right"},{default:b(()=>[_(D,{modelValue:s(e).values[d],"onUpdate:modelValue":U=>s(e).values[d]=U},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])),[[q,N(d)]])),128))]),_:1},8,["model","rules"])])}}});export{Ve as _};
