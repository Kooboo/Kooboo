var N=Object.defineProperty,T=Object.defineProperties;var $=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var b=(t,o,e)=>o in t?N(t,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[o]=e,v=(t,o)=>{for(var e in o||(o={}))K.call(o,e)&&b(t,e,o[e]);if(g)for(var e of g(o))L.call(o,e)&&b(t,e,o[e]);return t},C=(t,o)=>T(t,$(o));var V=(t,o,e)=>new Promise((c,_)=>{var f=n=>{try{i(e.next(n))}catch(u){_(u)}},m=n=>{try{i(e.throw(n))}catch(u){_(u)}},i=n=>n.done?c(n.value):Promise.resolve(n.value).then(f,m);i((e=e.apply(t,o)).next())});import{_ as U,a as A}from"./verify-button.a565bd86.js";import{g as D,o as M}from"./i18n.97105311.js";import{_ as P}from"./container.897c9065.js";import{d as z,E as H,aq as j,cd as G,M as J,g as E,o as O,a as Q,b as l,w as p,u as r,f as W,aH as X,t as Y}from"./url.2e6a77c4.js";import{a as x,p as Z,A as ee}from"./validate.98ddbafd.js";import{v as oe,s as te}from"./index.81ae6b99.js";import{u as re}from"./use-first-input-focus.12142181.js";import{E as ne,b as ae}from"./main.52487121.js";import{S as le,E as se,a as ie}from"./index.317a7f30.js";import{E as pe}from"./index.4587e608.js";import{E as me}from"./index.b09a9f00.js";import{E as ue}from"./index.f997a738.js";import"./country-and-region-codes.c36488d2.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./plugin-vue_export-helper.41ffa612.js";import"./windi.539ebeab.js";import"./index.6ebaed6b.js";import"./logo-transparent.1566007e.js";import"./light-switch.b8936b7e.js";import"./dark.ea14b486.js";import"./index.99641a60.js";import"./index.77759eed.js";import"./replace-all.8fa5a83d.js";import"./index.b1fe55d8.js";import"./index.51a59403.js";import"./index.29d7c76d.js";import"./style.f835519e.js";import"./toNumber.574be4f1.js";import"./_baseIsEqual.abb55a3a.js";import"./index.50c16ae5.js";import"./preload-helper.13a99eb0.js";import"./error.7e8331f1.js";import"./index.9e96921b.js";import"./_baseClone.f10ff33c.js";import"./isEqual.3700b7f1.js";import"./event.776e7e11.js";import"./isNil.98bb3b88.js";const de={class:"h-full overflow-hidden"},ce={class:"flex items-center space-x-8"},Ye=z({setup(t){const{t:o}=D();re();const e=H({phone:"",code:"",regionCode:"+86",returnurl:""}),c={phone:[x(o("common.inputPhoneTips")),Z],code:[x(o("common.inputSecurityCodeTips")),ee]},_=new le({phone:c.phone}),f=j(null),m=G(),i=J();i.query.returnurl&&(e.returnurl=i.query.returnurl);const n=()=>V(this,null,function*(){yield f.value.validate();const a=yield oe(`${e.regionCode}${e.phone}`,e.code,e.returnurl);if(a.error){ne.error(a.error);return}a.requireinfo?m.replace({name:"bind-name",query:C(v({},m.currentRoute.value.query),{id:a.verifyid})}):(ae().login(a.access_token),m.replace({name:"home"}))}),u=E(!1),h=E(!0),w=(a,s)=>{a==="phone"&&(u.value=s)},k=()=>{_.validate({phone:e.phone},a=>{h.value=!!a})},q=()=>{te(e.regionCode+e.phone)};return(a,s)=>{const R=A,y=se,I=pe,S=ie,B=me,F=ue;return O(),Q("div",de,[l(F,null,{default:p(()=>[l(P,{title:r(o)("common.phoneLogin"),back:"",onKeypress:M(n,["enter"])},{default:p(()=>[l(S,{ref_key:"form",ref:f,"label-position":"top",model:r(e),rules:r(c),"hide-required-asterisk":"",onValidate:w},{default:p(()=>[l(y,{label:r(o)("common.phoneNumber"),prop:"phone"},{default:p(()=>[l(R,{modelValue:r(e).phone,"onUpdate:modelValue":s[0]||(s[0]=d=>r(e).phone=d),regionCode:r(e).regionCode,"onUpdate:regionCode":s[1]||(s[1]=d=>r(e).regionCode=d),"data-cy":"phone-number",onInput:k},null,8,["modelValue","regionCode"])]),_:1},8,["label"]),l(y,{label:r(o)("common.securityCode"),prop:"code"},{default:p(()=>[W("div",ce,[l(I,{modelValue:r(e).code,"onUpdate:modelValue":s[2]||(s[2]=d=>r(e).code=d),class:"phone_login__code_input",maxlength:"4","data-cy":"security-code"},null,8,["modelValue"]),l(U,{disabled:h.value,"data-cy":"send-security-code",onClick:q},null,8,["disabled"])])]),_:1},8,["label"])]),_:1},8,["model","rules"]),l(B,{class:"w-full text-l h-48px",round:"",type:"primary",size:"large","data-cy":"login",onClick:n},{default:p(()=>[X(Y(r(o)("common.login")),1)]),_:1})]),_:1},8,["title","onKeypress"])]),_:1})])}}});export{Ye as default};
