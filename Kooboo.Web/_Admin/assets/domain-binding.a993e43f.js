var w=(k,d,m)=>new Promise((v,n)=>{var u=e=>{try{c(m.next(e))}catch(s){n(s)}},p=e=>{try{c(m.throw(e))}catch(s){n(s)}},c=e=>e.done?v(e.value):Promise.resolve(e.value).then(u,p);c((m=m.apply(k,d)).next())});import{g as S,w as F}from"./i18n.97105311.js";import{u as U}from"./use-operation-dialog.6127483f.js";import{m as q,a as C,r as T,d as A}from"./validate.98ddbafd.js";import{f as M,m as O,n as j,o as G,q as H}from"./index.934159ee.js";import{d as B,M as Q,g as b,i as W,o as x,j as E,w as l,b as i,u as t,f as D,t as y,a as h,b6 as z,F as J,G as K,E as P,aH as X,cg as Y,x as Z}from"./url.2e6a77c4.js";import{_ as ee}from"./index.9ffc2c80.js";import{W as oe}from"./main.52487121.js";import{_ as te}from"./plugin-vue_export-helper.21dcd24c.js";import{E as ae}from"./index.4587e608.js";import{E as le,a as ie}from"./index.317a7f30.js";import{E as ne,a as se}from"./index.afee24fe.js";import{E as me}from"./index.4b289bae.js";import{_ as re}from"./k-table.e9121736.js";import{b as de}from"./confirm.46f27373.js";import{E as ue}from"./index.b09a9f00.js";import{E as pe}from"./index.f3d28a97.js";import"./index.99641a60.js";import"./index.77759eed.js";import"./replace-all.8fa5a83d.js";import"./index.b1fe55d8.js";import"./index.51a59403.js";import"./index.29d7c76d.js";import"./style.f835519e.js";import"./toNumber.574be4f1.js";import"./_baseIsEqual.abb55a3a.js";import"./index.50c16ae5.js";import"./windi.539ebeab.js";import"./preload-helper.13a99eb0.js";import"./event.776e7e11.js";import"./index.9e96921b.js";import"./error.7e8331f1.js";import"./isNil.98bb3b88.js";import"./_baseClone.f10ff33c.js";import"./isEqual.3700b7f1.js";import"./index.9589f7cf.js";import"./focus-trap.de18cf8f.js";import"./event.53b2ad83.js";import"./index.f997a738.js";import"./index.bc93d068.js";import"./scroll.8babc10c.js";import"./debounce.61c67278.js";import"./index.a46fa52c.js";import"./validator.1d438d08.js";import"./index.07e210fb.js";import"./refs.4001ce17.js";import"./sortable.esm.a99254e8.js";import"./icon-button.e1f3bfd2.js";import"./index.975a8825.js";import"./index.7a88a6b5.js";import"./index.c1764395.js";import"./index.6302b2c1.js";import"./logo-transparent.1566007e.js";import"./index.d267cbe6.js";import"./aria.75ec5909.js";const ce=["title"],fe=B({props:{modelValue:{type:Boolean},domain:null},emits:["create-success"],setup(k,{emit:d}){const m=k,v=Q(),{t:n}=S(),{visible:u,handleClose:p}=U(m,d),c=b(),e=b(),s=b(),o=b({subDomain:"",rootDomain:"",SiteId:""}),g={subDomain:[q,C(n("common.inputValue")),T(1,63),A(o.value)],SiteId:[C(n("common.inputValue"))]};W(()=>u.value,_=>w(this,null,function*(){var a,I;_&&(c.value=yield oe(),e.value=yield M(),(a=s.value)==null||a.resetFields(),o.value.subDomain="",o.value.rootDomain=e.value.filter(V=>V.id===v.query.id)[0].domainName,o.value.SiteId=(I=c.value[0])==null?void 0:I.siteId)}));function r(){var _;(_=s.value)==null||_.validate(a=>w(this,null,function*(){a&&(yield O(o.value.subDomain,o.value.rootDomain,o.value.SiteId),p(),d("create-success"))}))}return(_,a)=>{const I=ae,V=le,N=ne,L=se,R=ie,$=me;return x(),E($,{modelValue:t(u),"onUpdate:modelValue":a[3]||(a[3]=f=>K(u)?u.value=f:null),width:"600px","close-on-click-modal":!1,title:t(n)("common.newBinding"),onClose:t(p)},{footer:l(()=>[i(ee,{"confirm-label":t(n)("common.create"),onConfirm:r,onCancel:t(p)},null,8,["confirm-label","onCancel"])]),default:l(()=>[i(R,{ref_key:"form",ref:s,class:"el-form--label-normal",model:o.value,rules:t(g),"label-position":"top",onSubmit:a[2]||(a[2]=F(()=>{},["prevent"]))},{default:l(()=>[i(V,{prop:"subDomain",label:t(n)("common.domain")},{default:l(()=>[i(I,{modelValue:o.value.subDomain,"onUpdate:modelValue":a[0]||(a[0]=f=>o.value.subDomain=f),placeholder:"www","data-cy":"subdomain"},{append:l(()=>[D("span",{disabled:"",class:"ellipsis max-w-240px px-16 dark:bg-[#222] dark:rounded-tr-normal dark:rounded-br-normal dark:border-[#4c4d4f] dark:border-1 border-solid dark:border-l-0",title:o.value.rootDomain,"data-cy":"root-domain"},"."+y(o.value.rootDomain),9,ce)]),_:1},8,["modelValue"])]),_:1},8,["label"]),i(V,{prop:"SiteId",label:t(n)("common.site")},{default:l(()=>[i(L,{modelValue:o.value.SiteId,"onUpdate:modelValue":a[1]||(a[1]=f=>o.value.SiteId=f),class:"w-full"},{default:l(()=>[(x(!0),h(J,null,z(c.value,f=>(x(),E(N,{key:f.siteId,label:f.siteDisplayName,value:f.siteId,"data-cy":"site-opt"},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title","onClose"])}}});var _e=te(fe,[["__scopeId","data-v-7327bb0f"]]);const be={class:"p-24"},ve={class:"flex items-center pb-24 space-x-16"},ge={class:"flex items-center"},we=["href"],ko=B({setup(k){const{t:d}=S(),m=P({status:!1,open(){m.status=!0}}),v=e=>{Y("//"+e)},n=b(),u=b();function p(){return w(this,null,function*(){const e=Z("id");e&&(u.value=yield j(e),n.value=yield G(e))})}p();function c(e){return w(this,null,function*(){e.length&&(yield de(e.length),yield H(e.map(s=>s.id)),p())})}return(e,s)=>{const o=ue,g=pe;return x(),h("div",be,[D("div",ve,[i(o,{round:"",onClick:t(m).open},{default:l(()=>[D("div",ge,y(t(d)("common.new")),1)]),_:1},8,["onClick"])]),i(t(re),{data:u.value,"show-check":"",onDelete:c},{default:l(()=>[i(g,{label:t(d)("common.domain")},{default:l(({row:r})=>[D("span",null,y(r.fullName),1)]),_:1},8,["label"]),i(g,{label:t(d)("common.site")},{default:l(({row:r})=>[D("a",{class:"cursor-pointer text-blue",href:`/_Admin/site?SiteId=${r.webSiteId}`,target:"_blank","data-cy":"site-name"},y(r.siteName),9,we)]),_:1},8,["label"]),i(g,{width:"150px",align:"center"},{default:l(({row:r})=>[i(o,{type:"primary",round:"",onClick:_=>v(r.fullName)},{default:l(()=>[X(y(t(d)("common.preview")),1)]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),i(_e,{modelValue:t(m).status,"onUpdate:modelValue":s[0]||(s[0]=r=>t(m).status=r),domain:n.value,onCreateSuccess:p},null,8,["modelValue","domain"])])}}});export{ko as default};
