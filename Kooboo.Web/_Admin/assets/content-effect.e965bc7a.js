var Q=Object.defineProperty,U=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var M=(n,s,r)=>s in n?Q(n,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[s]=r,$=(n,s)=>{for(var r in s||(s={}))X.call(s,r)&&M(n,r,s[r]);if(F)for(var r of F(s))Y.call(s,r)&&M(n,r,s[r]);return n},b=(n,s)=>U(n,W(s));var O=(n,s,r)=>new Promise((S,y)=>{var w=u=>{try{g(r.next(u))}catch(l){y(l)}},m=u=>{try{g(r.throw(u))}catch(l){y(l)}},g=u=>u.done?S(u.value):Promise.resolve(u.value).then(w,m);g((r=r.apply(n,s)).next())});import{e as Z,S as z,g as ee}from"./textContent.49dfc8fa.js";import{g as d,cd as te,M as oe,E as re,i as ae,ch as se}from"./url.2e6a77c4.js";import{d as j}from"./dayjs.min.378b3d72.js";import{u as ne}from"./use-date.88693eba.js";import{o as I}from"./omitBy.7923fe31.js";import{c as x}from"./index.aea1b33f.js";import{i as K}from"./isEmpty.fff03236.js";function ye(n,s,r){const S=d([]),y=d([]),w=d(!1),m=d([]),g=te(),u=oe(),l=re({currentPage:1,pageCount:0,pageSize:30}),h=d(""),C=d(""),k=d({}),B=d([]),c=d({prop:"",order:"ascending"});function D(){return O(this,null,function*(){h.value=C.value.trim(),yield P(1,l.pageSize)})}const N=se(D,1e3);ae(()=>C.value,()=>{N()});function R(){Z({folderId:n,keyword:h.value,categories:I(k.value,t=>K(t)),exclude:r})}function _(t,o,e){const p=I(k.value,a=>K(a));if(h.value){const a={folderId:n,pageNr:t,pageSize:o!=null?o:30,keyword:h.value,categories:p,exclude:e};return c.value.prop&&(a.sortField=c.value.prop,a.ascending=c.value.order==="ascending"),z(a)}else{const a={folderId:n,pageNr:t,pageSize:o!=null?o:30,categories:p,exclude:e};return c.value.prop&&(a.sortField=c.value.prop,a.ascending=c.value.order==="ascending"),ee(a)}}function P(t,o){return O(this,null,function*(){var p,a,i,f;t||(t=+((p=u.query.pageNr)!=null?p:1));const e=yield _(t,(a=o!=null?o:l.pageSize)!=null?a:30,r);B.value=(i=e.categories)!=null?i:[],m.value=((f=e.columns)!=null?f:[]).map(v=>(v.name=x(v.name),v)),y.value=e.list,A(e.list,m.value),l.currentPage=e.pageNr,l.pageCount=e.totalPages,l.pageSize=e.pageSize,s||g.replace({query:b($({},u.query),{pageNr:t})})})}function A(t,o){S.value=t.map(e=>{const p={id:e.id,online:e.online,lastModified:e.lastModified,usedBy:e.usedBy,order:e.order};for(const a in e.textValues){let i=e.textValues[a];const f=o.find(v=>v.name==x(a));if(f!=null&&f.selectionOptions)try{const v=JSON.parse(f.selectionOptions);let L=[i];f.controlType=="CheckBox"&&(L=JSON.parse(i));const q=[];for(const T of L){const V=v.find(H=>H.value==T);V?q.push(V.key):q.push(T)}i=q.join(",")}catch(v){}p[x(a)]=i,i&&j(i).isValid()&&i===j(i).toISOString()&&(p[x(a)]=ne(i))}return p}),w.value=!0}function E(){const{SiteId:t,folder:o}=u.query;return`${t}_TextContent_${o}`}function G(t){return O(this,null,function*(){var o;c.value.prop=(o=t.prop)!=null?o:"",c.value.order=t.order,localStorage.setItem(E(),JSON.stringify(c.value)),yield D()})}function J(){const t=localStorage.getItem(E());if(t){const{prop:o,order:e}=JSON.parse(t);c.value.prop=o,c.value.order=e}}return J(),{keywords:C,currentKeyword:h,pagination:l,list:S,rawList:y,columns:m,fetchList:P,columnLoaded:w,sortSetting:c,searchCategories:k,categoryOptions:B,onSortChanged:G,initSortSetting:J,exportData:R}}export{ye as u};
